<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Beyond Basic Numerics and Statistics | R Cookbook, 2nd Edition</title>
  <meta name="description" content="Second edition of R Cookbook" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Beyond Basic Numerics and Statistics | R Cookbook, 2nd Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Second edition of R Cookbook" />
  <meta name="github-repo" content="CerebralMastication/R-Cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Beyond Basic Numerics and Statistics | R Cookbook, 2nd Edition" />
  
  <meta name="twitter:description" content="Second edition of R Cookbook" />
  

<meta name="author" content="James (JD) Long" />
<meta name="author" content="Paul Teetor" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="UsefulTricks.html"/>
<link rel="next" href="TimeSeriesAnalysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129487349-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-129487349-3');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R Cookbook 2nd Edition</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to the R Cookbook 2nd Edition</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-recipes"><i class="fa fa-check"></i>The Recipes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-note-on-terminology"><i class="fa fa-check"></i>A Note on Terminology</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-and-platform-notes"><i class="fa fa-check"></i>Software and Platform Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions Used in This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-code-examples"><i class="fa fa-check"></i>Using Code Examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#safari-books-online"><i class="fa fa-check"></i>Safari® Books Online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i><b>1</b> Getting Started and Getting Help</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#intro-GettingStarted"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1.1" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id001"><i class="fa fa-check"></i><b>1.1</b> Downloading and Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id002b"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-startingrstudio"><i class="fa fa-check"></i><b>1.3</b> Starting RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id007"><i class="fa fa-check"></i><b>1.4</b> Entering Commands</a></li>
<li class="chapter" data-level="1.5" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id097"><i class="fa fa-check"></i><b>1.5</b> Exiting from RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id100"><i class="fa fa-check"></i><b>1.6</b> Interrupting R</a></li>
<li class="chapter" data-level="1.7" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id265"><i class="fa fa-check"></i><b>1.7</b> Viewing the Supplied Documentation</a></li>
<li class="chapter" data-level="1.8" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id003"><i class="fa fa-check"></i><b>1.8</b> Getting Help on a Function</a></li>
<li class="chapter" data-level="1.9" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id267"><i class="fa fa-check"></i><b>1.9</b> Searching the Supplied Documentation</a></li>
<li class="chapter" data-level="1.10" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id266"><i class="fa fa-check"></i><b>1.10</b> Getting Help on a Package</a></li>
<li class="chapter" data-level="1.11" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id005"><i class="fa fa-check"></i><b>1.11</b> Searching the Web for Help</a></li>
<li class="chapter" data-level="1.12" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id270"><i class="fa fa-check"></i><b>1.12</b> Finding Relevant Functions and Packages</a></li>
<li class="chapter" data-level="1.13" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id268"><i class="fa fa-check"></i><b>1.13</b> Searching the Mailing Lists</a></li>
<li class="chapter" data-level="1.14" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id269"><i class="fa fa-check"></i><b>1.14</b> Submitting Questions to Stack Overflow or Elsewhere in the Community</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="SomeBasics.html"><a href="SomeBasics.html"><i class="fa fa-check"></i><b>2</b> Some Basics</a>
<ul>
<li class="chapter" data-level="" data-path="SomeBasics.html"><a href="SomeBasics.html#intro-SomeBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2.1" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id017"><i class="fa fa-check"></i><b>2.1</b> Printing Something to the Screen</a></li>
<li class="chapter" data-level="2.2" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id016"><i class="fa fa-check"></i><b>2.2</b> Setting Variables</a></li>
<li class="chapter" data-level="2.3" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id091"><i class="fa fa-check"></i><b>2.3</b> Listing Variables</a></li>
<li class="chapter" data-level="2.4" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id075"><i class="fa fa-check"></i><b>2.4</b> Deleting Variables</a></li>
<li class="chapter" data-level="2.5" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id038"><i class="fa fa-check"></i><b>2.5</b> Creating a Vector</a></li>
<li class="chapter" data-level="2.6" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id101"><i class="fa fa-check"></i><b>2.6</b> Computing Basic Statistics</a></li>
<li class="chapter" data-level="2.7" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id021"><i class="fa fa-check"></i><b>2.7</b> Creating Sequences</a></li>
<li class="chapter" data-level="2.8" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id020"><i class="fa fa-check"></i><b>2.8</b> Comparing Vectors</a></li>
<li class="chapter" data-level="2.9" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id039"><i class="fa fa-check"></i><b>2.9</b> Selecting Vector Elements</a></li>
<li class="chapter" data-level="2.10" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id019"><i class="fa fa-check"></i><b>2.10</b> Performing Vector Arithmetic</a></li>
<li class="chapter" data-level="2.11" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id018"><i class="fa fa-check"></i><b>2.11</b> Getting Operator Precedence Right</a></li>
<li class="chapter" data-level="2.12" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id022"><i class="fa fa-check"></i><b>2.12</b> Typing Less and Accomplishing More</a></li>
<li class="chapter" data-level="2.13" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-pipe-2"><i class="fa fa-check"></i><b>2.13</b> Creating a Pipeline of Function Calls</a></li>
<li class="chapter" data-level="2.14" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id025"><i class="fa fa-check"></i><b>2.14</b> Avoiding Some Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html"><i class="fa fa-check"></i><b>3</b> Navigating the Software</a>
<ul>
<li class="chapter" data-level="" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#intro-NavigatingTheSoftware"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="3.1" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id008"><i class="fa fa-check"></i><b>3.1</b> Getting and Setting the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-CreateProject"><i class="fa fa-check"></i><b>3.2</b> Creating a New RStudio Project</a></li>
<li class="chapter" data-level="3.3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id009"><i class="fa fa-check"></i><b>3.3</b> Saving Your Workspace</a></li>
<li class="chapter" data-level="3.4" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id023"><i class="fa fa-check"></i><b>3.4</b> Viewing Your Command History</a></li>
<li class="chapter" data-level="3.5" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id024"><i class="fa fa-check"></i><b>3.5</b> Saving the Result of the Previous Command</a></li>
<li class="chapter" data-level="3.6" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id010"><i class="fa fa-check"></i><b>3.6</b> Displaying Loaded Packages via the Search Path</a></li>
<li class="chapter" data-level="3.7" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id094"><i class="fa fa-check"></i><b>3.7</b> Viewing the List of Installed Packages</a></li>
<li class="chapter" data-level="3.8" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id013"><i class="fa fa-check"></i><b>3.8</b> Accessing the Functions in a Package</a></li>
<li class="chapter" data-level="3.9" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id257"><i class="fa fa-check"></i><b>3.9</b> Accessing Built-in Datasets</a></li>
<li class="chapter" data-level="3.10" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id012"><i class="fa fa-check"></i><b>3.10</b> Installing Packages from CRAN</a></li>
<li class="chapter" data-level="3.11" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-installGH"><i class="fa fa-check"></i><b>3.11</b> Installing a Package from GitHub</a></li>
<li class="chapter" data-level="3.12" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id272"><i class="fa fa-check"></i><b>3.12</b> Setting or Changing a Default CRAN Mirror</a></li>
<li class="chapter" data-level="3.13" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id014"><i class="fa fa-check"></i><b>3.13</b> Running a Script</a></li>
<li class="chapter" data-level="3.14" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id015"><i class="fa fa-check"></i><b>3.14</b> Running a Batch Script</a></li>
<li class="chapter" data-level="3.15" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id102"><i class="fa fa-check"></i><b>3.15</b> Locating the R Home Directory</a></li>
<li class="chapter" data-level="3.16" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id099"><i class="fa fa-check"></i><b>3.16</b> Customizing R Startup</a></li>
<li class="chapter" data-level="3.17" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-Rcloud"><i class="fa fa-check"></i><b>3.17</b> Using R and RStudio in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="InputAndOutput.html"><a href="InputAndOutput.html"><i class="fa fa-check"></i><b>4</b> Input and Output</a>
<ul>
<li class="chapter" data-level="" data-path="InputAndOutput.html"><a href="InputAndOutput.html#intro-InputAndOutput"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="4.1" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id035"><i class="fa fa-check"></i><b>4.1</b> Entering Data from the Keyboard</a></li>
<li class="chapter" data-level="4.2" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id036"><i class="fa fa-check"></i><b>4.2</b> Printing Fewer Digits (or More Digits)</a></li>
<li class="chapter" data-level="4.3" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id034"><i class="fa fa-check"></i><b>4.3</b> Redirecting Output to a File</a></li>
<li class="chapter" data-level="4.4" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id030"><i class="fa fa-check"></i><b>4.4</b> Listing Files</a></li>
<li class="chapter" data-level="4.5" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id033"><i class="fa fa-check"></i><b>4.5</b> Dealing with “Cannot Open File” in Windows</a></li>
<li class="chapter" data-level="4.6" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id136"><i class="fa fa-check"></i><b>4.6</b> Reading Fixed-Width Records</a></li>
<li class="chapter" data-level="4.7" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id245"><i class="fa fa-check"></i><b>4.7</b> Reading Tabular Data Files</a></li>
<li class="chapter" data-level="4.8" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id027"><i class="fa fa-check"></i><b>4.8</b> Reading from CSV Files</a></li>
<li class="chapter" data-level="4.9" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id028"><i class="fa fa-check"></i><b>4.9</b> Writing to CSV Files</a></li>
<li class="chapter" data-level="4.10" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id031"><i class="fa fa-check"></i><b>4.10</b> Reading Tabular or CSV Data from the Web</a></li>
<li class="chapter" data-level="4.11" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readexcel"><i class="fa fa-check"></i><b>4.11</b> Reading Data from Excel</a></li>
<li class="chapter" data-level="4.12" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-writeexcel"><i class="fa fa-check"></i><b>4.12</b> Writing a Data Frame to Excel</a></li>
<li class="chapter" data-level="4.13" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readsas"><i class="fa fa-check"></i><b>4.13</b> Reading Data from a SAS file</a></li>
<li class="chapter" data-level="4.14" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id246"><i class="fa fa-check"></i><b>4.14</b> Reading Data from HTML Tables</a></li>
<li class="chapter" data-level="4.15" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id098"><i class="fa fa-check"></i><b>4.15</b> Reading Files with a Complex Structure</a></li>
<li class="chapter" data-level="4.16" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id037"><i class="fa fa-check"></i><b>4.16</b> Reading from MySQL Databases</a></li>
<li class="chapter" data-level="4.17" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-dbplyr"><i class="fa fa-check"></i><b>4.17</b> Accessing a Database with dbplyr</a></li>
<li class="chapter" data-level="4.18" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id029"><i class="fa fa-check"></i><b>4.18</b> Saving and Transporting Objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DataStructures.html"><a href="DataStructures.html"><i class="fa fa-check"></i><b>5</b> Data Structures</a>
<ul>
<li class="chapter" data-level="" data-path="DataStructures.html"><a href="DataStructures.html#intro-DataStructures"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="5.1" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id048"><i class="fa fa-check"></i><b>5.1</b> Appending Data to a Vector</a></li>
<li class="chapter" data-level="5.2" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id049"><i class="fa fa-check"></i><b>5.2</b> Inserting Data into a Vector</a></li>
<li class="chapter" data-level="5.3" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id050"><i class="fa fa-check"></i><b>5.3</b> Understanding the Recycling Rule</a></li>
<li class="chapter" data-level="5.4" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id051"><i class="fa fa-check"></i><b>5.4</b> Creating a Factor (Categorical Variable)</a></li>
<li class="chapter" data-level="5.5" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id227"><i class="fa fa-check"></i><b>5.5</b> Combining Multiple Vectors into One Vector and a Factor</a></li>
<li class="chapter" data-level="5.6" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id053"><i class="fa fa-check"></i><b>5.6</b> Creating a List</a></li>
<li class="chapter" data-level="5.7" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id054"><i class="fa fa-check"></i><b>5.7</b> Selecting List Elements by Position</a></li>
<li class="chapter" data-level="5.8" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id253"><i class="fa fa-check"></i><b>5.8</b> Selecting List Elements by Name</a></li>
<li class="chapter" data-level="5.9" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id158"><i class="fa fa-check"></i><b>5.9</b> Building a Name/Value Association List</a></li>
<li class="chapter" data-level="5.10" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id056"><i class="fa fa-check"></i><b>5.10</b> Removing an Element from a List</a></li>
<li class="chapter" data-level="5.11" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id152"><i class="fa fa-check"></i><b>5.11</b> Flatten a List into a Vector</a></li>
<li class="chapter" data-level="5.12" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id058"><i class="fa fa-check"></i><b>5.12</b> Removing NULL Elements from a List</a></li>
<li class="chapter" data-level="5.13" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id060"><i class="fa fa-check"></i><b>5.13</b> Removing List Elements Using a Condition</a></li>
<li class="chapter" data-level="5.14" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id062"><i class="fa fa-check"></i><b>5.14</b> Initializing a Matrix</a></li>
<li class="chapter" data-level="5.15" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id139"><i class="fa fa-check"></i><b>5.15</b> Performing Matrix Operations</a></li>
<li class="chapter" data-level="5.16" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id063"><i class="fa fa-check"></i><b>5.16</b> Giving Descriptive Names to the Rows and Columns of a Matrix</a></li>
<li class="chapter" data-level="5.17" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id250"><i class="fa fa-check"></i><b>5.17</b> Selecting One Row or Column from a Matrix</a></li>
<li class="chapter" data-level="5.18" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id251"><i class="fa fa-check"></i><b>5.18</b> Initializing a Data Frame from Column Data</a></li>
<li class="chapter" data-level="5.19" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id252"><i class="fa fa-check"></i><b>5.19</b> Initializing a Data Frame from Row Data</a></li>
<li class="chapter" data-level="5.20" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id071"><i class="fa fa-check"></i><b>5.20</b> Appending Rows to a Data Frame</a></li>
<li class="chapter" data-level="5.21" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id068"><i class="fa fa-check"></i><b>5.21</b> Selecting Data Frame Columns by Position</a></li>
<li class="chapter" data-level="5.22" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id254"><i class="fa fa-check"></i><b>5.22</b> Selecting Data Frame Columns by Name</a></li>
<li class="chapter" data-level="5.23" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id069"><i class="fa fa-check"></i><b>5.23</b> Changing the Names of Data Frame Columns</a></li>
<li class="chapter" data-level="5.24" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id249"><i class="fa fa-check"></i><b>5.24</b> Removing NAs from a Data Frame</a></li>
<li class="chapter" data-level="5.25" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id072"><i class="fa fa-check"></i><b>5.25</b> Excluding Columns by Name</a></li>
<li class="chapter" data-level="5.26" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id155"><i class="fa fa-check"></i><b>5.26</b> Combining Two Data Frames</a></li>
<li class="chapter" data-level="5.27" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id057"><i class="fa fa-check"></i><b>5.27</b> Merging Data Frames by Common Column</a></li>
<li class="chapter" data-level="5.28" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id248"><i class="fa fa-check"></i><b>5.28</b> Converting One Atomic Value into Another</a></li>
<li class="chapter" data-level="5.29" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id074"><i class="fa fa-check"></i><b>5.29</b> Converting One Structured Data Type into Another</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="DataTransformations.html"><a href="DataTransformations.html"><i class="fa fa-check"></i><b>6</b> Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="DataTransformations.html"><a href="DataTransformations.html#intro-DataTransformations"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="6.1" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id149"><i class="fa fa-check"></i><b>6.1</b> Applying a Function to Each List Element</a></li>
<li class="chapter" data-level="6.2" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-row_df"><i class="fa fa-check"></i><b>6.2</b> Applying a Function to Every Row of a Data Frame</a></li>
<li class="chapter" data-level="6.3" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id146"><i class="fa fa-check"></i><b>6.3</b> Applying a Function to Every Row of a Matrix</a></li>
<li class="chapter" data-level="6.4" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id157"><i class="fa fa-check"></i><b>6.4</b> Applying a Function to Every Column</a></li>
<li class="chapter" data-level="6.5" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id275"><i class="fa fa-check"></i><b>6.5</b> Applying a Function to Parallel Vectors or Lists</a></li>
<li class="chapter" data-level="6.6" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id148"><i class="fa fa-check"></i><b>6.6</b> Applying a Function to Groups of Data</a></li>
<li class="chapter" data-level="6.7" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-casewhen"><i class="fa fa-check"></i><b>6.7</b> Creating a New Column Based on Some Condition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="StringsAndDates.html"><a href="StringsAndDates.html"><i class="fa fa-check"></i><b>7</b> Strings and Dates</a>
<ul>
<li class="chapter" data-level="" data-path="StringsAndDates.html"><a href="StringsAndDates.html#I_sect17_d1e17434"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="7.1" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id093"><i class="fa fa-check"></i><b>7.1</b> Getting the Length of a String</a></li>
<li class="chapter" data-level="7.2" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id040"><i class="fa fa-check"></i><b>7.2</b> Concatenating Strings</a></li>
<li class="chapter" data-level="7.3" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id041"><i class="fa fa-check"></i><b>7.3</b> Extracting Substrings</a></li>
<li class="chapter" data-level="7.4" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id276"><i class="fa fa-check"></i><b>7.4</b> Splitting a String According to a Delimiter</a></li>
<li class="chapter" data-level="7.5" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id277"><i class="fa fa-check"></i><b>7.5</b> Replacing Substrings</a></li>
<li class="chapter" data-level="7.6" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id109"><i class="fa fa-check"></i><b>7.6</b> Generating All Pairwise Combinations of Strings</a></li>
<li class="chapter" data-level="7.7" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id045"><i class="fa fa-check"></i><b>7.7</b> Getting the Current Date</a></li>
<li class="chapter" data-level="7.8" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id043"><i class="fa fa-check"></i><b>7.8</b> Converting a String into a Date</a></li>
<li class="chapter" data-level="7.9" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id044"><i class="fa fa-check"></i><b>7.9</b> Converting a Date into a String</a></li>
<li class="chapter" data-level="7.10" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id241"><i class="fa fa-check"></i><b>7.10</b> Converting Year, Month, and Day into a Date</a></li>
<li class="chapter" data-level="7.11" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id042"><i class="fa fa-check"></i><b>7.11</b> Getting the Julian Date</a></li>
<li class="chapter" data-level="7.12" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id046"><i class="fa fa-check"></i><b>7.12</b> Extracting the Parts of a Date</a></li>
<li class="chapter" data-level="7.13" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id047"><i class="fa fa-check"></i><b>7.13</b> Creating a Sequence of Dates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Probability.html"><a href="Probability.html"><i class="fa fa-check"></i><b>8</b> Probability</a>
<ul>
<li class="chapter" data-level="" data-path="Probability.html"><a href="Probability.html#intro-Probability"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="8.1" data-path="Probability.html"><a href="Probability.html#recipe-id163"><i class="fa fa-check"></i><b>8.1</b> Counting the Number of Combinations</a></li>
<li class="chapter" data-level="8.2" data-path="Probability.html"><a href="Probability.html#recipe-id198"><i class="fa fa-check"></i><b>8.2</b> Generating Combinations</a></li>
<li class="chapter" data-level="8.3" data-path="Probability.html"><a href="Probability.html#recipe-id165"><i class="fa fa-check"></i><b>8.3</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="8.4" data-path="Probability.html"><a href="Probability.html#recipe-id201"><i class="fa fa-check"></i><b>8.4</b> Generating Reproducible Random Numbers</a></li>
<li class="chapter" data-level="8.5" data-path="Probability.html"><a href="Probability.html#recipe-id199"><i class="fa fa-check"></i><b>8.5</b> Generating a Random Sample</a></li>
<li class="chapter" data-level="8.6" data-path="Probability.html"><a href="Probability.html#recipe-id200"><i class="fa fa-check"></i><b>8.6</b> Generating Random Sequences</a></li>
<li class="chapter" data-level="8.7" data-path="Probability.html"><a href="Probability.html#recipe-id151"><i class="fa fa-check"></i><b>8.7</b> Randomly Permuting a Vector</a></li>
<li class="chapter" data-level="8.8" data-path="Probability.html"><a href="Probability.html#recipe-id196"><i class="fa fa-check"></i><b>8.8</b> Calculating Probabilities for Discrete Distributions</a></li>
<li class="chapter" data-level="8.9" data-path="Probability.html"><a href="Probability.html#recipe-id197"><i class="fa fa-check"></i><b>8.9</b> Calculating Probabilities for Continuous Distributions</a></li>
<li class="chapter" data-level="8.10" data-path="Probability.html"><a href="Probability.html#recipe-id168"><i class="fa fa-check"></i><b>8.10</b> Converting Probabilities to Quantiles</a></li>
<li class="chapter" data-level="8.11" data-path="Probability.html"><a href="Probability.html#recipe-id166"><i class="fa fa-check"></i><b>8.11</b> Plotting a Density Function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html"><i class="fa fa-check"></i><b>9</b> General Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#intro-GeneralStatistics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="9.1" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id119"><i class="fa fa-check"></i><b>9.1</b> Summarizing Your Data</a></li>
<li class="chapter" data-level="9.2" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id229"><i class="fa fa-check"></i><b>9.2</b> Calculating Relative Frequencies</a></li>
<li class="chapter" data-level="9.3" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id124"><i class="fa fa-check"></i><b>9.3</b> Tabulating Factors and Creating Contingency Tables</a></li>
<li class="chapter" data-level="9.4" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id125"><i class="fa fa-check"></i><b>9.4</b> Testing Categorical Variables for Independence</a></li>
<li class="chapter" data-level="9.5" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id143"><i class="fa fa-check"></i><b>9.5</b> Calculating Quantiles (and Quartiles) of a Dataset</a></li>
<li class="chapter" data-level="9.6" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id142"><i class="fa fa-check"></i><b>9.6</b> Inverting a Quantile</a></li>
<li class="chapter" data-level="9.7" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id133"><i class="fa fa-check"></i><b>9.7</b> Converting Data to z-Scores</a></li>
<li class="chapter" data-level="9.8" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id121"><i class="fa fa-check"></i><b>9.8</b> Testing the Mean of a Sample (t Test)</a></li>
<li class="chapter" data-level="9.9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id123"><i class="fa fa-check"></i><b>9.9</b> Forming a Confidence Interval for a Mean</a></li>
<li class="chapter" data-level="9.10" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id135"><i class="fa fa-check"></i><b>9.10</b> Forming a Confidence Interval for a Median</a></li>
<li class="chapter" data-level="9.11" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id225"><i class="fa fa-check"></i><b>9.11</b> Testing a Sample Proportion</a></li>
<li class="chapter" data-level="9.12" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id226"><i class="fa fa-check"></i><b>9.12</b> Forming a Confidence Interval for a Proportion</a></li>
<li class="chapter" data-level="9.13" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id126"><i class="fa fa-check"></i><b>9.13</b> Testing for Normality</a></li>
<li class="chapter" data-level="9.14" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id131"><i class="fa fa-check"></i><b>9.14</b> Testing for Runs</a></li>
<li class="chapter" data-level="9.15" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id122"><i class="fa fa-check"></i><b>9.15</b> Comparing the Means of Two Samples</a></li>
<li class="chapter" data-level="9.16" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id130"><i class="fa fa-check"></i><b>9.16</b> Comparing the Locations of Two Samples Nonparametrically</a></li>
<li class="chapter" data-level="9.17" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id132"><i class="fa fa-check"></i><b>9.17</b> Testing a Correlation for Significance</a></li>
<li class="chapter" data-level="9.18" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id134"><i class="fa fa-check"></i><b>9.18</b> Testing Groups for Equal Proportions</a></li>
<li class="chapter" data-level="9.19" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id127"><i class="fa fa-check"></i><b>9.19</b> Performing Pairwise Comparisons Between Group Means</a></li>
<li class="chapter" data-level="9.20" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id129"><i class="fa fa-check"></i><b>9.20</b> Testing Two Samples for the Same Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Graphics.html"><a href="Graphics.html"><i class="fa fa-check"></i><b>10</b> Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="Graphics.html"><a href="Graphics.html#intro-Graphics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10.1" data-path="Graphics.html"><a href="Graphics.html#recipe-id171"><i class="fa fa-check"></i><b>10.1</b> Creating a Scatter Plot</a></li>
<li class="chapter" data-level="10.2" data-path="Graphics.html"><a href="Graphics.html#recipe-id259"><i class="fa fa-check"></i><b>10.2</b> Adding a Title and Labels</a></li>
<li class="chapter" data-level="10.3" data-path="Graphics.html"><a href="Graphics.html#recipe-id261"><i class="fa fa-check"></i><b>10.3</b> Adding (or Removing) a Grid</a></li>
<li class="chapter" data-level="10.4" data-path="Graphics.html"><a href="Graphics.html#recipe-theme"><i class="fa fa-check"></i><b>10.4</b> Applying a Theme to a ggplot Figure</a></li>
<li class="chapter" data-level="10.5" data-path="Graphics.html"><a href="Graphics.html#recipe-id262"><i class="fa fa-check"></i><b>10.5</b> Creating a Scatter Plot of Multiple Groups</a></li>
<li class="chapter" data-level="10.6" data-path="Graphics.html"><a href="Graphics.html#recipe-id260"><i class="fa fa-check"></i><b>10.6</b> Adding (or Removing) a Legend</a></li>
<li class="chapter" data-level="10.7" data-path="Graphics.html"><a href="Graphics.html#recipe-id217"><i class="fa fa-check"></i><b>10.7</b> Plotting the Regression Line of a Scatter Plot</a></li>
<li class="chapter" data-level="10.8" data-path="Graphics.html"><a href="Graphics.html#recipe-id184"><i class="fa fa-check"></i><b>10.8</b> Plotting All Variables Against All Other Variables</a></li>
<li class="chapter" data-level="10.9" data-path="Graphics.html"><a href="Graphics.html#recipe-id185"><i class="fa fa-check"></i><b>10.9</b> Creating One Scatter Plot for Each Group</a></li>
<li class="chapter" data-level="10.10" data-path="Graphics.html"><a href="Graphics.html#recipe-id175"><i class="fa fa-check"></i><b>10.10</b> Creating a Bar Chart</a></li>
<li class="chapter" data-level="10.11" data-path="Graphics.html"><a href="Graphics.html#recipe-id177"><i class="fa fa-check"></i><b>10.11</b> Adding Confidence Intervals to a Bar Chart</a></li>
<li class="chapter" data-level="10.12" data-path="Graphics.html"><a href="Graphics.html#recipe-id176"><i class="fa fa-check"></i><b>10.12</b> Coloring a Bar Chart</a></li>
<li class="chapter" data-level="10.13" data-path="Graphics.html"><a href="Graphics.html#recipe-id174"><i class="fa fa-check"></i><b>10.13</b> Plotting a Line from x and y Points</a></li>
<li class="chapter" data-level="10.14" data-path="Graphics.html"><a href="Graphics.html#recipe-id256"><i class="fa fa-check"></i><b>10.14</b> Changing the Type, Width, or Color of a Line</a></li>
<li class="chapter" data-level="10.15" data-path="Graphics.html"><a href="Graphics.html#recipe-id263"><i class="fa fa-check"></i><b>10.15</b> Plotting Multiple Datasets</a></li>
<li class="chapter" data-level="10.16" data-path="Graphics.html"><a href="Graphics.html#recipe-id186"><i class="fa fa-check"></i><b>10.16</b> Adding Vertical or Horizontal Lines</a></li>
<li class="chapter" data-level="10.17" data-path="Graphics.html"><a href="Graphics.html#recipe-id178"><i class="fa fa-check"></i><b>10.17</b> Creating a Boxplot</a></li>
<li class="chapter" data-level="10.18" data-path="Graphics.html"><a href="Graphics.html#recipe-id179"><i class="fa fa-check"></i><b>10.18</b> Creating One Boxplot for Each Factor Level</a></li>
<li class="chapter" data-level="10.19" data-path="Graphics.html"><a href="Graphics.html#recipe-id182"><i class="fa fa-check"></i><b>10.19</b> Creating a Histogram</a></li>
<li class="chapter" data-level="10.20" data-path="Graphics.html"><a href="Graphics.html#recipe-id183"><i class="fa fa-check"></i><b>10.20</b> Adding a Density Estimate to a Histogram</a></li>
<li class="chapter" data-level="10.21" data-path="Graphics.html"><a href="Graphics.html#recipe-id180"><i class="fa fa-check"></i><b>10.21</b> Creating a Normal Quantile–Quantile Plot</a></li>
<li class="chapter" data-level="10.22" data-path="Graphics.html"><a href="Graphics.html#recipe-id181"><i class="fa fa-check"></i><b>10.22</b> Creating Other Quantile–Quantile Plots</a></li>
<li class="chapter" data-level="10.23" data-path="Graphics.html"><a href="Graphics.html#recipe-id191"><i class="fa fa-check"></i><b>10.23</b> Plotting a Variable in Multiple Colors</a></li>
<li class="chapter" data-level="10.24" data-path="Graphics.html"><a href="Graphics.html#recipe-id192"><i class="fa fa-check"></i><b>10.24</b> Graphing a Function</a></li>
<li class="chapter" data-level="10.25" data-path="Graphics.html"><a href="Graphics.html#recipe-id190"><i class="fa fa-check"></i><b>10.25</b> Displaying Several Figures on One Page</a></li>
<li class="chapter" data-level="10.26" data-path="Graphics.html"><a href="Graphics.html#recipe-id188"><i class="fa fa-check"></i><b>10.26</b> Writing Your Plot to a File</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html"><i class="fa fa-check"></i><b>11</b> Linear Regression and ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#intro-LinearRegressionAndANOVA"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id203"><i class="fa fa-check"></i><b>11.1</b> Performing Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id204"><i class="fa fa-check"></i><b>11.2</b> Performing Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.3" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id231"><i class="fa fa-check"></i><b>11.3</b> Getting Regression Statistics</a></li>
<li class="chapter" data-level="11.4" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id240"><i class="fa fa-check"></i><b>11.4</b> Understanding the Regression Summary</a></li>
<li class="chapter" data-level="11.5" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id205"><i class="fa fa-check"></i><b>11.5</b> Performing Linear Regression Without an Intercept</a></li>
<li class="chapter" data-level="11.6" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#title-highcor"><i class="fa fa-check"></i><b>11.6</b> Regressing Only Variables That Highly Correlate with Your Dependent Variable</a></li>
<li class="chapter" data-level="11.7" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id206"><i class="fa fa-check"></i><b>11.7</b> Performing Linear Regression with Interaction Terms</a></li>
<li class="chapter" data-level="11.8" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id236"><i class="fa fa-check"></i><b>11.8</b> Selecting the Best Regression Variables</a></li>
<li class="chapter" data-level="11.9" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id209"><i class="fa fa-check"></i><b>11.9</b> Regressing on a Subset of Your Data</a></li>
<li class="chapter" data-level="11.10" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id244"><i class="fa fa-check"></i><b>11.10</b> Using an Expression Inside a Regression Formula</a></li>
<li class="chapter" data-level="11.11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id243"><i class="fa fa-check"></i><b>11.11</b> Regressing on a Polynomial</a></li>
<li class="chapter" data-level="11.12" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id208"><i class="fa fa-check"></i><b>11.12</b> Regressing on Transformed Data</a></li>
<li class="chapter" data-level="11.13" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id210"><i class="fa fa-check"></i><b>11.13</b> Finding the Best Power Transformation (Box–Cox Procedure)</a></li>
<li class="chapter" data-level="11.14" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id211"><i class="fa fa-check"></i><b>11.14</b> Forming Confidence Intervals for Regression Coefficients</a></li>
<li class="chapter" data-level="11.15" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id216"><i class="fa fa-check"></i><b>11.15</b> Plotting Regression Residuals</a></li>
<li class="chapter" data-level="11.16" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id212"><i class="fa fa-check"></i><b>11.16</b> Diagnosing a Linear Regression</a></li>
<li class="chapter" data-level="11.17" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id233"><i class="fa fa-check"></i><b>11.17</b> Identifying Influential Observations</a></li>
<li class="chapter" data-level="11.18" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id213"><i class="fa fa-check"></i><b>11.18</b> Testing Residuals for Autocorrelation (Durbin–Watson Test)</a></li>
<li class="chapter" data-level="11.19" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id214"><i class="fa fa-check"></i><b>11.19</b> Predicting New Values</a></li>
<li class="chapter" data-level="11.20" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id215"><i class="fa fa-check"></i><b>11.20</b> Forming Prediction Intervals</a></li>
<li class="chapter" data-level="11.21" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id218"><i class="fa fa-check"></i><b>11.21</b> Performing One-Way ANOVA</a></li>
<li class="chapter" data-level="11.22" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id221"><i class="fa fa-check"></i><b>11.22</b> Creating an Interaction Plot</a></li>
<li class="chapter" data-level="11.23" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id220"><i class="fa fa-check"></i><b>11.23</b> Finding Differences Between Means of Groups</a></li>
<li class="chapter" data-level="11.24" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id228"><i class="fa fa-check"></i><b>11.24</b> Performing Robust ANOVA (Kruskal–Wallis Test)</a></li>
<li class="chapter" data-level="11.25" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id232"><i class="fa fa-check"></i><b>11.25</b> Comparing Models by Using ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="UsefulTricks.html"><a href="UsefulTricks.html"><i class="fa fa-check"></i><b>12</b> Useful Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="UsefulTricks.html"><a href="UsefulTricks.html#intro-UsefulTricks"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12.1" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id278"><i class="fa fa-check"></i><b>12.1</b> Peeking at Your Data</a></li>
<li class="chapter" data-level="12.2" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id271"><i class="fa fa-check"></i><b>12.2</b> Printing the Result of an Assignment</a></li>
<li class="chapter" data-level="12.3" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id138"><i class="fa fa-check"></i><b>12.3</b> Summing Rows and Columns</a></li>
<li class="chapter" data-level="12.4" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id112"><i class="fa fa-check"></i><b>12.4</b> Printing Data in Columns</a></li>
<li class="chapter" data-level="12.5" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id137"><i class="fa fa-check"></i><b>12.5</b> Binning Your Data</a></li>
<li class="chapter" data-level="12.6" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id116"><i class="fa fa-check"></i><b>12.6</b> Finding the Position of a Particular Value</a></li>
<li class="chapter" data-level="12.7" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id103"><i class="fa fa-check"></i><b>12.7</b> Selecting Every nth Element of a Vector</a></li>
<li class="chapter" data-level="12.8" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id107"><i class="fa fa-check"></i><b>12.8</b> Finding Minimums or Maximums</a></li>
<li class="chapter" data-level="12.9" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id110"><i class="fa fa-check"></i><b>12.9</b> Generating All Combinations of Several Variables</a></li>
<li class="chapter" data-level="12.10" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id153"><i class="fa fa-check"></i><b>12.10</b> Flattening a Data Frame</a></li>
<li class="chapter" data-level="12.11" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id247"><i class="fa fa-check"></i><b>12.11</b> Sorting a Data Frame</a></li>
<li class="chapter" data-level="12.12" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id223"><i class="fa fa-check"></i><b>12.12</b> Stripping Attributes from a Variable</a></li>
<li class="chapter" data-level="12.13" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id202"><i class="fa fa-check"></i><b>12.13</b> Revealing the Structure of an Object</a></li>
<li class="chapter" data-level="12.14" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id224"><i class="fa fa-check"></i><b>12.14</b> Timing Your Code</a></li>
<li class="chapter" data-level="12.15" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id113"><i class="fa fa-check"></i><b>12.15</b> Suppressing Warnings and Error Messages</a></li>
<li class="chapter" data-level="12.16" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id118"><i class="fa fa-check"></i><b>12.16</b> Taking Function Arguments from a List</a></li>
<li class="chapter" data-level="12.17" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id114"><i class="fa fa-check"></i><b>12.17</b> Defining Your Own Binary Operators</a></li>
<li class="chapter" data-level="12.18" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id111"><i class="fa fa-check"></i><b>12.18</b> Suppressing the Startup Message</a></li>
<li class="chapter" data-level="12.19" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id106"><i class="fa fa-check"></i><b>12.19</b> Getting and Setting Environment Variables</a></li>
<li class="chapter" data-level="12.20" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-codesections"><i class="fa fa-check"></i><b>12.20</b> Use Code Sections</a></li>
<li class="chapter" data-level="12.21" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_local"><i class="fa fa-check"></i><b>12.21</b> Executing R in Parallel Locally</a></li>
<li class="chapter" data-level="12.22" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_remote"><i class="fa fa-check"></i><b>12.22</b> Executing R in Parallel Remotely</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="BeyondBasics.html"><a href="BeyondBasics.html"><i class="fa fa-check"></i><b>13</b> Beyond Basic Numerics and Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="BeyondBasics.html"><a href="BeyondBasics.html#intro-BeyondBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="13.1" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id234"><i class="fa fa-check"></i><b>13.1</b> Minimizing or Maximizing a Single-Parameter Function</a></li>
<li class="chapter" data-level="13.2" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id235"><i class="fa fa-check"></i><b>13.2</b> Minimizing or Maximizing a Multiparameter Function</a></li>
<li class="chapter" data-level="13.3" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id140"><i class="fa fa-check"></i><b>13.3</b> Calculating Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="13.4" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id162"><i class="fa fa-check"></i><b>13.4</b> Performing Principal Component Analysis</a></li>
<li class="chapter" data-level="13.5" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id264"><i class="fa fa-check"></i><b>13.5</b> Performing Simple Orthogonal Regression</a></li>
<li class="chapter" data-level="13.6" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id160"><i class="fa fa-check"></i><b>13.6</b> Finding Clusters in Your Data</a></li>
<li class="chapter" data-level="13.7" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id161"><i class="fa fa-check"></i><b>13.7</b> Predicting a Binary-Valued Variable (Logistic Regression)</a></li>
<li class="chapter" data-level="13.8" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id159"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping a Statistic</a></li>
<li class="chapter" data-level="13.9" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id193"><i class="fa fa-check"></i><b>13.9</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html"><i class="fa fa-check"></i><b>14</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14.1" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id076"><i class="fa fa-check"></i><b>14.1</b> Representing Time Series Data</a></li>
<li class="chapter" data-level="14.2" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id089"><i class="fa fa-check"></i><b>14.2</b> Plotting Time Series Data</a></li>
<li class="chapter" data-level="14.3" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id077"><i class="fa fa-check"></i><b>14.3</b> Extracting the Oldest or Newest Observations</a></li>
<li class="chapter" data-level="14.4" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id281"><i class="fa fa-check"></i><b>14.4</b> Subsetting a Time Series</a></li>
<li class="chapter" data-level="14.5" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id079"><i class="fa fa-check"></i><b>14.5</b> Merging Several Time Series</a></li>
<li class="chapter" data-level="14.6" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id239"><i class="fa fa-check"></i><b>14.6</b> Filling or Padding a Time Series</a></li>
<li class="chapter" data-level="14.7" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id280"><i class="fa fa-check"></i><b>14.7</b> Lagging a Time Series</a></li>
<li class="chapter" data-level="14.8" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id141"><i class="fa fa-check"></i><b>14.8</b> Computing Successive Differences</a></li>
<li class="chapter" data-level="14.9" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id080"><i class="fa fa-check"></i><b>14.9</b> Performing Calculations on Time Series</a></li>
<li class="chapter" data-level="14.10" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id279"><i class="fa fa-check"></i><b>14.10</b> Computing a Moving Average</a></li>
<li class="chapter" data-level="14.11" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id282"><i class="fa fa-check"></i><b>14.11</b> Applying a Function by Calendar Period</a></li>
<li class="chapter" data-level="14.12" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id081"><i class="fa fa-check"></i><b>14.12</b> Applying a Rolling Function</a></li>
<li class="chapter" data-level="14.13" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id082"><i class="fa fa-check"></i><b>14.13</b> Plotting the Autocorrelation Function</a></li>
<li class="chapter" data-level="14.14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id104"><i class="fa fa-check"></i><b>14.14</b> Testing a Time Series for Autocorrelation</a></li>
<li class="chapter" data-level="14.15" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id083"><i class="fa fa-check"></i><b>14.15</b> Plotting the Partial Autocorrelation Function</a></li>
<li class="chapter" data-level="14.16" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id084"><i class="fa fa-check"></i><b>14.16</b> Finding Lagged Correlations Between Two Time Series</a></li>
<li class="chapter" data-level="14.17" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id088"><i class="fa fa-check"></i><b>14.17</b> Detrending a Time Series</a></li>
<li class="chapter" data-level="14.18" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id085"><i class="fa fa-check"></i><b>14.18</b> Fitting an ARIMA Model</a></li>
<li class="chapter" data-level="14.19" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id237"><i class="fa fa-check"></i><b>14.19</b> Removing Insignificant ARIMA Coefficients</a></li>
<li class="chapter" data-level="14.20" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id238"><i class="fa fa-check"></i><b>14.20</b> Running Diagnostics on an ARIMA Model</a></li>
<li class="chapter" data-level="14.21" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id086"><i class="fa fa-check"></i><b>14.21</b> Making Forecasts from an ARIMA Model</a></li>
<li class="chapter" data-level="14.22" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-plotting_forecast"><i class="fa fa-check"></i><b>14.22</b> Plotting a Forecast</a></li>
<li class="chapter" data-level="14.23" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id087"><i class="fa fa-check"></i><b>14.23</b> Testing for Mean Reversion</a></li>
<li class="chapter" data-level="14.24" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id195"><i class="fa fa-check"></i><b>14.24</b> Smoothing a Time Series</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html"><i class="fa fa-check"></i><b>15</b> Simple Programming</a>
<ul>
<li class="chapter" data-level="" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#intro-SimpleProgramming"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="15.1" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-creating_if_logic"><i class="fa fa-check"></i><b>15.1</b> Choosing Between Two Alternatives: if-else</a></li>
<li class="chapter" data-level="15.2" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-for_loop"><i class="fa fa-check"></i><b>15.2</b> Iterating with a Loop</a></li>
<li class="chapter" data-level="15.3" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-id117"><i class="fa fa-check"></i><b>15.3</b> Defining a Function</a></li>
<li class="chapter" data-level="15.4" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-variable"><i class="fa fa-check"></i><b>15.4</b> Creating a Local Variable</a></li>
<li class="chapter" data-level="15.5" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#choosing-between-multiple-alternatives-switch"><i class="fa fa-check"></i><b>15.5</b> Choosing Between Multiple Alternatives: switch</a></li>
<li class="chapter" data-level="15.6" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-title"><i class="fa fa-check"></i><b>15.6</b> Defining Defaults for Function Parameters</a></li>
<li class="chapter" data-level="15.7" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#signaling-errors"><i class="fa fa-check"></i><b>15.7</b> Signaling Errors</a></li>
<li class="chapter" data-level="15.8" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#protecting-against-errors"><i class="fa fa-check"></i><b>15.8</b> Protecting Against Errors</a></li>
<li class="chapter" data-level="15.9" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-anon-function"><i class="fa fa-check"></i><b>15.9</b> Creating an Anonymous Function</a></li>
<li class="chapter" data-level="15.10" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#creating-a-collection-of-reusable-functions"><i class="fa fa-check"></i><b>15.10</b> Creating a Collection of Reusable Functions</a></li>
<li class="chapter" data-level="15.11" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-indent"><i class="fa fa-check"></i><b>15.11</b> Automatically Reindent Code</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RMarkdown.html"><a href="RMarkdown.html"><i class="fa fa-check"></i><b>16</b> R Markdown and Publishing</a>
<ul>
<li class="chapter" data-level="" data-path="RMarkdown.html"><a href="RMarkdown.html#intro-Rmd_pub"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="16.1" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-new_doc"><i class="fa fa-check"></i><b>16.1</b> Creating a New Document</a></li>
<li class="chapter" data-level="16.2" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-metadata"><i class="fa fa-check"></i><b>16.2</b> Adding a Title, Author, or Date</a></li>
<li class="chapter" data-level="16.3" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc-text"><i class="fa fa-check"></i><b>16.3</b> Formatting Document Text</a></li>
<li class="chapter" data-level="16.4" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-headings"><i class="fa fa-check"></i><b>16.4</b> Inserting Document Headings</a></li>
<li class="chapter" data-level="16.5" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-list"><i class="fa fa-check"></i><b>16.5</b> Inserting a List</a></li>
<li class="chapter" data-level="16.6" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-exec_r"><i class="fa fa-check"></i><b>16.6</b> Showing Output from R Code</a></li>
<li class="chapter" data-level="16.7" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-code-results"><i class="fa fa-check"></i><b>16.7</b> Controlling Which Code and Results Are Shown</a></li>
<li class="chapter" data-level="16.8" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc_plot"><i class="fa fa-check"></i><b>16.8</b> Inserting a Plot</a></li>
<li class="chapter" data-level="16.9" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-static-table"><i class="fa fa-check"></i><b>16.9</b> Inserting a Table</a></li>
<li class="chapter" data-level="16.10" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-tables"><i class="fa fa-check"></i><b>16.10</b> Inserting a Table of Data</a></li>
<li class="chapter" data-level="16.11" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-equations"><i class="fa fa-check"></i><b>16.11</b> Inserting Math Equations</a></li>
<li class="chapter" data-level="16.12" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-html"><i class="fa fa-check"></i><b>16.12</b> Generating HTML Output</a></li>
<li class="chapter" data-level="16.13" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-pdf"><i class="fa fa-check"></i><b>16.13</b> Generating PDF Output</a></li>
<li class="chapter" data-level="16.14" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-word"><i class="fa fa-check"></i><b>16.14</b> Generating Microsoft Word Output</a></li>
<li class="chapter" data-level="16.15" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-prez"><i class="fa fa-check"></i><b>16.15</b> Generating Presentation Output</a></li>
<li class="chapter" data-level="16.16" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-param_report"><i class="fa fa-check"></i><b>16.16</b> Creating a Parameterized Report</a></li>
<li class="chapter" data-level="16.17" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-rmd_org"><i class="fa fa-check"></i><b>16.17</b> Organizing Your R Markdown Workflow</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cookbook, 2nd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="BeyondBasics" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">13</span> Beyond Basic Numerics and Statistics<a href="BeyondBasics.html#BeyondBasics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro-BeyondBasics" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="BeyondBasics.html#intro-BeyondBasics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter presents a few advanced techniques such as those you might
encounter in the first or second year of a graduate program in applied
statistics.</p>
<p>Most of these recipes use functions available in the base distribution.
Through add-on packages, R provides some of the world’s most advanced
statistical techniques. This is because researchers in statistics now
use R as their <em>lingua franca</em>, showcasing their newest work. Anyone
looking for a cutting-edge statistical technique is urged to search CRAN
and the web for possible implementations.</p>
</div>
<div id="recipe-id234" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Minimizing or Maximizing a Single-Parameter Function<a href="BeyondBasics.html#recipe-id234" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id234" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id234" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given a single-parameter function <code>f</code>, you want to find the point at
which <code>f</code> reaches its minimum or maximum.</p>
</div>
<div id="solution-id234" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id234" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To minimize a single-parameter function, use <code>optimize</code>. Specify the
function to be minimized and the bounds for its domain (<code>x</code>):</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="BeyondBasics.html#cb935-1" tabindex="-1"></a><span class="fu">optimize</span>(f, <span class="at">lower =</span> lowerBound, <span class="at">upper =</span> upperBound)</span></code></pre></div>
<p>If you instead want to maximize the function, specify <code>maximum = TRUE</code>:</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="BeyondBasics.html#cb936-1" tabindex="-1"></a><span class="fu">optimize</span>(f,</span>
<span id="cb936-2"><a href="BeyondBasics.html#cb936-2" tabindex="-1"></a>         <span class="at">lower =</span> lowerBound,</span>
<span id="cb936-3"><a href="BeyondBasics.html#cb936-3" tabindex="-1"></a>         <span class="at">upper =</span> upperBound,</span>
<span id="cb936-4"><a href="BeyondBasics.html#cb936-4" tabindex="-1"></a>         <span class="at">maximum =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="discussion-id234" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id234" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>optimize</code> function can handle functions of one argument. It
requires upper and lower bounds for <code>x</code> that delimit the region to be
searched. The following example finds the minimum of a polynomial,
3<em>x</em><sup>4</sup> – 2<em>x</em><sup>3</sup> + 3<em>x</em><sup>2</sup> – 4<em>x</em> + 5:</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="BeyondBasics.html#cb937-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb937-2"><a href="BeyondBasics.html#cb937-2" tabindex="-1"></a>  <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">4</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb937-3"><a href="BeyondBasics.html#cb937-3" tabindex="-1"></a><span class="fu">optimize</span>(f, <span class="at">lower =</span> <span class="sc">-</span><span class="dv">20</span>, <span class="at">upper =</span> <span class="dv">20</span>)</span>
<span id="cb937-4"><a href="BeyondBasics.html#cb937-4" tabindex="-1"></a><span class="co">#&gt; $minimum</span></span>
<span id="cb937-5"><a href="BeyondBasics.html#cb937-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.597</span></span>
<span id="cb937-6"><a href="BeyondBasics.html#cb937-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb937-7"><a href="BeyondBasics.html#cb937-7" tabindex="-1"></a><span class="co">#&gt; $objective</span></span>
<span id="cb937-8"><a href="BeyondBasics.html#cb937-8" tabindex="-1"></a><span class="co">#&gt; [1] 3.64</span></span></code></pre></div>
<p>The returned value is a list with two elements: <code>minimum</code>, the <code>x</code> value
that minimizes the function; and <code>objective</code>, the value of the function
at that point.</p>
<p>A tighter range for <code>lower</code> and <code>upper</code> means a smaller region to be
searched and hence a faster optimization. However, if you are unsure of
the appropriate bounds, then use big but reasonable values such as
<code>lower = -1000</code> and <code>upper = 1000</code>. Just be careful that your function does
not have multiple minima within that range! The <code>optimize</code> function will
find and return only one such minimum.</p>
</div>
<div id="see_also-id234" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id234" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="BeyondBasics.html#recipe-id235">13.2</a>, <a href="BeyondBasics.html#recipe-id235">“Minimizing or Maximizing a Multiparameter Function”</a>.</p>
</div>
</div>
<div id="recipe-id235" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Minimizing or Maximizing a Multiparameter Function<a href="BeyondBasics.html#recipe-id235" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id235" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id235" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given a multiparameter function <code>f</code>, you want to find the point at which
<code>f</code> reaches its minimum or maximum.</p>
</div>
<div id="solution-id235" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id235" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To minimize a multiparameter function, use <code>optim</code>. You must specify the
starting point, which is a vector of initial arguments for <code>f</code>:</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="BeyondBasics.html#cb938-1" tabindex="-1"></a><span class="fu">optim</span>(startingPoint, f)</span></code></pre></div>
<p>To maximize the function instead, specify this <code>control</code> parameter:</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="BeyondBasics.html#cb939-1" tabindex="-1"></a><span class="fu">optim</span>(startingPoint, f, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="discussion-id235" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id235" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>optim</code> function is more general than <code>optimize</code>
(see Recipe <a href="BeyondBasics.html#recipe-id234">13.1</a>, <a href="BeyondBasics.html#recipe-id234">“Minimizing or Maximizing a Single-Parameter Function”</a>)
because it handles multiparameter functions. To evaluate your function
at a point, <code>optim</code> packs the point’s coordinates into a vector and
calls your function with that vector. The function should return a
scalar value. <code>optim</code> will begin at your starting point and move through
the parameter space, searching for the function’s minimum.</p>
<p>Here is an example of using <code>optim</code> to fit a nonlinear model. Suppose
you believe that the paired observations <em>z</em> and <em>x</em> are related by
<em>z</em><sub><em>i</em></sub> = (<em>x</em><sub><em>i</em></sub> + <em>α</em>)<sup><em>β</em></sup> + <em>ε</em><sub><em>i</em></sub>, where <em>α</em> and <em>β</em> are
unknown parameters and where the <em>ε</em><sub><em>i</em></sub> are nonnormal noise terms.
Let’s fit the model by minimizing a robust metric, the sum of the
absolute deviations:</p>
<blockquote>
<p>∑|<em>z</em> – (<em>x</em> + <em>a</em>)<sup><em>b</em></sup>|</p>
</blockquote>
<p>First we define the function to be minimized. Note that the function
has only one formal parameter, a two-element vector. The actual
parameters to be evaluated, <em>a</em> and <em>b</em>, are packed into the vector in
locations 1 and 2:</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="BeyondBasics.html#cb940-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/opt.rdata&#39;</span>)  <span class="co"># loads x, y, z</span></span>
<span id="cb940-2"><a href="BeyondBasics.html#cb940-2" tabindex="-1"></a></span>
<span id="cb940-3"><a href="BeyondBasics.html#cb940-3" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb940-4"><a href="BeyondBasics.html#cb940-4" tabindex="-1"></a>  <span class="cf">function</span>(v) {</span>
<span id="cb940-5"><a href="BeyondBasics.html#cb940-5" tabindex="-1"></a>    a <span class="ot">&lt;-</span> v[<span class="dv">1</span>]</span>
<span id="cb940-6"><a href="BeyondBasics.html#cb940-6" tabindex="-1"></a>    b <span class="ot">&lt;-</span> v[<span class="dv">2</span>]                           <span class="co"># &quot;Unpack&quot; v, giving a and b</span></span>
<span id="cb940-7"><a href="BeyondBasics.html#cb940-7" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">abs</span>(z <span class="sc">-</span> ((x <span class="sc">+</span> a) <span class="sc">^</span> b)))         <span class="co"># calculate and returns the error</span></span>
<span id="cb940-8"><a href="BeyondBasics.html#cb940-8" tabindex="-1"></a>  }</span></code></pre></div>
<p>The following code makes a call to <code>optim</code>, starts from (1, 1), and searches for the minimum
point of <em>f</em>:</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="BeyondBasics.html#cb941-1" tabindex="-1"></a><span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), f)</span>
<span id="cb941-2"><a href="BeyondBasics.html#cb941-2" tabindex="-1"></a><span class="co">#&gt; $par</span></span>
<span id="cb941-3"><a href="BeyondBasics.html#cb941-3" tabindex="-1"></a><span class="co">#&gt; [1] 10.0  0.7</span></span>
<span id="cb941-4"><a href="BeyondBasics.html#cb941-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb941-5"><a href="BeyondBasics.html#cb941-5" tabindex="-1"></a><span class="co">#&gt; $value</span></span>
<span id="cb941-6"><a href="BeyondBasics.html#cb941-6" tabindex="-1"></a><span class="co">#&gt; [1] 1.26</span></span>
<span id="cb941-7"><a href="BeyondBasics.html#cb941-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb941-8"><a href="BeyondBasics.html#cb941-8" tabindex="-1"></a><span class="co">#&gt; $counts</span></span>
<span id="cb941-9"><a href="BeyondBasics.html#cb941-9" tabindex="-1"></a><span class="co">#&gt; function gradient </span></span>
<span id="cb941-10"><a href="BeyondBasics.html#cb941-10" tabindex="-1"></a><span class="co">#&gt;      485       NA </span></span>
<span id="cb941-11"><a href="BeyondBasics.html#cb941-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb941-12"><a href="BeyondBasics.html#cb941-12" tabindex="-1"></a><span class="co">#&gt; $convergence</span></span>
<span id="cb941-13"><a href="BeyondBasics.html#cb941-13" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb941-14"><a href="BeyondBasics.html#cb941-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb941-15"><a href="BeyondBasics.html#cb941-15" tabindex="-1"></a><span class="co">#&gt; $message</span></span>
<span id="cb941-16"><a href="BeyondBasics.html#cb941-16" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>The returned list includes <code>convergence</code>, the indicator of success or
failure. If this indicator is 0, then <code>optim</code> found a minimum; otherwise,
it did not. Obviously, the convergence indicator is the most important
returned value because other values are meaningless if the algorithm did
not converge.</p>
<p>The returned list also includes <code>par</code>, the parameters that minimize our
function, and <code>value</code>, the value of <em>f</em> at that point. In this case,
<code>optim</code> did converge and found a minimum point at approximately <em>a</em> =
10.0 and <em>b</em> = 0.7.</p>
<p>There are no lower and upper bounds for <code>optim</code>, just the starting point
that you provide. A better guess for the starting point means a faster
minimization.</p>
<p>The <code>optim</code> function supports several different minimization algorithms,
and you can select among them. If the default algorithm does not work
for you, see the help page for alternatives. A typical problem with
multidimensional minimization is that the algorithm gets stuck at a
local minimum and fails to find a deeper, global minimum. Generally
speaking, the algorithms that are more powerful are less likely to get
stuck. However, there is a trade-off: they also tend to run more slowly.</p>
</div>
<div id="see_also-id235" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id235" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The R community has implemented many tools for optimization. On CRAN,
see the task view for <a href="http://cran.r-project.org/web/views/Optimization.html">Optimization and Mathematical
Programming</a> for
more solutions.</p>
</div>
</div>
<div id="recipe-id140" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Calculating Eigenvalues and Eigenvectors<a href="BeyondBasics.html#recipe-id140" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id140" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id140" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to calculate the eigenvalues or eigenvectors of a matrix.</p>
</div>
<div id="solution-id140" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id140" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>eigen</code> function. It returns a list with two elements, <code>values</code>
and <code>vectors</code>, which contain (respectively) the eigenvalues and
eigenvectors.</p>
</div>
<div id="discussion-id140" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id140" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have a matrix such as the Fibonacci matrix:</p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="BeyondBasics.html#cb942-1" tabindex="-1"></a>fibmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb942-2"><a href="BeyondBasics.html#cb942-2" tabindex="-1"></a>fibmat</span>
<span id="cb942-3"><a href="BeyondBasics.html#cb942-3" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb942-4"><a href="BeyondBasics.html#cb942-4" tabindex="-1"></a><span class="co">#&gt; [1,]    0    1</span></span>
<span id="cb942-5"><a href="BeyondBasics.html#cb942-5" tabindex="-1"></a><span class="co">#&gt; [2,]    1    1</span></span></code></pre></div>
<p>Given the matrix, the <code>eigen</code> function will return a list of its
eigenvalues and eigenvectors:</p>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="BeyondBasics.html#cb943-1" tabindex="-1"></a><span class="fu">eigen</span>(fibmat)</span>
<span id="cb943-2"><a href="BeyondBasics.html#cb943-2" tabindex="-1"></a><span class="co">#&gt; eigen() decomposition</span></span>
<span id="cb943-3"><a href="BeyondBasics.html#cb943-3" tabindex="-1"></a><span class="co">#&gt; $values</span></span>
<span id="cb943-4"><a href="BeyondBasics.html#cb943-4" tabindex="-1"></a><span class="co">#&gt; [1]  1.618 -0.618</span></span>
<span id="cb943-5"><a href="BeyondBasics.html#cb943-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb943-6"><a href="BeyondBasics.html#cb943-6" tabindex="-1"></a><span class="co">#&gt; $vectors</span></span>
<span id="cb943-7"><a href="BeyondBasics.html#cb943-7" tabindex="-1"></a><span class="co">#&gt;       [,1]   [,2]</span></span>
<span id="cb943-8"><a href="BeyondBasics.html#cb943-8" tabindex="-1"></a><span class="co">#&gt; [1,] 0.526 -0.851</span></span>
<span id="cb943-9"><a href="BeyondBasics.html#cb943-9" tabindex="-1"></a><span class="co">#&gt; [2,] 0.851  0.526</span></span></code></pre></div>
<p>Use either <code>eigen(fibmat)$values</code> or <code>eigen(fibmat)$vectors</code> to select
the needed value from the list.</p>
</div>
</div>
<div id="recipe-id162" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Performing Principal Component Analysis<a href="BeyondBasics.html#recipe-id162" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id162" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id162" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to identify the principal components of a multivariable
dataset.</p>
</div>
<div id="solution-id162" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id162" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>prcomp</code> function. The first argument is a formula whose
righthand side is the set of variables, separated by plus signs (<code>+</code>).
The lefthand side is empty:</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="BeyondBasics.html#cb944-1" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">prcomp</span>( <span class="sc">~</span> x <span class="sc">+</span> y <span class="sc">+</span> z)</span>
<span id="cb944-2"><a href="BeyondBasics.html#cb944-2" tabindex="-1"></a><span class="fu">summary</span>(r)</span>
<span id="cb944-3"><a href="BeyondBasics.html#cb944-3" tabindex="-1"></a><span class="co">#&gt; Importance of components:</span></span>
<span id="cb944-4"><a href="BeyondBasics.html#cb944-4" tabindex="-1"></a><span class="co">#&gt;                          PC1     PC2     PC3</span></span>
<span id="cb944-5"><a href="BeyondBasics.html#cb944-5" tabindex="-1"></a><span class="co">#&gt; Standard deviation     1.894 0.11821 0.04459</span></span>
<span id="cb944-6"><a href="BeyondBasics.html#cb944-6" tabindex="-1"></a><span class="co">#&gt; Proportion of Variance 0.996 0.00388 0.00055</span></span>
<span id="cb944-7"><a href="BeyondBasics.html#cb944-7" tabindex="-1"></a><span class="co">#&gt; Cumulative Proportion  0.996 0.99945 1.00000</span></span></code></pre></div>
</div>
<div id="discussion-id162" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id162" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The base software for R includes two functions for principal component
analysis (PCA), <code>prcomp</code> and <code>princomp</code>. The documentation mentions that
<code>prcomp</code> has better numerical properties, so that’s the function
presented here.</p>
<p>An important use of PCA is to reduce the
dimensionality of your dataset. Suppose your data contains a large
number <em>N</em> of variables. Ideally, all the variables are more or less
independent and contributing equally. But if you suspect that some
variables are redundant, the PCA can tell you the number of sources of
variance in your data. If that number is near <em>N</em>, then all the
variables are useful. If the number is less than <em>N</em>, then your data can
be reduced to a dataset of smaller dimensionality.</p>
<p>The PCA recasts your data into a vector space where the first dimension
captures the most variance, the second dimension captures the second
most, and so forth. The actual output from <code>prcomp</code> is an object that,
when printed, gives the needed vector rotation:</p>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="BeyondBasics.html#cb945-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/pca.rdata&#39;</span>)</span>
<span id="cb945-2"><a href="BeyondBasics.html#cb945-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="sc">~</span> x <span class="sc">+</span> y)</span>
<span id="cb945-3"><a href="BeyondBasics.html#cb945-3" tabindex="-1"></a><span class="fu">print</span>(r)</span>
<span id="cb945-4"><a href="BeyondBasics.html#cb945-4" tabindex="-1"></a><span class="co">#&gt; Standard deviations (1, .., p=2):</span></span>
<span id="cb945-5"><a href="BeyondBasics.html#cb945-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.393 0.163</span></span>
<span id="cb945-6"><a href="BeyondBasics.html#cb945-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb945-7"><a href="BeyondBasics.html#cb945-7" tabindex="-1"></a><span class="co">#&gt; Rotation (n x k) = (2 x 2):</span></span>
<span id="cb945-8"><a href="BeyondBasics.html#cb945-8" tabindex="-1"></a><span class="co">#&gt;      PC1    PC2</span></span>
<span id="cb945-9"><a href="BeyondBasics.html#cb945-9" tabindex="-1"></a><span class="co">#&gt; x -0.553  0.833</span></span>
<span id="cb945-10"><a href="BeyondBasics.html#cb945-10" tabindex="-1"></a><span class="co">#&gt; y -0.833 -0.553</span></span></code></pre></div>
<p>We typically find the summary of PCA much more useful. It shows the proportion
of variance that is captured by each component:</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="BeyondBasics.html#cb946-1" tabindex="-1"></a><span class="fu">summary</span>(r)</span>
<span id="cb946-2"><a href="BeyondBasics.html#cb946-2" tabindex="-1"></a><span class="co">#&gt; Importance of components:</span></span>
<span id="cb946-3"><a href="BeyondBasics.html#cb946-3" tabindex="-1"></a><span class="co">#&gt;                          PC1   PC2</span></span>
<span id="cb946-4"><a href="BeyondBasics.html#cb946-4" tabindex="-1"></a><span class="co">#&gt; Standard deviation     0.393 0.163</span></span>
<span id="cb946-5"><a href="BeyondBasics.html#cb946-5" tabindex="-1"></a><span class="co">#&gt; Proportion of Variance 0.853 0.147</span></span>
<span id="cb946-6"><a href="BeyondBasics.html#cb946-6" tabindex="-1"></a><span class="co">#&gt; Cumulative Proportion  0.853 1.000</span></span></code></pre></div>
<p>In this example, the first component captured 85% of the variance and
the second component only 15%, so we know the first component captured
most of it.</p>
<p>After calling <code>prcomp</code>, use <code>plot(r)</code> to view a bar chart of the
variances of the principal components and <code>predict(r)</code> to rotate your
data to the principal components.</p>
</div>
<div id="see_also-id162" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id162" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="BeyondBasics.html#recipe-id193">13.9</a>, <a href="BeyondBasics.html#recipe-id193">“Factor Analysis”</a> for an example of using principal
component analysis.
Further uses of PCA in R are discussed in <em>Modern Applied Statistics with S-Plus</em> by W. N. Venables and B. D. Ripley (Springer).</p>
</div>
</div>
<div id="recipe-id264" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Performing Simple Orthogonal Regression<a href="BeyondBasics.html#recipe-id264" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id264" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id264" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to create a linear model using orthogonal regression in which
the variances of <em>x</em> and <em>y</em> are treated symmetrically.</p>
</div>
<div id="solution-id264" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id264" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>prcomp</code> to perform PCA on <em>x</em> and <em>y</em>.
From the resulting rotation, compute the slope and intercept:</p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="BeyondBasics.html#cb947-1" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="sc">~</span> x <span class="sc">+</span> y)</span>
<span id="cb947-2"><a href="BeyondBasics.html#cb947-2" tabindex="-1"></a>slope <span class="ot">&lt;-</span> r<span class="sc">$</span>rotation[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">/</span> r<span class="sc">$</span>rotation[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb947-3"><a href="BeyondBasics.html#cb947-3" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> r<span class="sc">$</span>center[<span class="dv">2</span>] <span class="sc">-</span> slope <span class="sc">*</span> r<span class="sc">$</span>center[<span class="dv">1</span>]</span></code></pre></div>
</div>
<div id="discussion-id264" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id264" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Orthogonal regression is also known as <em>total least squares</em> (TLS).</p>
<p>The ordinary least squares (OLS) algorithm has an odd property: it is
asymmetric. That is, calculating <code>lm(y ~ x)</code> is not the mathematical inverse of calculating <code>lm(x ~ y)</code>.
The reason is that OLS assumes the <em>x</em> values to be constants and the
<em>y</em> values to be random variables, so all the variance is attributed to
<em>y</em> and none is attributed to <em>x</em>. This creates an asymmetric situation.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tls"></span>
<img src="13_BeyondBasics_files/figure-html/tls-1.png" alt="Ordinary least squares versus orthogonal regression" width="85%" />
<p class="caption">
Figure 13.1: Ordinary least squares versus orthogonal regression
</p>
</div>
<p>The asymmetry is illustrated in Figure <a href="BeyondBasics.html#fig:tls">13.1</a> where the upper-left
panel displays the fit for <code>lm(y ~ x)</code>. The OLS algorithm tries the minimize the vertical
distances, which are shown as dotted lines. The upper-right panel shows
the identical dataset but fit with <code>lm(x ~ y)</code> instead, so the algorithm is minimizing the horizontal
dotted lines. Obviously, you’ll get a different result depending upon
which distances are minimized.</p>
<p>The lower panel of Figure <a href="BeyondBasics.html#fig:tls">13.1</a> is quite
different. It uses PCA to implement orthogonal regression. Now the
distances being minimized are the orthogonal distances from the data
points to the regression line. This is a symmetric situation: reversing
the roles of <em>x</em> and <em>y</em> does not change the distances to be minimized.</p>
<p>Implementing a basic orthogonal regression in R is quite simple. First,
perform the PCA:</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="BeyondBasics.html#cb948-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/pca.rdata&#39;</span>)</span>
<span id="cb948-2"><a href="BeyondBasics.html#cb948-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="sc">~</span> x <span class="sc">+</span> y)</span></code></pre></div>
<p>Next, use the rotations to compute the slope:</p>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb949-1"><a href="BeyondBasics.html#cb949-1" tabindex="-1"></a>slope <span class="ot">&lt;-</span> r<span class="sc">$</span>rotation[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">/</span> r<span class="sc">$</span>rotation[<span class="dv">1</span>, <span class="dv">1</span>]</span></code></pre></div>
<p>and then, from the slope, calculate the intercept:</p>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="BeyondBasics.html#cb950-1" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> r<span class="sc">$</span>center[<span class="dv">2</span>] <span class="sc">-</span> slope <span class="sc">*</span> r<span class="sc">$</span>center[<span class="dv">1</span>]</span></code></pre></div>
<p>We call this a “basic” regression because it yields only the point
estimates for the slope and intercept, not the confidence intervals.
Obviously, we’d like to have the regression statistics, too.
Recipe <a href="BeyondBasics.html#recipe-id159">13.8</a>, <a href="BeyondBasics.html#recipe-id159">“Bootstrapping a Statistic”</a>, shows one way to estimate the
confidence intervals using a bootstrap algorithm.</p>
</div>
<div id="see_also-id264" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id264" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Principal component analysis is described in Recipe <a href="BeyondBasics.html#recipe-id162">13.4</a>,
<a href="BeyondBasics.html#recipe-id162">“Performing Principal Component Analysis”</a>.
The graphics in this recipe were inspired
by the work of Vincent Zoonekynd and his <a href="http://zoonek2.free.fr/UNIX/48_R/09.html">tutorial on regression</a>.</p>
</div>
</div>
<div id="recipe-id160" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Finding Clusters in Your Data<a href="BeyondBasics.html#recipe-id160" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id160" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id160" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You believe your data contains clusters: groups of points that are
“near” each other. You want to identify those clusters.</p>
</div>
<div id="solution-id160" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id160" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your dataset, <em>x</em>, can be a vector, data frame, or matrix. Assume that
<em>n</em> is the number of clusters you desire:</p>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="BeyondBasics.html#cb951-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(x)               <span class="co"># Compute distances between observations</span></span>
<span id="cb951-2"><a href="BeyondBasics.html#cb951-2" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)            <span class="co"># Form hierarchical clusters</span></span>
<span id="cb951-3"><a href="BeyondBasics.html#cb951-3" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">k=</span>n)   <span class="co"># Organize them into the n largest clusters</span></span></code></pre></div>
<p>The result, <code>clust</code>, is a vector of numbers between 1 and <em>n</em>, one for
each observation in <em>x</em>. Each number classifies its corresponding
observation into one of the <em>n</em> clusters.</p>
</div>
<div id="discussion-id160" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id160" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>dist</code> function computes distances between all the observations. The
default is Euclidean distance, which works well for many applications,
but other distance measures are also available.</p>
<p>The <code>hclust</code> function uses those distances to form the observations into
a hierarchical tree of clusters. You can plot the result of <code>hclust</code> to
create a visualization of the hierarchy, called a <em>dendrogram</em>, as shown
in Figure <a href="BeyondBasics.html#fig:dendro">13.2</a>.</p>
<p>Finally, <code>cutree</code> extracts clusters from that tree. You must specify
either how many clusters you want or the height at which the tree should
be cut. Often the number of clusters is unknown, in which case you will
need to explore the dataset for clustering that makes sense in your
application.</p>
<p>We’ll illustrate clustering of a synthetic dataset. We start by
generating 99 normal variates, each with a randomly selected mean of
either –3, 0, or +3:</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="BeyondBasics.html#cb952-1" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">+</span><span class="dv">3</span>), <span class="dv">99</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb952-2"><a href="BeyondBasics.html#cb952-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">99</span>, <span class="at">mean =</span> means)</span></code></pre></div>
<p>For our own curiosity, we can compute the true means of the original
clusters. (In a real situation, we would not have the <code>means</code> factor and
would be unable to perform this computation.) We can confirm that the
groups’ means are pretty close to –3, 0, and +3:</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="BeyondBasics.html#cb953-1" tabindex="-1"></a><span class="fu">tapply</span>(x, <span class="fu">factor</span>(means), mean)</span>
<span id="cb953-2"><a href="BeyondBasics.html#cb953-2" tabindex="-1"></a><span class="co">#&gt;      -3       0       3 </span></span>
<span id="cb953-3"><a href="BeyondBasics.html#cb953-3" tabindex="-1"></a><span class="co">#&gt; -3.1750  0.0675  2.8479</span></span></code></pre></div>
<p>To “discover” the clusters, we first compute the distances between all
points:</p>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="BeyondBasics.html#cb954-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(x)</span></code></pre></div>
<p>Then we create the hierarchical clusters:</p>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="BeyondBasics.html#cb955-1" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span></code></pre></div>
<p>And we can plot the hierarchical cluster dendrogram by calling <code>plot</code> on the <code>hc</code> object:</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="BeyondBasics.html#cb956-1" tabindex="-1"></a><span class="fu">plot</span>(hc,</span>
<span id="cb956-2"><a href="BeyondBasics.html#cb956-2" tabindex="-1"></a>     <span class="at">sub =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb956-3"><a href="BeyondBasics.html#cb956-3" tabindex="-1"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dendro"></span>
<img src="13_BeyondBasics_files/figure-html/dendro-1.png" alt="Hierarchical cluster dendrogram" width="85%" />
<p class="caption">
Figure 13.2: Hierarchical cluster dendrogram
</p>
</div>
<p>Figure <a href="BeyondBasics.html#fig:dendro">13.2</a> allows us to now extract the three largest clusters. Obviously, we have a huge
advantage here because we know the true number of clusters. Real life is
rarely that easy. However, even if we didn’t already know we were dealing with three clusters, looking at the dendrogram gives us a good clue that there are three big clusters in the data.</p>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb957-1"><a href="BeyondBasics.html#cb957-1" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">k=</span><span class="dv">3</span>)</span></code></pre></div>
<p><code>clust</code> is a vector of integers between 1 and 3, one integer for each
observation in the sample, that assigns each observation to a cluster.
Here are the first 20 cluster assignments:</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="BeyondBasics.html#cb958-1" tabindex="-1"></a><span class="fu">head</span>(clust, <span class="dv">20</span>)</span>
<span id="cb958-2"><a href="BeyondBasics.html#cb958-2" tabindex="-1"></a><span class="co">#&gt;  [1] 1 2 2 1 1 3 2 1 3 1 2 1 2 1 1 1 1 1 2 1</span></span></code></pre></div>
<p>By treating the cluster number as a factor, we can compute the mean of
each statistical cluster (see Recipe <a href="DataTransformations.html#recipe-id148">6.6</a>), <a href="DataTransformations.html#recipe-id148">“Applying a Function to Groups of Data”</a>):</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="BeyondBasics.html#cb959-1" tabindex="-1"></a><span class="fu">tapply</span>(x, clust, mean)</span>
<span id="cb959-2"><a href="BeyondBasics.html#cb959-2" tabindex="-1"></a><span class="co">#&gt;      1      2      3 </span></span>
<span id="cb959-3"><a href="BeyondBasics.html#cb959-3" tabindex="-1"></a><span class="co">#&gt;  0.774 -3.058  3.811</span></span></code></pre></div>
<p>R did a good job of splitting data into clusters: the means appear
distinct, with one near –2.7, one near 0.27, and one near +3.2. (The
order of the extracted means does not necessarily match the order of the
original groups, of course.) The extracted means are similar but not
identical to the original means. Side-by-side boxplots can show why:</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="BeyondBasics.html#cb960-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb960-2"><a href="BeyondBasics.html#cb960-2" tabindex="-1"></a></span>
<span id="cb960-3"><a href="BeyondBasics.html#cb960-3" tabindex="-1"></a>df_cluster <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,</span>
<span id="cb960-4"><a href="BeyondBasics.html#cb960-4" tabindex="-1"></a>                         <span class="at">means =</span> <span class="fu">factor</span>(means),</span>
<span id="cb960-5"><a href="BeyondBasics.html#cb960-5" tabindex="-1"></a>                         <span class="at">clust =</span> <span class="fu">factor</span>(clust))</span>
<span id="cb960-6"><a href="BeyondBasics.html#cb960-6" tabindex="-1"></a></span>
<span id="cb960-7"><a href="BeyondBasics.html#cb960-7" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_cluster) <span class="sc">+</span></span>
<span id="cb960-8"><a href="BeyondBasics.html#cb960-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(means, x)) <span class="sc">+</span></span>
<span id="cb960-9"><a href="BeyondBasics.html#cb960-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Original Clusters&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Cluster Mean&quot;</span>)</span>
<span id="cb960-10"><a href="BeyondBasics.html#cb960-10" tabindex="-1"></a></span>
<span id="cb960-11"><a href="BeyondBasics.html#cb960-11" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_cluster) <span class="sc">+</span></span>
<span id="cb960-12"><a href="BeyondBasics.html#cb960-12" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(clust, x)) <span class="sc">+</span></span>
<span id="cb960-13"><a href="BeyondBasics.html#cb960-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Identified Clusters&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Cluster Number&quot;</span>)</span>
<span id="cb960-14"><a href="BeyondBasics.html#cb960-14" tabindex="-1"></a></span>
<span id="cb960-15"><a href="BeyondBasics.html#cb960-15" tabindex="-1"></a>g1 <span class="sc">+</span> g2</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxplot2"></span>
<img src="13_BeyondBasics_files/figure-html/boxplot2-1.png" alt="Cluster boxplots" width="85%" />
<p class="caption">
Figure 13.3: Cluster boxplots
</p>
</div>
<p>The boxplots are shown in Figure <a href="BeyondBasics.html#fig:boxplot2">13.3</a>. The clustering
algorithm perfectly separated the data into nonoverlapping groups. The
original clusters overlapped, whereas the identified clusters do not.</p>
<p>This illustration used one-dimensional data, but the <code>dist</code> function
works equally well on multidimensional data stored in a data frame or
matrix. Each row in the data frame or matrix is treated as one
observation in a multidimensional space, and <code>dist</code> computes the
distances between those observations.</p>
</div>
<div id="see_also-id160" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id160" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This demonstration is based on the clustering features of the base
package. There are other packages, such as <code>mclust</code>, that offer
alternative clustering mechanisms.</p>
</div>
</div>
<div id="recipe-id161" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Predicting a Binary-Valued Variable (Logistic Regression)<a href="BeyondBasics.html#recipe-id161" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id161" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id161" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to perform logistic regression, a regression model that
predicts the probability of a binary event occurring.</p>
</div>
<div id="solution-id161" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id161" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Call the <code>glm</code> function with <code>family = binomial</code> to perform logistic
regression. The result is a model object:</p>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="BeyondBasics.html#cb961-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glm</span>(b <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">family =</span> binomial)</span></code></pre></div>
<p>Here, <code>b</code> is a factor with two levels (e.g., <code>TRUE</code> and <code>FALSE</code>, <code>0</code> and
<code>1</code>), while <code>x1</code>, <code>x2</code>, and <code>x3</code> are predictor variables.</p>
<p>Use the model object, <code>m</code>, and the <code>predict</code> function to predict a
probability from new data:</p>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="BeyondBasics.html#cb962-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> value, <span class="at">x2 =</span> value, <span class="at">x3 =</span> value)</span>
<span id="cb962-2"><a href="BeyondBasics.html#cb962-2" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">newdata =</span> dfrm)</span></code></pre></div>
</div>
<div id="discussion-id161" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id161" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Predicting a binary-valued outcome is a common problem in modeling. Will
a treatment be effective or not? Will prices rise or fall? Who will win
the game, team A or team B? Logistic regression is useful for modeling
these situations. In the true spirit of statistics, it does not simply
give a “thumbs up” or “thumbs down” answer; rather, it computes a
probability for each of the two possible outcomes.</p>
<p>In the call to <code>predict</code>, we set <code>type = "response"</code> so that <code>predict</code>
returns a probability. Otherwise, it returns log-odds, which most of us don’t
find intuitive.</p>
<p>In his unpublished book entitled <a href="https://cran.r-project.org/doc/contrib/Faraway-PRA.pdf"><em>Practical Regression and ANOVA Using R</em></a>,
Julian Faraway gives an example of predicting a binary-valued variable: <code>test</code>
from the dataset <code>pima</code> is true if the patient tested positive for
diabetes. The predictors are diastolic blood pressure and body mass
index (BMI). Faraway uses linear regression, so let’s try logistic
regression instead:</p>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="BeyondBasics.html#cb963-1" tabindex="-1"></a><span class="fu">data</span>(pima, <span class="at">package =</span> <span class="st">&quot;faraway&quot;</span>)</span>
<span id="cb963-2"><a href="BeyondBasics.html#cb963-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">factor</span>(pima<span class="sc">$</span>test)</span>
<span id="cb963-3"><a href="BeyondBasics.html#cb963-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glm</span>(b <span class="sc">~</span> diastolic <span class="sc">+</span> bmi, <span class="at">family =</span> binomial, <span class="at">data =</span> pima)</span></code></pre></div>
<p>The summary of the resulting model, <code>m</code>, shows that the respective
<em>p</em>-values for the <code>diastolic</code> and the <code>bmi</code> variables are 0.8 and
(essentially) zero. We can therefore conclude that only the <code>bmi</code>
variable is significant:</p>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="BeyondBasics.html#cb964-1" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb964-2"><a href="BeyondBasics.html#cb964-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb964-3"><a href="BeyondBasics.html#cb964-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb964-4"><a href="BeyondBasics.html#cb964-4" tabindex="-1"></a><span class="co">#&gt; glm(formula = b ~ diastolic + bmi, family = binomial, data = pima)</span></span>
<span id="cb964-5"><a href="BeyondBasics.html#cb964-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb964-6"><a href="BeyondBasics.html#cb964-6" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb964-7"><a href="BeyondBasics.html#cb964-7" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb964-8"><a href="BeyondBasics.html#cb964-8" tabindex="-1"></a><span class="co">#&gt; (Intercept) -3.62955    0.46818   -7.75  9.0e-15 ***</span></span>
<span id="cb964-9"><a href="BeyondBasics.html#cb964-9" tabindex="-1"></a><span class="co">#&gt; diastolic   -0.00110    0.00443   -0.25      0.8    </span></span>
<span id="cb964-10"><a href="BeyondBasics.html#cb964-10" tabindex="-1"></a><span class="co">#&gt; bmi          0.09413    0.01230    7.65  1.9e-14 ***</span></span>
<span id="cb964-11"><a href="BeyondBasics.html#cb964-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb964-12"><a href="BeyondBasics.html#cb964-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb964-13"><a href="BeyondBasics.html#cb964-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb964-14"><a href="BeyondBasics.html#cb964-14" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb964-15"><a href="BeyondBasics.html#cb964-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb964-16"><a href="BeyondBasics.html#cb964-16" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 993.48  on 767  degrees of freedom</span></span>
<span id="cb964-17"><a href="BeyondBasics.html#cb964-17" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 920.65  on 765  degrees of freedom</span></span>
<span id="cb964-18"><a href="BeyondBasics.html#cb964-18" tabindex="-1"></a><span class="co">#&gt; AIC: 926.7</span></span>
<span id="cb964-19"><a href="BeyondBasics.html#cb964-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb964-20"><a href="BeyondBasics.html#cb964-20" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>Because only the <code>bmi</code> variable is significant, we can create a reduced
model like this:</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="BeyondBasics.html#cb965-1" tabindex="-1"></a>m.red <span class="ot">&lt;-</span> <span class="fu">glm</span>(b <span class="sc">~</span> bmi, <span class="at">family =</span> binomial, <span class="at">data =</span> pima)</span></code></pre></div>
<p>Let’s use the model to calculate the probability that someone with an
average BMI (32.0) will test positive for diabetes:</p>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb966-1"><a href="BeyondBasics.html#cb966-1" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bmi =</span> <span class="fl">32.0</span>)</span>
<span id="cb966-2"><a href="BeyondBasics.html#cb966-2" tabindex="-1"></a><span class="fu">predict</span>(m.red, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">newdata =</span> newdata)</span>
<span id="cb966-3"><a href="BeyondBasics.html#cb966-3" tabindex="-1"></a><span class="co">#&gt;     1 </span></span>
<span id="cb966-4"><a href="BeyondBasics.html#cb966-4" tabindex="-1"></a><span class="co">#&gt; 0.333</span></span></code></pre></div>
<p>According to this model, the probability is about 33.3%. The same
calculation for someone in the 90th percentile gives a probability of
54.9%:</p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="BeyondBasics.html#cb967-1" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bmi =</span> <span class="fu">quantile</span>(pima<span class="sc">$</span>bmi, .<span class="dv">90</span>))</span>
<span id="cb967-2"><a href="BeyondBasics.html#cb967-2" tabindex="-1"></a><span class="fu">predict</span>(m.red, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">newdata =</span> newdata)</span>
<span id="cb967-3"><a href="BeyondBasics.html#cb967-3" tabindex="-1"></a><span class="co">#&gt;   90% </span></span>
<span id="cb967-4"><a href="BeyondBasics.html#cb967-4" tabindex="-1"></a><span class="co">#&gt; 0.549</span></span></code></pre></div>
</div>
<div id="see_also-id161" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id161" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using logistic regression involves interpreting the deviance to judge
the significance of the model. We suggest you review a text on logistic
regression before attempting to draw any conclusions from your
regression.</p>
</div>
</div>
<div id="recipe-id159" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Bootstrapping a Statistic<a href="BeyondBasics.html#recipe-id159" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id159" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id159" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a dataset and a function to calculate a statistic from that
dataset. You want to estimate a confidence interval for the statistic.</p>
</div>
<div id="solution-id159" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id159" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>boot</code> package. Apply the <code>boot</code> function to calculate bootstrap
replicates of the statistic:</p>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb968-1"><a href="BeyondBasics.html#cb968-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb968-2"><a href="BeyondBasics.html#cb968-2" tabindex="-1"></a>bootfun <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb968-3"><a href="BeyondBasics.html#cb968-3" tabindex="-1"></a>  <span class="co"># . . . calculate statistic using data[indices]. . .</span></span>
<span id="cb968-4"><a href="BeyondBasics.html#cb968-4" tabindex="-1"></a>  <span class="fu">return</span>(statistic)</span>
<span id="cb968-5"><a href="BeyondBasics.html#cb968-5" tabindex="-1"></a>}</span>
<span id="cb968-6"><a href="BeyondBasics.html#cb968-6" tabindex="-1"></a></span>
<span id="cb968-7"><a href="BeyondBasics.html#cb968-7" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, bootfun, <span class="at">R =</span> <span class="dv">999</span>)</span></code></pre></div>
<p>Here, <code>data</code> is your original dataset, which can be stored in either a
vector or a data frame. The statistic function (<code>bootfun</code> in this case)
should expect two arguments: <code>data</code> is the original dataset, and
<code>indices</code> is a vector of integers that selects the bootstrap sample from
<code>data</code>.</p>
<p>Next, use the <code>boot.ci</code> function to estimate a confidence interval from
the replications:</p>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="BeyondBasics.html#cb969-1" tabindex="-1"></a><span class="fu">boot.ci</span>(reps, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
</div>
<div id="discussion-id159" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id159" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Anybody can calculate a statistic, but that’s just the point estimate.
We want to take it to the next level: What is the confidence interval (CI)?
For some statistics, we can calculate the CI analytically. The CI for a mean, for instance, is
calculated by the <code>t.test</code> function. Unfortunately, that is the
exception and not the rule. For most statistics, the mathematics is too
tortuous or simply unknown, and there is no known closed-form
calculation for the CI.</p>
<p>The bootstrap algorithm can estimate a CI even when no
closed-form calculation is available. It works like this. The algorithm
assumes that you have a sample of size <em>N</em> and a function to calculate
the statistic:</p>
<ol style="list-style-type: decimal">
<li><p>Randomly select <em>N</em> elements from the sample, <em>sampling with
replacement</em>. That set of elements is called a <em>bootstrap sample</em>.</p></li>
<li><p>Apply the function to the bootstrap sample to calculate
the statistic. That value is called a <em>bootstrap replication</em>.</p></li>
<li><p>Repeat steps 1 and 2 many times to yield many (typically thousands)
of bootstrap replications.</p></li>
<li><p>From the bootstrap replications, compute the confidence interval.</p></li>
</ol>
<p>That last step may seem mysterious, but there are several algorithms for
computing the CI. A simple one uses percentiles of the
replications, such as taking the 2.5 percentile and the 97.5 percentile
to form the 95% CI.</p>
<p>We’re huge fans of the bootstrap because we work daily with obscure
statistics, it is important that we know their confidence interval, and
there is definitely no known formula for their CI. The bootstrap gives
us a good approximation.</p>
<p>Let’s work an example. In Recipe <a href="BeyondBasics.html#recipe-id162">13.4</a>, <a href="BeyondBasics.html#recipe-id162">“Performing Principal Component Analysis”</a> we estimated
the slope of a line using orthogonal regression. That gave us a point
estimate, but how can we find the CI? First, we
encapsulate the slope calculation within a function:</p>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="BeyondBasics.html#cb970-1" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb970-2"><a href="BeyondBasics.html#cb970-2" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="sc">~</span> x <span class="sc">+</span> y, <span class="at">data =</span> data, <span class="at">subset =</span> indices)</span>
<span id="cb970-3"><a href="BeyondBasics.html#cb970-3" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> r<span class="sc">$</span>rotation[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">/</span> r<span class="sc">$</span>rotation[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb970-4"><a href="BeyondBasics.html#cb970-4" tabindex="-1"></a>  <span class="fu">return</span>(slope)</span>
<span id="cb970-5"><a href="BeyondBasics.html#cb970-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Notice that the function is careful to select the subset defined by
indices and to compute the slope from that exact subset.</p>
<p>Next, we calculate 999 replications of the slope. Recall that we had two
vectors, <em>x</em> and <em>y</em>, in the original recipe; here, we combine them into
a data frame:</p>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="BeyondBasics.html#cb971-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/pca.rdata&#39;</span>)</span>
<span id="cb971-2"><a href="BeyondBasics.html#cb971-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb971-3"><a href="BeyondBasics.html#cb971-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># for reproducability</span></span>
<span id="cb971-4"><a href="BeyondBasics.html#cb971-4" tabindex="-1"></a></span>
<span id="cb971-5"><a href="BeyondBasics.html#cb971-5" tabindex="-1"></a>boot.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb971-6"><a href="BeyondBasics.html#cb971-6" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">boot</span>(boot.data, stat, <span class="at">R =</span> <span class="dv">999</span>)</span></code></pre></div>
<p>The choice of 999 replications is a good starting point. You can always
repeat the bootstrap with more and see if the results change
significantly.</p>
<p>The <code>boot.ci</code> function can estimate the CI from the replications. It
implements several different algorithms, and the <code>type</code> argument selects
which algorithms are performed. For each selected algorithm, <code>boot.ci</code>
will return the resulting estimate:</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="BeyondBasics.html#cb972-1" tabindex="-1"></a><span class="fu">boot.ci</span>(reps, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb972-2"><a href="BeyondBasics.html#cb972-2" tabindex="-1"></a><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb972-3"><a href="BeyondBasics.html#cb972-3" tabindex="-1"></a><span class="co">#&gt; Based on 999 bootstrap replicates</span></span>
<span id="cb972-4"><a href="BeyondBasics.html#cb972-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb972-5"><a href="BeyondBasics.html#cb972-5" tabindex="-1"></a><span class="co">#&gt; CALL : </span></span>
<span id="cb972-6"><a href="BeyondBasics.html#cb972-6" tabindex="-1"></a><span class="co">#&gt; boot.ci(boot.out = reps, type = c(&quot;perc&quot;, &quot;bca&quot;))</span></span>
<span id="cb972-7"><a href="BeyondBasics.html#cb972-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb972-8"><a href="BeyondBasics.html#cb972-8" tabindex="-1"></a><span class="co">#&gt; Intervals : </span></span>
<span id="cb972-9"><a href="BeyondBasics.html#cb972-9" tabindex="-1"></a><span class="co">#&gt; Level     Percentile            BCa          </span></span>
<span id="cb972-10"><a href="BeyondBasics.html#cb972-10" tabindex="-1"></a><span class="co">#&gt; 95%   ( 1.03,  2.07 )   ( 1.06,  2.10 )  </span></span>
<span id="cb972-11"><a href="BeyondBasics.html#cb972-11" tabindex="-1"></a><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span></code></pre></div>
<p>Here we chose two algorithms, percentile and BCa, by setting
<code>type = c("perc","bca")</code>. The two resulting estimates appear at the bottom
under their names. Other algorithms are available; see the help page for <code>boot.ci</code>.</p>
<p>You will note that the two confidence intervals are slightly different:
(1.068, 1.992) versus (1.086, 2.050). This is an uncomfortable but
inevitable result of using two different algorithms. We don’t know any
method for deciding which is better. If the selection is a critical
issue, you will need to study the reference and understand the
differences. In the meantime, our best advice is to be conservative and
use the minimum lower bound and the maximum upper bound; in this case, that would be (1.068, 2.050).</p>
<p>By default, <code>boot.ci</code> estimates a 95% CI. You can
change that via the <code>conf</code> argument, like this:</p>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="BeyondBasics.html#cb973-1" tabindex="-1"></a><span class="fu">boot.ci</span>(reps, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>), <span class="at">conf =</span> <span class="fl">0.90</span>)</span></code></pre></div>
</div>
<div id="see_also-id159" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id159" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="BeyondBasics.html#recipe-id162">13.4</a>, <a href="#recipe-id162,">“Performing Principal Component Analysis”</a> for the
slope calculation. A good tutorial and reference for the bootstrap
algorithm is <em>An Introduction to the Bootstrap</em> by Bradley Efron and Robert Tibshirani
(Chapman &amp; Hall/CRC).</p>
</div>
</div>
<div id="recipe-id193" class="section level2 hasAnchor" number="13.9">
<h2><span class="header-section-number">13.9</span> Factor Analysis<a href="BeyondBasics.html#recipe-id193" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id193" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="BeyondBasics.html#problem-id193" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to perform factor analysis on your dataset, usually to discover
what your variables have in common.</p>
</div>
<div id="solution-id193" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="BeyondBasics.html#solution-id193" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>factanal</code> function, which requires your dataset and your
estimate of the number of factors:</p>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="BeyondBasics.html#cb974-1" tabindex="-1"></a><span class="fu">factanal</span>(data, <span class="at">factors =</span> n)</span></code></pre></div>
<p>The output includes <em>n</em> factors, showing the loadings of each input
variable for each factor.</p>
<p>The output also includes a <em>p</em>-value. Conventionally, a <em>p</em>-value of
less than 0.05 indicates that the number of factors is too small and
does not capture the full dimensionality of the dataset; a <em>p</em>-value
exceeding 0.05 indicates that there are likely enough (or more than
enough) factors.</p>
</div>
<div id="discussion-id193" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="BeyondBasics.html#discussion-id193" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Factor analysis creates linear combinations of your variables, called
factors, that abstract the variable’s underlying commonality. If your
<em>N</em> variables are perfectly independent, then they have nothing in
common and <em>N</em> factors are required to describe them. But to the extent
that the variables have an underlying commonality, fewer factors capture
most of the variance and so fewer than <em>N</em> factors are required.</p>
<p>For each factor and variable, we calculate the correlation between them, known as the <em>loading</em>. Variables with a high loading are well
explained by the factor. We can square the loading to know what fraction
of the variable’s total variance is explained by the factor.</p>
<p>Factor analysis is useful when it shows that a few factors capture most
of the variance of your variables. Thus, it alerts you to redundancy in
your data. In that case you can reduce your dataset by combining closely
related variables or by eliminating redundant variables altogether.</p>
<p>A more subtle application of factor analysis is interpreting the factors
to find interrelationships between your variables. If two variables both
have large loadings for the same factor, then you know they have
something in common. What is it? There is no mechanical answer. You’ll
need to study the data and its meaning.</p>
<p>There are two tricky aspects of factor analysis. The first is choosing
the number of factors. Fortunately, you can use PCA to get a good initial estimate of the number of factors. The
second tricky aspect is interpreting the factors themselves.</p>
<p>Let’s illustrate factor analysis by using stock prices or, more
precisely, changes in stock prices. The dataset contains six months of
price changes for the stocks of 12 companies. Every company is involved
in the petroleum and gasoline industry. Their stock prices probably move
together, since they are subject to similar economic and market
forces. We might ask: How many factors are required to explain their
changes? If only one factor is required, then all the stocks are the
same and one is as good as another. If many factors are required, we
know that owning several of them provides diversification.</p>
<p>We start by doing a PCA on <code>diffs</code>, the data
frame of price changes. Plotting the PCA results shows the variance
captured by the components:</p>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="BeyondBasics.html#cb975-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/diffs.rdata&#39;</span>)</span>
<span id="cb975-2"><a href="BeyondBasics.html#cb975-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">prcomp</span>(diffs))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pcaresults"></span>
<img src="13_BeyondBasics_files/figure-html/pcaresults-1.png" alt="PCA results plot" width="85%" />
<p class="caption">
Figure 13.4: PCA results plot
</p>
</div>
<p>We can see in Figure <a href="BeyondBasics.html#fig:pcaresults">13.4</a> that the first component captures much of the variance,
but we don’t know if more components are required.
So we perform the initial factor analysis while assuming that two factors are required:</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="BeyondBasics.html#cb976-1" tabindex="-1"></a><span class="fu">factanal</span>(diffs, <span class="at">factors =</span> <span class="dv">2</span>)</span>
<span id="cb976-2"><a href="BeyondBasics.html#cb976-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb976-3"><a href="BeyondBasics.html#cb976-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb976-4"><a href="BeyondBasics.html#cb976-4" tabindex="-1"></a><span class="co">#&gt; factanal(x = diffs, factors = 2)</span></span>
<span id="cb976-5"><a href="BeyondBasics.html#cb976-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb976-6"><a href="BeyondBasics.html#cb976-6" tabindex="-1"></a><span class="co">#&gt; Uniquenesses:</span></span>
<span id="cb976-7"><a href="BeyondBasics.html#cb976-7" tabindex="-1"></a><span class="co">#&gt;   APC    BP   BRY   CVX   HES   MRO   NBL   OXY   ETP   VLO   XOM </span></span>
<span id="cb976-8"><a href="BeyondBasics.html#cb976-8" tabindex="-1"></a><span class="co">#&gt; 0.307 0.652 0.997 0.308 0.440 0.358 0.363 0.556 0.902 0.786 0.285 </span></span>
<span id="cb976-9"><a href="BeyondBasics.html#cb976-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb976-10"><a href="BeyondBasics.html#cb976-10" tabindex="-1"></a><span class="co">#&gt; Loadings:</span></span>
<span id="cb976-11"><a href="BeyondBasics.html#cb976-11" tabindex="-1"></a><span class="co">#&gt;     Factor1 Factor2</span></span>
<span id="cb976-12"><a href="BeyondBasics.html#cb976-12" tabindex="-1"></a><span class="co">#&gt; APC 0.773   0.309  </span></span>
<span id="cb976-13"><a href="BeyondBasics.html#cb976-13" tabindex="-1"></a><span class="co">#&gt; BP  0.317   0.497  </span></span>
<span id="cb976-14"><a href="BeyondBasics.html#cb976-14" tabindex="-1"></a><span class="co">#&gt; BRY                </span></span>
<span id="cb976-15"><a href="BeyondBasics.html#cb976-15" tabindex="-1"></a><span class="co">#&gt; CVX 0.439   0.707  </span></span>
<span id="cb976-16"><a href="BeyondBasics.html#cb976-16" tabindex="-1"></a><span class="co">#&gt; HES 0.640   0.389  </span></span>
<span id="cb976-17"><a href="BeyondBasics.html#cb976-17" tabindex="-1"></a><span class="co">#&gt; MRO 0.707   0.377  </span></span>
<span id="cb976-18"><a href="BeyondBasics.html#cb976-18" tabindex="-1"></a><span class="co">#&gt; NBL 0.749   0.276  </span></span>
<span id="cb976-19"><a href="BeyondBasics.html#cb976-19" tabindex="-1"></a><span class="co">#&gt; OXY 0.562   0.358  </span></span>
<span id="cb976-20"><a href="BeyondBasics.html#cb976-20" tabindex="-1"></a><span class="co">#&gt; ETP 0.283   0.134  </span></span>
<span id="cb976-21"><a href="BeyondBasics.html#cb976-21" tabindex="-1"></a><span class="co">#&gt; VLO 0.303   0.350  </span></span>
<span id="cb976-22"><a href="BeyondBasics.html#cb976-22" tabindex="-1"></a><span class="co">#&gt; XOM 0.355   0.767  </span></span>
<span id="cb976-23"><a href="BeyondBasics.html#cb976-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb976-24"><a href="BeyondBasics.html#cb976-24" tabindex="-1"></a><span class="co">#&gt;                Factor1 Factor2</span></span>
<span id="cb976-25"><a href="BeyondBasics.html#cb976-25" tabindex="-1"></a><span class="co">#&gt; SS loadings       2.98   2.072</span></span>
<span id="cb976-26"><a href="BeyondBasics.html#cb976-26" tabindex="-1"></a><span class="co">#&gt; Proportion Var    0.27   0.188</span></span>
<span id="cb976-27"><a href="BeyondBasics.html#cb976-27" tabindex="-1"></a><span class="co">#&gt; Cumulative Var    0.27   0.459</span></span>
<span id="cb976-28"><a href="BeyondBasics.html#cb976-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb976-29"><a href="BeyondBasics.html#cb976-29" tabindex="-1"></a><span class="co">#&gt; Test of the hypothesis that 2 factors are sufficient.</span></span>
<span id="cb976-30"><a href="BeyondBasics.html#cb976-30" tabindex="-1"></a><span class="co">#&gt; The chi square statistic is 62.9 on 34 degrees of freedom.</span></span>
<span id="cb976-31"><a href="BeyondBasics.html#cb976-31" tabindex="-1"></a><span class="co">#&gt; The p-value is 0.00184</span></span></code></pre></div>
<p>We can ignore most of the output because the <em>p</em>-value at the bottom is
very close to zero (.00184). The small <em>p</em>-value indicates that two
factors are insufficient, so the analysis isn’t good. More are required,
so we try again with three factors instead:</p>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb977-1"><a href="BeyondBasics.html#cb977-1" tabindex="-1"></a><span class="fu">factanal</span>(diffs, <span class="at">factors =</span> <span class="dv">3</span>)</span>
<span id="cb977-2"><a href="BeyondBasics.html#cb977-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb977-3"><a href="BeyondBasics.html#cb977-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb977-4"><a href="BeyondBasics.html#cb977-4" tabindex="-1"></a><span class="co">#&gt; factanal(x = diffs, factors = 3)</span></span>
<span id="cb977-5"><a href="BeyondBasics.html#cb977-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb977-6"><a href="BeyondBasics.html#cb977-6" tabindex="-1"></a><span class="co">#&gt; Uniquenesses:</span></span>
<span id="cb977-7"><a href="BeyondBasics.html#cb977-7" tabindex="-1"></a><span class="co">#&gt;   APC    BP   BRY   CVX   HES   MRO   NBL   OXY   ETP   VLO   XOM </span></span>
<span id="cb977-8"><a href="BeyondBasics.html#cb977-8" tabindex="-1"></a><span class="co">#&gt; 0.316 0.650 0.984 0.315 0.374 0.355 0.346 0.521 0.723 0.605 0.271 </span></span>
<span id="cb977-9"><a href="BeyondBasics.html#cb977-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb977-10"><a href="BeyondBasics.html#cb977-10" tabindex="-1"></a><span class="co">#&gt; Loadings:</span></span>
<span id="cb977-11"><a href="BeyondBasics.html#cb977-11" tabindex="-1"></a><span class="co">#&gt;     Factor1 Factor2 Factor3</span></span>
<span id="cb977-12"><a href="BeyondBasics.html#cb977-12" tabindex="-1"></a><span class="co">#&gt; APC  0.747   0.270   0.230 </span></span>
<span id="cb977-13"><a href="BeyondBasics.html#cb977-13" tabindex="-1"></a><span class="co">#&gt; BP   0.298   0.459   0.224 </span></span>
<span id="cb977-14"><a href="BeyondBasics.html#cb977-14" tabindex="-1"></a><span class="co">#&gt; BRY                  0.123 </span></span>
<span id="cb977-15"><a href="BeyondBasics.html#cb977-15" tabindex="-1"></a><span class="co">#&gt; CVX  0.442   0.672   0.197 </span></span>
<span id="cb977-16"><a href="BeyondBasics.html#cb977-16" tabindex="-1"></a><span class="co">#&gt; HES  0.589   0.299   0.434 </span></span>
<span id="cb977-17"><a href="BeyondBasics.html#cb977-17" tabindex="-1"></a><span class="co">#&gt; MRO  0.703   0.350   0.167 </span></span>
<span id="cb977-18"><a href="BeyondBasics.html#cb977-18" tabindex="-1"></a><span class="co">#&gt; NBL  0.760   0.249   0.124 </span></span>
<span id="cb977-19"><a href="BeyondBasics.html#cb977-19" tabindex="-1"></a><span class="co">#&gt; OXY  0.592   0.357         </span></span>
<span id="cb977-20"><a href="BeyondBasics.html#cb977-20" tabindex="-1"></a><span class="co">#&gt; ETP  0.194           0.489 </span></span>
<span id="cb977-21"><a href="BeyondBasics.html#cb977-21" tabindex="-1"></a><span class="co">#&gt; VLO  0.198   0.264   0.535 </span></span>
<span id="cb977-22"><a href="BeyondBasics.html#cb977-22" tabindex="-1"></a><span class="co">#&gt; XOM  0.355   0.753   0.190 </span></span>
<span id="cb977-23"><a href="BeyondBasics.html#cb977-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb977-24"><a href="BeyondBasics.html#cb977-24" tabindex="-1"></a><span class="co">#&gt;                Factor1 Factor2 Factor3</span></span>
<span id="cb977-25"><a href="BeyondBasics.html#cb977-25" tabindex="-1"></a><span class="co">#&gt; SS loadings      2.814   1.774   0.951</span></span>
<span id="cb977-26"><a href="BeyondBasics.html#cb977-26" tabindex="-1"></a><span class="co">#&gt; Proportion Var   0.256   0.161   0.086</span></span>
<span id="cb977-27"><a href="BeyondBasics.html#cb977-27" tabindex="-1"></a><span class="co">#&gt; Cumulative Var   0.256   0.417   0.504</span></span>
<span id="cb977-28"><a href="BeyondBasics.html#cb977-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb977-29"><a href="BeyondBasics.html#cb977-29" tabindex="-1"></a><span class="co">#&gt; Test of the hypothesis that 3 factors are sufficient.</span></span>
<span id="cb977-30"><a href="BeyondBasics.html#cb977-30" tabindex="-1"></a><span class="co">#&gt; The chi square statistic is 30.2 on 25 degrees of freedom.</span></span>
<span id="cb977-31"><a href="BeyondBasics.html#cb977-31" tabindex="-1"></a><span class="co">#&gt; The p-value is 0.218</span></span></code></pre></div>
<p>The large <em>p</em>-value (0.218) confirms that three factors are sufficient,
so we can use the analysis.</p>
<p>The output includes a table of explained variance, shown here:</p>
<pre><code>               Factor1 Factor2 Factor3
SS loadings      2.814   1.774   0.951
Proportion Var   0.256   0.161   0.086
Cumulative Var   0.256   0.417   0.504</code></pre>
<p>This table shows that the proportion of variance explained by each
factor is 0.256, 0.161, and 0.086, respectively. Cumulatively, they
explain 0.504 of the variance, which leaves 1 – 0.504 = 0.496
unexplained.</p>
<p>Next we want to interpret the factors, which is more like voodoo than
science. Let’s look at the loadings, repeated here:</p>
<pre id="I_programlisting13_d1e37123"><code>Loadings:
    Factor1 Factor2 Factor3
APC  0.747   0.270   0.230 
BP   0.298   0.459   0.224 
BRY                  0.123 
CVX  0.442   0.672   0.197 
HES  0.589   0.299   0.434 
MRO  0.703   0.350   0.167 
NBL  0.760   0.249   0.124 
OXY  0.592   0.357         
ETP  0.194           0.489 
VLO  0.198   0.264   0.535 
XOM  0.355   0.753   0.190</code></pre>
<p>Each row is labeled with the variable name (stock symbol): APC, BP, BRY,
and so forth. The first factor has many large loadings, indicating that
it explains the variance of many stocks. This is a common phenomenon in
factor analysis. We are often looking at related variables, and the
first factor captures their most basic relationship. In this example, we
are dealing with stocks, and most stocks move together in concert with
the broad market. That’s probably captured by the first factor.</p>
<p>The second factor is more subtle. Notice that the loadings for CVX
(0.67) and XOM (0.75) are the dominant ones, with BP not far behind (0.46), but all other stocks
have noticeably smaller loadings. This indicates a connection between
CVX, XOM, and BP. Perhaps they operate together in a common market (e.g., multinational energy) and so tend to move together.</p>
<p>The third factor also has three dominant loadings: VLO, ETP, and HES. These are somewhat smaller companies than the global giants we see in the first factor. Possibly these three share similar markets or risks and so their stocks also tend to move together.</p>
<p>In summary, it seems there are three groups of stocks here:</p>
<ul>
<li><p>CVX, XOM, BP</p></li>
<li><p>VLO, ETP, HES</p></li>
<li><p>Everything else</p></li>
</ul>
<p>Factor analysis is an art and a science. We suggest that you read a good
book on multivariate analysis before employing it.</p>
</div>
<div id="see_also-id193" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="BeyondBasics.html#see_also-id193" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="BeyondBasics.html#recipe-id162">13.4</a>, <a href="BeyondBasics.html#recipe-id162">“Performing Principal Component Analysis”</a>, for more
about PCA.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="UsefulTricks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="TimeSeriesAnalysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/CerebralMastication/R-Cookbook/edit/master/13_BeyondBasics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
