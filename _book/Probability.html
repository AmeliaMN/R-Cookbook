<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Probability | R Cookbook, 2nd Edition</title>
  <meta name="description" content="Second edition of R Cookbook" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Probability | R Cookbook, 2nd Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Second edition of R Cookbook" />
  <meta name="github-repo" content="CerebralMastication/R-Cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Probability | R Cookbook, 2nd Edition" />
  
  <meta name="twitter:description" content="Second edition of R Cookbook" />
  

<meta name="author" content="James (JD) Long" />
<meta name="author" content="Paul Teetor" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="StringsAndDates.html"/>
<link rel="next" href="GeneralStatistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129487349-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-129487349-3');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R Cookbook 2nd Edition</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to the R Cookbook 2nd Edition</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-recipes"><i class="fa fa-check"></i>The Recipes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-note-on-terminology"><i class="fa fa-check"></i>A Note on Terminology</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-and-platform-notes"><i class="fa fa-check"></i>Software and Platform Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions Used in This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-code-examples"><i class="fa fa-check"></i>Using Code Examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#safari-books-online"><i class="fa fa-check"></i>Safari® Books Online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i><b>1</b> Getting Started and Getting Help</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#intro-GettingStarted"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1.1" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id001"><i class="fa fa-check"></i><b>1.1</b> Downloading and Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id002b"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-startingrstudio"><i class="fa fa-check"></i><b>1.3</b> Starting RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id007"><i class="fa fa-check"></i><b>1.4</b> Entering Commands</a></li>
<li class="chapter" data-level="1.5" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id097"><i class="fa fa-check"></i><b>1.5</b> Exiting from RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id100"><i class="fa fa-check"></i><b>1.6</b> Interrupting R</a></li>
<li class="chapter" data-level="1.7" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id265"><i class="fa fa-check"></i><b>1.7</b> Viewing the Supplied Documentation</a></li>
<li class="chapter" data-level="1.8" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id003"><i class="fa fa-check"></i><b>1.8</b> Getting Help on a Function</a></li>
<li class="chapter" data-level="1.9" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id267"><i class="fa fa-check"></i><b>1.9</b> Searching the Supplied Documentation</a></li>
<li class="chapter" data-level="1.10" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id266"><i class="fa fa-check"></i><b>1.10</b> Getting Help on a Package</a></li>
<li class="chapter" data-level="1.11" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id005"><i class="fa fa-check"></i><b>1.11</b> Searching the Web for Help</a></li>
<li class="chapter" data-level="1.12" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id270"><i class="fa fa-check"></i><b>1.12</b> Finding Relevant Functions and Packages</a></li>
<li class="chapter" data-level="1.13" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id268"><i class="fa fa-check"></i><b>1.13</b> Searching the Mailing Lists</a></li>
<li class="chapter" data-level="1.14" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id269"><i class="fa fa-check"></i><b>1.14</b> Submitting Questions to Stack Overflow or Elsewhere in the Community</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="SomeBasics.html"><a href="SomeBasics.html"><i class="fa fa-check"></i><b>2</b> Some Basics</a>
<ul>
<li class="chapter" data-level="" data-path="SomeBasics.html"><a href="SomeBasics.html#intro-SomeBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2.1" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id017"><i class="fa fa-check"></i><b>2.1</b> Printing Something to the Screen</a></li>
<li class="chapter" data-level="2.2" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id016"><i class="fa fa-check"></i><b>2.2</b> Setting Variables</a></li>
<li class="chapter" data-level="2.3" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id091"><i class="fa fa-check"></i><b>2.3</b> Listing Variables</a></li>
<li class="chapter" data-level="2.4" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id075"><i class="fa fa-check"></i><b>2.4</b> Deleting Variables</a></li>
<li class="chapter" data-level="2.5" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id038"><i class="fa fa-check"></i><b>2.5</b> Creating a Vector</a></li>
<li class="chapter" data-level="2.6" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id101"><i class="fa fa-check"></i><b>2.6</b> Computing Basic Statistics</a></li>
<li class="chapter" data-level="2.7" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id021"><i class="fa fa-check"></i><b>2.7</b> Creating Sequences</a></li>
<li class="chapter" data-level="2.8" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id020"><i class="fa fa-check"></i><b>2.8</b> Comparing Vectors</a></li>
<li class="chapter" data-level="2.9" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id039"><i class="fa fa-check"></i><b>2.9</b> Selecting Vector Elements</a></li>
<li class="chapter" data-level="2.10" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id019"><i class="fa fa-check"></i><b>2.10</b> Performing Vector Arithmetic</a></li>
<li class="chapter" data-level="2.11" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id018"><i class="fa fa-check"></i><b>2.11</b> Getting Operator Precedence Right</a></li>
<li class="chapter" data-level="2.12" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id022"><i class="fa fa-check"></i><b>2.12</b> Typing Less and Accomplishing More</a></li>
<li class="chapter" data-level="2.13" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-pipe-2"><i class="fa fa-check"></i><b>2.13</b> Creating a Pipeline of Function Calls</a></li>
<li class="chapter" data-level="2.14" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id025"><i class="fa fa-check"></i><b>2.14</b> Avoiding Some Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html"><i class="fa fa-check"></i><b>3</b> Navigating the Software</a>
<ul>
<li class="chapter" data-level="" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#intro-NavigatingTheSoftware"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="3.1" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id008"><i class="fa fa-check"></i><b>3.1</b> Getting and Setting the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-CreateProject"><i class="fa fa-check"></i><b>3.2</b> Creating a New RStudio Project</a></li>
<li class="chapter" data-level="3.3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id009"><i class="fa fa-check"></i><b>3.3</b> Saving Your Workspace</a></li>
<li class="chapter" data-level="3.4" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id023"><i class="fa fa-check"></i><b>3.4</b> Viewing Your Command History</a></li>
<li class="chapter" data-level="3.5" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id024"><i class="fa fa-check"></i><b>3.5</b> Saving the Result of the Previous Command</a></li>
<li class="chapter" data-level="3.6" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id010"><i class="fa fa-check"></i><b>3.6</b> Displaying Loaded Packages via the Search Path</a></li>
<li class="chapter" data-level="3.7" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id094"><i class="fa fa-check"></i><b>3.7</b> Viewing the List of Installed Packages</a></li>
<li class="chapter" data-level="3.8" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id013"><i class="fa fa-check"></i><b>3.8</b> Accessing the Functions in a Package</a></li>
<li class="chapter" data-level="3.9" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id257"><i class="fa fa-check"></i><b>3.9</b> Accessing Built-in Datasets</a></li>
<li class="chapter" data-level="3.10" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id012"><i class="fa fa-check"></i><b>3.10</b> Installing Packages from CRAN</a></li>
<li class="chapter" data-level="3.11" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-installGH"><i class="fa fa-check"></i><b>3.11</b> Installing a Package from GitHub</a></li>
<li class="chapter" data-level="3.12" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id272"><i class="fa fa-check"></i><b>3.12</b> Setting or Changing a Default CRAN Mirror</a></li>
<li class="chapter" data-level="3.13" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id014"><i class="fa fa-check"></i><b>3.13</b> Running a Script</a></li>
<li class="chapter" data-level="3.14" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id015"><i class="fa fa-check"></i><b>3.14</b> Running a Batch Script</a></li>
<li class="chapter" data-level="3.15" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id102"><i class="fa fa-check"></i><b>3.15</b> Locating the R Home Directory</a></li>
<li class="chapter" data-level="3.16" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id099"><i class="fa fa-check"></i><b>3.16</b> Customizing R Startup</a></li>
<li class="chapter" data-level="3.17" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-Rcloud"><i class="fa fa-check"></i><b>3.17</b> Using R and RStudio in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="InputAndOutput.html"><a href="InputAndOutput.html"><i class="fa fa-check"></i><b>4</b> Input and Output</a>
<ul>
<li class="chapter" data-level="" data-path="InputAndOutput.html"><a href="InputAndOutput.html#intro-InputAndOutput"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="4.1" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id035"><i class="fa fa-check"></i><b>4.1</b> Entering Data from the Keyboard</a></li>
<li class="chapter" data-level="4.2" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id036"><i class="fa fa-check"></i><b>4.2</b> Printing Fewer Digits (or More Digits)</a></li>
<li class="chapter" data-level="4.3" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id034"><i class="fa fa-check"></i><b>4.3</b> Redirecting Output to a File</a></li>
<li class="chapter" data-level="4.4" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id030"><i class="fa fa-check"></i><b>4.4</b> Listing Files</a></li>
<li class="chapter" data-level="4.5" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id033"><i class="fa fa-check"></i><b>4.5</b> Dealing with “Cannot Open File” in Windows</a></li>
<li class="chapter" data-level="4.6" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id136"><i class="fa fa-check"></i><b>4.6</b> Reading Fixed-Width Records</a></li>
<li class="chapter" data-level="4.7" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id245"><i class="fa fa-check"></i><b>4.7</b> Reading Tabular Data Files</a></li>
<li class="chapter" data-level="4.8" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id027"><i class="fa fa-check"></i><b>4.8</b> Reading from CSV Files</a></li>
<li class="chapter" data-level="4.9" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id028"><i class="fa fa-check"></i><b>4.9</b> Writing to CSV Files</a></li>
<li class="chapter" data-level="4.10" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id031"><i class="fa fa-check"></i><b>4.10</b> Reading Tabular or CSV Data from the Web</a></li>
<li class="chapter" data-level="4.11" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readexcel"><i class="fa fa-check"></i><b>4.11</b> Reading Data from Excel</a></li>
<li class="chapter" data-level="4.12" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-writeexcel"><i class="fa fa-check"></i><b>4.12</b> Writing a Data Frame to Excel</a></li>
<li class="chapter" data-level="4.13" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readsas"><i class="fa fa-check"></i><b>4.13</b> Reading Data from a SAS file</a></li>
<li class="chapter" data-level="4.14" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id246"><i class="fa fa-check"></i><b>4.14</b> Reading Data from HTML Tables</a></li>
<li class="chapter" data-level="4.15" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id098"><i class="fa fa-check"></i><b>4.15</b> Reading Files with a Complex Structure</a></li>
<li class="chapter" data-level="4.16" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id037"><i class="fa fa-check"></i><b>4.16</b> Reading from MySQL Databases</a></li>
<li class="chapter" data-level="4.17" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-dbplyr"><i class="fa fa-check"></i><b>4.17</b> Accessing a Database with dbplyr</a></li>
<li class="chapter" data-level="4.18" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id029"><i class="fa fa-check"></i><b>4.18</b> Saving and Transporting Objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DataStructures.html"><a href="DataStructures.html"><i class="fa fa-check"></i><b>5</b> Data Structures</a>
<ul>
<li class="chapter" data-level="" data-path="DataStructures.html"><a href="DataStructures.html#intro-DataStructures"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="5.1" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id048"><i class="fa fa-check"></i><b>5.1</b> Appending Data to a Vector</a></li>
<li class="chapter" data-level="5.2" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id049"><i class="fa fa-check"></i><b>5.2</b> Inserting Data into a Vector</a></li>
<li class="chapter" data-level="5.3" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id050"><i class="fa fa-check"></i><b>5.3</b> Understanding the Recycling Rule</a></li>
<li class="chapter" data-level="5.4" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id051"><i class="fa fa-check"></i><b>5.4</b> Creating a Factor (Categorical Variable)</a></li>
<li class="chapter" data-level="5.5" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id227"><i class="fa fa-check"></i><b>5.5</b> Combining Multiple Vectors into One Vector and a Factor</a></li>
<li class="chapter" data-level="5.6" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id053"><i class="fa fa-check"></i><b>5.6</b> Creating a List</a></li>
<li class="chapter" data-level="5.7" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id054"><i class="fa fa-check"></i><b>5.7</b> Selecting List Elements by Position</a></li>
<li class="chapter" data-level="5.8" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id253"><i class="fa fa-check"></i><b>5.8</b> Selecting List Elements by Name</a></li>
<li class="chapter" data-level="5.9" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id158"><i class="fa fa-check"></i><b>5.9</b> Building a Name/Value Association List</a></li>
<li class="chapter" data-level="5.10" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id056"><i class="fa fa-check"></i><b>5.10</b> Removing an Element from a List</a></li>
<li class="chapter" data-level="5.11" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id152"><i class="fa fa-check"></i><b>5.11</b> Flatten a List into a Vector</a></li>
<li class="chapter" data-level="5.12" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id058"><i class="fa fa-check"></i><b>5.12</b> Removing NULL Elements from a List</a></li>
<li class="chapter" data-level="5.13" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id060"><i class="fa fa-check"></i><b>5.13</b> Removing List Elements Using a Condition</a></li>
<li class="chapter" data-level="5.14" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id062"><i class="fa fa-check"></i><b>5.14</b> Initializing a Matrix</a></li>
<li class="chapter" data-level="5.15" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id139"><i class="fa fa-check"></i><b>5.15</b> Performing Matrix Operations</a></li>
<li class="chapter" data-level="5.16" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id063"><i class="fa fa-check"></i><b>5.16</b> Giving Descriptive Names to the Rows and Columns of a Matrix</a></li>
<li class="chapter" data-level="5.17" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id250"><i class="fa fa-check"></i><b>5.17</b> Selecting One Row or Column from a Matrix</a></li>
<li class="chapter" data-level="5.18" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id251"><i class="fa fa-check"></i><b>5.18</b> Initializing a Data Frame from Column Data</a></li>
<li class="chapter" data-level="5.19" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id252"><i class="fa fa-check"></i><b>5.19</b> Initializing a Data Frame from Row Data</a></li>
<li class="chapter" data-level="5.20" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id071"><i class="fa fa-check"></i><b>5.20</b> Appending Rows to a Data Frame</a></li>
<li class="chapter" data-level="5.21" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id068"><i class="fa fa-check"></i><b>5.21</b> Selecting Data Frame Columns by Position</a></li>
<li class="chapter" data-level="5.22" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id254"><i class="fa fa-check"></i><b>5.22</b> Selecting Data Frame Columns by Name</a></li>
<li class="chapter" data-level="5.23" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id069"><i class="fa fa-check"></i><b>5.23</b> Changing the Names of Data Frame Columns</a></li>
<li class="chapter" data-level="5.24" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id249"><i class="fa fa-check"></i><b>5.24</b> Removing NAs from a Data Frame</a></li>
<li class="chapter" data-level="5.25" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id072"><i class="fa fa-check"></i><b>5.25</b> Excluding Columns by Name</a></li>
<li class="chapter" data-level="5.26" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id155"><i class="fa fa-check"></i><b>5.26</b> Combining Two Data Frames</a></li>
<li class="chapter" data-level="5.27" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id057"><i class="fa fa-check"></i><b>5.27</b> Merging Data Frames by Common Column</a></li>
<li class="chapter" data-level="5.28" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id248"><i class="fa fa-check"></i><b>5.28</b> Converting One Atomic Value into Another</a></li>
<li class="chapter" data-level="5.29" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id074"><i class="fa fa-check"></i><b>5.29</b> Converting One Structured Data Type into Another</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="DataTransformations.html"><a href="DataTransformations.html"><i class="fa fa-check"></i><b>6</b> Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="DataTransformations.html"><a href="DataTransformations.html#intro-DataTransformations"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="6.1" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id149"><i class="fa fa-check"></i><b>6.1</b> Applying a Function to Each List Element</a></li>
<li class="chapter" data-level="6.2" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-row_df"><i class="fa fa-check"></i><b>6.2</b> Applying a Function to Every Row of a Data Frame</a></li>
<li class="chapter" data-level="6.3" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id146"><i class="fa fa-check"></i><b>6.3</b> Applying a Function to Every Row of a Matrix</a></li>
<li class="chapter" data-level="6.4" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id157"><i class="fa fa-check"></i><b>6.4</b> Applying a Function to Every Column</a></li>
<li class="chapter" data-level="6.5" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id275"><i class="fa fa-check"></i><b>6.5</b> Applying a Function to Parallel Vectors or Lists</a></li>
<li class="chapter" data-level="6.6" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id148"><i class="fa fa-check"></i><b>6.6</b> Applying a Function to Groups of Data</a></li>
<li class="chapter" data-level="6.7" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-casewhen"><i class="fa fa-check"></i><b>6.7</b> Creating a New Column Based on Some Condition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="StringsAndDates.html"><a href="StringsAndDates.html"><i class="fa fa-check"></i><b>7</b> Strings and Dates</a>
<ul>
<li class="chapter" data-level="" data-path="StringsAndDates.html"><a href="StringsAndDates.html#I_sect17_d1e17434"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="7.1" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id093"><i class="fa fa-check"></i><b>7.1</b> Getting the Length of a String</a></li>
<li class="chapter" data-level="7.2" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id040"><i class="fa fa-check"></i><b>7.2</b> Concatenating Strings</a></li>
<li class="chapter" data-level="7.3" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id041"><i class="fa fa-check"></i><b>7.3</b> Extracting Substrings</a></li>
<li class="chapter" data-level="7.4" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id276"><i class="fa fa-check"></i><b>7.4</b> Splitting a String According to a Delimiter</a></li>
<li class="chapter" data-level="7.5" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id277"><i class="fa fa-check"></i><b>7.5</b> Replacing Substrings</a></li>
<li class="chapter" data-level="7.6" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id109"><i class="fa fa-check"></i><b>7.6</b> Generating All Pairwise Combinations of Strings</a></li>
<li class="chapter" data-level="7.7" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id045"><i class="fa fa-check"></i><b>7.7</b> Getting the Current Date</a></li>
<li class="chapter" data-level="7.8" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id043"><i class="fa fa-check"></i><b>7.8</b> Converting a String into a Date</a></li>
<li class="chapter" data-level="7.9" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id044"><i class="fa fa-check"></i><b>7.9</b> Converting a Date into a String</a></li>
<li class="chapter" data-level="7.10" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id241"><i class="fa fa-check"></i><b>7.10</b> Converting Year, Month, and Day into a Date</a></li>
<li class="chapter" data-level="7.11" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id042"><i class="fa fa-check"></i><b>7.11</b> Getting the Julian Date</a></li>
<li class="chapter" data-level="7.12" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id046"><i class="fa fa-check"></i><b>7.12</b> Extracting the Parts of a Date</a></li>
<li class="chapter" data-level="7.13" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id047"><i class="fa fa-check"></i><b>7.13</b> Creating a Sequence of Dates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Probability.html"><a href="Probability.html"><i class="fa fa-check"></i><b>8</b> Probability</a>
<ul>
<li class="chapter" data-level="" data-path="Probability.html"><a href="Probability.html#intro-Probability"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="8.1" data-path="Probability.html"><a href="Probability.html#recipe-id163"><i class="fa fa-check"></i><b>8.1</b> Counting the Number of Combinations</a></li>
<li class="chapter" data-level="8.2" data-path="Probability.html"><a href="Probability.html#recipe-id198"><i class="fa fa-check"></i><b>8.2</b> Generating Combinations</a></li>
<li class="chapter" data-level="8.3" data-path="Probability.html"><a href="Probability.html#recipe-id165"><i class="fa fa-check"></i><b>8.3</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="8.4" data-path="Probability.html"><a href="Probability.html#recipe-id201"><i class="fa fa-check"></i><b>8.4</b> Generating Reproducible Random Numbers</a></li>
<li class="chapter" data-level="8.5" data-path="Probability.html"><a href="Probability.html#recipe-id199"><i class="fa fa-check"></i><b>8.5</b> Generating a Random Sample</a></li>
<li class="chapter" data-level="8.6" data-path="Probability.html"><a href="Probability.html#recipe-id200"><i class="fa fa-check"></i><b>8.6</b> Generating Random Sequences</a></li>
<li class="chapter" data-level="8.7" data-path="Probability.html"><a href="Probability.html#recipe-id151"><i class="fa fa-check"></i><b>8.7</b> Randomly Permuting a Vector</a></li>
<li class="chapter" data-level="8.8" data-path="Probability.html"><a href="Probability.html#recipe-id196"><i class="fa fa-check"></i><b>8.8</b> Calculating Probabilities for Discrete Distributions</a></li>
<li class="chapter" data-level="8.9" data-path="Probability.html"><a href="Probability.html#recipe-id197"><i class="fa fa-check"></i><b>8.9</b> Calculating Probabilities for Continuous Distributions</a></li>
<li class="chapter" data-level="8.10" data-path="Probability.html"><a href="Probability.html#recipe-id168"><i class="fa fa-check"></i><b>8.10</b> Converting Probabilities to Quantiles</a></li>
<li class="chapter" data-level="8.11" data-path="Probability.html"><a href="Probability.html#recipe-id166"><i class="fa fa-check"></i><b>8.11</b> Plotting a Density Function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html"><i class="fa fa-check"></i><b>9</b> General Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#intro-GeneralStatistics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="9.1" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id119"><i class="fa fa-check"></i><b>9.1</b> Summarizing Your Data</a></li>
<li class="chapter" data-level="9.2" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id229"><i class="fa fa-check"></i><b>9.2</b> Calculating Relative Frequencies</a></li>
<li class="chapter" data-level="9.3" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id124"><i class="fa fa-check"></i><b>9.3</b> Tabulating Factors and Creating Contingency Tables</a></li>
<li class="chapter" data-level="9.4" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id125"><i class="fa fa-check"></i><b>9.4</b> Testing Categorical Variables for Independence</a></li>
<li class="chapter" data-level="9.5" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id143"><i class="fa fa-check"></i><b>9.5</b> Calculating Quantiles (and Quartiles) of a Dataset</a></li>
<li class="chapter" data-level="9.6" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id142"><i class="fa fa-check"></i><b>9.6</b> Inverting a Quantile</a></li>
<li class="chapter" data-level="9.7" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id133"><i class="fa fa-check"></i><b>9.7</b> Converting Data to z-Scores</a></li>
<li class="chapter" data-level="9.8" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id121"><i class="fa fa-check"></i><b>9.8</b> Testing the Mean of a Sample (t Test)</a></li>
<li class="chapter" data-level="9.9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id123"><i class="fa fa-check"></i><b>9.9</b> Forming a Confidence Interval for a Mean</a></li>
<li class="chapter" data-level="9.10" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id135"><i class="fa fa-check"></i><b>9.10</b> Forming a Confidence Interval for a Median</a></li>
<li class="chapter" data-level="9.11" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id225"><i class="fa fa-check"></i><b>9.11</b> Testing a Sample Proportion</a></li>
<li class="chapter" data-level="9.12" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id226"><i class="fa fa-check"></i><b>9.12</b> Forming a Confidence Interval for a Proportion</a></li>
<li class="chapter" data-level="9.13" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id126"><i class="fa fa-check"></i><b>9.13</b> Testing for Normality</a></li>
<li class="chapter" data-level="9.14" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id131"><i class="fa fa-check"></i><b>9.14</b> Testing for Runs</a></li>
<li class="chapter" data-level="9.15" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id122"><i class="fa fa-check"></i><b>9.15</b> Comparing the Means of Two Samples</a></li>
<li class="chapter" data-level="9.16" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id130"><i class="fa fa-check"></i><b>9.16</b> Comparing the Locations of Two Samples Nonparametrically</a></li>
<li class="chapter" data-level="9.17" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id132"><i class="fa fa-check"></i><b>9.17</b> Testing a Correlation for Significance</a></li>
<li class="chapter" data-level="9.18" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id134"><i class="fa fa-check"></i><b>9.18</b> Testing Groups for Equal Proportions</a></li>
<li class="chapter" data-level="9.19" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id127"><i class="fa fa-check"></i><b>9.19</b> Performing Pairwise Comparisons Between Group Means</a></li>
<li class="chapter" data-level="9.20" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id129"><i class="fa fa-check"></i><b>9.20</b> Testing Two Samples for the Same Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Graphics.html"><a href="Graphics.html"><i class="fa fa-check"></i><b>10</b> Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="Graphics.html"><a href="Graphics.html#intro-Graphics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10.1" data-path="Graphics.html"><a href="Graphics.html#recipe-id171"><i class="fa fa-check"></i><b>10.1</b> Creating a Scatter Plot</a></li>
<li class="chapter" data-level="10.2" data-path="Graphics.html"><a href="Graphics.html#recipe-id259"><i class="fa fa-check"></i><b>10.2</b> Adding a Title and Labels</a></li>
<li class="chapter" data-level="10.3" data-path="Graphics.html"><a href="Graphics.html#recipe-id261"><i class="fa fa-check"></i><b>10.3</b> Adding (or Removing) a Grid</a></li>
<li class="chapter" data-level="10.4" data-path="Graphics.html"><a href="Graphics.html#recipe-theme"><i class="fa fa-check"></i><b>10.4</b> Applying a Theme to a ggplot Figure</a></li>
<li class="chapter" data-level="10.5" data-path="Graphics.html"><a href="Graphics.html#recipe-id262"><i class="fa fa-check"></i><b>10.5</b> Creating a Scatter Plot of Multiple Groups</a></li>
<li class="chapter" data-level="10.6" data-path="Graphics.html"><a href="Graphics.html#recipe-id260"><i class="fa fa-check"></i><b>10.6</b> Adding (or Removing) a Legend</a></li>
<li class="chapter" data-level="10.7" data-path="Graphics.html"><a href="Graphics.html#recipe-id217"><i class="fa fa-check"></i><b>10.7</b> Plotting the Regression Line of a Scatter Plot</a></li>
<li class="chapter" data-level="10.8" data-path="Graphics.html"><a href="Graphics.html#recipe-id184"><i class="fa fa-check"></i><b>10.8</b> Plotting All Variables Against All Other Variables</a></li>
<li class="chapter" data-level="10.9" data-path="Graphics.html"><a href="Graphics.html#recipe-id185"><i class="fa fa-check"></i><b>10.9</b> Creating One Scatter Plot for Each Group</a></li>
<li class="chapter" data-level="10.10" data-path="Graphics.html"><a href="Graphics.html#recipe-id175"><i class="fa fa-check"></i><b>10.10</b> Creating a Bar Chart</a></li>
<li class="chapter" data-level="10.11" data-path="Graphics.html"><a href="Graphics.html#recipe-id177"><i class="fa fa-check"></i><b>10.11</b> Adding Confidence Intervals to a Bar Chart</a></li>
<li class="chapter" data-level="10.12" data-path="Graphics.html"><a href="Graphics.html#recipe-id176"><i class="fa fa-check"></i><b>10.12</b> Coloring a Bar Chart</a></li>
<li class="chapter" data-level="10.13" data-path="Graphics.html"><a href="Graphics.html#recipe-id174"><i class="fa fa-check"></i><b>10.13</b> Plotting a Line from x and y Points</a></li>
<li class="chapter" data-level="10.14" data-path="Graphics.html"><a href="Graphics.html#recipe-id256"><i class="fa fa-check"></i><b>10.14</b> Changing the Type, Width, or Color of a Line</a></li>
<li class="chapter" data-level="10.15" data-path="Graphics.html"><a href="Graphics.html#recipe-id263"><i class="fa fa-check"></i><b>10.15</b> Plotting Multiple Datasets</a></li>
<li class="chapter" data-level="10.16" data-path="Graphics.html"><a href="Graphics.html#recipe-id186"><i class="fa fa-check"></i><b>10.16</b> Adding Vertical or Horizontal Lines</a></li>
<li class="chapter" data-level="10.17" data-path="Graphics.html"><a href="Graphics.html#recipe-id178"><i class="fa fa-check"></i><b>10.17</b> Creating a Boxplot</a></li>
<li class="chapter" data-level="10.18" data-path="Graphics.html"><a href="Graphics.html#recipe-id179"><i class="fa fa-check"></i><b>10.18</b> Creating One Boxplot for Each Factor Level</a></li>
<li class="chapter" data-level="10.19" data-path="Graphics.html"><a href="Graphics.html#recipe-id182"><i class="fa fa-check"></i><b>10.19</b> Creating a Histogram</a></li>
<li class="chapter" data-level="10.20" data-path="Graphics.html"><a href="Graphics.html#recipe-id183"><i class="fa fa-check"></i><b>10.20</b> Adding a Density Estimate to a Histogram</a></li>
<li class="chapter" data-level="10.21" data-path="Graphics.html"><a href="Graphics.html#recipe-id180"><i class="fa fa-check"></i><b>10.21</b> Creating a Normal Quantile–Quantile Plot</a></li>
<li class="chapter" data-level="10.22" data-path="Graphics.html"><a href="Graphics.html#recipe-id181"><i class="fa fa-check"></i><b>10.22</b> Creating Other Quantile–Quantile Plots</a></li>
<li class="chapter" data-level="10.23" data-path="Graphics.html"><a href="Graphics.html#recipe-id191"><i class="fa fa-check"></i><b>10.23</b> Plotting a Variable in Multiple Colors</a></li>
<li class="chapter" data-level="10.24" data-path="Graphics.html"><a href="Graphics.html#recipe-id192"><i class="fa fa-check"></i><b>10.24</b> Graphing a Function</a></li>
<li class="chapter" data-level="10.25" data-path="Graphics.html"><a href="Graphics.html#recipe-id190"><i class="fa fa-check"></i><b>10.25</b> Displaying Several Figures on One Page</a></li>
<li class="chapter" data-level="10.26" data-path="Graphics.html"><a href="Graphics.html#recipe-id188"><i class="fa fa-check"></i><b>10.26</b> Writing Your Plot to a File</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html"><i class="fa fa-check"></i><b>11</b> Linear Regression and ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#intro-LinearRegressionAndANOVA"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id203"><i class="fa fa-check"></i><b>11.1</b> Performing Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id204"><i class="fa fa-check"></i><b>11.2</b> Performing Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.3" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id231"><i class="fa fa-check"></i><b>11.3</b> Getting Regression Statistics</a></li>
<li class="chapter" data-level="11.4" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id240"><i class="fa fa-check"></i><b>11.4</b> Understanding the Regression Summary</a></li>
<li class="chapter" data-level="11.5" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id205"><i class="fa fa-check"></i><b>11.5</b> Performing Linear Regression Without an Intercept</a></li>
<li class="chapter" data-level="11.6" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#title-highcor"><i class="fa fa-check"></i><b>11.6</b> Regressing Only Variables That Highly Correlate with Your Dependent Variable</a></li>
<li class="chapter" data-level="11.7" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id206"><i class="fa fa-check"></i><b>11.7</b> Performing Linear Regression with Interaction Terms</a></li>
<li class="chapter" data-level="11.8" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id236"><i class="fa fa-check"></i><b>11.8</b> Selecting the Best Regression Variables</a></li>
<li class="chapter" data-level="11.9" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id209"><i class="fa fa-check"></i><b>11.9</b> Regressing on a Subset of Your Data</a></li>
<li class="chapter" data-level="11.10" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id244"><i class="fa fa-check"></i><b>11.10</b> Using an Expression Inside a Regression Formula</a></li>
<li class="chapter" data-level="11.11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id243"><i class="fa fa-check"></i><b>11.11</b> Regressing on a Polynomial</a></li>
<li class="chapter" data-level="11.12" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id208"><i class="fa fa-check"></i><b>11.12</b> Regressing on Transformed Data</a></li>
<li class="chapter" data-level="11.13" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id210"><i class="fa fa-check"></i><b>11.13</b> Finding the Best Power Transformation (Box–Cox Procedure)</a></li>
<li class="chapter" data-level="11.14" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id211"><i class="fa fa-check"></i><b>11.14</b> Forming Confidence Intervals for Regression Coefficients</a></li>
<li class="chapter" data-level="11.15" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id216"><i class="fa fa-check"></i><b>11.15</b> Plotting Regression Residuals</a></li>
<li class="chapter" data-level="11.16" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id212"><i class="fa fa-check"></i><b>11.16</b> Diagnosing a Linear Regression</a></li>
<li class="chapter" data-level="11.17" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id233"><i class="fa fa-check"></i><b>11.17</b> Identifying Influential Observations</a></li>
<li class="chapter" data-level="11.18" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id213"><i class="fa fa-check"></i><b>11.18</b> Testing Residuals for Autocorrelation (Durbin–Watson Test)</a></li>
<li class="chapter" data-level="11.19" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id214"><i class="fa fa-check"></i><b>11.19</b> Predicting New Values</a></li>
<li class="chapter" data-level="11.20" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id215"><i class="fa fa-check"></i><b>11.20</b> Forming Prediction Intervals</a></li>
<li class="chapter" data-level="11.21" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id218"><i class="fa fa-check"></i><b>11.21</b> Performing One-Way ANOVA</a></li>
<li class="chapter" data-level="11.22" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id221"><i class="fa fa-check"></i><b>11.22</b> Creating an Interaction Plot</a></li>
<li class="chapter" data-level="11.23" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id220"><i class="fa fa-check"></i><b>11.23</b> Finding Differences Between Means of Groups</a></li>
<li class="chapter" data-level="11.24" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id228"><i class="fa fa-check"></i><b>11.24</b> Performing Robust ANOVA (Kruskal–Wallis Test)</a></li>
<li class="chapter" data-level="11.25" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id232"><i class="fa fa-check"></i><b>11.25</b> Comparing Models by Using ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="UsefulTricks.html"><a href="UsefulTricks.html"><i class="fa fa-check"></i><b>12</b> Useful Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="UsefulTricks.html"><a href="UsefulTricks.html#intro-UsefulTricks"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12.1" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id278"><i class="fa fa-check"></i><b>12.1</b> Peeking at Your Data</a></li>
<li class="chapter" data-level="12.2" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id271"><i class="fa fa-check"></i><b>12.2</b> Printing the Result of an Assignment</a></li>
<li class="chapter" data-level="12.3" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id138"><i class="fa fa-check"></i><b>12.3</b> Summing Rows and Columns</a></li>
<li class="chapter" data-level="12.4" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id112"><i class="fa fa-check"></i><b>12.4</b> Printing Data in Columns</a></li>
<li class="chapter" data-level="12.5" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id137"><i class="fa fa-check"></i><b>12.5</b> Binning Your Data</a></li>
<li class="chapter" data-level="12.6" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id116"><i class="fa fa-check"></i><b>12.6</b> Finding the Position of a Particular Value</a></li>
<li class="chapter" data-level="12.7" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id103"><i class="fa fa-check"></i><b>12.7</b> Selecting Every nth Element of a Vector</a></li>
<li class="chapter" data-level="12.8" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id107"><i class="fa fa-check"></i><b>12.8</b> Finding Minimums or Maximums</a></li>
<li class="chapter" data-level="12.9" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id110"><i class="fa fa-check"></i><b>12.9</b> Generating All Combinations of Several Variables</a></li>
<li class="chapter" data-level="12.10" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id153"><i class="fa fa-check"></i><b>12.10</b> Flattening a Data Frame</a></li>
<li class="chapter" data-level="12.11" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id247"><i class="fa fa-check"></i><b>12.11</b> Sorting a Data Frame</a></li>
<li class="chapter" data-level="12.12" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id223"><i class="fa fa-check"></i><b>12.12</b> Stripping Attributes from a Variable</a></li>
<li class="chapter" data-level="12.13" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id202"><i class="fa fa-check"></i><b>12.13</b> Revealing the Structure of an Object</a></li>
<li class="chapter" data-level="12.14" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id224"><i class="fa fa-check"></i><b>12.14</b> Timing Your Code</a></li>
<li class="chapter" data-level="12.15" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id113"><i class="fa fa-check"></i><b>12.15</b> Suppressing Warnings and Error Messages</a></li>
<li class="chapter" data-level="12.16" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id118"><i class="fa fa-check"></i><b>12.16</b> Taking Function Arguments from a List</a></li>
<li class="chapter" data-level="12.17" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id114"><i class="fa fa-check"></i><b>12.17</b> Defining Your Own Binary Operators</a></li>
<li class="chapter" data-level="12.18" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id111"><i class="fa fa-check"></i><b>12.18</b> Suppressing the Startup Message</a></li>
<li class="chapter" data-level="12.19" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id106"><i class="fa fa-check"></i><b>12.19</b> Getting and Setting Environment Variables</a></li>
<li class="chapter" data-level="12.20" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-codesections"><i class="fa fa-check"></i><b>12.20</b> Use Code Sections</a></li>
<li class="chapter" data-level="12.21" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_local"><i class="fa fa-check"></i><b>12.21</b> Executing R in Parallel Locally</a></li>
<li class="chapter" data-level="12.22" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_remote"><i class="fa fa-check"></i><b>12.22</b> Executing R in Parallel Remotely</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="BeyondBasics.html"><a href="BeyondBasics.html"><i class="fa fa-check"></i><b>13</b> Beyond Basic Numerics and Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="BeyondBasics.html"><a href="BeyondBasics.html#intro-BeyondBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="13.1" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id234"><i class="fa fa-check"></i><b>13.1</b> Minimizing or Maximizing a Single-Parameter Function</a></li>
<li class="chapter" data-level="13.2" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id235"><i class="fa fa-check"></i><b>13.2</b> Minimizing or Maximizing a Multiparameter Function</a></li>
<li class="chapter" data-level="13.3" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id140"><i class="fa fa-check"></i><b>13.3</b> Calculating Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="13.4" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id162"><i class="fa fa-check"></i><b>13.4</b> Performing Principal Component Analysis</a></li>
<li class="chapter" data-level="13.5" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id264"><i class="fa fa-check"></i><b>13.5</b> Performing Simple Orthogonal Regression</a></li>
<li class="chapter" data-level="13.6" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id160"><i class="fa fa-check"></i><b>13.6</b> Finding Clusters in Your Data</a></li>
<li class="chapter" data-level="13.7" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id161"><i class="fa fa-check"></i><b>13.7</b> Predicting a Binary-Valued Variable (Logistic Regression)</a></li>
<li class="chapter" data-level="13.8" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id159"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping a Statistic</a></li>
<li class="chapter" data-level="13.9" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id193"><i class="fa fa-check"></i><b>13.9</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html"><i class="fa fa-check"></i><b>14</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14.1" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id076"><i class="fa fa-check"></i><b>14.1</b> Representing Time Series Data</a></li>
<li class="chapter" data-level="14.2" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id089"><i class="fa fa-check"></i><b>14.2</b> Plotting Time Series Data</a></li>
<li class="chapter" data-level="14.3" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id077"><i class="fa fa-check"></i><b>14.3</b> Extracting the Oldest or Newest Observations</a></li>
<li class="chapter" data-level="14.4" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id281"><i class="fa fa-check"></i><b>14.4</b> Subsetting a Time Series</a></li>
<li class="chapter" data-level="14.5" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id079"><i class="fa fa-check"></i><b>14.5</b> Merging Several Time Series</a></li>
<li class="chapter" data-level="14.6" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id239"><i class="fa fa-check"></i><b>14.6</b> Filling or Padding a Time Series</a></li>
<li class="chapter" data-level="14.7" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id280"><i class="fa fa-check"></i><b>14.7</b> Lagging a Time Series</a></li>
<li class="chapter" data-level="14.8" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id141"><i class="fa fa-check"></i><b>14.8</b> Computing Successive Differences</a></li>
<li class="chapter" data-level="14.9" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id080"><i class="fa fa-check"></i><b>14.9</b> Performing Calculations on Time Series</a></li>
<li class="chapter" data-level="14.10" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id279"><i class="fa fa-check"></i><b>14.10</b> Computing a Moving Average</a></li>
<li class="chapter" data-level="14.11" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id282"><i class="fa fa-check"></i><b>14.11</b> Applying a Function by Calendar Period</a></li>
<li class="chapter" data-level="14.12" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id081"><i class="fa fa-check"></i><b>14.12</b> Applying a Rolling Function</a></li>
<li class="chapter" data-level="14.13" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id082"><i class="fa fa-check"></i><b>14.13</b> Plotting the Autocorrelation Function</a></li>
<li class="chapter" data-level="14.14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id104"><i class="fa fa-check"></i><b>14.14</b> Testing a Time Series for Autocorrelation</a></li>
<li class="chapter" data-level="14.15" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id083"><i class="fa fa-check"></i><b>14.15</b> Plotting the Partial Autocorrelation Function</a></li>
<li class="chapter" data-level="14.16" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id084"><i class="fa fa-check"></i><b>14.16</b> Finding Lagged Correlations Between Two Time Series</a></li>
<li class="chapter" data-level="14.17" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id088"><i class="fa fa-check"></i><b>14.17</b> Detrending a Time Series</a></li>
<li class="chapter" data-level="14.18" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id085"><i class="fa fa-check"></i><b>14.18</b> Fitting an ARIMA Model</a></li>
<li class="chapter" data-level="14.19" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id237"><i class="fa fa-check"></i><b>14.19</b> Removing Insignificant ARIMA Coefficients</a></li>
<li class="chapter" data-level="14.20" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id238"><i class="fa fa-check"></i><b>14.20</b> Running Diagnostics on an ARIMA Model</a></li>
<li class="chapter" data-level="14.21" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id086"><i class="fa fa-check"></i><b>14.21</b> Making Forecasts from an ARIMA Model</a></li>
<li class="chapter" data-level="14.22" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-plotting_forecast"><i class="fa fa-check"></i><b>14.22</b> Plotting a Forecast</a></li>
<li class="chapter" data-level="14.23" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id087"><i class="fa fa-check"></i><b>14.23</b> Testing for Mean Reversion</a></li>
<li class="chapter" data-level="14.24" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id195"><i class="fa fa-check"></i><b>14.24</b> Smoothing a Time Series</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html"><i class="fa fa-check"></i><b>15</b> Simple Programming</a>
<ul>
<li class="chapter" data-level="" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#intro-SimpleProgramming"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="15.1" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-creating_if_logic"><i class="fa fa-check"></i><b>15.1</b> Choosing Between Two Alternatives: if-else</a></li>
<li class="chapter" data-level="15.2" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-for_loop"><i class="fa fa-check"></i><b>15.2</b> Iterating with a Loop</a></li>
<li class="chapter" data-level="15.3" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-id117"><i class="fa fa-check"></i><b>15.3</b> Defining a Function</a></li>
<li class="chapter" data-level="15.4" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-variable"><i class="fa fa-check"></i><b>15.4</b> Creating a Local Variable</a></li>
<li class="chapter" data-level="15.5" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#choosing-between-multiple-alternatives-switch"><i class="fa fa-check"></i><b>15.5</b> Choosing Between Multiple Alternatives: switch</a></li>
<li class="chapter" data-level="15.6" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-title"><i class="fa fa-check"></i><b>15.6</b> Defining Defaults for Function Parameters</a></li>
<li class="chapter" data-level="15.7" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#signaling-errors"><i class="fa fa-check"></i><b>15.7</b> Signaling Errors</a></li>
<li class="chapter" data-level="15.8" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#protecting-against-errors"><i class="fa fa-check"></i><b>15.8</b> Protecting Against Errors</a></li>
<li class="chapter" data-level="15.9" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-anon-function"><i class="fa fa-check"></i><b>15.9</b> Creating an Anonymous Function</a></li>
<li class="chapter" data-level="15.10" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#creating-a-collection-of-reusable-functions"><i class="fa fa-check"></i><b>15.10</b> Creating a Collection of Reusable Functions</a></li>
<li class="chapter" data-level="15.11" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-indent"><i class="fa fa-check"></i><b>15.11</b> Automatically Reindent Code</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RMarkdown.html"><a href="RMarkdown.html"><i class="fa fa-check"></i><b>16</b> R Markdown and Publishing</a>
<ul>
<li class="chapter" data-level="" data-path="RMarkdown.html"><a href="RMarkdown.html#intro-Rmd_pub"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="16.1" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-new_doc"><i class="fa fa-check"></i><b>16.1</b> Creating a New Document</a></li>
<li class="chapter" data-level="16.2" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-metadata"><i class="fa fa-check"></i><b>16.2</b> Adding a Title, Author, or Date</a></li>
<li class="chapter" data-level="16.3" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc-text"><i class="fa fa-check"></i><b>16.3</b> Formatting Document Text</a></li>
<li class="chapter" data-level="16.4" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-headings"><i class="fa fa-check"></i><b>16.4</b> Inserting Document Headings</a></li>
<li class="chapter" data-level="16.5" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-list"><i class="fa fa-check"></i><b>16.5</b> Inserting a List</a></li>
<li class="chapter" data-level="16.6" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-exec_r"><i class="fa fa-check"></i><b>16.6</b> Showing Output from R Code</a></li>
<li class="chapter" data-level="16.7" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-code-results"><i class="fa fa-check"></i><b>16.7</b> Controlling Which Code and Results Are Shown</a></li>
<li class="chapter" data-level="16.8" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc_plot"><i class="fa fa-check"></i><b>16.8</b> Inserting a Plot</a></li>
<li class="chapter" data-level="16.9" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-static-table"><i class="fa fa-check"></i><b>16.9</b> Inserting a Table</a></li>
<li class="chapter" data-level="16.10" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-tables"><i class="fa fa-check"></i><b>16.10</b> Inserting a Table of Data</a></li>
<li class="chapter" data-level="16.11" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-equations"><i class="fa fa-check"></i><b>16.11</b> Inserting Math Equations</a></li>
<li class="chapter" data-level="16.12" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-html"><i class="fa fa-check"></i><b>16.12</b> Generating HTML Output</a></li>
<li class="chapter" data-level="16.13" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-pdf"><i class="fa fa-check"></i><b>16.13</b> Generating PDF Output</a></li>
<li class="chapter" data-level="16.14" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-word"><i class="fa fa-check"></i><b>16.14</b> Generating Microsoft Word Output</a></li>
<li class="chapter" data-level="16.15" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-prez"><i class="fa fa-check"></i><b>16.15</b> Generating Presentation Output</a></li>
<li class="chapter" data-level="16.16" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-param_report"><i class="fa fa-check"></i><b>16.16</b> Creating a Parameterized Report</a></li>
<li class="chapter" data-level="16.17" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-rmd_org"><i class="fa fa-check"></i><b>16.17</b> Organizing Your R Markdown Workflow</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cookbook, 2nd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Probability" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Probability<a href="Probability.html#Probability" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro-Probability" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="Probability.html#intro-Probability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Probability theory is the foundation of statistics, and R has plenty of
machinery for working with probability, probability distributions, and
random variables. The recipes in this chapter show you how to calculate
probabilities from quantiles, calculate quantiles from probabilities,
generate random variables drawn from distributions, plot distributions,
and so forth.</p>
<div id="names-of-distributions" class="section level3 unnumbered hasAnchor">
<h3>Names of Distributions<a href="Probability.html#names-of-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R has an abbreviated name for every probability distribution. This name
is used to identify the functions associated with the distribution. For
example, the name of the Normal distribution is “norm,” which is the
root of the function names listed in Table <a href="Probability.html#tab:tbl-profunctions">8.1</a>.</p>
<table>
<caption><span id="tab:tbl-profunctions">Table 8.1: </span> Normal distribution functions</caption>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>dnorm</code></td>
<td align="left">Normal density</td>
</tr>
<tr class="even">
<td align="left"><code>pnorm</code></td>
<td align="left">Normal distribution function</td>
</tr>
<tr class="odd">
<td align="left"><code>qnorm</code></td>
<td align="left">Normal quantile function</td>
</tr>
<tr class="even">
<td align="left"><code>rnorm</code></td>
<td align="left">Normal random variates</td>
</tr>
</tbody>
</table>
<p>Table <a href="Probability.html#tab:tbl-Discrete">8.2</a> describes some common discrete
distributions, and Table <a href="Probability.html#tab:tbl-Continuous">8.3</a> describes several
common continuous distributions.</p>
<table>
<caption><span id="tab:tbl-Discrete">Table 8.2: </span> Common discrete distributions</caption>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Discrete distribution</th>
<th>R name</th>
<th>Parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Binomial</td>
<td><code>binom</code></td>
<td><code>n</code> = number of trials; <code>p</code> = probability of success for one trial</td>
</tr>
<tr class="even">
<td>Geometric</td>
<td><code>geom</code></td>
<td><code>p</code> = probability of success for one trial</td>
</tr>
<tr class="odd">
<td>Hypergeometric</td>
<td><code>hyper</code></td>
<td><code>m</code> = number of white balls in urn; <code>n</code> = number of black balls in urn; <code>k</code> = number of balls drawn from urn</td>
</tr>
<tr class="even">
<td>Negative binomial (NegBinomial)</td>
<td><code>nbinom</code></td>
<td><code>size</code> = number of successful trials; either <code>prob</code> = probability of successful trial or <code>mu</code> = mean</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td><code>pois</code></td>
<td><code>lambda</code> = mean</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:tbl-Continuous">Table 8.3: </span> Common continuous distributions</caption>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Continuous distribution</th>
<th>R name</th>
<th>Parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Beta</td>
<td><code>beta</code></td>
<td><code>shape1</code>; <code>shape2</code></td>
</tr>
<tr class="even">
<td>Cauchy</td>
<td><code>cauchy</code></td>
<td><code>location</code>; <code>scale</code></td>
</tr>
<tr class="odd">
<td>Chi-squared (Chisquare)</td>
<td><code>chisq</code></td>
<td><code>df</code> = degrees of freedom</td>
</tr>
<tr class="even">
<td>Exponential</td>
<td><code>exp</code></td>
<td><code>rate</code></td>
</tr>
<tr class="odd">
<td>F</td>
<td><code>f</code></td>
<td><code>df1</code> and <code>df2</code> = degrees of freedom</td>
</tr>
<tr class="even">
<td>Gamma</td>
<td><code>gamma</code></td>
<td><code>rate</code>; either <code>rate</code> or <code>scale</code></td>
</tr>
<tr class="odd">
<td>Log-normal (Lognormal)</td>
<td><code>lnorm</code></td>
<td><code>meanlog</code> = mean on logarithmic scale; <code>sdlog</code> = standard deviation on logarithmic scale</td>
</tr>
<tr class="even">
<td>Logistic</td>
<td><code>logis</code></td>
<td><code>location</code>; <code>scale</code></td>
</tr>
<tr class="odd">
<td>Normal</td>
<td><code>norm</code></td>
<td><code>mean</code>; <code>sd</code> = standard deviation</td>
</tr>
<tr class="even">
<td>Student’s <em>t</em> (TDist)</td>
<td><code>t</code></td>
<td><code>df</code> = degrees of freedom</td>
</tr>
<tr class="odd">
<td>Uniform</td>
<td><code>unif</code></td>
<td><code>min</code> = lower limit; <code>max</code> = upper limit</td>
</tr>
<tr class="even">
<td>Weibull</td>
<td><code>weibull</code></td>
<td><code>shape</code>; <code>scale</code></td>
</tr>
<tr class="odd">
<td>Wilcoxon</td>
<td><code>wilcox</code></td>
<td><code>m</code> = number of observations in first sample; <code>n</code> = number of observations in second sample</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Warning</strong></p>
<p>All distribution-related functions require distributional parameters,
such as <code>size</code> and <code>prob</code> for the binomial or <code>prob</code> for the
geometric. The big “gotcha” is that the distributional parameters may
not be what you expect. For example, we would expect the parameter of
an exponential distribution to be <em>β</em>, the mean. The R convention,
however, is for the exponential distribution to be defined by the rate
= 1/<em>β</em>, so we often supply the wrong value. The moral is, study the
help page before you use a function related to a distribution. Be sure
you’ve got the parameters right.</p>
</blockquote>
</div>
<div id="getting-help-on-probability-distributions" class="section level3 unnumbered hasAnchor">
<h3>Getting Help on Probability Distributions<a href="Probability.html#getting-help-on-probability-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To see the R functions related to a particular probability distribution,
use the help command and the full name of the distribution. For example,
this will show the functions related to the Normal distribution:</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="Probability.html#cb497-1" tabindex="-1"></a>?Normal</span></code></pre></div>
<p>Some distributions have names that don’t work well with the help
command, such as “Student’s <em>t</em>.” They have special help names, as noted
in Tables <a href="Probability.html#tab:tbl-Discrete">8.2</a> and <a href="Probability.html#tab:tbl-Continuous">8.3</a>: NegBinomial, Chisquare, Lognormal, and
TDist. Thus, to get help on the Student’s <em>t</em> distribution, use this:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="Probability.html#cb498-1" tabindex="-1"></a>?TDist</span></code></pre></div>
</div>
<div id="see-also-2" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see-also-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are many other distributions implemented in downloadable packages;
see the CRAN task view devoted to <a href="http://cran.r-project.org/web/views/Distributions.html">probability
distributions</a>.
The <code>SuppDists</code> package is part of the R base, and it includes 10
supplemental distributions. The <code>MASS</code> package, which is also part of
the base, provides additional support for distributions, such as
maximum-likelihood fitting for some common distributions as well as
sampling from a multivariate normal distribution.</p>
</div>
</div>
<div id="recipe-id163" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Counting the Number of Combinations<a href="Probability.html#recipe-id163" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id163" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id163" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to calculate the number of combinations of <em>n</em> items taken <em>k</em>
at a time.</p>
</div>
<div id="solution-id163" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id163" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>choose</code> function:</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="Probability.html#cb499-1" tabindex="-1"></a><span class="fu">choose</span>(n, k)</span></code></pre></div>
</div>
<div id="discussion-id163" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id163" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A common problem in computing probabilities of discrete variables is
counting combinations: the number of distinct subsets of size <em>k</em> that
can be created from <em>n</em> items. The number is given by <em>n</em>!/<em>r</em>!(<em>n</em> -
<em>r</em>)!, but it’s much more convenient to use the <code>choose</code>
function—especially as <em>n</em> and <em>k</em> grow larger:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="Probability.html#cb500-1" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">5</span>, <span class="dv">3</span>)   <span class="co"># How many ways can we select 3 items from 5 items?</span></span>
<span id="cb500-2"><a href="Probability.html#cb500-2" tabindex="-1"></a><span class="co">#&gt; [1] 10</span></span>
<span id="cb500-3"><a href="Probability.html#cb500-3" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">50</span>, <span class="dv">3</span>)  <span class="co"># How many ways can we select 3 items from 50 items?</span></span>
<span id="cb500-4"><a href="Probability.html#cb500-4" tabindex="-1"></a><span class="co">#&gt; [1] 19600</span></span>
<span id="cb500-5"><a href="Probability.html#cb500-5" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">50</span>, <span class="dv">30</span>) <span class="co"># How many ways can we select 30 items from 50 items?</span></span>
<span id="cb500-6"><a href="Probability.html#cb500-6" tabindex="-1"></a><span class="co">#&gt; [1] 4.71e+13</span></span></code></pre></div>
<p>These numbers are also known as <em>binomial coefficients</em>.</p>
</div>
<div id="see_also-id163" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id163" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This recipe merely counts the combinations; see
Recipe <a href="Probability.html#recipe-id198">8.2</a>, <a href="Probability.html#recipe-id198">“Generating Combinations”</a>, to actually generate them.</p>
</div>
</div>
<div id="recipe-id198" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Generating Combinations<a href="Probability.html#recipe-id198" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id198" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id198" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to generate all combinations of <em>n</em> items taken <em>k</em> at a time.</p>
</div>
<div id="solution-id198" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id198" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>combn</code> function:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="Probability.html#cb501-1" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb501-2"><a href="Probability.html#cb501-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb501-3"><a href="Probability.html#cb501-3" tabindex="-1"></a><span class="fu">combn</span>(items, k)</span>
<span id="cb501-4"><a href="Probability.html#cb501-4" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span id="cb501-5"><a href="Probability.html#cb501-5" tabindex="-1"></a><span class="co">#&gt; [1,]    2    2    2    3    3    4</span></span>
<span id="cb501-6"><a href="Probability.html#cb501-6" tabindex="-1"></a><span class="co">#&gt; [2,]    3    4    5    4    5    5</span></span></code></pre></div>
</div>
<div id="discussion-id198" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id198" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use <code>combn(1:5,3)</code> to generate all combinations of the numbers 1
through 5 taken three at a time:</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="Probability.html#cb502-1" tabindex="-1"></a><span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb502-2"><a href="Probability.html#cb502-2" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb502-3"><a href="Probability.html#cb502-3" tabindex="-1"></a><span class="co">#&gt; [1,]    1    1    1    1    1    1    2    2    2     3</span></span>
<span id="cb502-4"><a href="Probability.html#cb502-4" tabindex="-1"></a><span class="co">#&gt; [2,]    2    2    2    3    3    4    3    3    4     4</span></span>
<span id="cb502-5"><a href="Probability.html#cb502-5" tabindex="-1"></a><span class="co">#&gt; [3,]    3    4    5    4    5    5    4    5    5     5</span></span></code></pre></div>
<p>The function is not restricted to numbers. We can generate combinations
of strings, too. Here are all combinations of five treatments taken
three at a time:</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="Probability.html#cb503-1" tabindex="-1"></a><span class="fu">combn</span>(<span class="fu">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;T2&quot;</span>, <span class="st">&quot;T3&quot;</span>, <span class="st">&quot;T4&quot;</span>, <span class="st">&quot;T5&quot;</span>), <span class="dv">3</span>)</span>
<span id="cb503-2"><a href="Probability.html#cb503-2" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb503-3"><a href="Probability.html#cb503-3" tabindex="-1"></a><span class="co">#&gt; [1,] &quot;T1&quot; &quot;T1&quot; &quot;T1&quot; &quot;T1&quot; &quot;T1&quot; &quot;T1&quot; &quot;T2&quot; &quot;T2&quot; &quot;T2&quot; &quot;T3&quot; </span></span>
<span id="cb503-4"><a href="Probability.html#cb503-4" tabindex="-1"></a><span class="co">#&gt; [2,] &quot;T2&quot; &quot;T2&quot; &quot;T2&quot; &quot;T3&quot; &quot;T3&quot; &quot;T4&quot; &quot;T3&quot; &quot;T3&quot; &quot;T4&quot; &quot;T4&quot; </span></span>
<span id="cb503-5"><a href="Probability.html#cb503-5" tabindex="-1"></a><span class="co">#&gt; [3,] &quot;T3&quot; &quot;T4&quot; &quot;T5&quot; &quot;T4&quot; &quot;T5&quot; &quot;T5&quot; &quot;T4&quot; &quot;T5&quot; &quot;T5&quot; &quot;T5&quot;</span></span></code></pre></div>
<blockquote>
<p><strong>Warning</strong></p>
<p>As the number of items, <em>n</em>, increases, the number of combinations can
explode—especially if <em>k</em> is not near to 1 or <em>n</em>.</p>
</blockquote>
</div>
<div id="see_also-id198" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id198" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Probability.html#recipe-id163">8.1</a>, <a href="Probability.html#recipe-id163">“Counting the Number of Combinations”</a>, to count the
number of possible combinations <em>before</em> you generate a huge set.</p>
</div>
</div>
<div id="recipe-id165" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Generating Random Numbers<a href="Probability.html#recipe-id165" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id165" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id165" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to generate random numbers.</p>
</div>
<div id="solution-id165" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id165" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The simple case of generating a uniform random number between 0 and 1 is
handled by the <code>runif</code> function. This example generates one uniform
random number:</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="Probability.html#cb504-1" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb504-2"><a href="Probability.html#cb504-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.915</span></span></code></pre></div>
<blockquote>
<p>Note: If you are saying <code>runif</code> out loud (or even in your head), you should pronounce it “are unif” instead of “run if.” The term <code>runif</code> is a <em>portmanteau</em> of “random uniform” so should not sound as if it’s a flow control function.</p>
</blockquote>
<p>R can generate random variates from other distributions as well. For a
given distribution, the name of the random number generator is “r”
prefixed to the distribution’s abbreviated name (e.g., <code>rnorm</code> for the
normal distribution’s random number generator). This example generates
one random value from the standard normal distribution:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="Probability.html#cb505-1" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb505-2"><a href="Probability.html#cb505-2" tabindex="-1"></a><span class="co">#&gt; [1] 1.53</span></span></code></pre></div>
</div>
<div id="discussion-id165" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id165" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Most programming languages have a wimpy random number generator that
generates one random number, uniformly distributed between 0.0 and 1.0,
and that’s all. Not R.</p>
<p>R can generate random numbers from many probability distributions other
than the uniform distribution. The simple case of generating uniform
random numbers between 0 and 1 is handled by the <code>runif</code> function:</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="Probability.html#cb506-1" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb506-2"><a href="Probability.html#cb506-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.83</span></span></code></pre></div>
<p>The argument of <code>runif</code> is the number of random values to be generated.
Generating a vector of 10 such values is as easy as generating one:</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="Probability.html#cb507-1" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb507-2"><a href="Probability.html#cb507-2" tabindex="-1"></a><span class="co">#&gt;  [1] 0.642 0.519 0.737 0.135 0.657 0.705 0.458 0.719 0.935 0.255</span></span></code></pre></div>
<p>There are random number generators for all built-in distributions.
Simply prefix the distribution name with “r” and you have the name of
the corresponding random number generator. Here are some common ones:</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="Probability.html#cb508-1" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">max =</span> <span class="dv">3</span>)      <span class="co"># One uniform variate between -3 and +3</span></span>
<span id="cb508-2"><a href="Probability.html#cb508-2" tabindex="-1"></a><span class="co">#&gt; [1] 2.49</span></span>
<span id="cb508-3"><a href="Probability.html#cb508-3" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>)                         <span class="co"># One standard normal variate</span></span>
<span id="cb508-4"><a href="Probability.html#cb508-4" tabindex="-1"></a><span class="co">#&gt; [1] 1.53</span></span>
<span id="cb508-5"><a href="Probability.html#cb508-5" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)    <span class="co"># One normal variate, mean 100 and SD 15</span></span>
<span id="cb508-6"><a href="Probability.html#cb508-6" tabindex="-1"></a><span class="co">#&gt; [1] 114</span></span>
<span id="cb508-7"><a href="Probability.html#cb508-7" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>) <span class="co"># One binomial variate</span></span>
<span id="cb508-8"><a href="Probability.html#cb508-8" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb508-9"><a href="Probability.html#cb508-9" tabindex="-1"></a><span class="fu">rpois</span>(<span class="dv">1</span>, <span class="at">lambda =</span> <span class="dv">10</span>)            <span class="co"># One Poisson variate</span></span>
<span id="cb508-10"><a href="Probability.html#cb508-10" tabindex="-1"></a><span class="co">#&gt; [1] 12</span></span>
<span id="cb508-11"><a href="Probability.html#cb508-11" tabindex="-1"></a><span class="fu">rexp</span>(<span class="dv">1</span>, <span class="at">rate =</span> <span class="fl">0.1</span>)              <span class="co"># One exponential variate</span></span>
<span id="cb508-12"><a href="Probability.html#cb508-12" tabindex="-1"></a><span class="co">#&gt; [1] 3.14</span></span>
<span id="cb508-13"><a href="Probability.html#cb508-13" tabindex="-1"></a><span class="fu">rgamma</span>(<span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">rate =</span> <span class="fl">0.1</span>) <span class="co"># One gamma variate</span></span>
<span id="cb508-14"><a href="Probability.html#cb508-14" tabindex="-1"></a><span class="co">#&gt; [1] 22.3</span></span></code></pre></div>
<p>As with <code>runif</code>, the first argument is the number of random values to be
generated. Subsequent arguments are the parameters of the distribution,
such as <code>mean</code> and <code>sd</code> for the normal distribution or <code>size</code> and <code>prob</code>
for the binomial. See the function’s R help page for details.</p>
<p>The examples given so far use simple scalars for distributional
parameters. Yet the parameters can also be vectors, in which case R will
cycle through the vector while generating random values. The following
example generates three normal random values drawn from distributions
with means of –10, 0, and +10, respectively (all distributions have a
standard deviation of 1.0):</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="Probability.html#cb509-1" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="sc">+</span><span class="dv">10</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb509-2"><a href="Probability.html#cb509-2" tabindex="-1"></a><span class="co">#&gt; [1] -9.420 -0.658 11.555</span></span></code></pre></div>
<p>That is a powerful capability in cases such as hierarchical models,
where the parameters are themselves random. The next example calculates
30 draws of a normal variate whose mean is itself randomly distributed
and with hyperparameters of <em>μ</em> = 0 and <em>σ</em> = 0.2:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="Probability.html#cb510-1" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb510-2"><a href="Probability.html#cb510-2" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> means, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb510-3"><a href="Probability.html#cb510-3" tabindex="-1"></a><span class="co">#&gt;  [1] -0.5549 -2.9232 -1.2203  0.6962  0.1673 -1.0779 -0.3138 -3.3165  1.5952</span></span>
<span id="cb510-4"><a href="Probability.html#cb510-4" tabindex="-1"></a><span class="co">#&gt; [10]  0.8184 -0.1251  0.3601 -0.8142  0.1050  2.1264  0.6943 -2.7771  0.9026</span></span>
<span id="cb510-5"><a href="Probability.html#cb510-5" tabindex="-1"></a><span class="co">#&gt; [19]  0.0389  0.2280 -0.5599  0.9572  0.1972  0.2602 -0.4423  1.9707  0.4553</span></span>
<span id="cb510-6"><a href="Probability.html#cb510-6" tabindex="-1"></a><span class="co">#&gt; [28]  0.0467  1.5229  0.3176</span></span></code></pre></div>
<p>If you are generating many random values and the vector of parameters is
too short, R will apply the Recycling Rule to the parameter vector.</p>
</div>
<div id="see_also-id165" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id165" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See the <a href="Probability.html#intro-Probability">Introduction</a> to this chapter.</p>
</div>
</div>
<div id="recipe-id201" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Generating Reproducible Random Numbers<a href="Probability.html#recipe-id201" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id201" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id201" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to generate a sequence of random numbers, but you want to
reproduce the same sequence every time your program runs.</p>
</div>
<div id="solution-id201" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id201" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before running your R code, call the <code>set.seed</code> function to initialize
the random number generator to a known state:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="Probability.html#cb511-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># Or use any other positive integer...</span></span></code></pre></div>
</div>
<div id="discussion-id201" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id201" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After generating random numbers, you may often want to reproduce the
same sequence of “random” numbers every time your program executes. That
way, you get the same results from run to run.
One of the authors once supported a
complicated Monte Carlo analysis of a huge portfolio of securities. The
users complained about getting slightly different results each time the
program ran. No kidding! The analysis was driven entirely by random numbers, so
of course there was randomness in the output. The solution was to set the
random number generator to a known state at the beginning of the
program. That way, it would generate the same (quasi-)random numbers
each time and thus yield consistent, reproducible results.</p>
<p>In R, the <code>set.seed</code> function sets the random number generator to a
known state. The function takes one argument, an integer. Any positive
integer will work, but you must use the same one in order to get the
same initial state.</p>
<p>The function returns nothing. It works behind the scenes, initializing
(or reinitializing) the random number generator. The key here is that
using the same seed restarts the random number generator back at the
same place:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="Probability.html#cb512-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">165</span>)   <span class="co"># Initialize generator to known state</span></span>
<span id="cb512-2"><a href="Probability.html#cb512-2" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">10</span>)       <span class="co"># Generate ten random numbers</span></span>
<span id="cb512-3"><a href="Probability.html#cb512-3" tabindex="-1"></a><span class="co">#&gt;  [1] 0.116 0.450 0.996 0.611 0.616 0.426 0.666 0.168 0.788 0.442</span></span>
<span id="cb512-4"><a href="Probability.html#cb512-4" tabindex="-1"></a></span>
<span id="cb512-5"><a href="Probability.html#cb512-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">165</span>)   <span class="co"># Reinitialize to the same known state</span></span>
<span id="cb512-6"><a href="Probability.html#cb512-6" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">10</span>)       <span class="co"># Generate the same ten &quot;random&quot; numbers</span></span>
<span id="cb512-7"><a href="Probability.html#cb512-7" tabindex="-1"></a><span class="co">#&gt;  [1] 0.116 0.450 0.996 0.611 0.616 0.426 0.666 0.168 0.788 0.442</span></span></code></pre></div>
<blockquote>
<p><strong>Warning</strong></p>
<p>When you set the seed value and freeze your sequence of random
numbers, you are eliminating a source of randomness that may be critical
to algorithms such as Monte Carlo simulations. Before you call
<code>set.seed</code> in your application, ask yourself: Am I undercutting the
value of my program or perhaps even damaging its logic?</p>
</blockquote>
</div>
<div id="see_also-id201" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id201" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Probability.html#recipe-id165">8.3</a>, <a href="Probability.html#recipe-id165">“Generating Random Numbers”</a>, for more about generating
random numbers.</p>
</div>
</div>
<div id="recipe-id199" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Generating a Random Sample<a href="Probability.html#recipe-id199" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id199" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id199" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to sample a dataset randomly.</p>
</div>
<div id="solution-id199" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id199" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sample</code> function will randomly select <em>n</em> items from a set:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="Probability.html#cb513-1" tabindex="-1"></a><span class="fu">sample</span>(set, n)</span></code></pre></div>
</div>
<div id="discussion-id199" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id199" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose your World Series data contains a vector of years when the
Series was played. You can select 10 years at random using <code>sample</code>:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="Probability.html#cb514-1" tabindex="-1"></a>world_series <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./data/world_series.csv&quot;</span>)</span>
<span id="cb514-2"><a href="Probability.html#cb514-2" tabindex="-1"></a><span class="fu">sample</span>(world_series<span class="sc">$</span>year, <span class="dv">10</span>)</span>
<span id="cb514-3"><a href="Probability.html#cb514-3" tabindex="-1"></a><span class="co">#&gt;  [1] 2005 1929 1964 1966 1934 1969 1909 2014 1997 1987</span></span></code></pre></div>
<p>The items are randomly selected, so running <code>sample</code> again (usually)
produces a different result:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="Probability.html#cb515-1" tabindex="-1"></a><span class="fu">sample</span>(world_series<span class="sc">$</span>year, <span class="dv">10</span>)</span>
<span id="cb515-2"><a href="Probability.html#cb515-2" tabindex="-1"></a><span class="co">#&gt;  [1] 1973 2005 2001 1977 1953 1946 1974 1951 1956 1990</span></span></code></pre></div>
<p>The <code>sample</code> function normally samples without replacement, meaning it
will not select the same item twice. Some statistical procedures
(especially the bootstrap) require sampling <em>with</em> replacement, which
means that one item can appear multiple times in the sample. Specify
<code>replace=TRUE</code> to sample with replacement.</p>
<p>It’s easy to implement a simple bootstrap using sampling with
replacement.
Suppose we have a vector, <code>x</code>, of 1,000 random numbers,
drawn from a normal distribution with mean 4 and standard deviation 10.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="Probability.html#cb516-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb516-2"><a href="Probability.html#cb516-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">4</span>, <span class="dv">10</span>)</span></code></pre></div>
<p>This code fragment samples 1,000 times from <code>x</code> and
calculates the median of each sample:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="Probability.html#cb517-1" tabindex="-1"></a>medians <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)   <span class="co"># empty vector of 1000 numbers</span></span>
<span id="cb517-2"><a href="Probability.html#cb517-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb517-3"><a href="Probability.html#cb517-3" tabindex="-1"></a>  medians[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">sample</span>(x, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb517-4"><a href="Probability.html#cb517-4" tabindex="-1"></a>}</span></code></pre></div>
<p>From the bootstrap estimates, we can estimate the confidence interval
for the median:</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="Probability.html#cb518-1" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(medians, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb518-2"><a href="Probability.html#cb518-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% confidence interval is (&quot;</span>, ci, <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb518-3"><a href="Probability.html#cb518-3" tabindex="-1"></a><span class="co">#&gt; 95% confidence interval is ( 3.15 4.5 )</span></span></code></pre></div>
<p>We know that <code>x</code> was created from a normal distribution with a mean of 4
and, hence, the sample median should be 4 also.
(In a symmetrical distribution like the normal, the mean and the median are the same.)
Our confidence interval easily contains the value.</p>
</div>
<div id="see_also-id199" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id199" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Probability.html#recipe-id151">8.7</a>, <a href="Probability.html#recipe-id151">“Randomly Permuting a Vector”</a>, for randomly permuting
a vector and Recipe <a href="BeyondBasics.html#recipe-id159">13.8</a>, <a href="BeyondBasics.html#recipe-id159">“Bootstrapping a Statistic”</a>, for more about bootstrapping. Recipe <a href="Probability.html#recipe-id201">8.4</a>, <a href="Probability.html#recipe-id201">“Generating Reproducible Random Numbers”</a>, discusses setting seeds for quasi-random numbers.</p>
</div>
</div>
<div id="recipe-id200" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Generating Random Sequences<a href="Probability.html#recipe-id200" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id200" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id200" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to generate a random sequence, such as a series of simulated
coin tosses or a simulated sequence of Bernoulli trials.</p>
</div>
<div id="solution-id200" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id200" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>sample</code> function. Sample <em>n</em> draws from the set of possible values, and
set <code>replace=TRUE</code>:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="Probability.html#cb519-1" tabindex="-1"></a><span class="fu">sample</span>(set, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="discussion-id200" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id200" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sample</code> function randomly selects items from a set. It normally
samples <em>without</em> replacement, which means that it will not select the
same item twice and will return an error if you try to sample more items than exist in the set. With <code>replace=TRUE</code>, however, <code>sample</code> can select items
over and over; this allows you to generate long, random sequences of
items.</p>
<p>The following example generates a random sequence of 10 simulated flips
of a coin:</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="Probability.html#cb520-1" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb520-2"><a href="Probability.html#cb520-2" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;H&quot; &quot;H&quot; &quot;T&quot; &quot;H&quot; &quot;H&quot; &quot;H&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot;</span></span></code></pre></div>
<p>The next example generates a sequence of 20 Bernoulli trials—random
successes or failures. We use <code>TRUE</code> to signify a success:</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="Probability.html#cb521-1" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb521-2"><a href="Probability.html#cb521-2" tabindex="-1"></a><span class="co">#&gt;  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE</span></span>
<span id="cb521-3"><a href="Probability.html#cb521-3" tabindex="-1"></a><span class="co">#&gt; [13]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p>By default, <code>sample</code> will choose equally among the set elements and so
the probability of selecting either <code>TRUE</code> or <code>FALSE</code> is 0.5. With a
Bernoulli trial, the probability <em>p</em> of success is not necessarily 0.5.
You can bias the sample by using the <code>prob</code> argument of <code>sample</code>; this
argument is a vector of probabilities, one for each set element. Suppose
we want to generate 20 Bernoulli trials with a probability of success
<em>p</em> = 0.8. We set the probability of <code>FALSE</code> to be 0.2 and the
probability of <code>TRUE</code> to 0.8:</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="Probability.html#cb522-1" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb522-2"><a href="Probability.html#cb522-2" tabindex="-1"></a><span class="co">#&gt;  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE</span></span>
<span id="cb522-3"><a href="Probability.html#cb522-3" tabindex="-1"></a><span class="co">#&gt; [13]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE</span></span></code></pre></div>
<p>The resulting sequence is clearly biased toward <code>TRUE</code>. We chose this
example because it’s a simple demonstration of a general technique. For
the special case of a binary-valued sequence you can use <code>rbinom</code>, the
random generator for binomial variates:</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="Probability.html#cb523-1" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.8</span>)</span>
<span id="cb523-2"><a href="Probability.html#cb523-2" tabindex="-1"></a><span class="co">#&gt;  [1] 1 0 1 0 0 1 1 1 1 1</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id151" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Randomly Permuting a Vector<a href="Probability.html#recipe-id151" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id151" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id151" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to generate a random permutation of a vector.</p>
</div>
<div id="solution-id151" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id151" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If <code>v</code> is your vector, then <code>sample(v)</code> returns a random permutation.</p>
</div>
<div id="discussion-id151" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id151" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We typically think of the <code>sample</code> function for sampling from large datasets.
However, the default parameters enable you to create a random
rearrangement of the dataset. The function call <code>sample(v)</code> is
equivalent to:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="Probability.html#cb524-1" tabindex="-1"></a><span class="fu">sample</span>(v, <span class="at">size =</span> <span class="fu">length</span>(v), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>which means “select all the elements of <code>v</code> in random order while using
each element exactly once.” That is a random permutation. Here is a
random permutation of 1, …, 10:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="Probability.html#cb525-1" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb525-2"><a href="Probability.html#cb525-2" tabindex="-1"></a><span class="co">#&gt;  [1]  2  7 10  5  6  3  4  1  9  8</span></span></code></pre></div>
</div>
<div id="see_also-id151" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id151" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Probability.html#recipe-id199">8.5</a>, <a href="Probability.html#recipe-id199">“Generating a Random Sample”</a>, for more about <code>sample</code>.</p>
</div>
</div>
<div id="recipe-id196" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Calculating Probabilities for Discrete Distributions<a href="Probability.html#recipe-id196" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id196" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id196" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to calculate either the simple or the cumulative probability
associated with a discrete random variable.</p>
</div>
<div id="solution-id196" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id196" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a simple probability, <em>P</em>(<em>X</em> = <em>x</em>), use the density function. All
built-in probability distributions have a density function whose name is
“d” prefixed to the distribution name. For example, <code>dbinom</code> for the
binomial distribution.</p>
<p>For a cumulative probability, <em>P</em>(<em>X</em> ≤ <em>x</em>), use the distribution
function. All built-in probability distributions have a distribution
function whose name is “p” prefixed to the distribution name; thus,
<code>pbinom</code> is the distribution function for the binomial distribution.</p>
</div>
<div id="discussion-id196" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id196" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have a binomial random variable <em>X</em> over 10 trials, where
each trial has a success probability of 1/2. Then we can calculate the
probability of observing <em>x</em> = 7 by calling <code>dbinom</code>:</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="Probability.html#cb526-1" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">7</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb526-2"><a href="Probability.html#cb526-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.117</span></span></code></pre></div>
<p>That calculates a probability of about 0.117. R calls <code>dbinom</code> the
<em>density function</em>. Some textbooks call it the <em>probability mass function</em>
or the <em>probability function</em>. Calling it a density function keeps the
terminology consistent between discrete and continuous distributions
(see Recipe <a href="Probability.html#recipe-id197">8.9</a>, <a href="Probability.html#recipe-id197">“Calculating Probabilities for Continuous Distributions”</a>).</p>
<p>The cumulative probability, <em>P</em>(<em>X</em> ≤ <em>x</em>), is given by the <em>distribution
function</em>, which is sometimes called the <em>cumulative probability function</em>.
The distribution function for the binomial distribution is <code>pbinom</code>.
Here is the cumulative probability for <em>x</em> = 7 (i.e., <em>P</em>(<em>X</em> ≤ 7)):</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="Probability.html#cb527-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb527-2"><a href="Probability.html#cb527-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.945</span></span></code></pre></div>
<p>It appears the probability of observing <em>X</em> ≤ 7 is about 0.945.</p>
<p>The density functions and distribution functions for some
common discrete distributions are shown in Table <a href="Probability.html#tab:distributions">8.4</a>.</p>
<table>
<caption><span id="tab:distributions">Table 8.4: </span> Discrete distributions</caption>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="left">Density function: <em>P</em>(<em>X</em> = <em>x</em>)</th>
<th align="left">Distribution function: <em>P</em>(<em>X</em> ≤ <em>x</em>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Binomial</td>
<td align="left"><code>dbinom(*x*, *size*, *prob*)</code></td>
<td align="left"><code>pbinom(*x*, *size*, *prob*)</code></td>
</tr>
<tr class="even">
<td align="left">Geometric</td>
<td align="left"><code>dgeom(*x*, *prob*)</code></td>
<td align="left"><code>pgeom(*x*, *prob*)</code></td>
</tr>
<tr class="odd">
<td align="left">Poisson</td>
<td align="left"><code>dpois(*x*, *lambda*)</code></td>
<td align="left"><code>ppois(*x*, *lambda*)</code></td>
</tr>
</tbody>
</table>
<p>The complement of the cumulative probability is the <em>survival function</em>,
<em>P</em>(<em>X</em> &gt; <em>x</em>). All of the distribution functions let you find this
right-tail probability simply by specifying <code>lower.tail=FALSE</code>:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="Probability.html#cb528-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb528-2"><a href="Probability.html#cb528-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.0547</span></span></code></pre></div>
<p>Thus we see that the probability of observing <em>X</em> &gt; 7 is about 0.055.</p>
<p>The <em>interval probability</em>, <em>P</em>(<em>x</em><sub>1</sub> &lt; <em>X</em> ≤ <em>x</em><sub>2</sub>), is the
probability of observing <em>X</em> between the limits <em>x</em><sub>1</sub> and <em>x</em><sub>2</sub>. It is calculated as the difference between two cumulative
probabilities: <em>P</em>(<em>X</em> ≤ <em>x</em><sub>2</sub>) – <em>P</em>(<em>X</em> ≤ <em>x</em><sub>1</sub>). Here is <em>P</em>(3 &lt;
<em>X</em> ≤ 7) for our binomial variable:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="Probability.html#cb529-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>) <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb529-2"><a href="Probability.html#cb529-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.773</span></span></code></pre></div>
<p>R lets you specify multiple values of <em>x</em> for these functions and will
return a vector of the corresponding probabilities. Here we calculate
two cumulative probabilities, <em>P</em>(<em>X</em> ≤ 3) and <em>P</em>(<em>X</em> ≤ 7), in one call
to <code>pbinom</code>:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="Probability.html#cb530-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>), <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb530-2"><a href="Probability.html#cb530-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.172 0.945</span></span></code></pre></div>
<p>This leads to a one-liner for calculating interval probabilities. The
<code>diff</code> function calculates the difference between successive elements of
a vector. We apply it to the output of <code>pbinom</code> to obtain the difference
in cumulative probabilities—in other words, the interval probability:</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="Probability.html#cb531-1" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">pbinom</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>), <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>))</span>
<span id="cb531-2"><a href="Probability.html#cb531-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.773</span></span></code></pre></div>
</div>
<div id="see_also-id196" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id196" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See this chapter’s <a href="Probability.html#intro-Probability">Introduction</a> for more about the
built-in probability distributions.</p>
</div>
</div>
<div id="recipe-id197" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> Calculating Probabilities for Continuous Distributions<a href="Probability.html#recipe-id197" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id197" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id197" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to calculate the distribution function (DF) or cumulative
distribution function (CDF) for a continuous random variable.</p>
</div>
<div id="solution-id197" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id197" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the distribution function, which calculates <em>P</em>(<em>X</em> ≤ <em>x</em>). All
built-in probability distributions have a distribution function whose
name is “p” prefixed to the distribution’s abbreviated name—for
instance, <code>pnorm</code> for the normal distribution.</p>
<p>Example: what’s the probability of a draw being below .8 for a draw from a random standard normal distribution?</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="Probability.html#cb532-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> .<span class="dv">8</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb532-2"><a href="Probability.html#cb532-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.788</span></span></code></pre></div>
</div>
<div id="discussion-id197" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id197" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The R functions for probability distributions follow a consistent
pattern, so the solution to this recipe is essentially identical to the
solution for discrete random variables
(see Recipe <a href="Probability.html#recipe-id196">8.8</a>, <a href="Probability.html#recipe-id196">“Calculating Probabilities for Discrete Distributions”</a>).
The significant difference is that continuous variables have no
“probability” at a single point, <em>P</em>(<em>X</em> = <em>x</em>). Instead, they have a
density at a point.</p>
<p>Given that consistency, the discussion of distribution functions in
Recipe <a href="Probability.html#recipe-id196">8.8</a>, <a href="Probability.html#recipe-id196">“Calculating Probabilities for Discrete Distributions”</a>, is
applicable here, too. Table <a href="Probability.html#tab:continuous">8.5</a> gives the distribution
functions for several continuous distributions.</p>
<table>
<caption><span id="tab:continuous">Table 8.5: </span> Continuous distributions</caption>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="left">Distribution function: <em>P</em>(<em>X</em> ≤ <em>x</em>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Normal</td>
<td align="left"><code>pnorm(*x*, *mean*, *sd*)</code></td>
</tr>
<tr class="even">
<td align="left">Student’s <em>t</em></td>
<td align="left"><code>pt(*x*, *df*)</code></td>
</tr>
<tr class="odd">
<td align="left">Exponential</td>
<td align="left"><code>pexp(*x*, *rate*)</code></td>
</tr>
<tr class="even">
<td align="left">Gamma</td>
<td align="left"><code>pgamma(*x*, *shape*, *rate*)</code></td>
</tr>
<tr class="odd">
<td align="left">Chi-squared (χ<sup>2</sup>)</td>
<td align="left"><code>pchisq(*x*, *df*)</code></td>
</tr>
</tbody>
</table>
<p>We can use <code>pnorm</code> to calculate the probability that a man is shorter
than 66 inches, assuming that men’s heights are normally distributed
with a mean of 70 inches and a standard deviation of 3 inches.
Mathematically speaking, we want <em>P</em>(<em>X</em> ≤ 66) given that <em>X</em> ~ <em>N</em>(70,
3):</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="Probability.html#cb533-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">66</span>, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb533-2"><a href="Probability.html#cb533-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.0912</span></span></code></pre></div>
<p>Likewise, we can use <code>pexp</code> to calculate the probability that an
exponential variable with a mean of 40 could be less than 20:</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="Probability.html#cb534-1" tabindex="-1"></a><span class="fu">pexp</span>(<span class="dv">20</span>, <span class="at">rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">40</span>)</span>
<span id="cb534-2"><a href="Probability.html#cb534-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.393</span></span></code></pre></div>
<p>Just as for discrete probabilities, the functions for continuous
probabilities use <code>lower.tail=FALSE</code> to specify the survival function,
<em>P</em>(<em>X</em> &gt; <em>x</em>). This call to <code>pexp</code> gives the probability that the
same exponential variable could be greater than 50:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="Probability.html#cb535-1" tabindex="-1"></a><span class="fu">pexp</span>(<span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">40</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb535-2"><a href="Probability.html#cb535-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.287</span></span></code></pre></div>
<p>Also like discrete probabilities, the interval probability for a
continuous variable, <em>P</em>(<em>x</em><sub>1</sub> &lt; <em>X</em> &lt; <em>x</em><sub>2</sub>), is computed as
the difference between two cumulative probabilities, <em>P</em>(<em>X</em> &lt;
<em>x</em><sub>2</sub>) – <em>P</em>(<em>X</em> &lt; <em>x</em><sub>1</sub>). For the same exponential variable, here
is <em>P</em>(20 &lt; <em>X</em> &lt; 50), the probability that it could fall between
20 and 50:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="Probability.html#cb536-1" tabindex="-1"></a><span class="fu">pexp</span>(<span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">40</span>) <span class="sc">-</span> <span class="fu">pexp</span>(<span class="dv">20</span>, <span class="at">rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">40</span>)</span>
<span id="cb536-2"><a href="Probability.html#cb536-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.32</span></span></code></pre></div>
</div>
<div id="see_also-id197" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see_also-id197" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See this chapter’s <a href="Probability.html#intro-Probability">Introduction</a> for more about the
built-in probability distributions.</p>
</div>
</div>
<div id="recipe-id168" class="section level2 hasAnchor" number="8.10">
<h2><span class="header-section-number">8.10</span> Converting Probabilities to Quantiles<a href="Probability.html#recipe-id168" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id168" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id168" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given a probability <em>p</em> and a distribution, you want to determine the
corresponding quantile for <em>p</em>: the value <em>x</em> such that <em>P</em>(<em>X</em> ≤ <em>x</em>) =
<em>p</em>.</p>
</div>
<div id="solution-id168" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id168" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Every built-in distribution includes a quantile function that converts
probabilities to quantiles. The function’s name is “q” prefixed to the
distribution name; thus, for instance, <code>qnorm</code> is the quantile function
for the normal distribution.</p>
<p>The first argument of the quantile function is the probability. The
remaining arguments are the distribution’s parameters, such as <code>mean</code>,
<code>shape</code>, or <code>rate</code>:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="Probability.html#cb537-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.05</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb537-2"><a href="Probability.html#cb537-2" tabindex="-1"></a><span class="co">#&gt; [1] 75.3</span></span></code></pre></div>
</div>
<div id="discussion-id168" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id168" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A common example of computing quantiles is when we compute the limits of
a confidence interval. If we want to know the 95% confidence interval
(<em>α</em> = 0.05) of a standard normal variable, then we need the quantiles
with probabilities of <em>α</em>/2 = 0.025 and (1 – <em>α</em>)/2 = 0.975:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="Probability.html#cb538-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.025</span>)</span>
<span id="cb538-2"><a href="Probability.html#cb538-2" tabindex="-1"></a><span class="co">#&gt; [1] -1.96</span></span>
<span id="cb538-3"><a href="Probability.html#cb538-3" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb538-4"><a href="Probability.html#cb538-4" tabindex="-1"></a><span class="co">#&gt; [1] 1.96</span></span></code></pre></div>
<p>In the true spirit of R, the first argument of the quantile functions
can be a vector of probabilities, in which case we get a vector of
quantiles. We can simplify this example into a one-liner:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="Probability.html#cb539-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb539-2"><a href="Probability.html#cb539-2" tabindex="-1"></a><span class="co">#&gt; [1] -1.96  1.96</span></span></code></pre></div>
<p>All the built-in probability distributions provide a quantile function.
Table <a href="Probability.html#tab:discrete-quant-dist">8.6</a> shows the quantile functions for some common discrete distributions.</p>
<table>
<caption><span id="tab:discrete-quant-dist">Table 8.6: </span> Discrete quantile distributions</caption>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="left">Quantile function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Binomial</td>
<td align="left"><code>qbinom(*p*, *size*, *prob*)</code></td>
</tr>
<tr class="even">
<td align="left">Geometric</td>
<td align="left"><code>qgeom(*p*, *prob*)</code></td>
</tr>
<tr class="odd">
<td align="left">Poisson</td>
<td align="left"><code>qpois(*p*, *lambda*)</code></td>
</tr>
</tbody>
</table>
<p>Table <a href="Probability.html#tab:cont-quant-dist">8.7</a> shows the quantile functions for common continuous distributions.</p>
<table>
<caption><span id="tab:cont-quant-dist">Table 8.7: </span> Continuous quantile distributions</caption>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="left">Quantile function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Normal</td>
<td align="left"><code>qnorm(*p*, *mean*, *sd*)</code></td>
</tr>
<tr class="even">
<td align="left">Student’s <em>t</em></td>
<td align="left"><code>qt(*p*, *df*)</code></td>
</tr>
<tr class="odd">
<td align="left">Exponential</td>
<td align="left"><code>qexp(*p*, *rate*)</code></td>
</tr>
<tr class="even">
<td align="left">Gamma</td>
<td align="left"><code>qgamma(*p*, *shape*, *rate*=*rate*)</code> or <code>qgamma(*p*, *shape*, *scale*=*scale*)</code></td>
</tr>
<tr class="odd">
<td align="left">Chi-squared (χ<sup>2</sup>)</td>
<td align="left"><code>qchisq(*p*, *df*)</code></td>
</tr>
</tbody>
</table>
</div>
<div id="see-also-id168" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Probability.html#see-also-id168" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Determining the quantiles of a dataset is different from determining
the quantiles of a distribution—see Recipe <a href="GeneralStatistics.html#recipe-id143">9.5</a>, <a href="GeneralStatistics.html#recipe-id143">“Calculating Quantiles (and Quartiles) of a Dataset”</a>.</p>
</div>
</div>
<div id="recipe-id166" class="section level2 hasAnchor" number="8.11">
<h2><span class="header-section-number">8.11</span> Plotting a Density Function<a href="Probability.html#recipe-id166" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id166" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Probability.html#problem-id166" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to plot the density function of a probability distribution.</p>
</div>
<div id="solution-id166" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Probability.html#solution-id166" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Define a vector <code>x</code> over the domain. Apply the distribution’s density
function to <code>x</code> and then plot the result. If <code>x</code> is a vector of points over the domain we care about plotting, we then calculate the density using one of the <code>d_____</code> density functions, like <code>dlnorm</code> for lognormal or <code>dnorm</code> for normal.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="Probability.html#cb540-1" tabindex="-1"></a>dens <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, </span>
<span id="cb540-2"><a href="Probability.html#cb540-2" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">d_____</span>(x))</span>
<span id="cb540-3"><a href="Probability.html#cb540-3" tabindex="-1"></a><span class="fu">ggplot</span>(dens, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p>Here is a specific example that plots the
standard normal distribution for the interval –3 to +3:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="Probability.html#cb541-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb541-2"><a href="Probability.html#cb541-2" tabindex="-1"></a></span>
<span id="cb541-3"><a href="Probability.html#cb541-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">+</span><span class="dv">3</span>, <span class="fl">0.1</span>)</span>
<span id="cb541-4"><a href="Probability.html#cb541-4" tabindex="-1"></a>dens <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">dnorm</span>(x))</span>
<span id="cb541-5"><a href="Probability.html#cb541-5" tabindex="-1"></a></span>
<span id="cb541-6"><a href="Probability.html#cb541-6" tabindex="-1"></a><span class="fu">ggplot</span>(dens, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:std-norm"></span>
<img src="08_Probability_files/figure-html/std-norm-1.png" alt="Smooth density function" width="85%" />
<p class="caption">
Figure 8.1: Smooth density function
</p>
</div>
<p>Figure <a href="Probability.html#fig:std-norm">8.1</a> shows the smooth density function.</p>
</div>
<div id="discussion-id166" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Probability.html#discussion-id166" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All the built-in probability distributions include a density function.
For a particular density, the function name is “d” prepended to the
density name. The density function for the normal distribution is
<code>dnorm</code>, the density for the gamma distribution is <code>dgamma</code>, and so
forth.</p>
<p>If the first argument of the density function is a vector, then the
function calculates the density at each point and returns the vector of
densities.</p>
<p>The following code creates a 2 × 2 plot of four densities:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="Probability.html#cb542-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">100</span>) <span class="co"># Define the density domains</span></span>
<span id="cb542-2"><a href="Probability.html#cb542-2" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>)</span>
<span id="cb542-3"><a href="Probability.html#cb542-3" tabindex="-1"></a></span>
<span id="cb542-4"><a href="Probability.html#cb542-4" tabindex="-1"></a><span class="co"># Make a data.frame with densities of several distributions</span></span>
<span id="cb542-5"><a href="Probability.html#cb542-5" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb542-6"><a href="Probability.html#cb542-6" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">dist_name =</span> <span class="st">&quot;Uniform&quot;</span>    , <span class="at">y =</span> <span class="fu">dunif</span>(x, <span class="at">min   =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">4</span>)),</span>
<span id="cb542-7"><a href="Probability.html#cb542-7" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">dist_name =</span> <span class="st">&quot;Normal&quot;</span>     , <span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">mean  =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb542-8"><a href="Probability.html#cb542-8" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">dist_name =</span> <span class="st">&quot;Exponential&quot;</span>, <span class="at">y =</span> <span class="fu">dexp</span>(x, <span class="at">rate  =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>)),</span>
<span id="cb542-9"><a href="Probability.html#cb542-9" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">dist_name =</span> <span class="st">&quot;Gamma&quot;</span>      , <span class="at">y =</span> <span class="fu">dgamma</span>(x, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">rate =</span> <span class="dv">1</span>)) )</span>
<span id="cb542-10"><a href="Probability.html#cb542-10" tabindex="-1"></a></span>
<span id="cb542-11"><a href="Probability.html#cb542-11" tabindex="-1"></a><span class="co"># Make a line plot like before, but use facet_wrap to create the grid</span></span>
<span id="cb542-12"><a href="Probability.html#cb542-12" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb542-13"><a href="Probability.html#cb542-13" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb542-14"><a href="Probability.html#cb542-14" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>dist_name)   <span class="co"># facet and wrap by the variable dist_name</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:densities"></span>
<img src="08_Probability_files/figure-html/densities-1.png" alt="Multiple density plots" width="85%" />
<p class="caption">
Figure 8.2: Multiple density plots
</p>
</div>
<p>Figure <a href="Probability.html#fig:densities">8.2</a> shows four density plots. However, a raw density plot is rarely useful or interesting by itself, and we often shade a region of interest.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:densityshaded"></span>
<img src="08_Probability_files/figure-html/densityshaded-1.png" alt="Standard normal with shading" width="85%" />
<p class="caption">
Figure 8.3: Standard normal with shading
</p>
</div>
<p>Figure <a href="Probability.html#fig:densityshaded">8.3</a> is a normal distribution with shading from the 75<sup>th</sup> percentile to the 95<sup>th</sup> percentile.</p>
<p>We create the plot by first plotting the density and then creating a shaded
region with the <code>geom_ribbon</code> function from <code>ggplot2</code>.</p>
<p>First, we create some data and draw the density curve like the one shown in Figure <a href="Probability.html#fig:normalden1">8.4</a></p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="Probability.html#cb543-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb543-2"><a href="Probability.html#cb543-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb543-3"><a href="Probability.html#cb543-3" tabindex="-1"></a></span>
<span id="cb543-4"><a href="Probability.html#cb543-4" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb543-5"><a href="Probability.html#cb543-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb543-6"><a href="Probability.html#cb543-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb543-7"><a href="Probability.html#cb543-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Standard Normal Distribution&quot;</span>,</span>
<span id="cb543-8"><a href="Probability.html#cb543-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb543-9"><a href="Probability.html#cb543-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Quantile&quot;</span></span>
<span id="cb543-10"><a href="Probability.html#cb543-10" tabindex="-1"></a>  )</span>
<span id="cb543-11"><a href="Probability.html#cb543-11" tabindex="-1"></a>p</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normalden1"></span>
<img src="08_Probability_files/figure-html/normalden1-1.png" alt="Density plot" width="85%" />
<p class="caption">
Figure 8.4: Density plot
</p>
</div>
<p>Next, we define the region of interest by calculating the <code>x</code> value for the quantiles we’re interested in. Finally, we use a <code>geom_ribbon</code> to add a subset of our original data as a colored region. The resulting plot is shown in Figure <a href="Probability.html#fig:normalden2">8.5</a>.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="Probability.html#cb544-1" tabindex="-1"></a>q75 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>x, .<span class="dv">75</span>)</span>
<span id="cb544-2"><a href="Probability.html#cb544-2" tabindex="-1"></a>q95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>x, .<span class="dv">95</span>)</span>
<span id="cb544-3"><a href="Probability.html#cb544-3" tabindex="-1"></a></span>
<span id="cb544-4"><a href="Probability.html#cb544-4" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb544-5"><a href="Probability.html#cb544-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb544-6"><a href="Probability.html#cb544-6" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df, x <span class="sc">&gt;</span> q75 <span class="sc">&amp;</span> x <span class="sc">&lt;</span> q95),</span>
<span id="cb544-7"><a href="Probability.html#cb544-7" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymax =</span> y),</span>
<span id="cb544-8"><a href="Probability.html#cb544-8" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb544-9"><a href="Probability.html#cb544-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb544-10"><a href="Probability.html#cb544-10" tabindex="-1"></a>    <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb544-11"><a href="Probability.html#cb544-11" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb544-12"><a href="Probability.html#cb544-12" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normalden2"></span>
<img src="08_Probability_files/figure-html/normalden2-1.png" alt="Normal density with shading" width="85%" />
<p class="caption">
Figure 8.5: Normal density with shading
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="StringsAndDates.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="GeneralStatistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/CerebralMastication/R-Cookbook/edit/master/08_Probability.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
