<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Linear Regression and ANOVA | R Cookbook, 2nd Edition</title>
  <meta name="description" content="Second edition of R Cookbook" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Linear Regression and ANOVA | R Cookbook, 2nd Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Second edition of R Cookbook" />
  <meta name="github-repo" content="CerebralMastication/R-Cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Linear Regression and ANOVA | R Cookbook, 2nd Edition" />
  
  <meta name="twitter:description" content="Second edition of R Cookbook" />
  

<meta name="author" content="James (JD) Long" />
<meta name="author" content="Paul Teetor" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Graphics.html"/>
<link rel="next" href="UsefulTricks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129487349-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-129487349-3');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R Cookbook 2nd Edition</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to the R Cookbook 2nd Edition</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-recipes"><i class="fa fa-check"></i>The Recipes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-note-on-terminology"><i class="fa fa-check"></i>A Note on Terminology</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-and-platform-notes"><i class="fa fa-check"></i>Software and Platform Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions Used in This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-code-examples"><i class="fa fa-check"></i>Using Code Examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#safari-books-online"><i class="fa fa-check"></i>SafariÂ® Books Online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i><b>1</b> Getting Started and Getting Help</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#intro-GettingStarted"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1.1" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id001"><i class="fa fa-check"></i><b>1.1</b> Downloading and Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id002b"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-startingrstudio"><i class="fa fa-check"></i><b>1.3</b> Starting RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id007"><i class="fa fa-check"></i><b>1.4</b> Entering Commands</a></li>
<li class="chapter" data-level="1.5" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id097"><i class="fa fa-check"></i><b>1.5</b> Exiting from RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id100"><i class="fa fa-check"></i><b>1.6</b> Interrupting R</a></li>
<li class="chapter" data-level="1.7" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id265"><i class="fa fa-check"></i><b>1.7</b> Viewing the Supplied Documentation</a></li>
<li class="chapter" data-level="1.8" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id003"><i class="fa fa-check"></i><b>1.8</b> Getting Help on a Function</a></li>
<li class="chapter" data-level="1.9" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id267"><i class="fa fa-check"></i><b>1.9</b> Searching the Supplied Documentation</a></li>
<li class="chapter" data-level="1.10" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id266"><i class="fa fa-check"></i><b>1.10</b> Getting Help on a Package</a></li>
<li class="chapter" data-level="1.11" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id005"><i class="fa fa-check"></i><b>1.11</b> Searching the Web for Help</a></li>
<li class="chapter" data-level="1.12" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id270"><i class="fa fa-check"></i><b>1.12</b> Finding Relevant Functions and Packages</a></li>
<li class="chapter" data-level="1.13" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id268"><i class="fa fa-check"></i><b>1.13</b> Searching the Mailing Lists</a></li>
<li class="chapter" data-level="1.14" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id269"><i class="fa fa-check"></i><b>1.14</b> Submitting Questions to Stack Overflow or Elsewhere in the Community</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="SomeBasics.html"><a href="SomeBasics.html"><i class="fa fa-check"></i><b>2</b> Some Basics</a>
<ul>
<li class="chapter" data-level="" data-path="SomeBasics.html"><a href="SomeBasics.html#intro-SomeBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2.1" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id017"><i class="fa fa-check"></i><b>2.1</b> Printing Something to the Screen</a></li>
<li class="chapter" data-level="2.2" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id016"><i class="fa fa-check"></i><b>2.2</b> Setting Variables</a></li>
<li class="chapter" data-level="2.3" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id091"><i class="fa fa-check"></i><b>2.3</b> Listing Variables</a></li>
<li class="chapter" data-level="2.4" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id075"><i class="fa fa-check"></i><b>2.4</b> Deleting Variables</a></li>
<li class="chapter" data-level="2.5" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id038"><i class="fa fa-check"></i><b>2.5</b> Creating a Vector</a></li>
<li class="chapter" data-level="2.6" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id101"><i class="fa fa-check"></i><b>2.6</b> Computing Basic Statistics</a></li>
<li class="chapter" data-level="2.7" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id021"><i class="fa fa-check"></i><b>2.7</b> Creating Sequences</a></li>
<li class="chapter" data-level="2.8" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id020"><i class="fa fa-check"></i><b>2.8</b> Comparing Vectors</a></li>
<li class="chapter" data-level="2.9" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id039"><i class="fa fa-check"></i><b>2.9</b> Selecting Vector Elements</a></li>
<li class="chapter" data-level="2.10" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id019"><i class="fa fa-check"></i><b>2.10</b> Performing Vector Arithmetic</a></li>
<li class="chapter" data-level="2.11" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id018"><i class="fa fa-check"></i><b>2.11</b> Getting Operator Precedence Right</a></li>
<li class="chapter" data-level="2.12" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id022"><i class="fa fa-check"></i><b>2.12</b> Typing Less and Accomplishing More</a></li>
<li class="chapter" data-level="2.13" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-pipe-2"><i class="fa fa-check"></i><b>2.13</b> Creating a Pipeline of Function Calls</a></li>
<li class="chapter" data-level="2.14" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id025"><i class="fa fa-check"></i><b>2.14</b> Avoiding Some Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html"><i class="fa fa-check"></i><b>3</b> Navigating the Software</a>
<ul>
<li class="chapter" data-level="" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#intro-NavigatingTheSoftware"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="3.1" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id008"><i class="fa fa-check"></i><b>3.1</b> Getting and Setting the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-CreateProject"><i class="fa fa-check"></i><b>3.2</b> Creating a New RStudio Project</a></li>
<li class="chapter" data-level="3.3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id009"><i class="fa fa-check"></i><b>3.3</b> Saving Your Workspace</a></li>
<li class="chapter" data-level="3.4" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id023"><i class="fa fa-check"></i><b>3.4</b> Viewing Your Command History</a></li>
<li class="chapter" data-level="3.5" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id024"><i class="fa fa-check"></i><b>3.5</b> Saving the Result of the Previous Command</a></li>
<li class="chapter" data-level="3.6" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id010"><i class="fa fa-check"></i><b>3.6</b> Displaying Loaded Packages via the Search Path</a></li>
<li class="chapter" data-level="3.7" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id094"><i class="fa fa-check"></i><b>3.7</b> Viewing the List of Installed Packages</a></li>
<li class="chapter" data-level="3.8" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id013"><i class="fa fa-check"></i><b>3.8</b> Accessing the Functions in a Package</a></li>
<li class="chapter" data-level="3.9" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id257"><i class="fa fa-check"></i><b>3.9</b> Accessing Built-in Datasets</a></li>
<li class="chapter" data-level="3.10" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id012"><i class="fa fa-check"></i><b>3.10</b> Installing Packages from CRAN</a></li>
<li class="chapter" data-level="3.11" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-installGH"><i class="fa fa-check"></i><b>3.11</b> Installing a Package from GitHub</a></li>
<li class="chapter" data-level="3.12" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id272"><i class="fa fa-check"></i><b>3.12</b> Setting or Changing a Default CRAN Mirror</a></li>
<li class="chapter" data-level="3.13" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id014"><i class="fa fa-check"></i><b>3.13</b> Running a Script</a></li>
<li class="chapter" data-level="3.14" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id015"><i class="fa fa-check"></i><b>3.14</b> Running a Batch Script</a></li>
<li class="chapter" data-level="3.15" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id102"><i class="fa fa-check"></i><b>3.15</b> Locating the R Home Directory</a></li>
<li class="chapter" data-level="3.16" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id099"><i class="fa fa-check"></i><b>3.16</b> Customizing R Startup</a></li>
<li class="chapter" data-level="3.17" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-Rcloud"><i class="fa fa-check"></i><b>3.17</b> Using R and RStudio in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="InputAndOutput.html"><a href="InputAndOutput.html"><i class="fa fa-check"></i><b>4</b> Input and Output</a>
<ul>
<li class="chapter" data-level="" data-path="InputAndOutput.html"><a href="InputAndOutput.html#intro-InputAndOutput"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="4.1" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id035"><i class="fa fa-check"></i><b>4.1</b> Entering Data from the Keyboard</a></li>
<li class="chapter" data-level="4.2" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id036"><i class="fa fa-check"></i><b>4.2</b> Printing Fewer Digits (or More Digits)</a></li>
<li class="chapter" data-level="4.3" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id034"><i class="fa fa-check"></i><b>4.3</b> Redirecting Output to a File</a></li>
<li class="chapter" data-level="4.4" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id030"><i class="fa fa-check"></i><b>4.4</b> Listing Files</a></li>
<li class="chapter" data-level="4.5" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id033"><i class="fa fa-check"></i><b>4.5</b> Dealing with âCannot Open Fileâ in Windows</a></li>
<li class="chapter" data-level="4.6" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id136"><i class="fa fa-check"></i><b>4.6</b> Reading Fixed-Width Records</a></li>
<li class="chapter" data-level="4.7" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id245"><i class="fa fa-check"></i><b>4.7</b> Reading Tabular Data Files</a></li>
<li class="chapter" data-level="4.8" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id027"><i class="fa fa-check"></i><b>4.8</b> Reading from CSV Files</a></li>
<li class="chapter" data-level="4.9" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id028"><i class="fa fa-check"></i><b>4.9</b> Writing to CSV Files</a></li>
<li class="chapter" data-level="4.10" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id031"><i class="fa fa-check"></i><b>4.10</b> Reading Tabular or CSV Data from the Web</a></li>
<li class="chapter" data-level="4.11" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readexcel"><i class="fa fa-check"></i><b>4.11</b> Reading Data from Excel</a></li>
<li class="chapter" data-level="4.12" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-writeexcel"><i class="fa fa-check"></i><b>4.12</b> Writing a Data Frame to Excel</a></li>
<li class="chapter" data-level="4.13" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readsas"><i class="fa fa-check"></i><b>4.13</b> Reading Data from a SAS file</a></li>
<li class="chapter" data-level="4.14" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id246"><i class="fa fa-check"></i><b>4.14</b> Reading Data from HTML Tables</a></li>
<li class="chapter" data-level="4.15" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id098"><i class="fa fa-check"></i><b>4.15</b> Reading Files with a Complex Structure</a></li>
<li class="chapter" data-level="4.16" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id037"><i class="fa fa-check"></i><b>4.16</b> Reading from MySQL Databases</a></li>
<li class="chapter" data-level="4.17" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-dbplyr"><i class="fa fa-check"></i><b>4.17</b> Accessing a Database with dbplyr</a></li>
<li class="chapter" data-level="4.18" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id029"><i class="fa fa-check"></i><b>4.18</b> Saving and Transporting Objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DataStructures.html"><a href="DataStructures.html"><i class="fa fa-check"></i><b>5</b> Data Structures</a>
<ul>
<li class="chapter" data-level="" data-path="DataStructures.html"><a href="DataStructures.html#intro-DataStructures"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="5.1" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id048"><i class="fa fa-check"></i><b>5.1</b> Appending Data to a Vector</a></li>
<li class="chapter" data-level="5.2" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id049"><i class="fa fa-check"></i><b>5.2</b> Inserting Data into a Vector</a></li>
<li class="chapter" data-level="5.3" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id050"><i class="fa fa-check"></i><b>5.3</b> Understanding the Recycling Rule</a></li>
<li class="chapter" data-level="5.4" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id051"><i class="fa fa-check"></i><b>5.4</b> Creating a Factor (Categorical Variable)</a></li>
<li class="chapter" data-level="5.5" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id227"><i class="fa fa-check"></i><b>5.5</b> Combining Multiple Vectors into One Vector and a Factor</a></li>
<li class="chapter" data-level="5.6" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id053"><i class="fa fa-check"></i><b>5.6</b> Creating a List</a></li>
<li class="chapter" data-level="5.7" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id054"><i class="fa fa-check"></i><b>5.7</b> Selecting List Elements by Position</a></li>
<li class="chapter" data-level="5.8" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id253"><i class="fa fa-check"></i><b>5.8</b> Selecting List Elements by Name</a></li>
<li class="chapter" data-level="5.9" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id158"><i class="fa fa-check"></i><b>5.9</b> Building a Name/Value Association List</a></li>
<li class="chapter" data-level="5.10" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id056"><i class="fa fa-check"></i><b>5.10</b> Removing an Element from a List</a></li>
<li class="chapter" data-level="5.11" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id152"><i class="fa fa-check"></i><b>5.11</b> Flatten a List into a Vector</a></li>
<li class="chapter" data-level="5.12" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id058"><i class="fa fa-check"></i><b>5.12</b> Removing NULL Elements from a List</a></li>
<li class="chapter" data-level="5.13" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id060"><i class="fa fa-check"></i><b>5.13</b> Removing List Elements Using a Condition</a></li>
<li class="chapter" data-level="5.14" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id062"><i class="fa fa-check"></i><b>5.14</b> Initializing a Matrix</a></li>
<li class="chapter" data-level="5.15" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id139"><i class="fa fa-check"></i><b>5.15</b> Performing Matrix Operations</a></li>
<li class="chapter" data-level="5.16" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id063"><i class="fa fa-check"></i><b>5.16</b> Giving Descriptive Names to the Rows and Columns of a Matrix</a></li>
<li class="chapter" data-level="5.17" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id250"><i class="fa fa-check"></i><b>5.17</b> Selecting One Row or Column from a Matrix</a></li>
<li class="chapter" data-level="5.18" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id251"><i class="fa fa-check"></i><b>5.18</b> Initializing a Data Frame from Column Data</a></li>
<li class="chapter" data-level="5.19" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id252"><i class="fa fa-check"></i><b>5.19</b> Initializing a Data Frame from Row Data</a></li>
<li class="chapter" data-level="5.20" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id071"><i class="fa fa-check"></i><b>5.20</b> Appending Rows to a Data Frame</a></li>
<li class="chapter" data-level="5.21" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id068"><i class="fa fa-check"></i><b>5.21</b> Selecting Data Frame Columns by Position</a></li>
<li class="chapter" data-level="5.22" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id254"><i class="fa fa-check"></i><b>5.22</b> Selecting Data Frame Columns by Name</a></li>
<li class="chapter" data-level="5.23" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id069"><i class="fa fa-check"></i><b>5.23</b> Changing the Names of Data Frame Columns</a></li>
<li class="chapter" data-level="5.24" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id249"><i class="fa fa-check"></i><b>5.24</b> Removing NAs from a Data Frame</a></li>
<li class="chapter" data-level="5.25" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id072"><i class="fa fa-check"></i><b>5.25</b> Excluding Columns by Name</a></li>
<li class="chapter" data-level="5.26" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id155"><i class="fa fa-check"></i><b>5.26</b> Combining Two Data Frames</a></li>
<li class="chapter" data-level="5.27" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id057"><i class="fa fa-check"></i><b>5.27</b> Merging Data Frames by Common Column</a></li>
<li class="chapter" data-level="5.28" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id248"><i class="fa fa-check"></i><b>5.28</b> Converting One Atomic Value into Another</a></li>
<li class="chapter" data-level="5.29" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id074"><i class="fa fa-check"></i><b>5.29</b> Converting One Structured Data Type into Another</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="DataTransformations.html"><a href="DataTransformations.html"><i class="fa fa-check"></i><b>6</b> Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="DataTransformations.html"><a href="DataTransformations.html#intro-DataTransformations"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="6.1" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id149"><i class="fa fa-check"></i><b>6.1</b> Applying a Function to Each List Element</a></li>
<li class="chapter" data-level="6.2" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-row_df"><i class="fa fa-check"></i><b>6.2</b> Applying a Function to Every Row of a Data Frame</a></li>
<li class="chapter" data-level="6.3" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id146"><i class="fa fa-check"></i><b>6.3</b> Applying a Function to Every Row of a Matrix</a></li>
<li class="chapter" data-level="6.4" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id157"><i class="fa fa-check"></i><b>6.4</b> Applying a Function to Every Column</a></li>
<li class="chapter" data-level="6.5" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id275"><i class="fa fa-check"></i><b>6.5</b> Applying a Function to Parallel Vectors or Lists</a></li>
<li class="chapter" data-level="6.6" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id148"><i class="fa fa-check"></i><b>6.6</b> Applying a Function to Groups of Data</a></li>
<li class="chapter" data-level="6.7" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-casewhen"><i class="fa fa-check"></i><b>6.7</b> Creating a New Column Based on Some Condition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="StringsAndDates.html"><a href="StringsAndDates.html"><i class="fa fa-check"></i><b>7</b> Strings and Dates</a>
<ul>
<li class="chapter" data-level="" data-path="StringsAndDates.html"><a href="StringsAndDates.html#I_sect17_d1e17434"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="7.1" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id093"><i class="fa fa-check"></i><b>7.1</b> Getting the Length of a String</a></li>
<li class="chapter" data-level="7.2" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id040"><i class="fa fa-check"></i><b>7.2</b> Concatenating Strings</a></li>
<li class="chapter" data-level="7.3" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id041"><i class="fa fa-check"></i><b>7.3</b> Extracting Substrings</a></li>
<li class="chapter" data-level="7.4" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id276"><i class="fa fa-check"></i><b>7.4</b> Splitting a String According to a Delimiter</a></li>
<li class="chapter" data-level="7.5" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id277"><i class="fa fa-check"></i><b>7.5</b> Replacing Substrings</a></li>
<li class="chapter" data-level="7.6" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id109"><i class="fa fa-check"></i><b>7.6</b> Generating All Pairwise Combinations of Strings</a></li>
<li class="chapter" data-level="7.7" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id045"><i class="fa fa-check"></i><b>7.7</b> Getting the Current Date</a></li>
<li class="chapter" data-level="7.8" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id043"><i class="fa fa-check"></i><b>7.8</b> Converting a String into a Date</a></li>
<li class="chapter" data-level="7.9" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id044"><i class="fa fa-check"></i><b>7.9</b> Converting a Date into a String</a></li>
<li class="chapter" data-level="7.10" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id241"><i class="fa fa-check"></i><b>7.10</b> Converting Year, Month, and Day into a Date</a></li>
<li class="chapter" data-level="7.11" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id042"><i class="fa fa-check"></i><b>7.11</b> Getting the Julian Date</a></li>
<li class="chapter" data-level="7.12" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id046"><i class="fa fa-check"></i><b>7.12</b> Extracting the Parts of a Date</a></li>
<li class="chapter" data-level="7.13" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id047"><i class="fa fa-check"></i><b>7.13</b> Creating a Sequence of Dates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Probability.html"><a href="Probability.html"><i class="fa fa-check"></i><b>8</b> Probability</a>
<ul>
<li class="chapter" data-level="" data-path="Probability.html"><a href="Probability.html#intro-Probability"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="8.1" data-path="Probability.html"><a href="Probability.html#recipe-id163"><i class="fa fa-check"></i><b>8.1</b> Counting the Number of Combinations</a></li>
<li class="chapter" data-level="8.2" data-path="Probability.html"><a href="Probability.html#recipe-id198"><i class="fa fa-check"></i><b>8.2</b> Generating Combinations</a></li>
<li class="chapter" data-level="8.3" data-path="Probability.html"><a href="Probability.html#recipe-id165"><i class="fa fa-check"></i><b>8.3</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="8.4" data-path="Probability.html"><a href="Probability.html#recipe-id201"><i class="fa fa-check"></i><b>8.4</b> Generating Reproducible Random Numbers</a></li>
<li class="chapter" data-level="8.5" data-path="Probability.html"><a href="Probability.html#recipe-id199"><i class="fa fa-check"></i><b>8.5</b> Generating a Random Sample</a></li>
<li class="chapter" data-level="8.6" data-path="Probability.html"><a href="Probability.html#recipe-id200"><i class="fa fa-check"></i><b>8.6</b> Generating Random Sequences</a></li>
<li class="chapter" data-level="8.7" data-path="Probability.html"><a href="Probability.html#recipe-id151"><i class="fa fa-check"></i><b>8.7</b> Randomly Permuting a Vector</a></li>
<li class="chapter" data-level="8.8" data-path="Probability.html"><a href="Probability.html#recipe-id196"><i class="fa fa-check"></i><b>8.8</b> Calculating Probabilities for Discrete Distributions</a></li>
<li class="chapter" data-level="8.9" data-path="Probability.html"><a href="Probability.html#recipe-id197"><i class="fa fa-check"></i><b>8.9</b> Calculating Probabilities for Continuous Distributions</a></li>
<li class="chapter" data-level="8.10" data-path="Probability.html"><a href="Probability.html#recipe-id168"><i class="fa fa-check"></i><b>8.10</b> Converting Probabilities to Quantiles</a></li>
<li class="chapter" data-level="8.11" data-path="Probability.html"><a href="Probability.html#recipe-id166"><i class="fa fa-check"></i><b>8.11</b> Plotting a Density Function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html"><i class="fa fa-check"></i><b>9</b> General Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#intro-GeneralStatistics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="9.1" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id119"><i class="fa fa-check"></i><b>9.1</b> Summarizing Your Data</a></li>
<li class="chapter" data-level="9.2" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id229"><i class="fa fa-check"></i><b>9.2</b> Calculating Relative Frequencies</a></li>
<li class="chapter" data-level="9.3" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id124"><i class="fa fa-check"></i><b>9.3</b> Tabulating Factors and Creating Contingency Tables</a></li>
<li class="chapter" data-level="9.4" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id125"><i class="fa fa-check"></i><b>9.4</b> Testing Categorical Variables for Independence</a></li>
<li class="chapter" data-level="9.5" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id143"><i class="fa fa-check"></i><b>9.5</b> Calculating Quantiles (and Quartiles) of a Dataset</a></li>
<li class="chapter" data-level="9.6" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id142"><i class="fa fa-check"></i><b>9.6</b> Inverting a Quantile</a></li>
<li class="chapter" data-level="9.7" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id133"><i class="fa fa-check"></i><b>9.7</b> Converting Data to z-Scores</a></li>
<li class="chapter" data-level="9.8" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id121"><i class="fa fa-check"></i><b>9.8</b> Testing the Mean of a Sample (t Test)</a></li>
<li class="chapter" data-level="9.9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id123"><i class="fa fa-check"></i><b>9.9</b> Forming a Confidence Interval for a Mean</a></li>
<li class="chapter" data-level="9.10" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id135"><i class="fa fa-check"></i><b>9.10</b> Forming a Confidence Interval for a Median</a></li>
<li class="chapter" data-level="9.11" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id225"><i class="fa fa-check"></i><b>9.11</b> Testing a Sample Proportion</a></li>
<li class="chapter" data-level="9.12" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id226"><i class="fa fa-check"></i><b>9.12</b> Forming a Confidence Interval for a Proportion</a></li>
<li class="chapter" data-level="9.13" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id126"><i class="fa fa-check"></i><b>9.13</b> Testing for Normality</a></li>
<li class="chapter" data-level="9.14" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id131"><i class="fa fa-check"></i><b>9.14</b> Testing for Runs</a></li>
<li class="chapter" data-level="9.15" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id122"><i class="fa fa-check"></i><b>9.15</b> Comparing the Means of Two Samples</a></li>
<li class="chapter" data-level="9.16" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id130"><i class="fa fa-check"></i><b>9.16</b> Comparing the Locations of Two Samples Nonparametrically</a></li>
<li class="chapter" data-level="9.17" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id132"><i class="fa fa-check"></i><b>9.17</b> Testing a Correlation for Significance</a></li>
<li class="chapter" data-level="9.18" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id134"><i class="fa fa-check"></i><b>9.18</b> Testing Groups for Equal Proportions</a></li>
<li class="chapter" data-level="9.19" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id127"><i class="fa fa-check"></i><b>9.19</b> Performing Pairwise Comparisons Between Group Means</a></li>
<li class="chapter" data-level="9.20" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id129"><i class="fa fa-check"></i><b>9.20</b> Testing Two Samples for the Same Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Graphics.html"><a href="Graphics.html"><i class="fa fa-check"></i><b>10</b> Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="Graphics.html"><a href="Graphics.html#intro-Graphics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10.1" data-path="Graphics.html"><a href="Graphics.html#recipe-id171"><i class="fa fa-check"></i><b>10.1</b> Creating a Scatter Plot</a></li>
<li class="chapter" data-level="10.2" data-path="Graphics.html"><a href="Graphics.html#recipe-id259"><i class="fa fa-check"></i><b>10.2</b> Adding a Title and Labels</a></li>
<li class="chapter" data-level="10.3" data-path="Graphics.html"><a href="Graphics.html#recipe-id261"><i class="fa fa-check"></i><b>10.3</b> Adding (or Removing) a Grid</a></li>
<li class="chapter" data-level="10.4" data-path="Graphics.html"><a href="Graphics.html#recipe-theme"><i class="fa fa-check"></i><b>10.4</b> Applying a Theme to a ggplot Figure</a></li>
<li class="chapter" data-level="10.5" data-path="Graphics.html"><a href="Graphics.html#recipe-id262"><i class="fa fa-check"></i><b>10.5</b> Creating a Scatter Plot of Multiple Groups</a></li>
<li class="chapter" data-level="10.6" data-path="Graphics.html"><a href="Graphics.html#recipe-id260"><i class="fa fa-check"></i><b>10.6</b> Adding (or Removing) a Legend</a></li>
<li class="chapter" data-level="10.7" data-path="Graphics.html"><a href="Graphics.html#recipe-id217"><i class="fa fa-check"></i><b>10.7</b> Plotting the Regression Line of a Scatter Plot</a></li>
<li class="chapter" data-level="10.8" data-path="Graphics.html"><a href="Graphics.html#recipe-id184"><i class="fa fa-check"></i><b>10.8</b> Plotting All Variables Against All Other Variables</a></li>
<li class="chapter" data-level="10.9" data-path="Graphics.html"><a href="Graphics.html#recipe-id185"><i class="fa fa-check"></i><b>10.9</b> Creating One Scatter Plot for Each Group</a></li>
<li class="chapter" data-level="10.10" data-path="Graphics.html"><a href="Graphics.html#recipe-id175"><i class="fa fa-check"></i><b>10.10</b> Creating a Bar Chart</a></li>
<li class="chapter" data-level="10.11" data-path="Graphics.html"><a href="Graphics.html#recipe-id177"><i class="fa fa-check"></i><b>10.11</b> Adding Confidence Intervals to a Bar Chart</a></li>
<li class="chapter" data-level="10.12" data-path="Graphics.html"><a href="Graphics.html#recipe-id176"><i class="fa fa-check"></i><b>10.12</b> Coloring a Bar Chart</a></li>
<li class="chapter" data-level="10.13" data-path="Graphics.html"><a href="Graphics.html#recipe-id174"><i class="fa fa-check"></i><b>10.13</b> Plotting a Line from x and y Points</a></li>
<li class="chapter" data-level="10.14" data-path="Graphics.html"><a href="Graphics.html#recipe-id256"><i class="fa fa-check"></i><b>10.14</b> Changing the Type, Width, or Color of a Line</a></li>
<li class="chapter" data-level="10.15" data-path="Graphics.html"><a href="Graphics.html#recipe-id263"><i class="fa fa-check"></i><b>10.15</b> Plotting Multiple Datasets</a></li>
<li class="chapter" data-level="10.16" data-path="Graphics.html"><a href="Graphics.html#recipe-id186"><i class="fa fa-check"></i><b>10.16</b> Adding Vertical or Horizontal Lines</a></li>
<li class="chapter" data-level="10.17" data-path="Graphics.html"><a href="Graphics.html#recipe-id178"><i class="fa fa-check"></i><b>10.17</b> Creating a Boxplot</a></li>
<li class="chapter" data-level="10.18" data-path="Graphics.html"><a href="Graphics.html#recipe-id179"><i class="fa fa-check"></i><b>10.18</b> Creating One Boxplot for Each Factor Level</a></li>
<li class="chapter" data-level="10.19" data-path="Graphics.html"><a href="Graphics.html#recipe-id182"><i class="fa fa-check"></i><b>10.19</b> Creating a Histogram</a></li>
<li class="chapter" data-level="10.20" data-path="Graphics.html"><a href="Graphics.html#recipe-id183"><i class="fa fa-check"></i><b>10.20</b> Adding a Density Estimate to a Histogram</a></li>
<li class="chapter" data-level="10.21" data-path="Graphics.html"><a href="Graphics.html#recipe-id180"><i class="fa fa-check"></i><b>10.21</b> Creating a Normal QuantileâQuantile Plot</a></li>
<li class="chapter" data-level="10.22" data-path="Graphics.html"><a href="Graphics.html#recipe-id181"><i class="fa fa-check"></i><b>10.22</b> Creating Other QuantileâQuantile Plots</a></li>
<li class="chapter" data-level="10.23" data-path="Graphics.html"><a href="Graphics.html#recipe-id191"><i class="fa fa-check"></i><b>10.23</b> Plotting a Variable in Multiple Colors</a></li>
<li class="chapter" data-level="10.24" data-path="Graphics.html"><a href="Graphics.html#recipe-id192"><i class="fa fa-check"></i><b>10.24</b> Graphing a Function</a></li>
<li class="chapter" data-level="10.25" data-path="Graphics.html"><a href="Graphics.html#recipe-id190"><i class="fa fa-check"></i><b>10.25</b> Displaying Several Figures on One Page</a></li>
<li class="chapter" data-level="10.26" data-path="Graphics.html"><a href="Graphics.html#recipe-id188"><i class="fa fa-check"></i><b>10.26</b> Writing Your Plot to a File</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html"><i class="fa fa-check"></i><b>11</b> Linear Regression and ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#intro-LinearRegressionAndANOVA"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id203"><i class="fa fa-check"></i><b>11.1</b> Performing Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id204"><i class="fa fa-check"></i><b>11.2</b> Performing Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.3" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id231"><i class="fa fa-check"></i><b>11.3</b> Getting Regression Statistics</a></li>
<li class="chapter" data-level="11.4" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id240"><i class="fa fa-check"></i><b>11.4</b> Understanding the Regression Summary</a></li>
<li class="chapter" data-level="11.5" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id205"><i class="fa fa-check"></i><b>11.5</b> Performing Linear Regression Without an Intercept</a></li>
<li class="chapter" data-level="11.6" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#title-highcor"><i class="fa fa-check"></i><b>11.6</b> Regressing Only Variables That Highly Correlate with Your Dependent Variable</a></li>
<li class="chapter" data-level="11.7" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id206"><i class="fa fa-check"></i><b>11.7</b> Performing Linear Regression with Interaction Terms</a></li>
<li class="chapter" data-level="11.8" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id236"><i class="fa fa-check"></i><b>11.8</b> Selecting the Best Regression Variables</a></li>
<li class="chapter" data-level="11.9" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id209"><i class="fa fa-check"></i><b>11.9</b> Regressing on a Subset of Your Data</a></li>
<li class="chapter" data-level="11.10" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id244"><i class="fa fa-check"></i><b>11.10</b> Using an Expression Inside a Regression Formula</a></li>
<li class="chapter" data-level="11.11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id243"><i class="fa fa-check"></i><b>11.11</b> Regressing on a Polynomial</a></li>
<li class="chapter" data-level="11.12" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id208"><i class="fa fa-check"></i><b>11.12</b> Regressing on Transformed Data</a></li>
<li class="chapter" data-level="11.13" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id210"><i class="fa fa-check"></i><b>11.13</b> Finding the Best Power Transformation (BoxâCox Procedure)</a></li>
<li class="chapter" data-level="11.14" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id211"><i class="fa fa-check"></i><b>11.14</b> Forming Confidence Intervals for Regression Coefficients</a></li>
<li class="chapter" data-level="11.15" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id216"><i class="fa fa-check"></i><b>11.15</b> Plotting Regression Residuals</a></li>
<li class="chapter" data-level="11.16" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id212"><i class="fa fa-check"></i><b>11.16</b> Diagnosing a Linear Regression</a></li>
<li class="chapter" data-level="11.17" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id233"><i class="fa fa-check"></i><b>11.17</b> Identifying Influential Observations</a></li>
<li class="chapter" data-level="11.18" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id213"><i class="fa fa-check"></i><b>11.18</b> Testing Residuals for Autocorrelation (DurbinâWatson Test)</a></li>
<li class="chapter" data-level="11.19" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id214"><i class="fa fa-check"></i><b>11.19</b> Predicting New Values</a></li>
<li class="chapter" data-level="11.20" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id215"><i class="fa fa-check"></i><b>11.20</b> Forming Prediction Intervals</a></li>
<li class="chapter" data-level="11.21" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id218"><i class="fa fa-check"></i><b>11.21</b> Performing One-Way ANOVA</a></li>
<li class="chapter" data-level="11.22" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id221"><i class="fa fa-check"></i><b>11.22</b> Creating an Interaction Plot</a></li>
<li class="chapter" data-level="11.23" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id220"><i class="fa fa-check"></i><b>11.23</b> Finding Differences Between Means of Groups</a></li>
<li class="chapter" data-level="11.24" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id228"><i class="fa fa-check"></i><b>11.24</b> Performing Robust ANOVA (KruskalâWallis Test)</a></li>
<li class="chapter" data-level="11.25" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id232"><i class="fa fa-check"></i><b>11.25</b> Comparing Models by Using ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="UsefulTricks.html"><a href="UsefulTricks.html"><i class="fa fa-check"></i><b>12</b> Useful Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="UsefulTricks.html"><a href="UsefulTricks.html#intro-UsefulTricks"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12.1" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id278"><i class="fa fa-check"></i><b>12.1</b> Peeking at Your Data</a></li>
<li class="chapter" data-level="12.2" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id271"><i class="fa fa-check"></i><b>12.2</b> Printing the Result of an Assignment</a></li>
<li class="chapter" data-level="12.3" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id138"><i class="fa fa-check"></i><b>12.3</b> Summing Rows and Columns</a></li>
<li class="chapter" data-level="12.4" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id112"><i class="fa fa-check"></i><b>12.4</b> Printing Data in Columns</a></li>
<li class="chapter" data-level="12.5" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id137"><i class="fa fa-check"></i><b>12.5</b> Binning Your Data</a></li>
<li class="chapter" data-level="12.6" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id116"><i class="fa fa-check"></i><b>12.6</b> Finding the Position of a Particular Value</a></li>
<li class="chapter" data-level="12.7" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id103"><i class="fa fa-check"></i><b>12.7</b> Selecting Every nth Element of a Vector</a></li>
<li class="chapter" data-level="12.8" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id107"><i class="fa fa-check"></i><b>12.8</b> Finding Minimums or Maximums</a></li>
<li class="chapter" data-level="12.9" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id110"><i class="fa fa-check"></i><b>12.9</b> Generating All Combinations of Several Variables</a></li>
<li class="chapter" data-level="12.10" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id153"><i class="fa fa-check"></i><b>12.10</b> Flattening a Data Frame</a></li>
<li class="chapter" data-level="12.11" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id247"><i class="fa fa-check"></i><b>12.11</b> Sorting a Data Frame</a></li>
<li class="chapter" data-level="12.12" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id223"><i class="fa fa-check"></i><b>12.12</b> Stripping Attributes from a Variable</a></li>
<li class="chapter" data-level="12.13" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id202"><i class="fa fa-check"></i><b>12.13</b> Revealing the Structure of an Object</a></li>
<li class="chapter" data-level="12.14" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id224"><i class="fa fa-check"></i><b>12.14</b> Timing Your Code</a></li>
<li class="chapter" data-level="12.15" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id113"><i class="fa fa-check"></i><b>12.15</b> Suppressing Warnings and Error Messages</a></li>
<li class="chapter" data-level="12.16" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id118"><i class="fa fa-check"></i><b>12.16</b> Taking Function Arguments from a List</a></li>
<li class="chapter" data-level="12.17" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id114"><i class="fa fa-check"></i><b>12.17</b> Defining Your Own Binary Operators</a></li>
<li class="chapter" data-level="12.18" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id111"><i class="fa fa-check"></i><b>12.18</b> Suppressing the Startup Message</a></li>
<li class="chapter" data-level="12.19" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id106"><i class="fa fa-check"></i><b>12.19</b> Getting and Setting Environment Variables</a></li>
<li class="chapter" data-level="12.20" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-codesections"><i class="fa fa-check"></i><b>12.20</b> Use Code Sections</a></li>
<li class="chapter" data-level="12.21" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_local"><i class="fa fa-check"></i><b>12.21</b> Executing R in Parallel Locally</a></li>
<li class="chapter" data-level="12.22" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_remote"><i class="fa fa-check"></i><b>12.22</b> Executing R in Parallel Remotely</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="BeyondBasics.html"><a href="BeyondBasics.html"><i class="fa fa-check"></i><b>13</b> Beyond Basic Numerics and Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="BeyondBasics.html"><a href="BeyondBasics.html#intro-BeyondBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="13.1" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id234"><i class="fa fa-check"></i><b>13.1</b> Minimizing or Maximizing a Single-Parameter Function</a></li>
<li class="chapter" data-level="13.2" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id235"><i class="fa fa-check"></i><b>13.2</b> Minimizing or Maximizing a Multiparameter Function</a></li>
<li class="chapter" data-level="13.3" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id140"><i class="fa fa-check"></i><b>13.3</b> Calculating Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="13.4" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id162"><i class="fa fa-check"></i><b>13.4</b> Performing Principal Component Analysis</a></li>
<li class="chapter" data-level="13.5" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id264"><i class="fa fa-check"></i><b>13.5</b> Performing Simple Orthogonal Regression</a></li>
<li class="chapter" data-level="13.6" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id160"><i class="fa fa-check"></i><b>13.6</b> Finding Clusters in Your Data</a></li>
<li class="chapter" data-level="13.7" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id161"><i class="fa fa-check"></i><b>13.7</b> Predicting a Binary-Valued Variable (Logistic Regression)</a></li>
<li class="chapter" data-level="13.8" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id159"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping a Statistic</a></li>
<li class="chapter" data-level="13.9" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id193"><i class="fa fa-check"></i><b>13.9</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html"><i class="fa fa-check"></i><b>14</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14.1" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id076"><i class="fa fa-check"></i><b>14.1</b> Representing Time Series Data</a></li>
<li class="chapter" data-level="14.2" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id089"><i class="fa fa-check"></i><b>14.2</b> Plotting Time Series Data</a></li>
<li class="chapter" data-level="14.3" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id077"><i class="fa fa-check"></i><b>14.3</b> Extracting the Oldest or Newest Observations</a></li>
<li class="chapter" data-level="14.4" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id281"><i class="fa fa-check"></i><b>14.4</b> Subsetting a Time Series</a></li>
<li class="chapter" data-level="14.5" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id079"><i class="fa fa-check"></i><b>14.5</b> Merging Several Time Series</a></li>
<li class="chapter" data-level="14.6" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id239"><i class="fa fa-check"></i><b>14.6</b> Filling or Padding a Time Series</a></li>
<li class="chapter" data-level="14.7" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id280"><i class="fa fa-check"></i><b>14.7</b> Lagging a Time Series</a></li>
<li class="chapter" data-level="14.8" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id141"><i class="fa fa-check"></i><b>14.8</b> Computing Successive Differences</a></li>
<li class="chapter" data-level="14.9" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id080"><i class="fa fa-check"></i><b>14.9</b> Performing Calculations on Time Series</a></li>
<li class="chapter" data-level="14.10" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id279"><i class="fa fa-check"></i><b>14.10</b> Computing a Moving Average</a></li>
<li class="chapter" data-level="14.11" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id282"><i class="fa fa-check"></i><b>14.11</b> Applying a Function by Calendar Period</a></li>
<li class="chapter" data-level="14.12" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id081"><i class="fa fa-check"></i><b>14.12</b> Applying a Rolling Function</a></li>
<li class="chapter" data-level="14.13" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id082"><i class="fa fa-check"></i><b>14.13</b> Plotting the Autocorrelation Function</a></li>
<li class="chapter" data-level="14.14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id104"><i class="fa fa-check"></i><b>14.14</b> Testing a Time Series for Autocorrelation</a></li>
<li class="chapter" data-level="14.15" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id083"><i class="fa fa-check"></i><b>14.15</b> Plotting the Partial Autocorrelation Function</a></li>
<li class="chapter" data-level="14.16" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id084"><i class="fa fa-check"></i><b>14.16</b> Finding Lagged Correlations Between Two Time Series</a></li>
<li class="chapter" data-level="14.17" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id088"><i class="fa fa-check"></i><b>14.17</b> Detrending a Time Series</a></li>
<li class="chapter" data-level="14.18" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id085"><i class="fa fa-check"></i><b>14.18</b> Fitting an ARIMA Model</a></li>
<li class="chapter" data-level="14.19" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id237"><i class="fa fa-check"></i><b>14.19</b> Removing Insignificant ARIMA Coefficients</a></li>
<li class="chapter" data-level="14.20" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id238"><i class="fa fa-check"></i><b>14.20</b> Running Diagnostics on an ARIMA Model</a></li>
<li class="chapter" data-level="14.21" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id086"><i class="fa fa-check"></i><b>14.21</b> Making Forecasts from an ARIMA Model</a></li>
<li class="chapter" data-level="14.22" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-plotting_forecast"><i class="fa fa-check"></i><b>14.22</b> Plotting a Forecast</a></li>
<li class="chapter" data-level="14.23" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id087"><i class="fa fa-check"></i><b>14.23</b> Testing for Mean Reversion</a></li>
<li class="chapter" data-level="14.24" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id195"><i class="fa fa-check"></i><b>14.24</b> Smoothing a Time Series</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html"><i class="fa fa-check"></i><b>15</b> Simple Programming</a>
<ul>
<li class="chapter" data-level="" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#intro-SimpleProgramming"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="15.1" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-creating_if_logic"><i class="fa fa-check"></i><b>15.1</b> Choosing Between Two Alternatives: if-else</a></li>
<li class="chapter" data-level="15.2" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-for_loop"><i class="fa fa-check"></i><b>15.2</b> Iterating with a Loop</a></li>
<li class="chapter" data-level="15.3" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-id117"><i class="fa fa-check"></i><b>15.3</b> Defining a Function</a></li>
<li class="chapter" data-level="15.4" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-variable"><i class="fa fa-check"></i><b>15.4</b> Creating a Local Variable</a></li>
<li class="chapter" data-level="15.5" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#choosing-between-multiple-alternatives-switch"><i class="fa fa-check"></i><b>15.5</b> Choosing Between Multiple Alternatives: switch</a></li>
<li class="chapter" data-level="15.6" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-title"><i class="fa fa-check"></i><b>15.6</b> Defining Defaults for Function Parameters</a></li>
<li class="chapter" data-level="15.7" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#signaling-errors"><i class="fa fa-check"></i><b>15.7</b> Signaling Errors</a></li>
<li class="chapter" data-level="15.8" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#protecting-against-errors"><i class="fa fa-check"></i><b>15.8</b> Protecting Against Errors</a></li>
<li class="chapter" data-level="15.9" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-anon-function"><i class="fa fa-check"></i><b>15.9</b> Creating an Anonymous Function</a></li>
<li class="chapter" data-level="15.10" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#creating-a-collection-of-reusable-functions"><i class="fa fa-check"></i><b>15.10</b> Creating a Collection of Reusable Functions</a></li>
<li class="chapter" data-level="15.11" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-indent"><i class="fa fa-check"></i><b>15.11</b> Automatically Reindent Code</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RMarkdown.html"><a href="RMarkdown.html"><i class="fa fa-check"></i><b>16</b> R Markdown and Publishing</a>
<ul>
<li class="chapter" data-level="" data-path="RMarkdown.html"><a href="RMarkdown.html#intro-Rmd_pub"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="16.1" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-new_doc"><i class="fa fa-check"></i><b>16.1</b> Creating a New Document</a></li>
<li class="chapter" data-level="16.2" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-metadata"><i class="fa fa-check"></i><b>16.2</b> Adding a Title, Author, or Date</a></li>
<li class="chapter" data-level="16.3" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc-text"><i class="fa fa-check"></i><b>16.3</b> Formatting Document Text</a></li>
<li class="chapter" data-level="16.4" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-headings"><i class="fa fa-check"></i><b>16.4</b> Inserting Document Headings</a></li>
<li class="chapter" data-level="16.5" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-list"><i class="fa fa-check"></i><b>16.5</b> Inserting a List</a></li>
<li class="chapter" data-level="16.6" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-exec_r"><i class="fa fa-check"></i><b>16.6</b> Showing Output from R Code</a></li>
<li class="chapter" data-level="16.7" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-code-results"><i class="fa fa-check"></i><b>16.7</b> Controlling Which Code and Results Are Shown</a></li>
<li class="chapter" data-level="16.8" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc_plot"><i class="fa fa-check"></i><b>16.8</b> Inserting a Plot</a></li>
<li class="chapter" data-level="16.9" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-static-table"><i class="fa fa-check"></i><b>16.9</b> Inserting a Table</a></li>
<li class="chapter" data-level="16.10" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-tables"><i class="fa fa-check"></i><b>16.10</b> Inserting a Table of Data</a></li>
<li class="chapter" data-level="16.11" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-equations"><i class="fa fa-check"></i><b>16.11</b> Inserting Math Equations</a></li>
<li class="chapter" data-level="16.12" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-html"><i class="fa fa-check"></i><b>16.12</b> Generating HTML Output</a></li>
<li class="chapter" data-level="16.13" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-pdf"><i class="fa fa-check"></i><b>16.13</b> Generating PDF Output</a></li>
<li class="chapter" data-level="16.14" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-word"><i class="fa fa-check"></i><b>16.14</b> Generating Microsoft Word Output</a></li>
<li class="chapter" data-level="16.15" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-prez"><i class="fa fa-check"></i><b>16.15</b> Generating Presentation Output</a></li>
<li class="chapter" data-level="16.16" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-param_report"><i class="fa fa-check"></i><b>16.16</b> Creating a Parameterized Report</a></li>
<li class="chapter" data-level="16.17" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-rmd_org"><i class="fa fa-check"></i><b>16.17</b> Organizing Your R Markdown Workflow</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cookbook, 2nd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="LinearRegressionAndANOVA" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Linear Regression and ANOVA<a href="LinearRegressionAndANOVA.html#LinearRegressionAndANOVA" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro-LinearRegressionAndANOVA" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="LinearRegressionAndANOVA.html#intro-LinearRegressionAndANOVA" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In statistics, modeling is where we get down to business. Models
quantify the relationships between our variables. Models let us make
predictions.</p>
<p>A simple linear regression is the most basic model. Itâs just two
variables and is modeled as a linear relationship with an error term:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>x</em><sub><em>i</em></sub> + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
<p>We are given the data for <em>x</em> and <em>y</em>. Our mission is to fit the model,
which will give us the best estimates for <em>Î²</em><sub>0</sub> and <em>Î²</em><sub>1</sub>
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id203">âPerforming Simple Linear Regressionâ</a>).</p>
<p>That generalizes naturally to multiple linear regression, where we have
multiple variables on the righthand side of the relationship
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id204">âPerforming Multiple Linear Regressionâ</a>):</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>u</em><sub><em>i</em></sub> + <em>Î²</em><sub>2</sub><em>v</em><sub><em>i</em></sub> + <em>Î²</em><sub>3</sub><em>w</em><sub><em>i</em></sub> +
<em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
<p>Statisticians call <em>u</em>, <em>v</em>, and <em>w</em> the <em>predictors</em> and <em>y</em> the
<em>response</em>. Obviously, the model is useful only if there is a fairly
linear relationship between the predictors and the response, but that
requirement is much less restrictive than you might think.
Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id208">âRegressing on Transformed Dataâ</a>, discusses transforming
your variables into a (more) linear relationship so that you can use the
well-developed machinery of linear regression.</p>
<p>The beauty of R is that anyone can build these linear models. The models
are built by a function, <code>lm</code>, which returns a model object. From the
model object, we get the coefficients (<em>Î²</em><sub><em>i</em></sub>) and regression
statistics. Itâs easy. Really!</p>
<p>The horror of R is that anyone can build these models. Nothing requires
you to check that the model is reasonable, much less statistically
significant. Before you blindly believe a model, check it. Most of the
information you need is in the regression summary
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id240">âUnderstanding the Regression Summaryâ</a>):</p>
<dl>
<dt>Is the model statistically significant?</dt>
<dd>
<p>Check the <em>F</em> statistic at the bottom of the summary.</p>
</dd>
<dt>Are the coefficients significant?</dt>
<dd>
<p>Check the coefficientâs <em>t</em> statistics and <em>p</em>-values in the
summary, or check their confidence intervals
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id211">âForming Confidence Intervals for Regressionâ</a>).</p>
</dd>
<dt>Is the model useful?</dt>
<dd>
<p>Check the <em>R</em><sup>2</sup> near the bottom of the summary.</p>
</dd>
<dt>Does the model fit the data well?</dt>
<dd>
<p>Plot the residuals and check the regression diagnostics (see Recipes <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id216">âPlotting Regression Residualsâ</a>, and <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id212">âDiagnosing a Linear Regressionâ</a>).</p>
</dd>
<dt>Does the data satisfy the assumptions behind linear regression?</dt>
<dd>
<p>Check whether the diagnostics confirm that a linear model is
reasonable for your data
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id212">âDiagnosing a Linear Regressionâ</a>).</p>
</dd>
</dl>
<div id="anova" class="section level3 unnumbered hasAnchor">
<h3>ANOVA<a href="LinearRegressionAndANOVA.html#anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Analysis of variance (ANOVA) is a powerful statistical technique.
First-year graduate students in statistics are taught ANOVA almost
immediately because of its importance, both theoretical and practical.
We are often amazed, however, at the extent to which people outside the
field are unaware of its purpose and value.</p>
<p>Regression creates a model, and ANOVA is one method of evaluating such
models. The mathematics of ANOVA are intertwined with the mathematics of
regression, so statisticians usually present them together; we follow
that tradition here.</p>
<p>ANOVA is actually a family of techniques that are connected by a common
mathematical analysis. This chapter mentions several applications:</p>
<dl>
<dt>One-way ANOVA</dt>
<dd>
<p>This is the simplest application of ANOVA. Suppose you have data
samples from several populations and are wondering whether the
populations have different means. One-way ANOVA answers
that question. If the populations have normal distributions, use the
<code>oneway.test</code> function (see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id218">âPerforming One-Way ANOVAâ</a>);
otherwise, use the nonparametric version, the <code>kruskal.test</code>
function
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id228">âPerforming Robust ANOVA (KruskalâWallis Testâ)</a>).</p>
</dd>
<dt>Model comparison</dt>
<dd>
<p>When you add or delete a predictor variable from a linear
regression, you want to know whether that change did or did not
improve the model. The <code>anova</code> function compares two regression
models and reports whether they are significantly different
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id232">âComparing Models by Using ANOVAâ</a>).</p>
</dd>
<dt>ANOVA table</dt>
<dd>
<p>The <code>anova</code> function can also construct the ANOVA table of a linear
regression model, which includes the <em>F</em> statistic needed to gauge
the modelâs statistical significance
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id231">âGetting Regression Statisticsâ</a>). This important
table is discussed in nearly every textbook on regression.</p>
</dd>
</dl>
<p>The See Also section contains more about the mathematics of ANOVA.</p>
</div>
<div id="example-data" class="section level3 unnumbered hasAnchor">
<h3>Example Data<a href="LinearRegressionAndANOVA.html#example-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In many of the examples in this chapter, we start with creating example data using Râs pseudorandom number generation capabilities. So at the beginning of each recipe, you may see something like the following:</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="LinearRegressionAndANOVA.html#cb702-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb702-2"><a href="LinearRegressionAndANOVA.html#cb702-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb702-3"><a href="LinearRegressionAndANOVA.html#cb702-3" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">5</span>)</span>
<span id="cb702-4"><a href="LinearRegressionAndANOVA.html#cb702-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">15</span> <span class="sc">*</span> x <span class="sc">+</span> e</span></code></pre></div>
<p>We use <code>set.seed</code> to set the random number generation seed so that if you run the example code on your machine you will get the same answer. In the preceding example, <code>x</code> is a vector of 100 draws from a standard normal (<code>mean</code> = 0, <code>sd</code> = 1) distribution. Then we create a little random noise called <code>e</code> from a normal distribution with <code>mean</code> = 0 and <code>sd</code> = 5. <code>y</code> is then calculated as <code>5 + 15 * x + e</code>. The idea behind creating example data rather than using âreal worldâ data is that with simulated âtoyâ data you can change the coefficients and parameters and see how the change impacts the resulting model. For example, you could increase the standard deviation of <code>e</code> in the example data and see what impact that has on the <code>R^2</code> of your model.</p>
</div>
<div id="see-also-3" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see-also-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are many good texts on linear regression. One of our favorites is
<em>Applied Linear Regression Models</em>, 4th edition, by Michael Kutner, Christopher Nachtsheim, and John Neter (McGraw-Hill/Irwin). We generally follow their terminology and
conventions in this chapter.</p>
<p>We also like <em>Linear Models with R</em> by Julian Faraway (Chapman &amp; Hall),
because it illustrates regression using R and is quite readable.
Earlier versions of Faradayâs work are available free <a href="http://cran.r-project.org/doc/contrib/Faraway-PRA.pdf">online</a>, too.</p>
</div>
</div>
<div id="recipe-id203" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Performing Simple Linear Regression<a href="LinearRegressionAndANOVA.html#recipe-id203" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id203" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id203" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have two vectors, <em>x</em> and <em>y</em>, that hold paired observations:
(<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>), (<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>), â¦, (<em>x<sub>n</sub></em>, <em>y<sub>n</sub></em>). You believe
there is a linear relationship between <em>x</em> and <em>y</em>, and you want to
create a regression model of the relationship.</p>
</div>
<div id="solution-id203" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id203" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>lm</code> function performs a linear regression and reports the
coefficients.</p>
<p>If your data is in vectors:</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="LinearRegressionAndANOVA.html#cb703-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x)</span></code></pre></div>
<p>Or if your data is in columns in a data frame:</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="LinearRegressionAndANOVA.html#cb704-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df)</span></code></pre></div>
</div>
<div id="discussion-id203" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id203" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simple linear regression involves two variables: a predictor (or independent) variable,
often called <em>x</em>, and a response (or dependent) variable, often called <em>y</em>. The
regression uses the <em>ordinary least-squares</em> (OLS) algorithm to fit the
linear model:</p>
<blockquote>
<p><em>y<sub>i</sub></em> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>x<sub>i</sub></em> + <em>Îµ<sub>i</sub></em></p>
</blockquote>
<p>where <em>Î²</em><sub>0</sub> and <em>Î²</em><sub>1</sub> are the regression coefficients and the <em>Îµ<sub>i</sub></em>
are the error terms.</p>
<p>The <code>lm</code> function can perform linear regression. The main argument is a
model formula, such as <code>y ~ x</code>. The formula has the response variable on
the left of the tilde character (<code>~</code>) and the predictor variable on the
right. The function estimates the regression coefficients, <em>Î²</em><sub>0</sub> and
<em>Î²</em><sub>1</sub>, and reports them as the intercept and the coefficient of <em>x</em>,
respectively:</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="LinearRegressionAndANOVA.html#cb705-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb705-2"><a href="LinearRegressionAndANOVA.html#cb705-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb705-3"><a href="LinearRegressionAndANOVA.html#cb705-3" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb705-4"><a href="LinearRegressionAndANOVA.html#cb705-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">15</span> <span class="sc">*</span> x <span class="sc">+</span> e</span>
<span id="cb705-5"><a href="LinearRegressionAndANOVA.html#cb705-5" tabindex="-1"></a></span>
<span id="cb705-6"><a href="LinearRegressionAndANOVA.html#cb705-6" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb705-7"><a href="LinearRegressionAndANOVA.html#cb705-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb705-8"><a href="LinearRegressionAndANOVA.html#cb705-8" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb705-9"><a href="LinearRegressionAndANOVA.html#cb705-9" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x)</span></span>
<span id="cb705-10"><a href="LinearRegressionAndANOVA.html#cb705-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb705-11"><a href="LinearRegressionAndANOVA.html#cb705-11" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb705-12"><a href="LinearRegressionAndANOVA.html#cb705-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)            x  </span></span>
<span id="cb705-13"><a href="LinearRegressionAndANOVA.html#cb705-13" tabindex="-1"></a><span class="co">#&gt;        4.56        15.14</span></span></code></pre></div>
<p>In this case, the regression equation is:</p>
<blockquote>
<p><em>y<sub>i</sub></em> = 4.56 + 15.14<em>x<sub>i</sub></em> + <em>Îµ<sub>i</sub></em></p>
</blockquote>
<p>It is quite common for data to be captured inside a data frame, in which
case you want to perform a regression between two data frame columns.
Here, <code>x</code> and <code>y</code> are columns of a data frame <code>dfrm</code>:</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="LinearRegressionAndANOVA.html#cb706-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb706-2"><a href="LinearRegressionAndANOVA.html#cb706-2" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb706-3"><a href="LinearRegressionAndANOVA.html#cb706-3" tabindex="-1"></a><span class="co">#&gt;        x     y</span></span>
<span id="cb706-4"><a href="LinearRegressionAndANOVA.html#cb706-4" tabindex="-1"></a><span class="co">#&gt; 1  1.371 31.57</span></span>
<span id="cb706-5"><a href="LinearRegressionAndANOVA.html#cb706-5" tabindex="-1"></a><span class="co">#&gt; 2 -0.565  1.75</span></span>
<span id="cb706-6"><a href="LinearRegressionAndANOVA.html#cb706-6" tabindex="-1"></a><span class="co">#&gt; 3  0.363  5.43</span></span>
<span id="cb706-7"><a href="LinearRegressionAndANOVA.html#cb706-7" tabindex="-1"></a><span class="co">#&gt; 4  0.633 23.74</span></span>
<span id="cb706-8"><a href="LinearRegressionAndANOVA.html#cb706-8" tabindex="-1"></a><span class="co">#&gt; 5  0.404  7.73</span></span>
<span id="cb706-9"><a href="LinearRegressionAndANOVA.html#cb706-9" tabindex="-1"></a><span class="co">#&gt; 6 -0.106  3.94</span></span></code></pre></div>
<p>The <code>lm</code> function lets you specify a data frame by using the <code>data</code>
parameter. If you do, the function will take the variables from the data
frame and not from your workspace:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="LinearRegressionAndANOVA.html#cb707-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df)          <span class="co"># Take x and y from df</span></span>
<span id="cb707-2"><a href="LinearRegressionAndANOVA.html#cb707-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb707-3"><a href="LinearRegressionAndANOVA.html#cb707-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb707-4"><a href="LinearRegressionAndANOVA.html#cb707-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x, data = df)</span></span>
<span id="cb707-5"><a href="LinearRegressionAndANOVA.html#cb707-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb707-6"><a href="LinearRegressionAndANOVA.html#cb707-6" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb707-7"><a href="LinearRegressionAndANOVA.html#cb707-7" tabindex="-1"></a><span class="co">#&gt; (Intercept)            x  </span></span>
<span id="cb707-8"><a href="LinearRegressionAndANOVA.html#cb707-8" tabindex="-1"></a><span class="co">#&gt;        4.56        15.14</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id204" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Performing Multiple Linear Regression<a href="LinearRegressionAndANOVA.html#recipe-id204" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id204" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id204" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have several predictor variables (e.g., <em>u</em>, <em>v</em>, and <em>w</em>) and a
response variable, <em>y</em>. You believe there is a linear relationship
between the predictors and the response, and you want to perform a
linear regression on the data.</p>
</div>
<div id="solution-id204" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id204" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>lm</code> function. Specify the multiple predictors on the righthand
side of the formula, separated by plus signs (<code>+</code>):</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="LinearRegressionAndANOVA.html#cb708-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w)</span></code></pre></div>
</div>
<div id="discussion-id204" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id204" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multiple linear regression is the obvious generalization of simple
linear regression. It allows multiple predictor variables instead of one
predictor variable and still uses OLS to compute the coefficients of a
linear equation. The three-variable regression just given corresponds to
this linear model:</p>
<blockquote>
<p><em>y<sub>i</sub></em> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>u<sub>i</sub></em> + <em>Î²</em><sub>2</sub><em>v<sub>i</sub></em> + <em>Î²</em><sub>3</sub><em>w<sub>i</sub></em> + <em>Îµ<sub>i</sub></em></p>
</blockquote>
<p>R uses the <code>lm</code> function for both simple and multiple linear regression.
You simply add more variables to the righthand side of the model
formula. The output then shows the coefficients of the fitted model. Letâs set up some example random normal data using the <code>rnorm</code> function:</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="LinearRegressionAndANOVA.html#cb709-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb709-2"><a href="LinearRegressionAndANOVA.html#cb709-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb709-3"><a href="LinearRegressionAndANOVA.html#cb709-3" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">3</span>,  <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb709-4"><a href="LinearRegressionAndANOVA.html#cb709-4" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb709-5"><a href="LinearRegressionAndANOVA.html#cb709-5" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>,  <span class="at">sd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Then we can create an equation using known coefficients to calculate our <em>y</em> variable:</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="LinearRegressionAndANOVA.html#cb710-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> u <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> v <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> w <span class="sc">+</span> e</span></code></pre></div>
<p>And then if we run a linear regression, we can see that R solves for the coefficients and gets pretty close to the actual values just used:</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="LinearRegressionAndANOVA.html#cb711-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w)</span>
<span id="cb711-2"><a href="LinearRegressionAndANOVA.html#cb711-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb711-3"><a href="LinearRegressionAndANOVA.html#cb711-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb711-4"><a href="LinearRegressionAndANOVA.html#cb711-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ u + v + w)</span></span>
<span id="cb711-5"><a href="LinearRegressionAndANOVA.html#cb711-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb711-6"><a href="LinearRegressionAndANOVA.html#cb711-6" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb711-7"><a href="LinearRegressionAndANOVA.html#cb711-7" tabindex="-1"></a><span class="co">#&gt; (Intercept)            u            v            w  </span></span>
<span id="cb711-8"><a href="LinearRegressionAndANOVA.html#cb711-8" tabindex="-1"></a><span class="co">#&gt;        4.77         4.17         3.01         1.91</span></span></code></pre></div>
<p>The <code>data</code> parameter of <code>lm</code> is especially valuable when the number of
variables increases, since itâs much easier to keep your data in one
data frame than in many separate variables. Suppose your data is
captured in a data frame, such as the <code>df</code> variable shown here:</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="LinearRegressionAndANOVA.html#cb712-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, u, v, w)</span>
<span id="cb712-2"><a href="LinearRegressionAndANOVA.html#cb712-2" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb712-3"><a href="LinearRegressionAndANOVA.html#cb712-3" tabindex="-1"></a><span class="co">#&gt;       y      u     v     w</span></span>
<span id="cb712-4"><a href="LinearRegressionAndANOVA.html#cb712-4" tabindex="-1"></a><span class="co">#&gt; 1 16.67  1.371 5.402 -5.00</span></span>
<span id="cb712-5"><a href="LinearRegressionAndANOVA.html#cb712-5" tabindex="-1"></a><span class="co">#&gt; 2 14.96 -0.565 5.090 -2.67</span></span>
<span id="cb712-6"><a href="LinearRegressionAndANOVA.html#cb712-6" tabindex="-1"></a><span class="co">#&gt; 3  5.89  0.363 0.994 -1.83</span></span>
<span id="cb712-7"><a href="LinearRegressionAndANOVA.html#cb712-7" tabindex="-1"></a><span class="co">#&gt; 4 27.95  0.633 6.697 -0.94</span></span>
<span id="cb712-8"><a href="LinearRegressionAndANOVA.html#cb712-8" tabindex="-1"></a><span class="co">#&gt; 5  2.42  0.404 1.666 -4.38</span></span>
<span id="cb712-9"><a href="LinearRegressionAndANOVA.html#cb712-9" tabindex="-1"></a><span class="co">#&gt; 6  5.73 -0.106 3.211 -4.15</span></span></code></pre></div>
<p>When we supply <code>df</code> to the <code>data</code> parameter of <code>lm</code>, R looks for the
regression variables in the columns of the data frame:</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="LinearRegressionAndANOVA.html#cb713-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w, <span class="at">data =</span> df)</span>
<span id="cb713-2"><a href="LinearRegressionAndANOVA.html#cb713-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb713-3"><a href="LinearRegressionAndANOVA.html#cb713-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb713-4"><a href="LinearRegressionAndANOVA.html#cb713-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ u + v + w, data = df)</span></span>
<span id="cb713-5"><a href="LinearRegressionAndANOVA.html#cb713-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb713-6"><a href="LinearRegressionAndANOVA.html#cb713-6" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb713-7"><a href="LinearRegressionAndANOVA.html#cb713-7" tabindex="-1"></a><span class="co">#&gt; (Intercept)            u            v            w  </span></span>
<span id="cb713-8"><a href="LinearRegressionAndANOVA.html#cb713-8" tabindex="-1"></a><span class="co">#&gt;        4.77         4.17         3.01         1.91</span></span></code></pre></div>
</div>
<div id="see_also-id204" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id204" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id203">âPerforming Simple Linear Regressionâ</a>, for simple
linear regression.</p>
</div>
</div>
<div id="recipe-id231" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Getting Regression Statistics<a href="LinearRegressionAndANOVA.html#recipe-id231" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id231" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id231" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want the critical statistics and information regarding your
regression, such as <em>R</em><sup>2</sup>, the <em>F</em> statistic, confidence intervals for
the coefficients, residuals, the ANOVA table, and so forth.</p>
</div>
<div id="solution-id231" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id231" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Save the regression model in a variable, say <code>m</code>:</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="LinearRegressionAndANOVA.html#cb714-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w)</span></code></pre></div>
<p>Then use functions to extract regression statistics and information from
the model:</p>
<dl>
<dt><code>anova(m)</code></dt>
<dd>
<p>ANOVA table</p>
</dd>
<dt><code>coefficients(m)</code></dt>
<dd>
<p>Model coefficients</p>
</dd>
<dt><code>coef(m)</code></dt>
<dd>
<p>Same as <code>coefficients(m)</code></p>
</dd>
<dt><code>confint(m)</code></dt>
<dd>
<p>Confidence intervals for the regression coefficients</p>
</dd>
<dt><code>deviance(m)</code></dt>
<dd>
<p>Residual sum of squares</p>
</dd>
<dt><code>effects(m)</code></dt>
<dd>
<p>Vector of orthogonal effects</p>
</dd>
<dt><code>fitted(m)</code></dt>
<dd>
<p>Vector of fitted <em>y</em> values</p>
</dd>
<dt><code>residuals(m)</code></dt>
<dd>
<p>Model residuals</p>
</dd>
<dt><code>resid(m)</code></dt>
<dd>
<p>Same as <code>residuals(m)</code></p>
</dd>
<dt><code>summary(m)</code></dt>
<dd>
<p>Key statistics, such as <em>R</em><sup>2</sup>, the <em>F</em> statistic, and the residual
standard error (<em>Ï</em>)</p>
</dd>
<dt><code>vcov(m)</code></dt>
<dd>
<p>Varianceâcovariance matrix of the main parameters</p>
</dd>
</dl>
</div>
<div id="discussion-id231" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id231" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we started using R, the documentation said use the <code>lm</code> function to
perform linear regression. So we did something like this, getting the
output shown in Recipe <a href="LinearRegressionAndANOVA.html#recipe-id204">11.2</a>, <a href="LinearRegressionAndANOVA.html#recipe-id204">âPerforming Multiple Linear Regressionâ</a>:</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="LinearRegressionAndANOVA.html#cb715-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w)</span>
<span id="cb715-2"><a href="LinearRegressionAndANOVA.html#cb715-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb715-3"><a href="LinearRegressionAndANOVA.html#cb715-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb715-4"><a href="LinearRegressionAndANOVA.html#cb715-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ u + v + w)</span></span>
<span id="cb715-5"><a href="LinearRegressionAndANOVA.html#cb715-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb715-6"><a href="LinearRegressionAndANOVA.html#cb715-6" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb715-7"><a href="LinearRegressionAndANOVA.html#cb715-7" tabindex="-1"></a><span class="co">#&gt; (Intercept)            u            v            w  </span></span>
<span id="cb715-8"><a href="LinearRegressionAndANOVA.html#cb715-8" tabindex="-1"></a><span class="co">#&gt;        4.77         4.17         3.01         1.91</span></span></code></pre></div>
<p>How disappointing! The output was nothing compared to other
statistics packages such as SAS. Where is <em>R</em><sup>2</sup>? Where are the
confidence intervals for the coefficients? Where is the <em>F</em> statistic,
its <em>p</em>-value, and the ANOVA table?</p>
<p>Of course, all that information is availableâyou just have to ask for
it. Other statistics systems dump everything and let you wade through
it. R is more minimalist. It prints a bare-bones output and lets you
request what more you want.</p>
<p>The <code>lm</code> function returns a model object that you can assign to a
variable:</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="LinearRegressionAndANOVA.html#cb716-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w)</span></code></pre></div>
<p>From the model object, you can extract important information using
specialized functions. The most important function is <code>summary</code>:</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="LinearRegressionAndANOVA.html#cb717-1" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb717-2"><a href="LinearRegressionAndANOVA.html#cb717-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb717-3"><a href="LinearRegressionAndANOVA.html#cb717-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb717-4"><a href="LinearRegressionAndANOVA.html#cb717-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ u + v + w)</span></span>
<span id="cb717-5"><a href="LinearRegressionAndANOVA.html#cb717-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb717-6"><a href="LinearRegressionAndANOVA.html#cb717-6" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb717-7"><a href="LinearRegressionAndANOVA.html#cb717-7" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb717-8"><a href="LinearRegressionAndANOVA.html#cb717-8" tabindex="-1"></a><span class="co">#&gt; -5.383 -1.760 -0.312  1.856  6.984 </span></span>
<span id="cb717-9"><a href="LinearRegressionAndANOVA.html#cb717-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb717-10"><a href="LinearRegressionAndANOVA.html#cb717-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb717-11"><a href="LinearRegressionAndANOVA.html#cb717-11" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb717-12"><a href="LinearRegressionAndANOVA.html#cb717-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)    4.770      0.969    4.92  3.5e-06 ***</span></span>
<span id="cb717-13"><a href="LinearRegressionAndANOVA.html#cb717-13" tabindex="-1"></a><span class="co">#&gt; u              4.173      0.260   16.07  &lt; 2e-16 ***</span></span>
<span id="cb717-14"><a href="LinearRegressionAndANOVA.html#cb717-14" tabindex="-1"></a><span class="co">#&gt; v              3.013      0.148   20.31  &lt; 2e-16 ***</span></span>
<span id="cb717-15"><a href="LinearRegressionAndANOVA.html#cb717-15" tabindex="-1"></a><span class="co">#&gt; w              1.905      0.266    7.15  1.7e-10 ***</span></span>
<span id="cb717-16"><a href="LinearRegressionAndANOVA.html#cb717-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb717-17"><a href="LinearRegressionAndANOVA.html#cb717-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb717-18"><a href="LinearRegressionAndANOVA.html#cb717-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb717-19"><a href="LinearRegressionAndANOVA.html#cb717-19" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.66 on 96 degrees of freedom</span></span>
<span id="cb717-20"><a href="LinearRegressionAndANOVA.html#cb717-20" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.885,  Adjusted R-squared:  0.882 </span></span>
<span id="cb717-21"><a href="LinearRegressionAndANOVA.html#cb717-21" tabindex="-1"></a><span class="co">#&gt; F-statistic:  247 on 3 and 96 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>The summary shows the estimated coefficients. It shows the critical
statistics, such as <em>R</em><sup>2</sup> and the <em>F</em> statistic. It shows an estimate
of <em>Ï</em>, the standard error of the residuals. The summary is so important
that there is an entire recipe devoted to understanding it. See also Recipe <a href="LinearRegressionAndANOVA.html#recipe-id240">11.4</a>, <a href="LinearRegressionAndANOVA.html#recipe-id240">âUnderstanding the Regression Summaryâ</a>.</p>
<p>There are specialized extractor functions for other important
information:</p>
<dl>
<dt>Model coefficients (point estimates)</dt>
<dd>

</dd>
</dl>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="LinearRegressionAndANOVA.html#cb718-1" tabindex="-1"></a>    <span class="fu">coef</span>(m)</span>
<span id="cb718-2"><a href="LinearRegressionAndANOVA.html#cb718-2" tabindex="-1"></a><span class="co">#&gt; (Intercept)           u           v           w </span></span>
<span id="cb718-3"><a href="LinearRegressionAndANOVA.html#cb718-3" tabindex="-1"></a><span class="co">#&gt;        4.77        4.17        3.01        1.91</span></span></code></pre></div>
<dl>
<dt>Confidence intervals for model coefficients</dt>
<dd>

</dd>
</dl>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="LinearRegressionAndANOVA.html#cb719-1" tabindex="-1"></a>    <span class="fu">confint</span>(m)</span>
<span id="cb719-2"><a href="LinearRegressionAndANOVA.html#cb719-2" tabindex="-1"></a><span class="co">#&gt;             2.5 % 97.5 %</span></span>
<span id="cb719-3"><a href="LinearRegressionAndANOVA.html#cb719-3" tabindex="-1"></a><span class="co">#&gt; (Intercept)  2.85   6.69</span></span>
<span id="cb719-4"><a href="LinearRegressionAndANOVA.html#cb719-4" tabindex="-1"></a><span class="co">#&gt; u            3.66   4.69</span></span>
<span id="cb719-5"><a href="LinearRegressionAndANOVA.html#cb719-5" tabindex="-1"></a><span class="co">#&gt; v            2.72   3.31</span></span>
<span id="cb719-6"><a href="LinearRegressionAndANOVA.html#cb719-6" tabindex="-1"></a><span class="co">#&gt; w            1.38   2.43</span></span></code></pre></div>
<dl>
<dt>Model residuals</dt>
<dd>

</dd>
</dl>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="LinearRegressionAndANOVA.html#cb720-1" tabindex="-1"></a>    <span class="fu">resid</span>(m)</span>
<span id="cb720-2"><a href="LinearRegressionAndANOVA.html#cb720-2" tabindex="-1"></a><span class="co">#&gt;       1       2       3       4       5       6       7       8       9      10 </span></span>
<span id="cb720-3"><a href="LinearRegressionAndANOVA.html#cb720-3" tabindex="-1"></a><span class="co">#&gt; -0.5675  2.2880  0.0972  2.1474 -0.7169 -0.3617  1.0350  2.8040 -4.2496 -0.2048 </span></span>
<span id="cb720-4"><a href="LinearRegressionAndANOVA.html#cb720-4" tabindex="-1"></a><span class="co">#&gt;      11      12      13      14      15      16      17      18      19      20 </span></span>
<span id="cb720-5"><a href="LinearRegressionAndANOVA.html#cb720-5" tabindex="-1"></a><span class="co">#&gt; -0.6467 -2.5772 -2.9339 -1.9330  1.7800 -1.4400 -2.3989  0.9245 -3.3663  2.6890 </span></span>
<span id="cb720-6"><a href="LinearRegressionAndANOVA.html#cb720-6" tabindex="-1"></a><span class="co">#&gt;      21      22      23      24      25      26      27      28      29      30 </span></span>
<span id="cb720-7"><a href="LinearRegressionAndANOVA.html#cb720-7" tabindex="-1"></a><span class="co">#&gt; -1.4190  0.7871  0.0355 -0.3806  5.0459 -2.5011  3.4516  0.3371 -2.7099 -0.0761 </span></span>
<span id="cb720-8"><a href="LinearRegressionAndANOVA.html#cb720-8" tabindex="-1"></a><span class="co">#&gt;      31      32      33      34      35      36      37      38      39      40 </span></span>
<span id="cb720-9"><a href="LinearRegressionAndANOVA.html#cb720-9" tabindex="-1"></a><span class="co">#&gt;  2.0261 -1.3902 -2.7041  0.3953  2.7201 -0.0254 -3.9887 -3.9011 -1.9458 -1.7701 </span></span>
<span id="cb720-10"><a href="LinearRegressionAndANOVA.html#cb720-10" tabindex="-1"></a><span class="co">#&gt;      41      42      43      44      45      46      47      48      49      50 </span></span>
<span id="cb720-11"><a href="LinearRegressionAndANOVA.html#cb720-11" tabindex="-1"></a><span class="co">#&gt; -0.2614  2.0977 -1.3986 -3.1910  1.8439  0.8218  3.6273 -5.3832  0.2905  3.7878 </span></span>
<span id="cb720-12"><a href="LinearRegressionAndANOVA.html#cb720-12" tabindex="-1"></a><span class="co">#&gt;      51      52      53      54      55      56      57      58      59      60 </span></span>
<span id="cb720-13"><a href="LinearRegressionAndANOVA.html#cb720-13" tabindex="-1"></a><span class="co">#&gt;  1.9194 -2.4106  1.6855 -2.7964 -1.3348  3.3549 -1.1525  2.4012 -0.5320 -4.9434 </span></span>
<span id="cb720-14"><a href="LinearRegressionAndANOVA.html#cb720-14" tabindex="-1"></a><span class="co">#&gt;      61      62      63      64      65      66      67      68      69      70 </span></span>
<span id="cb720-15"><a href="LinearRegressionAndANOVA.html#cb720-15" tabindex="-1"></a><span class="co">#&gt; -2.4899 -3.2718 -1.6161 -1.5119 -0.4493 -0.9869  5.6273 -4.4626 -1.7568  0.8099 </span></span>
<span id="cb720-16"><a href="LinearRegressionAndANOVA.html#cb720-16" tabindex="-1"></a><span class="co">#&gt;      71      72      73      74      75      76      77      78      79      80 </span></span>
<span id="cb720-17"><a href="LinearRegressionAndANOVA.html#cb720-17" tabindex="-1"></a><span class="co">#&gt;  5.0320  0.1689  3.5761 -4.8668  4.2781 -2.1386 -0.9739 -3.6380  0.5788  5.5664 </span></span>
<span id="cb720-18"><a href="LinearRegressionAndANOVA.html#cb720-18" tabindex="-1"></a><span class="co">#&gt;      81      82      83      84      85      86      87      88      89      90 </span></span>
<span id="cb720-19"><a href="LinearRegressionAndANOVA.html#cb720-19" tabindex="-1"></a><span class="co">#&gt;  6.9840 -3.5119  1.2842  4.1445 -0.4630 -0.7867 -0.7565  1.6384  3.7578  1.8942 </span></span>
<span id="cb720-20"><a href="LinearRegressionAndANOVA.html#cb720-20" tabindex="-1"></a><span class="co">#&gt;      91      92      93      94      95      96      97      98      99     100 </span></span>
<span id="cb720-21"><a href="LinearRegressionAndANOVA.html#cb720-21" tabindex="-1"></a><span class="co">#&gt;  0.5542 -0.8662  1.2041 -1.7401 -0.7261  3.2701  1.4012  0.9476 -0.9140  2.4278</span></span></code></pre></div>
<dl>
<dt>Residual sum of squares</dt>
<dd>

</dd>
</dl>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="LinearRegressionAndANOVA.html#cb721-1" tabindex="-1"></a>    <span class="fu">deviance</span>(m)</span>
<span id="cb721-2"><a href="LinearRegressionAndANOVA.html#cb721-2" tabindex="-1"></a><span class="co">#&gt; [1] 679</span></span></code></pre></div>
<dl>
<dt>ANOVA table</dt>
<dd>

</dd>
</dl>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="LinearRegressionAndANOVA.html#cb722-1" tabindex="-1"></a>    <span class="fu">anova</span>(m)</span>
<span id="cb722-2"><a href="LinearRegressionAndANOVA.html#cb722-2" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb722-3"><a href="LinearRegressionAndANOVA.html#cb722-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb722-4"><a href="LinearRegressionAndANOVA.html#cb722-4" tabindex="-1"></a><span class="co">#&gt; Response: y</span></span>
<span id="cb722-5"><a href="LinearRegressionAndANOVA.html#cb722-5" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span id="cb722-6"><a href="LinearRegressionAndANOVA.html#cb722-6" tabindex="-1"></a><span class="co">#&gt; u          1   1776    1776   251.0 &lt; 2e-16 ***</span></span>
<span id="cb722-7"><a href="LinearRegressionAndANOVA.html#cb722-7" tabindex="-1"></a><span class="co">#&gt; v          1   3097    3097   437.7 &lt; 2e-16 ***</span></span>
<span id="cb722-8"><a href="LinearRegressionAndANOVA.html#cb722-8" tabindex="-1"></a><span class="co">#&gt; w          1    362     362    51.1 1.7e-10 ***</span></span>
<span id="cb722-9"><a href="LinearRegressionAndANOVA.html#cb722-9" tabindex="-1"></a><span class="co">#&gt; Residuals 96    679       7                    </span></span>
<span id="cb722-10"><a href="LinearRegressionAndANOVA.html#cb722-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb722-11"><a href="LinearRegressionAndANOVA.html#cb722-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>If you find it annoying to save the model in a variable, you are welcome
to use one-liners such as this:</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="LinearRegressionAndANOVA.html#cb723-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w))</span></code></pre></div>
<p>Or you can use <code>magritr</code> pipes:</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="LinearRegressionAndANOVA.html#cb724-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w) <span class="sc">%&gt;%</span></span>
<span id="cb724-2"><a href="LinearRegressionAndANOVA.html#cb724-2" tabindex="-1"></a>  summary</span></code></pre></div>
</div>
<div id="see_also-id231" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id231" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id240">11.4</a>, <a href="LinearRegressionAndANOVA.html#recipe-id240">âUnderstanding the Regression Summaryâ</a>. See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id233">11.17</a>, <a href="LinearRegressionAndANOVA.html#recipe-id233">âIdentifying Influential Observationsâ</a>, for regression statistics specific to model diagnostics.</p>
</div>
</div>
<div id="recipe-id240" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Understanding the Regression Summary<a href="LinearRegressionAndANOVA.html#recipe-id240" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id240" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id240" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You created a linear regression model, <code>m</code>. However, you are confused by
the output from <code>summary(m)</code>.</p>
</div>
<div id="discussion-id240" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id240" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The model summary is important because it links you to the most critical
regression statistics. Here is the model summary from Recipe <a href="LinearRegressionAndANOVA.html#recipe-id231">11.3</a>, <a href="LinearRegressionAndANOVA.html#recipe-id231">âGetting Regression Statisticsâ</a>:</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="LinearRegressionAndANOVA.html#cb725-1" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb725-2"><a href="LinearRegressionAndANOVA.html#cb725-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb725-3"><a href="LinearRegressionAndANOVA.html#cb725-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb725-4"><a href="LinearRegressionAndANOVA.html#cb725-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ u + v + w)</span></span>
<span id="cb725-5"><a href="LinearRegressionAndANOVA.html#cb725-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb725-6"><a href="LinearRegressionAndANOVA.html#cb725-6" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb725-7"><a href="LinearRegressionAndANOVA.html#cb725-7" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb725-8"><a href="LinearRegressionAndANOVA.html#cb725-8" tabindex="-1"></a><span class="co">#&gt; -5.383 -1.760 -0.312  1.856  6.984 </span></span>
<span id="cb725-9"><a href="LinearRegressionAndANOVA.html#cb725-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb725-10"><a href="LinearRegressionAndANOVA.html#cb725-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb725-11"><a href="LinearRegressionAndANOVA.html#cb725-11" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb725-12"><a href="LinearRegressionAndANOVA.html#cb725-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)    4.770      0.969    4.92  3.5e-06 ***</span></span>
<span id="cb725-13"><a href="LinearRegressionAndANOVA.html#cb725-13" tabindex="-1"></a><span class="co">#&gt; u              4.173      0.260   16.07  &lt; 2e-16 ***</span></span>
<span id="cb725-14"><a href="LinearRegressionAndANOVA.html#cb725-14" tabindex="-1"></a><span class="co">#&gt; v              3.013      0.148   20.31  &lt; 2e-16 ***</span></span>
<span id="cb725-15"><a href="LinearRegressionAndANOVA.html#cb725-15" tabindex="-1"></a><span class="co">#&gt; w              1.905      0.266    7.15  1.7e-10 ***</span></span>
<span id="cb725-16"><a href="LinearRegressionAndANOVA.html#cb725-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb725-17"><a href="LinearRegressionAndANOVA.html#cb725-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb725-18"><a href="LinearRegressionAndANOVA.html#cb725-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb725-19"><a href="LinearRegressionAndANOVA.html#cb725-19" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.66 on 96 degrees of freedom</span></span>
<span id="cb725-20"><a href="LinearRegressionAndANOVA.html#cb725-20" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.885,  Adjusted R-squared:  0.882 </span></span>
<span id="cb725-21"><a href="LinearRegressionAndANOVA.html#cb725-21" tabindex="-1"></a><span class="co">#&gt; F-statistic:  247 on 3 and 96 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>Letâs dissect this summary by section. Weâll read it from top to
bottomâeven though the most important statistic, the <em>F</em> statistic,
appears at the end.</p>
<dl>
<dt>Call</dt>
<dd>

</dd>
</dl>
<pre><code>summary(m)$call
#&gt; lm(formula = y ~ u + v + w)</code></pre>
<p>This shows how <code>lm</code> was called when it created the model, which is
important for putting this summary into the proper context.</p>
<dl>
<dt>Residuals statistics</dt>
<dd>

</dd>
</dl>
<pre><code>#&gt; Residuals:
#&gt;     Min      1Q  Median      3Q     Max 
#&gt;  -5.383  -1.760  -0.312   1.856   6.984</code></pre>
<p>Ideally, the regression residuals would have a perfect
normal distribution. These statistics help you identify possible
deviations from normality. The OLS algorithm is mathematically
guaranteed to produce residuals with a mean of zero.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Hence the
sign of the median indicates the skewâs direction, and the magnitude
of the median indicates the extent. In this case the median is
negative, which suggests some skew to the left.</p>
<p>If the residuals have a nice, bell-shaped distribution, then the
first quartile (<code>1Q</code>) and third quartile (<code>3Q</code>) should have about the
same magnitude. In this example, the larger magnitude of <code>3Q</code> versus
<code>1Q</code> (1.859 versus 1.76) indicates a slight skew to the right in
our data, although the negative median makes the situation
less clear-cut.</p>
<p>The <code>Min</code> and <code>Max</code> residuals offer a quick way to detect extreme
outliers in the data, since extreme outliers (in the
response variable) produce large residuals.</p>
<dl>
<dt>Coefficients</dt>
<dd>

</dd>
</dl>
<pre><code> #&gt; Coefficients:
 #&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
 #&gt; (Intercept)    4.770      0.969    4.92  3.5e-06 ***
 #&gt; u              4.173      0.260   16.07  &lt; 2e-16 ***
 #&gt; v              3.013      0.148   20.31  &lt; 2e-16 ***
 #&gt; w              1.905      0.266    7.15  1.7e-10 ***</code></pre>
<p>The column labeled <code>Estimate</code> contains the estimated regression
coefficients as calculated by ordinary least squares.</p>
<p>Theoretically, if a variableâs coefficient is zero then the variable
is worthless; it adds nothing to the model. Yet the coefficients
shown here are only estimates, and they will never be exactly zero.
We therefore ask: Statistically speaking, how likely is it that the
true coefficient is zero? That is the purpose of the <em>t</em> statistics
and the <em>p</em>-values, which in the summary are labeled (respectively)
<code>t</code> <code>value</code> and <code>Pr(&gt;|t|)</code>.</p>
<p>The <em>p</em>-value is a probability. It gauges the likelihood that the
coefficient is <em>not</em> significant, so smaller is better. Big is bad
because it indicates a high likelihood of insignificance. In this
example, the <em>p</em>-value for the <em>u</em> coefficient is a mere 0.00106, so
<em>u</em> is likely significant. The <em>p</em>-value for <em>w</em>, however, is
0.05744; this is just over our conventional limit of 0.05, which
suggests that <em>w</em> is likely insignificant.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> Variables with large
<em>p</em>-values are candidates for elimination.</p>
<p>A handy feature is that R flags the significant variables for
quick identification. Do you notice the extreme righthand column
containing double asterisks (<code>**</code>), a single asterisk (<code>*</code>), and a
period(<code>.</code>)? That column highlights the significant variables. The
line labeled <code>Signif. codes</code> at the bottom gives a cryptic guide
to the flagsâ meanings:</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><code>***</code></td>
<td align="left"><em>p</em>-value between 0 and 0.001</td>
</tr>
<tr class="even">
<td align="left"><code>**</code></td>
<td align="left"><em>p</em>-value between 0.001 and 0.01</td>
</tr>
<tr class="odd">
<td align="left"><code>*</code></td>
<td align="left"><em>p</em>-value between 0.01 and 0.05</td>
</tr>
<tr class="even">
<td align="left"><code>.</code></td>
<td align="left"><em>p</em>-value between 0.05 and 0.1</td>
</tr>
<tr class="odd">
<td align="left">(blank)</td>
<td align="left"><em>p</em>-value between 0.1 and 1.0</td>
</tr>
</tbody>
</table>
<p>The column labeled <code>Std.</code> <code>Error</code> is the standard error of the
estimated coefficient. The column labeled <code>t</code> <code>value</code> is the <em>t</em>
statistic from which the <em>p</em>-value was calculated.</p>
<dl>
<dt>Residual standard error</dt>
<dd>

</dd>
</dl>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="LinearRegressionAndANOVA.html#cb729-1" tabindex="-1"></a><span class="co"># Residual standard error: 2.66 on 96 degrees of freedom</span></span></code></pre></div>
<p>This reports the standard error of the residuals (<em>Ï</em>)âthat is, the
sample standard deviation of <em>Îµ</em>.</p>
<dl>
<dt><em>R</em><sup>2</sup> (coefficient of determination)</dt>
<dd>

</dd>
</dl>
<pre><code># Multiple R-squared:  0.885, Adjusted R-squared:  0.882 </code></pre>
<p><em>R</em><sup>2</sup> is a measure of the modelâs quality. Bigger is better.
Mathematically, it is the fraction of the variance of <em>y</em> that is
explained by the regression model. The remaining variance is not
explained by the model, so it must be due to other factors (i.e.,
unknown variables or sampling variability). In this case, the model
explains 0.885 (88.5%) of the variance of <em>y</em>, and the remaining
0.115 (11.5%) is unexplained.</p>
<p>That being said, we strongly suggest using the adjusted rather than
the basic <em>R</em><sup>2</sup>. The adjusted value accounts for the number of
variables in your model and so is a more realistic assessment of
its effectiveness. In this case, then, we would use 0.882,
not 0.885.</p>
<dl>
<dt><em>F</em> statistic</dt>
<dd>

</dd>
</dl>
<pre><code># F-statistic: 246.6 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The <em>F</em> statistic tells you whether the model is significant
or insignificant. The model is significant if any of the
coefficients are nonzero (i.e., if <em>Î²</em><sub><em>i</em></sub> â  0 for some <em>i</em>). It is
insignificant if all coefficients are zero (<em>Î²</em><sub>1</sub> = <em>Î²</em><sub>2</sub> = â¦ =
<em>Î²</em><sub><em>n</em></sub> = 0).</p>
<p>Conventionally, a <em>p</em>-value of less than 0.05 indicates that the
model is likely significant (one or more <em>Î²</em><sub><em>i</em></sub> are nonzero),
whereas values exceeding 0.05 indicate that the model is likely
not significant. Here, the probability is only 2.2e-16 that our
model is insignificant. Thatâs good.</p>
<p>Most people look at the <em>R</em><sup>2</sup> statistic first. The statistician
wisely starts with the <em>F</em> statistic, because if the model is not
significant then nothing else matters.</p>
</div>
<div id="see_also-id240" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id240" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id231">11.3</a>, <a href="LinearRegressionAndANOVA.html#recipe-id231">âGetting Regression Statisticsâ</a>, for more on
extracting statistics and information from the model object.</p>
</div>
</div>
<div id="recipe-id205" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Performing Linear Regression Without an Intercept<a href="LinearRegressionAndANOVA.html#recipe-id205" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id205" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id205" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to perform a linear regression, but you want to force the
intercept to be zero.</p>
</div>
<div id="solution-id205" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id205" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Add â<code>+</code> <code>0</code>â to the righthand side of your regression formula. That
will force <code>lm</code> to fit the model with a zero intercept:</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="LinearRegressionAndANOVA.html#cb732-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="dv">0</span>)</span></code></pre></div>
<p>The corresponding regression equation is:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²x</em><sub><em>i</em></sub> + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
</div>
<div id="discussion-id205" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id205" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linear regression ordinarily includes an intercept term, so that is the
default in R. In rare cases, however, you may want to fit the data while
assuming that the intercept is zero. In this case you make a modeling
assumption: when <em>x</em> is zero, <em>y</em> should be zero.</p>
<p>When you force a zero intercept, the <code>lm</code> output includes a coefficient
for <em>x</em> but no intercept for <em>y</em>, as shown here:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="LinearRegressionAndANOVA.html#cb733-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="dv">0</span>)</span>
<span id="cb733-2"><a href="LinearRegressionAndANOVA.html#cb733-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb733-3"><a href="LinearRegressionAndANOVA.html#cb733-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb733-4"><a href="LinearRegressionAndANOVA.html#cb733-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x + 0)</span></span>
<span id="cb733-5"><a href="LinearRegressionAndANOVA.html#cb733-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb733-6"><a href="LinearRegressionAndANOVA.html#cb733-6" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb733-7"><a href="LinearRegressionAndANOVA.html#cb733-7" tabindex="-1"></a><span class="co">#&gt;   x  </span></span>
<span id="cb733-8"><a href="LinearRegressionAndANOVA.html#cb733-8" tabindex="-1"></a><span class="co">#&gt; 4.3</span></span></code></pre></div>
<p>We strongly suggest you check that modeling assumption before proceeding.
Perform a regression with an intercept; then see if the intercept could
plausibly be zero. Check the interceptâs confidence interval. In this
example, the confidence interval is (6.26, 8.84):</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="LinearRegressionAndANOVA.html#cb734-1" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))</span>
<span id="cb734-2"><a href="LinearRegressionAndANOVA.html#cb734-2" tabindex="-1"></a><span class="co">#&gt;             2.5 % 97.5 %</span></span>
<span id="cb734-3"><a href="LinearRegressionAndANOVA.html#cb734-3" tabindex="-1"></a><span class="co">#&gt; (Intercept)  6.26   8.84</span></span>
<span id="cb734-4"><a href="LinearRegressionAndANOVA.html#cb734-4" tabindex="-1"></a><span class="co">#&gt; x            2.82   5.31</span></span></code></pre></div>
<p>Because the confidence interval does not contain zero, it is <em>not</em> statistically
plausible that the intercept could be zero. So in this case, it is not reasonable to rerun the regression while forcing a zero intercept.</p>
</div>
</div>
<div id="title-highcor" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Regressing Only Variables That Highly Correlate with Your Dependent Variable<a href="LinearRegressionAndANOVA.html#title-highcor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-highcor" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-highcor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a data frame with many variables and you want to build a multiple linear regression using only the variables that are highly correlated to your response (dependent) variable.</p>
</div>
<div id="solution-highcor" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-highcor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If <code>df</code> is our data frame containing both our response (dependent) and all our predictor (independent) variables and <code>dep_var</code> is our response variable, we can figure out our best predictors and then use them in a linear regression. If we want the top four predictor variables, we can use this recipe:</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="LinearRegressionAndANOVA.html#cb735-1" tabindex="-1"></a>best_pred <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb735-2"><a href="LinearRegressionAndANOVA.html#cb735-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>dep_var) <span class="sc">%&gt;%</span></span>
<span id="cb735-3"><a href="LinearRegressionAndANOVA.html#cb735-3" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> df<span class="sc">$</span>dep_var) <span class="sc">%&gt;%</span></span>
<span id="cb735-4"><a href="LinearRegressionAndANOVA.html#cb735-4" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb735-5"><a href="LinearRegressionAndANOVA.html#cb735-5" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span></span>
<span id="cb735-6"><a href="LinearRegressionAndANOVA.html#cb735-6" tabindex="-1"></a>  names <span class="sc">%&gt;%</span></span>
<span id="cb735-7"><a href="LinearRegressionAndANOVA.html#cb735-7" tabindex="-1"></a>  df[.]</span>
<span id="cb735-8"><a href="LinearRegressionAndANOVA.html#cb735-8" tabindex="-1"></a></span>
<span id="cb735-9"><a href="LinearRegressionAndANOVA.html#cb735-9" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(df<span class="sc">$</span>dep_var <span class="sc">~</span> <span class="fu">as.matrix</span>(best_pred))</span></code></pre></div>
<p>This recipe is a combination of many different pieces of logic used elsewhere in this book. We will describe each step here, and then walk through it in the Discussion using some example data.</p>
<p>First we drop the response variable out of our pipe chain so that we have only our predictor variables in our data flow:</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="LinearRegressionAndANOVA.html#cb736-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb736-2"><a href="LinearRegressionAndANOVA.html#cb736-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>dep_var)</span></code></pre></div>
<p>Then we use <code>map_dbl</code> from <code>purrr</code> to perform a pairwise correlation on each column relative to the response variable:</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="LinearRegressionAndANOVA.html#cb737-1" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> df<span class="sc">$</span>dep_var) <span class="sc">%&gt;%</span></span></code></pre></div>
<p>We then take the resulting correlations and sort them in decreasing order:</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="LinearRegressionAndANOVA.html#cb738-1" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span></code></pre></div>
<p>We want only the top four correlated variables, so we select the top four records in the resulting vector:</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="LinearRegressionAndANOVA.html#cb739-1" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span></span></code></pre></div>
<p>And we donât need the correlation values, only the names of the rowsâwhich are the variable names from our original data frame, <code>df</code>:</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="LinearRegressionAndANOVA.html#cb740-1" tabindex="-1"></a>names <span class="sc">%&gt;%</span></span></code></pre></div>
<p>Then we can pass those names into our subsetting brackets to select only the columns with names matching the ones we want:</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="LinearRegressionAndANOVA.html#cb741-1" tabindex="-1"></a>df[.]</span></code></pre></div>
<p>Our pipe chain assigns the resulting data frame into <code>best_pred</code>. We can then use <code>best_pred</code> as the predictor variables in our regression and we can use <code>df$dep_var</code> as the response:</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="LinearRegressionAndANOVA.html#cb742-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(df<span class="sc">$</span>dep_var <span class="sc">~</span> <span class="fu">as.matrix</span>(best_pred))</span></code></pre></div>
</div>
<div id="discussion-title" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-title" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By combining the mapping functions discussed in Recipe <a href="DataTransformations.html#recipe-id157">6.4</a>, <a href="DataTransformations.html#recipe-id157">âApplying a Function to Every Columnâ</a>, we can create a recipe to remove low-correlation variables from
a set of predictors and use the high-correlation predictors in a regression.</p>
<p>We have an example data frame that contains six predictor variables named <code>pred1</code> through <code>pred6</code>. The response variable is named <code>resp</code>. Letâs walk that data frame through our logic and see how it works.</p>
<p>Loading the data and dropping the <code>resp</code> variable is pretty straightforward. So letâs look at the result of mapping the <code>cor</code> function:</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="LinearRegressionAndANOVA.html#cb743-1" tabindex="-1"></a><span class="co"># loads the pred data frame</span></span>
<span id="cb743-2"><a href="LinearRegressionAndANOVA.html#cb743-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/pred.rdata&quot;</span>)</span>
<span id="cb743-3"><a href="LinearRegressionAndANOVA.html#cb743-3" tabindex="-1"></a></span>
<span id="cb743-4"><a href="LinearRegressionAndANOVA.html#cb743-4" tabindex="-1"></a>pred <span class="sc">%&gt;%</span></span>
<span id="cb743-5"><a href="LinearRegressionAndANOVA.html#cb743-5" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb743-6"><a href="LinearRegressionAndANOVA.html#cb743-6" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> pred<span class="sc">$</span>resp) </span>
<span id="cb743-7"><a href="LinearRegressionAndANOVA.html#cb743-7" tabindex="-1"></a><span class="co">#&gt; pred1 pred2 pred3 pred4 pred5 pred6 </span></span>
<span id="cb743-8"><a href="LinearRegressionAndANOVA.html#cb743-8" tabindex="-1"></a><span class="co">#&gt; 0.573 0.279 0.753 0.799 0.322 0.607</span></span></code></pre></div>
<p>The output is a named vector of values where the names are the variable names and the values are the pairwise correlations between each predictor variable and <code>resp</code>, the response variable.</p>
<p>If we sort this vector, we get the correlations in decreasing order:</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="LinearRegressionAndANOVA.html#cb744-1" tabindex="-1"></a>pred <span class="sc">%&gt;%</span></span>
<span id="cb744-2"><a href="LinearRegressionAndANOVA.html#cb744-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb744-3"><a href="LinearRegressionAndANOVA.html#cb744-3" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> pred<span class="sc">$</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb744-4"><a href="LinearRegressionAndANOVA.html#cb744-4" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb744-5"><a href="LinearRegressionAndANOVA.html#cb744-5" tabindex="-1"></a><span class="co">#&gt; pred4 pred3 pred6 pred1 pred5 pred2 </span></span>
<span id="cb744-6"><a href="LinearRegressionAndANOVA.html#cb744-6" tabindex="-1"></a><span class="co">#&gt; 0.799 0.753 0.607 0.573 0.322 0.279</span></span></code></pre></div>
<p>Using subsetting allows us to select the top four records. The <code>.</code> operator is a special operator that tells the pipe where to put the result of the prior step.</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="LinearRegressionAndANOVA.html#cb745-1" tabindex="-1"></a>pred <span class="sc">%&gt;%</span></span>
<span id="cb745-2"><a href="LinearRegressionAndANOVA.html#cb745-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb745-3"><a href="LinearRegressionAndANOVA.html#cb745-3" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> pred<span class="sc">$</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb745-4"><a href="LinearRegressionAndANOVA.html#cb745-4" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb745-5"><a href="LinearRegressionAndANOVA.html#cb745-5" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] </span>
<span id="cb745-6"><a href="LinearRegressionAndANOVA.html#cb745-6" tabindex="-1"></a><span class="co">#&gt; pred4 pred3 pred6 pred1 </span></span>
<span id="cb745-7"><a href="LinearRegressionAndANOVA.html#cb745-7" tabindex="-1"></a><span class="co">#&gt; 0.799 0.753 0.607 0.573</span></span></code></pre></div>
<p>We then use the <code>names</code> function to extract the names from our vector. The names are the names of the columns we ultimately want to use as our independent variables:</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="LinearRegressionAndANOVA.html#cb746-1" tabindex="-1"></a>pred <span class="sc">%&gt;%</span></span>
<span id="cb746-2"><a href="LinearRegressionAndANOVA.html#cb746-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb746-3"><a href="LinearRegressionAndANOVA.html#cb746-3" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> pred<span class="sc">$</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb746-4"><a href="LinearRegressionAndANOVA.html#cb746-4" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb746-5"><a href="LinearRegressionAndANOVA.html#cb746-5" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span></span>
<span id="cb746-6"><a href="LinearRegressionAndANOVA.html#cb746-6" tabindex="-1"></a>  names </span>
<span id="cb746-7"><a href="LinearRegressionAndANOVA.html#cb746-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;pred4&quot; &quot;pred3&quot; &quot;pred6&quot; &quot;pred1&quot;</span></span></code></pre></div>
<p>When we pass the vector of names into <code>pred[.]</code>, the names are used to select columns from the <code>pred</code> data frame. We then use <code>head</code> to select only the top six rows for easier illustration:</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="LinearRegressionAndANOVA.html#cb747-1" tabindex="-1"></a>pred <span class="sc">%&gt;%</span></span>
<span id="cb747-2"><a href="LinearRegressionAndANOVA.html#cb747-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb747-3"><a href="LinearRegressionAndANOVA.html#cb747-3" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> pred<span class="sc">$</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb747-4"><a href="LinearRegressionAndANOVA.html#cb747-4" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb747-5"><a href="LinearRegressionAndANOVA.html#cb747-5" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span></span>
<span id="cb747-6"><a href="LinearRegressionAndANOVA.html#cb747-6" tabindex="-1"></a>  names <span class="sc">%&gt;%</span></span>
<span id="cb747-7"><a href="LinearRegressionAndANOVA.html#cb747-7" tabindex="-1"></a>  pred[.] <span class="sc">%&gt;%</span></span>
<span id="cb747-8"><a href="LinearRegressionAndANOVA.html#cb747-8" tabindex="-1"></a>  head</span>
<span id="cb747-9"><a href="LinearRegressionAndANOVA.html#cb747-9" tabindex="-1"></a><span class="co">#&gt;    pred4   pred3  pred6  pred1</span></span>
<span id="cb747-10"><a href="LinearRegressionAndANOVA.html#cb747-10" tabindex="-1"></a><span class="co">#&gt; 1  7.252  1.5127  0.560  0.206</span></span>
<span id="cb747-11"><a href="LinearRegressionAndANOVA.html#cb747-11" tabindex="-1"></a><span class="co">#&gt; 2  2.076  0.2579 -0.124 -0.361</span></span>
<span id="cb747-12"><a href="LinearRegressionAndANOVA.html#cb747-12" tabindex="-1"></a><span class="co">#&gt; 3 -0.649  0.0884  0.657  0.758</span></span>
<span id="cb747-13"><a href="LinearRegressionAndANOVA.html#cb747-13" tabindex="-1"></a><span class="co">#&gt; 4  1.365 -0.1209  0.122 -0.727</span></span>
<span id="cb747-14"><a href="LinearRegressionAndANOVA.html#cb747-14" tabindex="-1"></a><span class="co">#&gt; 5 -5.444 -1.1943 -0.391 -1.368</span></span>
<span id="cb747-15"><a href="LinearRegressionAndANOVA.html#cb747-15" tabindex="-1"></a><span class="co">#&gt; 6  2.554  0.6120  1.273  0.433</span></span></code></pre></div>
<p>Now letâs bring it all together and pass the resulting data into the regression:</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="LinearRegressionAndANOVA.html#cb748-1" tabindex="-1"></a>best_pred <span class="ot">&lt;-</span> pred <span class="sc">%&gt;%</span></span>
<span id="cb748-2"><a href="LinearRegressionAndANOVA.html#cb748-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb748-3"><a href="LinearRegressionAndANOVA.html#cb748-3" tabindex="-1"></a>  <span class="fu">map_dbl</span>(cor, <span class="at">y =</span> pred<span class="sc">$</span>resp) <span class="sc">%&gt;%</span></span>
<span id="cb748-4"><a href="LinearRegressionAndANOVA.html#cb748-4" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb748-5"><a href="LinearRegressionAndANOVA.html#cb748-5" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span></span>
<span id="cb748-6"><a href="LinearRegressionAndANOVA.html#cb748-6" tabindex="-1"></a>  names <span class="sc">%&gt;%</span></span>
<span id="cb748-7"><a href="LinearRegressionAndANOVA.html#cb748-7" tabindex="-1"></a>  pred[.]</span>
<span id="cb748-8"><a href="LinearRegressionAndANOVA.html#cb748-8" tabindex="-1"></a></span>
<span id="cb748-9"><a href="LinearRegressionAndANOVA.html#cb748-9" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(pred<span class="sc">$</span>resp <span class="sc">~</span> <span class="fu">as.matrix</span>(best_pred))</span>
<span id="cb748-10"><a href="LinearRegressionAndANOVA.html#cb748-10" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb748-11"><a href="LinearRegressionAndANOVA.html#cb748-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb748-12"><a href="LinearRegressionAndANOVA.html#cb748-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb748-13"><a href="LinearRegressionAndANOVA.html#cb748-13" tabindex="-1"></a><span class="co">#&gt; lm(formula = pred$resp ~ as.matrix(best_pred))</span></span>
<span id="cb748-14"><a href="LinearRegressionAndANOVA.html#cb748-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb748-15"><a href="LinearRegressionAndANOVA.html#cb748-15" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb748-16"><a href="LinearRegressionAndANOVA.html#cb748-16" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb748-17"><a href="LinearRegressionAndANOVA.html#cb748-17" tabindex="-1"></a><span class="co">#&gt; -1.485 -0.619  0.189  0.562  1.398 </span></span>
<span id="cb748-18"><a href="LinearRegressionAndANOVA.html#cb748-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb748-19"><a href="LinearRegressionAndANOVA.html#cb748-19" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb748-20"><a href="LinearRegressionAndANOVA.html#cb748-20" tabindex="-1"></a><span class="co">#&gt;                           Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb748-21"><a href="LinearRegressionAndANOVA.html#cb748-21" tabindex="-1"></a><span class="co">#&gt; (Intercept)                  1.117      0.340    3.28   0.0051 **</span></span>
<span id="cb748-22"><a href="LinearRegressionAndANOVA.html#cb748-22" tabindex="-1"></a><span class="co">#&gt; as.matrix(best_pred)pred4    0.523      0.207    2.53   0.0231 * </span></span>
<span id="cb748-23"><a href="LinearRegressionAndANOVA.html#cb748-23" tabindex="-1"></a><span class="co">#&gt; as.matrix(best_pred)pred3   -0.693      0.870   -0.80   0.4382   </span></span>
<span id="cb748-24"><a href="LinearRegressionAndANOVA.html#cb748-24" tabindex="-1"></a><span class="co">#&gt; as.matrix(best_pred)pred6    1.160      0.682    1.70   0.1095   </span></span>
<span id="cb748-25"><a href="LinearRegressionAndANOVA.html#cb748-25" tabindex="-1"></a><span class="co">#&gt; as.matrix(best_pred)pred1    0.343      0.359    0.95   0.3549   </span></span>
<span id="cb748-26"><a href="LinearRegressionAndANOVA.html#cb748-26" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb748-27"><a href="LinearRegressionAndANOVA.html#cb748-27" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb748-28"><a href="LinearRegressionAndANOVA.html#cb748-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb748-29"><a href="LinearRegressionAndANOVA.html#cb748-29" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.927 on 15 degrees of freedom</span></span>
<span id="cb748-30"><a href="LinearRegressionAndANOVA.html#cb748-30" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.838,  Adjusted R-squared:  0.795 </span></span>
<span id="cb748-31"><a href="LinearRegressionAndANOVA.html#cb748-31" tabindex="-1"></a><span class="co">#&gt; F-statistic: 19.4 on 4 and 15 DF,  p-value: 8.59e-06</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id206" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> Performing Linear Regression with Interaction Terms<a href="LinearRegressionAndANOVA.html#recipe-id206" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id206" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id206" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to include an interaction term in your regression.</p>
</div>
<div id="solution-id206" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id206" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The R syntax for regression formulas lets you specify interaction terms.
To indicate the interaction of two variables, <code>u</code> and <code>v</code>, we separate their names with an asterisk (<code>*</code>):</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="LinearRegressionAndANOVA.html#cb749-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">*</span> v)</span></code></pre></div>
<p>This corresponds to the model <em>y</em><sub>i</sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>u</em><sub><em>i</em></sub> +
<em>Î²</em><sub>2</sub><em>v</em><sub><em>i</em></sub> + <em>Î²</em><sub>3</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub> + <em>Îµ</em><sub><em>i</em></sub>, which includes the
first-order interaction term <em>Î²</em><sub>3</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub>.</p>
</div>
<div id="discussion-id206" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id206" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In regression, an interaction occurs when the product of two predictor
variables is also a significant predictor (i.e., in addition to the
predictor variables themselves). Suppose we have two predictors, <em>u</em> and
<em>v</em>, and want to include their interaction in the regression. This is
expressed by the following equation:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>u</em><sub><em>i</em></sub> + <em>Î²</em><sub>2</sub><em>v</em><sub><em>i</em></sub> +
<em>Î²</em><sub>3</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub> + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
<p>Here the product term, <em>Î²</em><sub>3</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub>, is called the <em>interaction
term</em>. The R formula for that equation is:</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="LinearRegressionAndANOVA.html#cb750-1" tabindex="-1"></a>y <span class="sc">~</span> u <span class="sc">*</span> v</span></code></pre></div>
<p>When you write <code>y</code> <code>~</code> <code>u * v</code>, R automatically includes <em>u</em>, <em>v</em>, and
their product in the model. This is for a good reason. If a model
includes an interaction term, such as <em>Î²</em><sub>3</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub>, then
regression theory tells us the model should also contain the constituent
variables <em>u</em><sub><em>i</em></sub> and <em>v</em><sub><em>i</em></sub>.</p>
<p>Likewise, if you have three predictors (<em>u</em>, <em>v</em>, and <em>w</em>) and want to
include all their interactions, separate them by asterisks:</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="LinearRegressionAndANOVA.html#cb751-1" tabindex="-1"></a>y <span class="sc">~</span> u <span class="sc">*</span> v <span class="sc">*</span> w</span></code></pre></div>
<p>This corresponds to the regression equation:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>u</em><sub><em>i</em></sub> + <em>Î²</em><sub>2</sub><em>v</em><sub><em>i</em></sub> + <em>Î²</em><sub>3</sub><em>w</em><sub><em>i</em></sub> +
<em>Î²</em><sub>4</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub> + <em>Î²</em><sub>5</sub><em>u</em><sub><em>i</em></sub><em>w</em><sub><em>i</em></sub> +
<em>Î²</em><sub>6</sub><em>v</em><sub><em>i</em></sub><em>w</em><sub><em>i</em></sub> + <em>Î²</em><sub>7</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub><em>w</em><sub><em>i</em></sub> + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
<p>Now we have all the first-order interactions and a second-order
interaction (<em>Î²</em><sub>7</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub><em>w</em><sub><em>i</em></sub>).</p>
<p>Sometimes, however, you may not want every possible interaction. You can
explicitly specify a single product by using the colon operator (<code>:</code>).
For example, <code>u:v:w</code> denotes the product term <em>Î²u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub><em>w</em><sub><em>i</em></sub>
but without all possible interactions. So the R formula:</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="LinearRegressionAndANOVA.html#cb752-1" tabindex="-1"></a>y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w <span class="sc">+</span> u<span class="sc">:</span>v<span class="sc">:</span>w</span></code></pre></div>
<p>corresponds to the regression equation:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>u</em><sub><em>i</em></sub> + <em>Î²</em><sub>2</sub><em>v</em><sub><em>i</em></sub> + <em>Î²</em><sub>3</sub><em>w</em><sub><em>i</em></sub> +
<em>Î²</em><sub>4</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub><em>w</em><sub><em>i</em></sub> + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
<p>It might seem odd that colon (<code>:</code>) means pure multiplication while
asterisk (<code>*</code>) means both multiplication and inclusion of constituent
terms. Again, this is because we normally incorporate the constituents
when we include their interaction, so making that approach the default for
asterisk makes sense.</p>
<p>There is some additional syntax for easily specifying many interactions:</p>
<dl>
<dt><code>(u + v + ... + w)^2</code></dt>
<dd>
<p>Include all variables (<em>u</em>, <em>v</em>, â¦, <em>w</em>) and all their
first-order interactions.</p>
</dd>
<dt><code>(u + v + ... + w)^3</code></dt>
<dd>
<p>Include all variables, all their first-order interactions, and all
their second-order interactions.</p>
</dd>
<dt><code>(u + v + ... + w)^4</code></dt>
<dd>
<p>And so forth.</p>
</dd>
</dl>
<p>Both the asterisk (<code>*</code>) and the colon (<code>:</code>) follow a âdistributive law,â
so the following notations are also allowed:</p>
<dl>
<dt><code>x*(u + v + ... + w)</code></dt>
<dd>
<p>Same as <code>x*u + x*v + ... +               x*w</code>
(which is the same as <code>x +               u + v + ... + w + x:u + x:v + ... + x:w</code>).</p>
</dd>
<dt><code>x:(u + v + ... + w)</code></dt>
<dd>
<p>Same as <code>x:u + x:v + ... + x:w</code>.</p>
</dd>
</dl>
<p>All this syntax gives you some flexibility in writing your formula. For
example, these three formulas are equivalent:</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="LinearRegressionAndANOVA.html#cb753-1" tabindex="-1"></a>y <span class="sc">~</span> u <span class="sc">*</span> v</span>
<span id="cb753-2"><a href="LinearRegressionAndANOVA.html#cb753-2" tabindex="-1"></a>y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> u<span class="sc">:</span>v</span>
<span id="cb753-3"><a href="LinearRegressionAndANOVA.html#cb753-3" tabindex="-1"></a>y <span class="sc">~</span> (u <span class="sc">+</span> v) <span class="sc">^</span> <span class="dv">2</span></span></code></pre></div>
<p>They all define the same regression equation, <em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> +
<em>Î²</em><sub>1</sub><em>u</em><sub><em>i</em></sub> + <em>Î²</em><sub>2</sub><em>v</em><sub><em>i</em></sub> + <em>Î²</em><sub>3</sub><em>u</em><sub><em>i</em></sub><em>v</em><sub><em>i</em></sub> + <em>Îµ</em><sub><em>i</em></sub> .</p>
</div>
<div id="see_also-id206" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id206" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The full syntax for formulas is richer than described here.
See <a href="http://oreilly.com/catalog/9780596801717"><em>R in a Nutshell</em></a> (OâReilly)
or the R Language Definition for more details.</p>
</div>
</div>
<div id="recipe-id236" class="section level2 hasAnchor" number="11.8">
<h2><span class="header-section-number">11.8</span> Selecting the Best Regression Variables<a href="LinearRegressionAndANOVA.html#recipe-id236" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id236" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id236" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You are creating a new regression model or improving an existing model.
You have the luxury of many regression variables, and you want to select
the best subset of those variables.</p>
</div>
<div id="solution-id236" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id236" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>step</code> function can perform stepwise regression, either forward or
backward. Backward stepwise regression starts with many variables and
removes the underperformers:</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="LinearRegressionAndANOVA.html#cb754-1" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4)</span>
<span id="cb754-2"><a href="LinearRegressionAndANOVA.html#cb754-2" tabindex="-1"></a>reduced.model <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<p>Forward stepwise regression starts with a few variables and adds new
ones to improve the model until it cannot be improved further:</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="LinearRegressionAndANOVA.html#cb755-1" tabindex="-1"></a>min.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb755-2"><a href="LinearRegressionAndANOVA.html#cb755-2" tabindex="-1"></a>fwd.model <span class="ot">&lt;-</span></span>
<span id="cb755-3"><a href="LinearRegressionAndANOVA.html#cb755-3" tabindex="-1"></a>  <span class="fu">step</span>(min.model,</span>
<span id="cb755-4"><a href="LinearRegressionAndANOVA.html#cb755-4" tabindex="-1"></a>       <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>,</span>
<span id="cb755-5"><a href="LinearRegressionAndANOVA.html#cb755-5" tabindex="-1"></a>       <span class="at">scope =</span> (<span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4))</span></code></pre></div>
</div>
<div id="discussion-id236" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id236" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you have many predictors, it can be quite difficult to choose the
best subset. Adding and removing individual variables affects the
overall mix, so the search for âthe bestâ can become tedious.</p>
<p>The <code>step</code> function automates that search. Backward stepwise regression
is the easiest approach. Start with a model that includes all the
predictors. We call that the <em>full model</em>. The model summary, shown here,
indicates that not all predictors are statistically significant:</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="LinearRegressionAndANOVA.html#cb756-1" tabindex="-1"></a><span class="co"># example data</span></span>
<span id="cb756-2"><a href="LinearRegressionAndANOVA.html#cb756-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb756-3"><a href="LinearRegressionAndANOVA.html#cb756-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb756-4"><a href="LinearRegressionAndANOVA.html#cb756-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb756-5"><a href="LinearRegressionAndANOVA.html#cb756-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb756-6"><a href="LinearRegressionAndANOVA.html#cb756-6" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb756-7"><a href="LinearRegressionAndANOVA.html#cb756-7" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb756-8"><a href="LinearRegressionAndANOVA.html#cb756-8" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb756-9"><a href="LinearRegressionAndANOVA.html#cb756-9" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">+</span> x1 <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> x3 <span class="sc">+</span> e</span>
<span id="cb756-10"><a href="LinearRegressionAndANOVA.html#cb756-10" tabindex="-1"></a></span>
<span id="cb756-11"><a href="LinearRegressionAndANOVA.html#cb756-11" tabindex="-1"></a><span class="co"># build the model</span></span>
<span id="cb756-12"><a href="LinearRegressionAndANOVA.html#cb756-12" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4)</span>
<span id="cb756-13"><a href="LinearRegressionAndANOVA.html#cb756-13" tabindex="-1"></a><span class="fu">summary</span>(full.model)</span>
<span id="cb756-14"><a href="LinearRegressionAndANOVA.html#cb756-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb756-15"><a href="LinearRegressionAndANOVA.html#cb756-15" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb756-16"><a href="LinearRegressionAndANOVA.html#cb756-16" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x1 + x2 + x3 + x4)</span></span>
<span id="cb756-17"><a href="LinearRegressionAndANOVA.html#cb756-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb756-18"><a href="LinearRegressionAndANOVA.html#cb756-18" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb756-19"><a href="LinearRegressionAndANOVA.html#cb756-19" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb756-20"><a href="LinearRegressionAndANOVA.html#cb756-20" tabindex="-1"></a><span class="co">#&gt; -8.032 -1.774  0.158  2.032  6.626 </span></span>
<span id="cb756-21"><a href="LinearRegressionAndANOVA.html#cb756-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb756-22"><a href="LinearRegressionAndANOVA.html#cb756-22" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb756-23"><a href="LinearRegressionAndANOVA.html#cb756-23" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb756-24"><a href="LinearRegressionAndANOVA.html#cb756-24" tabindex="-1"></a><span class="co">#&gt; (Intercept)  3.40224    0.80767    4.21  4.4e-05 ***</span></span>
<span id="cb756-25"><a href="LinearRegressionAndANOVA.html#cb756-25" tabindex="-1"></a><span class="co">#&gt; x1           0.53937    0.25935    2.08    0.039 *  </span></span>
<span id="cb756-26"><a href="LinearRegressionAndANOVA.html#cb756-26" tabindex="-1"></a><span class="co">#&gt; x2           0.16831    0.12291    1.37    0.173    </span></span>
<span id="cb756-27"><a href="LinearRegressionAndANOVA.html#cb756-27" tabindex="-1"></a><span class="co">#&gt; x3           5.17410    0.23983   21.57  &lt; 2e-16 ***</span></span>
<span id="cb756-28"><a href="LinearRegressionAndANOVA.html#cb756-28" tabindex="-1"></a><span class="co">#&gt; x4          -0.00982    0.12954   -0.08    0.940    </span></span>
<span id="cb756-29"><a href="LinearRegressionAndANOVA.html#cb756-29" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb756-30"><a href="LinearRegressionAndANOVA.html#cb756-30" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb756-31"><a href="LinearRegressionAndANOVA.html#cb756-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb756-32"><a href="LinearRegressionAndANOVA.html#cb756-32" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.92 on 145 degrees of freedom</span></span>
<span id="cb756-33"><a href="LinearRegressionAndANOVA.html#cb756-33" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.77,   Adjusted R-squared:  0.763 </span></span>
<span id="cb756-34"><a href="LinearRegressionAndANOVA.html#cb756-34" tabindex="-1"></a><span class="co">#&gt; F-statistic:  121 on 4 and 145 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>We want to eliminate the insignificant variables, so we use <code>step</code> to
incrementally eliminate the underperformers. The result is called the
<em>reduced model</em>:</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="LinearRegressionAndANOVA.html#cb757-1" tabindex="-1"></a>reduced.model <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, <span class="at">direction=</span><span class="st">&quot;backward&quot;</span>)</span>
<span id="cb757-2"><a href="LinearRegressionAndANOVA.html#cb757-2" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=327</span></span>
<span id="cb757-3"><a href="LinearRegressionAndANOVA.html#cb757-3" tabindex="-1"></a><span class="co">#&gt; y ~ x1 + x2 + x3 + x4</span></span>
<span id="cb757-4"><a href="LinearRegressionAndANOVA.html#cb757-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb757-5"><a href="LinearRegressionAndANOVA.html#cb757-5" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq  RSS AIC</span></span>
<span id="cb757-6"><a href="LinearRegressionAndANOVA.html#cb757-6" tabindex="-1"></a><span class="co">#&gt; - x4    1         0 1240 325</span></span>
<span id="cb757-7"><a href="LinearRegressionAndANOVA.html#cb757-7" tabindex="-1"></a><span class="co">#&gt; - x2    1        16 1256 327</span></span>
<span id="cb757-8"><a href="LinearRegressionAndANOVA.html#cb757-8" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              1240 327</span></span>
<span id="cb757-9"><a href="LinearRegressionAndANOVA.html#cb757-9" tabindex="-1"></a><span class="co">#&gt; - x1    1        37 1277 329</span></span>
<span id="cb757-10"><a href="LinearRegressionAndANOVA.html#cb757-10" tabindex="-1"></a><span class="co">#&gt; - x3    1      3979 5219 540</span></span>
<span id="cb757-11"><a href="LinearRegressionAndANOVA.html#cb757-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb757-12"><a href="LinearRegressionAndANOVA.html#cb757-12" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=325</span></span>
<span id="cb757-13"><a href="LinearRegressionAndANOVA.html#cb757-13" tabindex="-1"></a><span class="co">#&gt; y ~ x1 + x2 + x3</span></span>
<span id="cb757-14"><a href="LinearRegressionAndANOVA.html#cb757-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb757-15"><a href="LinearRegressionAndANOVA.html#cb757-15" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq  RSS AIC</span></span>
<span id="cb757-16"><a href="LinearRegressionAndANOVA.html#cb757-16" tabindex="-1"></a><span class="co">#&gt; - x2    1        16 1256 325</span></span>
<span id="cb757-17"><a href="LinearRegressionAndANOVA.html#cb757-17" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              1240 325</span></span>
<span id="cb757-18"><a href="LinearRegressionAndANOVA.html#cb757-18" tabindex="-1"></a><span class="co">#&gt; - x1    1        37 1277 327</span></span>
<span id="cb757-19"><a href="LinearRegressionAndANOVA.html#cb757-19" tabindex="-1"></a><span class="co">#&gt; - x3    1      3988 5228 539</span></span>
<span id="cb757-20"><a href="LinearRegressionAndANOVA.html#cb757-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb757-21"><a href="LinearRegressionAndANOVA.html#cb757-21" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=325</span></span>
<span id="cb757-22"><a href="LinearRegressionAndANOVA.html#cb757-22" tabindex="-1"></a><span class="co">#&gt; y ~ x1 + x3</span></span>
<span id="cb757-23"><a href="LinearRegressionAndANOVA.html#cb757-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb757-24"><a href="LinearRegressionAndANOVA.html#cb757-24" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq  RSS AIC</span></span>
<span id="cb757-25"><a href="LinearRegressionAndANOVA.html#cb757-25" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              1256 325</span></span>
<span id="cb757-26"><a href="LinearRegressionAndANOVA.html#cb757-26" tabindex="-1"></a><span class="co">#&gt; - x1    1        44 1300 328</span></span>
<span id="cb757-27"><a href="LinearRegressionAndANOVA.html#cb757-27" tabindex="-1"></a><span class="co">#&gt; - x3    1      3974 5230 537</span></span></code></pre></div>
<p>The output from <code>step</code> shows the sequence of models that it explored. In
this case, <code>step</code> removed <code>x2</code> and <code>x4</code> and left only <code>x1</code> and <code>x3</code> in
the final (reduced) model. The summary of the reduced model shows that
it contains only significant predictors:</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="LinearRegressionAndANOVA.html#cb758-1" tabindex="-1"></a><span class="fu">summary</span>(reduced.model)</span>
<span id="cb758-2"><a href="LinearRegressionAndANOVA.html#cb758-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb758-3"><a href="LinearRegressionAndANOVA.html#cb758-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb758-4"><a href="LinearRegressionAndANOVA.html#cb758-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x1 + x3)</span></span>
<span id="cb758-5"><a href="LinearRegressionAndANOVA.html#cb758-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb758-6"><a href="LinearRegressionAndANOVA.html#cb758-6" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb758-7"><a href="LinearRegressionAndANOVA.html#cb758-7" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb758-8"><a href="LinearRegressionAndANOVA.html#cb758-8" tabindex="-1"></a><span class="co">#&gt; -8.148 -1.850 -0.055  2.026  6.550 </span></span>
<span id="cb758-9"><a href="LinearRegressionAndANOVA.html#cb758-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb758-10"><a href="LinearRegressionAndANOVA.html#cb758-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb758-11"><a href="LinearRegressionAndANOVA.html#cb758-11" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb758-12"><a href="LinearRegressionAndANOVA.html#cb758-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)    3.648      0.751    4.86    3e-06 ***</span></span>
<span id="cb758-13"><a href="LinearRegressionAndANOVA.html#cb758-13" tabindex="-1"></a><span class="co">#&gt; x1             0.582      0.255    2.28    0.024 *  </span></span>
<span id="cb758-14"><a href="LinearRegressionAndANOVA.html#cb758-14" tabindex="-1"></a><span class="co">#&gt; x3             5.147      0.239   21.57   &lt;2e-16 ***</span></span>
<span id="cb758-15"><a href="LinearRegressionAndANOVA.html#cb758-15" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb758-16"><a href="LinearRegressionAndANOVA.html#cb758-16" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb758-17"><a href="LinearRegressionAndANOVA.html#cb758-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb758-18"><a href="LinearRegressionAndANOVA.html#cb758-18" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.92 on 147 degrees of freedom</span></span>
<span id="cb758-19"><a href="LinearRegressionAndANOVA.html#cb758-19" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.767,  Adjusted R-squared:  0.763 </span></span>
<span id="cb758-20"><a href="LinearRegressionAndANOVA.html#cb758-20" tabindex="-1"></a><span class="co">#&gt; F-statistic:  241 on 2 and 147 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>Backward stepwise regression is easy, but sometimes itâs not feasible to
start with âeverythingâ because you have too many candidate variables.
In that case use forward stepwise regression, which will start with
nothing and incrementally add variables that improve the regression. It
stops when no further improvement is possible.</p>
<p>A model that âstarts with nothingâ may look odd at first:</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="LinearRegressionAndANOVA.html#cb759-1" tabindex="-1"></a>min.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)</span></code></pre></div>
<p>This is a model with a response variable (<em>y</em>) but no predictor
variables. (All the fitted values for <em>y</em> are simply the mean of <em>y</em>,
which is what you would guess if no predictors were available.)</p>
<p>We must tell <code>step</code> which candidate variables are available for
inclusion in the model. That is the purpose of the <code>scope</code> argument. <code>scope</code> is a formula with nothing on the lefthand side of the tilde
(<code>~</code>) and candidate variables on the righthand side:</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="LinearRegressionAndANOVA.html#cb760-1" tabindex="-1"></a>fwd.model <span class="ot">&lt;-</span> <span class="fu">step</span>(</span>
<span id="cb760-2"><a href="LinearRegressionAndANOVA.html#cb760-2" tabindex="-1"></a>  min.model,</span>
<span id="cb760-3"><a href="LinearRegressionAndANOVA.html#cb760-3" tabindex="-1"></a>  <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>,</span>
<span id="cb760-4"><a href="LinearRegressionAndANOVA.html#cb760-4" tabindex="-1"></a>  <span class="at">scope =</span> (<span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4),</span>
<span id="cb760-5"><a href="LinearRegressionAndANOVA.html#cb760-5" tabindex="-1"></a>  <span class="at">trace =</span> <span class="dv">0</span></span>
<span id="cb760-6"><a href="LinearRegressionAndANOVA.html#cb760-6" tabindex="-1"></a>)</span></code></pre></div>
<p>Here we see that <code>x1</code>, <code>x2</code>, <code>x3</code>, and <code>x4</code> are all candidates for
inclusion. (We also included <code>trace = 0</code> to inhibit the voluminous output
from <code>step</code>.) The resulting model has two significant predictors and no
insignificant predictors:</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="LinearRegressionAndANOVA.html#cb761-1" tabindex="-1"></a><span class="fu">summary</span>(fwd.model)</span>
<span id="cb761-2"><a href="LinearRegressionAndANOVA.html#cb761-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb761-3"><a href="LinearRegressionAndANOVA.html#cb761-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb761-4"><a href="LinearRegressionAndANOVA.html#cb761-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x3 + x1)</span></span>
<span id="cb761-5"><a href="LinearRegressionAndANOVA.html#cb761-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb761-6"><a href="LinearRegressionAndANOVA.html#cb761-6" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb761-7"><a href="LinearRegressionAndANOVA.html#cb761-7" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb761-8"><a href="LinearRegressionAndANOVA.html#cb761-8" tabindex="-1"></a><span class="co">#&gt; -8.148 -1.850 -0.055  2.026  6.550 </span></span>
<span id="cb761-9"><a href="LinearRegressionAndANOVA.html#cb761-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb761-10"><a href="LinearRegressionAndANOVA.html#cb761-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb761-11"><a href="LinearRegressionAndANOVA.html#cb761-11" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb761-12"><a href="LinearRegressionAndANOVA.html#cb761-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)    3.648      0.751    4.86    3e-06 ***</span></span>
<span id="cb761-13"><a href="LinearRegressionAndANOVA.html#cb761-13" tabindex="-1"></a><span class="co">#&gt; x3             5.147      0.239   21.57   &lt;2e-16 ***</span></span>
<span id="cb761-14"><a href="LinearRegressionAndANOVA.html#cb761-14" tabindex="-1"></a><span class="co">#&gt; x1             0.582      0.255    2.28    0.024 *  </span></span>
<span id="cb761-15"><a href="LinearRegressionAndANOVA.html#cb761-15" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb761-16"><a href="LinearRegressionAndANOVA.html#cb761-16" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb761-17"><a href="LinearRegressionAndANOVA.html#cb761-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb761-18"><a href="LinearRegressionAndANOVA.html#cb761-18" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.92 on 147 degrees of freedom</span></span>
<span id="cb761-19"><a href="LinearRegressionAndANOVA.html#cb761-19" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.767,  Adjusted R-squared:  0.763 </span></span>
<span id="cb761-20"><a href="LinearRegressionAndANOVA.html#cb761-20" tabindex="-1"></a><span class="co">#&gt; F-statistic:  241 on 2 and 147 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>The step-forward algorithm reached the same model as the step-backward
model by including <code>x1</code> and <code>x3</code> but excluding <code>x2</code> and <code>x4</code>. This is a
toy example, so that is not surprising. In real applications, we suggest
trying both the forward and the backward regression and then comparing
the results. You might be surprised.</p>
<p>Finally, donât get carried away with stepwise regression. It is not a
panacea, it cannot turn junk into gold, and it is definitely not a
substitute for choosing predictors carefully and wisely. You might
think: âOh boy! I can generate every possible interaction term for my
model, then let <code>step</code> choose the best ones! What a model Iâll get!â
Youâd be thinking of something like this, which starts with all possible interactions
and then tries to reduce the model:</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="LinearRegressionAndANOVA.html#cb762-1" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> (x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4) <span class="sc">^</span> <span class="dv">4</span>)</span>
<span id="cb762-2"><a href="LinearRegressionAndANOVA.html#cb762-2" tabindex="-1"></a>reduced.model <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>)</span>
<span id="cb762-3"><a href="LinearRegressionAndANOVA.html#cb762-3" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=337</span></span>
<span id="cb762-4"><a href="LinearRegressionAndANOVA.html#cb762-4" tabindex="-1"></a><span class="co">#&gt; y ~ (x1 + x2 + x3 + x4)^4</span></span>
<span id="cb762-5"><a href="LinearRegressionAndANOVA.html#cb762-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-6"><a href="LinearRegressionAndANOVA.html#cb762-6" tabindex="-1"></a><span class="co">#&gt;               Df Sum of Sq  RSS AIC</span></span>
<span id="cb762-7"><a href="LinearRegressionAndANOVA.html#cb762-7" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x3:x4  1    0.0321 1145 335</span></span>
<span id="cb762-8"><a href="LinearRegressionAndANOVA.html#cb762-8" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                     1145 337</span></span>
<span id="cb762-9"><a href="LinearRegressionAndANOVA.html#cb762-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-10"><a href="LinearRegressionAndANOVA.html#cb762-10" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=335</span></span>
<span id="cb762-11"><a href="LinearRegressionAndANOVA.html#cb762-11" tabindex="-1"></a><span class="co">#&gt; y ~ x1 + x2 + x3 + x4 + x1:x2 + x1:x3 + x1:x4 + x2:x3 + x2:x4 + </span></span>
<span id="cb762-12"><a href="LinearRegressionAndANOVA.html#cb762-12" tabindex="-1"></a><span class="co">#&gt;     x3:x4 + x1:x2:x3 + x1:x2:x4 + x1:x3:x4 + x2:x3:x4</span></span>
<span id="cb762-13"><a href="LinearRegressionAndANOVA.html#cb762-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-14"><a href="LinearRegressionAndANOVA.html#cb762-14" tabindex="-1"></a><span class="co">#&gt;            Df Sum of Sq  RSS AIC</span></span>
<span id="cb762-15"><a href="LinearRegressionAndANOVA.html#cb762-15" tabindex="-1"></a><span class="co">#&gt; - x2:x3:x4  1      0.76 1146 333</span></span>
<span id="cb762-16"><a href="LinearRegressionAndANOVA.html#cb762-16" tabindex="-1"></a><span class="co">#&gt; - x1:x3:x4  1      8.37 1154 334</span></span>
<span id="cb762-17"><a href="LinearRegressionAndANOVA.html#cb762-17" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                  1145 335</span></span>
<span id="cb762-18"><a href="LinearRegressionAndANOVA.html#cb762-18" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x4  1     20.95 1166 336</span></span>
<span id="cb762-19"><a href="LinearRegressionAndANOVA.html#cb762-19" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x3  1     25.18 1170 336</span></span>
<span id="cb762-20"><a href="LinearRegressionAndANOVA.html#cb762-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-21"><a href="LinearRegressionAndANOVA.html#cb762-21" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=333</span></span>
<span id="cb762-22"><a href="LinearRegressionAndANOVA.html#cb762-22" tabindex="-1"></a><span class="co">#&gt; y ~ x1 + x2 + x3 + x4 + x1:x2 + x1:x3 + x1:x4 + x2:x3 + x2:x4 + </span></span>
<span id="cb762-23"><a href="LinearRegressionAndANOVA.html#cb762-23" tabindex="-1"></a><span class="co">#&gt;     x3:x4 + x1:x2:x3 + x1:x2:x4 + x1:x3:x4</span></span>
<span id="cb762-24"><a href="LinearRegressionAndANOVA.html#cb762-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-25"><a href="LinearRegressionAndANOVA.html#cb762-25" tabindex="-1"></a><span class="co">#&gt;            Df Sum of Sq  RSS AIC</span></span>
<span id="cb762-26"><a href="LinearRegressionAndANOVA.html#cb762-26" tabindex="-1"></a><span class="co">#&gt; - x1:x3:x4  1      8.74 1155 332</span></span>
<span id="cb762-27"><a href="LinearRegressionAndANOVA.html#cb762-27" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                  1146 333</span></span>
<span id="cb762-28"><a href="LinearRegressionAndANOVA.html#cb762-28" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x4  1     21.72 1168 334</span></span>
<span id="cb762-29"><a href="LinearRegressionAndANOVA.html#cb762-29" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x3  1     26.51 1172 334</span></span>
<span id="cb762-30"><a href="LinearRegressionAndANOVA.html#cb762-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-31"><a href="LinearRegressionAndANOVA.html#cb762-31" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=332</span></span>
<span id="cb762-32"><a href="LinearRegressionAndANOVA.html#cb762-32" tabindex="-1"></a><span class="co">#&gt; y ~ x1 + x2 + x3 + x4 + x1:x2 + x1:x3 + x1:x4 + x2:x3 + x2:x4 + </span></span>
<span id="cb762-33"><a href="LinearRegressionAndANOVA.html#cb762-33" tabindex="-1"></a><span class="co">#&gt;     x3:x4 + x1:x2:x3 + x1:x2:x4</span></span>
<span id="cb762-34"><a href="LinearRegressionAndANOVA.html#cb762-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-35"><a href="LinearRegressionAndANOVA.html#cb762-35" tabindex="-1"></a><span class="co">#&gt;            Df Sum of Sq  RSS AIC</span></span>
<span id="cb762-36"><a href="LinearRegressionAndANOVA.html#cb762-36" tabindex="-1"></a><span class="co">#&gt; - x3:x4     1      0.29 1155 330</span></span>
<span id="cb762-37"><a href="LinearRegressionAndANOVA.html#cb762-37" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                  1155 332</span></span>
<span id="cb762-38"><a href="LinearRegressionAndANOVA.html#cb762-38" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x4  1     23.24 1178 333</span></span>
<span id="cb762-39"><a href="LinearRegressionAndANOVA.html#cb762-39" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x3  1     31.11 1186 334</span></span>
<span id="cb762-40"><a href="LinearRegressionAndANOVA.html#cb762-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-41"><a href="LinearRegressionAndANOVA.html#cb762-41" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=330</span></span>
<span id="cb762-42"><a href="LinearRegressionAndANOVA.html#cb762-42" tabindex="-1"></a><span class="co">#&gt; y ~ x1 + x2 + x3 + x4 + x1:x2 + x1:x3 + x1:x4 + x2:x3 + x2:x4 + </span></span>
<span id="cb762-43"><a href="LinearRegressionAndANOVA.html#cb762-43" tabindex="-1"></a><span class="co">#&gt;     x1:x2:x3 + x1:x2:x4</span></span>
<span id="cb762-44"><a href="LinearRegressionAndANOVA.html#cb762-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb762-45"><a href="LinearRegressionAndANOVA.html#cb762-45" tabindex="-1"></a><span class="co">#&gt;            Df Sum of Sq  RSS AIC</span></span>
<span id="cb762-46"><a href="LinearRegressionAndANOVA.html#cb762-46" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                  1155 330</span></span>
<span id="cb762-47"><a href="LinearRegressionAndANOVA.html#cb762-47" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x4  1      23.4 1178 331</span></span>
<span id="cb762-48"><a href="LinearRegressionAndANOVA.html#cb762-48" tabindex="-1"></a><span class="co">#&gt; - x1:x2:x3  1      31.5 1187 332</span></span></code></pre></div>
<p>This does not work well. Most of the interaction terms are meaningless.
The <code>step</code> function becomes overwhelmed, and you are left with many
insignificant terms.</p>
</div>
<div id="see_also-id236" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id236" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id232">11.25</a>, <a href="LinearRegressionAndANOVA.html#recipe-id232">âComparing Models by Using ANOVAâ</a>.</p>
</div>
</div>
<div id="recipe-id209" class="section level2 hasAnchor" number="11.9">
<h2><span class="header-section-number">11.9</span> Regressing on a Subset of Your Data<a href="LinearRegressionAndANOVA.html#recipe-id209" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id209" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id209" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to fit a linear model to a subset of your data, not to the
entire dataset.</p>
</div>
<div id="solution-id209" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id209" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>lm</code> function has a <code>subset</code> parameter that specifies which data
elements should be used for fitting. The parameterâs value can be any
index expression that could index your data. This shows a fitting that
uses only the first 100 observations:</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="LinearRegressionAndANOVA.html#cb763-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">subset=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)          <span class="co"># Use only x[1:100]</span></span></code></pre></div>
</div>
<div id="discussion-id209" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id209" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You will often want to regress only a subset of your data. This can
happen, for example, when youâre using in-sample data to create the model and
out-of-sample data to test it.</p>
<p>The <code>lm</code> function has a parameter, <code>subset</code>, that selects the
observations used for fitting. The value of <code>subset</code> is a vector. It can
be a vector of index values, in which case <code>lm</code> selects only the
indicated observations from your data. It can also be a logical vector,
the same length as your data, in which case <code>lm</code> selects the
observations with a corresponding <code>TRUE</code>.</p>
<p>Suppose you have 1,000 observations of (<em>x</em>, <em>y</em>) pairs and want to fit
your model using only the first half of those observations. Use a
<code>subset</code> parameter of 1:500, indicating <code>lm</code> should use observations 1
through 500:</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="LinearRegressionAndANOVA.html#cb764-1" tabindex="-1"></a><span class="do">## example data</span></span>
<span id="cb764-2"><a href="LinearRegressionAndANOVA.html#cb764-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb764-3"><a href="LinearRegressionAndANOVA.html#cb764-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb764-4"><a href="LinearRegressionAndANOVA.html#cb764-4" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, .<span class="dv">5</span>)</span>
<span id="cb764-5"><a href="LinearRegressionAndANOVA.html#cb764-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">+</span> e</span>
<span id="cb764-6"><a href="LinearRegressionAndANOVA.html#cb764-6" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">subset =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>)</span>
<span id="cb764-7"><a href="LinearRegressionAndANOVA.html#cb764-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb764-8"><a href="LinearRegressionAndANOVA.html#cb764-8" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb764-9"><a href="LinearRegressionAndANOVA.html#cb764-9" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x, subset = 1:500)</span></span>
<span id="cb764-10"><a href="LinearRegressionAndANOVA.html#cb764-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb764-11"><a href="LinearRegressionAndANOVA.html#cb764-11" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb764-12"><a href="LinearRegressionAndANOVA.html#cb764-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)            x  </span></span>
<span id="cb764-13"><a href="LinearRegressionAndANOVA.html#cb764-13" tabindex="-1"></a><span class="co">#&gt;           3            2</span></span></code></pre></div>
<p>More generally, you can use the expression <code>1:floor(length(x)/2)</code> to
select the first half of your data, regardless of size:</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="LinearRegressionAndANOVA.html#cb765-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">subset =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">floor</span>(<span class="fu">length</span>(x) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb765-2"><a href="LinearRegressionAndANOVA.html#cb765-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb765-3"><a href="LinearRegressionAndANOVA.html#cb765-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb765-4"><a href="LinearRegressionAndANOVA.html#cb765-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x, subset = 1:floor(length(x)/2))</span></span>
<span id="cb765-5"><a href="LinearRegressionAndANOVA.html#cb765-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb765-6"><a href="LinearRegressionAndANOVA.html#cb765-6" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb765-7"><a href="LinearRegressionAndANOVA.html#cb765-7" tabindex="-1"></a><span class="co">#&gt; (Intercept)            x  </span></span>
<span id="cb765-8"><a href="LinearRegressionAndANOVA.html#cb765-8" tabindex="-1"></a><span class="co">#&gt;           3            2</span></span></code></pre></div>
<p>Letâs say your data was collected in several labs and you have a factor,
<code>lab</code>, that identifies the lab of origin. You can limit your regression
to observations collected in New Jersey by using a logical vector that
is <code>TRUE</code> only for those observations:</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="LinearRegressionAndANOVA.html#cb766-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;./data/lab_df.rdata&#39;</span>)</span>
<span id="cb766-2"><a href="LinearRegressionAndANOVA.html#cb766-2" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">subset =</span> (lab <span class="sc">==</span> <span class="st">&quot;NJ&quot;</span>), <span class="at">data =</span> lab_df)</span>
<span id="cb766-3"><a href="LinearRegressionAndANOVA.html#cb766-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb766-4"><a href="LinearRegressionAndANOVA.html#cb766-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb766-5"><a href="LinearRegressionAndANOVA.html#cb766-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x, data = lab_df, subset = (lab == &quot;NJ&quot;))</span></span>
<span id="cb766-6"><a href="LinearRegressionAndANOVA.html#cb766-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb766-7"><a href="LinearRegressionAndANOVA.html#cb766-7" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb766-8"><a href="LinearRegressionAndANOVA.html#cb766-8" tabindex="-1"></a><span class="co">#&gt; (Intercept)            x  </span></span>
<span id="cb766-9"><a href="LinearRegressionAndANOVA.html#cb766-9" tabindex="-1"></a><span class="co">#&gt;        2.58         5.03</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id244" class="section level2 hasAnchor" number="11.10">
<h2><span class="header-section-number">11.10</span> Using an Expression Inside a Regression Formula<a href="LinearRegressionAndANOVA.html#recipe-id244" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id244" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id244" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to regress on calculated values, not simple variables, but the
syntax of a regression formula seems to forbid that.</p>
</div>
<div id="solution-id244" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id244" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Embed the expressions for the calculated values inside the <code>I(...)</code>
operator. That will force R to calculate the expression and use the
calculated value for the regression.</p>
</div>
<div id="discussion-id244" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id244" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you want to regress on the sum of <em>u</em> and <em>v</em>, then this is your
regression equation:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub>(<em>u</em><sub><em>i</em></sub> + <em>v</em><sub><em>i</em></sub>) + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
<p>How do you write that equation as a regression formula? This wonât work:</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="LinearRegressionAndANOVA.html#cb767-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v)    <span class="co"># Not quite right</span></span></code></pre></div>
<p>Here R will interpret <code>u</code> and <code>v</code> as two separate predictors, each with
its own regression coefficient. Likewise, suppose your regression
equation is:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>u</em><sub><em>i</em></sub> + <em>Î²</em><sub>2</sub><em>u</em><sub><em>i</em></sub><sup>2</sup> + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
<p>This wonât work:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="LinearRegressionAndANOVA.html#cb768-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> u <span class="sc">^</span> <span class="dv">2</span>)  <span class="co"># That&#39;s an interaction, not a quadratic term</span></span></code></pre></div>
<p>R will interpret <code>u^2</code> as an interaction term
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id206">11.7</a>, <a href="LinearRegressionAndANOVA.html#recipe-id206">âPerforming Linear Regression with Interaction Termsâ</a>)
and not as the square of <em>u</em>.</p>
<p>The solution is to surround the expressions by the <code>I(...)</code> operator,
which inhibits the expressions from being interpreted as a regression
formula. Instead, it forces R to calculate the expressionâs value and
then incorporate that value directly into the regression. Thus, the first
example becomes:</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="LinearRegressionAndANOVA.html#cb769-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">I</span>(u <span class="sc">+</span> v))</span></code></pre></div>
<p>In response to that command, R computes <em>u</em> + <em>v</em> and then regresses <em>y</em>
on the sum.</p>
<p>For the second example we use:</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="LinearRegressionAndANOVA.html#cb770-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> <span class="fu">I</span>(u <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<p>Here R computes the square of <em>u</em> and then regresses on the sum <em>u</em> +
<em>u</em><sup>2</sup>.</p>
<p>All the basic binary operators (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>) have special
meanings inside a regression formula. For this reason, you must use the
<code>I(...)</code> operator whenever you incorporate calculated values into a
regression.</p>
<p>A beautiful aspect of these embedded transformations is that R remembers
them and applies them when you make predictions from the
model. Consider the quadratic model described by the second example. It
uses <code>u</code> and <code>u^2</code>, but we supply the value of <em>u</em> only and R does the
heavy lifting. We donât need to calculate the square of <em>u</em> ourselves:</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="LinearRegressionAndANOVA.html#cb771-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;./data/df_squared.rdata&#39;</span>)</span>
<span id="cb771-2"><a href="LinearRegressionAndANOVA.html#cb771-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> <span class="fu">I</span>(u <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> df_squared)</span>
<span id="cb771-3"><a href="LinearRegressionAndANOVA.html#cb771-3" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">u =</span> <span class="fl">13.4</span>))</span>
<span id="cb771-4"><a href="LinearRegressionAndANOVA.html#cb771-4" tabindex="-1"></a><span class="co">#&gt;   1 </span></span>
<span id="cb771-5"><a href="LinearRegressionAndANOVA.html#cb771-5" tabindex="-1"></a><span class="co">#&gt; 877</span></span></code></pre></div>
</div>
<div id="see_also-id244" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id244" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id243">11.11</a>, <a href="LinearRegressionAndANOVA.html#recipe-id243">âRegressing on a Polynomialâ</a>, for the special case of
regression on a polynomial. See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id208">11.12</a>,
<a href="LinearRegressionAndANOVA.html#recipe-id208">âRegressing on Transformed Dataâ</a>, for incorporating other
data transformations into the regression.</p>
</div>
</div>
<div id="recipe-id243" class="section level2 hasAnchor" number="11.11">
<h2><span class="header-section-number">11.11</span> Regressing on a Polynomial<a href="LinearRegressionAndANOVA.html#recipe-id243" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id243" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id243" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to regress <em>y</em> on a polynomial of <em>x</em>.</p>
</div>
<div id="solution-id243" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id243" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>poly(x,n)</code> function in your regression formula to regress on an
<em>n</em>-degree polynomial of <em>x</em>. This example models <em>y</em> as a cubic
function of <em>x</em>:</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="LinearRegressionAndANOVA.html#cb772-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>The exampleâs formula corresponds to the following cubic regression
equation:</p>
<blockquote>
<p><em>y</em><sub><em>i</em></sub> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>x</em><sub><em>i</em></sub> + <em>Î²</em><sub>2</sub><em>x</em><sub><em>i</em></sub><sup>2</sup> +
<em>Î²</em><sub>3</sub><em>x</em><sub><em>i</em></sub><sup>3</sup> + <em>Îµ</em><sub><em>i</em></sub></p>
</blockquote>
</div>
<div id="discussion-id243" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id243" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When people first use a polynomial model in R, they often do something clunky like
this:</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="LinearRegressionAndANOVA.html#cb773-1" tabindex="-1"></a>x_sq <span class="ot">&lt;-</span> x <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb773-2"><a href="LinearRegressionAndANOVA.html#cb773-2" tabindex="-1"></a>x_cub <span class="ot">&lt;-</span> x <span class="sc">^</span> <span class="dv">3</span></span>
<span id="cb773-3"><a href="LinearRegressionAndANOVA.html#cb773-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x_sq <span class="sc">+</span> x_cub)</span></code></pre></div>
<p>Obviously, this is quite annoying, and it litters their workspace with
extra variables.</p>
<p>Itâs much easier to write:</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="LinearRegressionAndANOVA.html#cb774-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>The <code>raw = TRUE</code> is necessary. Without it, the <code>poly</code> function computes
orthogonal polynomials instead of simple polynomials.</p>
<p>Beyond the convenience, a huge advantage is that R will calculate all
those powers of <em>x</em> when you make predictions from the model
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id214">11.19</a>, <a href="LinearRegressionAndANOVA.html#recipe-id214">âPredicting New Valuesâ</a>). Without that, you are stuck
calculating <em>x</em><sup>2</sup> and <em>x</em><sup>3</sup> yourself every time you employ the model.</p>
<p>Here is another good reason to use <code>poly</code>. You cannot write your
regression formula in this way:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="LinearRegressionAndANOVA.html#cb775-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">3</span>)     <span class="co"># Does not do what you think!</span></span></code></pre></div>
<p>R will interpret <code>x^2</code> and <code>x^3</code> as interaction terms, not as powers of
<em>x</em>. The resulting model is a one-term linear regression, completely
unlike your expectation. You could write the regression formula like
this:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="LinearRegressionAndANOVA.html#cb776-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">3</span>))</span></code></pre></div>
<p>But thatâs getting pretty verbose. Just use <code>poly</code>.</p>
</div>
<div id="see_also-id243" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id243" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id206">11.7</a>, <a href="LinearRegressionAndANOVA.html#recipe-id206">âPerforming Linear Regression with Interaction Termsâ</a>,
for more about interaction terms. See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id208">11.12</a>, <a href="LinearRegressionAndANOVA.html#recipe-id208">âRegressing on Transformed Dataâ</a>, for other
transformations on regression data.</p>
</div>
</div>
<div id="recipe-id208" class="section level2 hasAnchor" number="11.12">
<h2><span class="header-section-number">11.12</span> Regressing on Transformed Data<a href="LinearRegressionAndANOVA.html#recipe-id208" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id208" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id208" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to build a regression model for <em>x</em> and <em>y</em>, but they do not
have a linear relationship.</p>
</div>
<div id="solution-id208" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id208" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can embed the needed transformation inside the regression formula.
If, for example, <em>y</em> must be transformed into log(<em>y</em>), then the
regression formula becomes:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="LinearRegressionAndANOVA.html#cb777-1" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span></code></pre></div>
</div>
<div id="discussion-id208" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id208" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A critical assumption behind the <code>lm</code> function for regression is that
the variables have a linear relationship. To the extent this assumption
is false, the resulting regression becomes meaningless.</p>
<p>Fortunately, many datasets can be transformed into a linear relationship
before applying <code>lm</code>.</p>
<pre><code>#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;
#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:obs-trans"></span>
<img src="11_LinearRegression_files/figure-html/obs-trans-1.png" alt="Example of a data transform" width="85%" />
<p class="caption">
Figure 11.1: Example of a data transform
</p>
</div>
<p>Figure <a href="LinearRegressionAndANOVA.html#fig:obs-trans">11.1</a> shows an example of
exponential decay. The left panel shows the original data, <em>z</em>. The
dotted line shows a linear regression on the original data; clearly,
itâs a lousy fit. If the data is really exponential, then a possible
model is:</p>
<p><em>z</em> = exp[<em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>t</em> + <em>Îµ</em>]</p>
<p>where <em>t</em> is time and exp[] is the exponential function (<em>e</em><sup><em>x</em></sup>).
This is not linear, of course, but we can linearize it by taking
logarithms:</p>
<p>log(<em>z</em>) = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub><em>t</em> + <em>Îµ</em></p>
<p>In R, that regression is simple because we can embed the log transform
directly into the regression formula:</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="LinearRegressionAndANOVA.html#cb779-1" tabindex="-1"></a><span class="co"># read in our example data</span></span>
<span id="cb779-2"><a href="LinearRegressionAndANOVA.html#cb779-2" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/df_decay.rdata&#39;</span>)</span>
<span id="cb779-3"><a href="LinearRegressionAndANOVA.html#cb779-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> df_decay<span class="sc">$</span>z</span>
<span id="cb779-4"><a href="LinearRegressionAndANOVA.html#cb779-4" tabindex="-1"></a>t <span class="ot">&lt;-</span> df_decay<span class="sc">$</span>time</span>
<span id="cb779-5"><a href="LinearRegressionAndANOVA.html#cb779-5" tabindex="-1"></a></span>
<span id="cb779-6"><a href="LinearRegressionAndANOVA.html#cb779-6" tabindex="-1"></a><span class="co"># transform and model</span></span>
<span id="cb779-7"><a href="LinearRegressionAndANOVA.html#cb779-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(z) <span class="sc">~</span> t)</span>
<span id="cb779-8"><a href="LinearRegressionAndANOVA.html#cb779-8" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb779-9"><a href="LinearRegressionAndANOVA.html#cb779-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb779-10"><a href="LinearRegressionAndANOVA.html#cb779-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb779-11"><a href="LinearRegressionAndANOVA.html#cb779-11" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(z) ~ t)</span></span>
<span id="cb779-12"><a href="LinearRegressionAndANOVA.html#cb779-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb779-13"><a href="LinearRegressionAndANOVA.html#cb779-13" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb779-14"><a href="LinearRegressionAndANOVA.html#cb779-14" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb779-15"><a href="LinearRegressionAndANOVA.html#cb779-15" tabindex="-1"></a><span class="co">#&gt; -0.4479 -0.0993  0.0049  0.0978  0.2802 </span></span>
<span id="cb779-16"><a href="LinearRegressionAndANOVA.html#cb779-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb779-17"><a href="LinearRegressionAndANOVA.html#cb779-17" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb779-18"><a href="LinearRegressionAndANOVA.html#cb779-18" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb779-19"><a href="LinearRegressionAndANOVA.html#cb779-19" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.6887     0.0306    22.5   &lt;2e-16 ***</span></span>
<span id="cb779-20"><a href="LinearRegressionAndANOVA.html#cb779-20" tabindex="-1"></a><span class="co">#&gt; t            -2.0118     0.0351   -57.3   &lt;2e-16 ***</span></span>
<span id="cb779-21"><a href="LinearRegressionAndANOVA.html#cb779-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb779-22"><a href="LinearRegressionAndANOVA.html#cb779-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb779-23"><a href="LinearRegressionAndANOVA.html#cb779-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb779-24"><a href="LinearRegressionAndANOVA.html#cb779-24" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.148 on 98 degrees of freedom</span></span>
<span id="cb779-25"><a href="LinearRegressionAndANOVA.html#cb779-25" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.971,  Adjusted R-squared:  0.971 </span></span>
<span id="cb779-26"><a href="LinearRegressionAndANOVA.html#cb779-26" tabindex="-1"></a><span class="co">#&gt; F-statistic: 3.28e+03 on 1 and 98 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>The right panel of Figure <a href="LinearRegressionAndANOVA.html#fig:obs-trans">11.1</a>
shows the plot of log(<em>z</em>) versus time. Superimposed on that plot is
their regression line. The fit appears to be much better; this is
confirmed by the <em>R</em><sup>2</sup> = 0.97, compared with 0.82 for the linear
regression on the original data.</p>
<p>You can embed other functions inside your formula. If you thought the
relationship was quadratic, you could use a square-root transformation:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="LinearRegressionAndANOVA.html#cb780-1" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">sqrt</span>(y) <span class="sc">~</span> month)</span></code></pre></div>
<p>You can apply transformations to variables on both sides of the formula,
of course. This formula regresses <em>y</em> on the square root of <em>x</em>:</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="LinearRegressionAndANOVA.html#cb781-1" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">sqrt</span>(x))</span></code></pre></div>
<p>This regression is for a log-log relationship between <em>x</em> and <em>y</em>:</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="LinearRegressionAndANOVA.html#cb782-1" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span></code></pre></div>
</div>
<div id="see_also-id208" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id208" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe @ref(recipe-id210,) <a href="LinearRegressionAndANOVA.html#recipe-id210">âFinding the Best Power Transformation (BoxâCox Procedure)â</a>.</p>
</div>
</div>
<div id="recipe-id210" class="section level2 hasAnchor" number="11.13">
<h2><span class="header-section-number">11.13</span> Finding the Best Power Transformation (BoxâCox Procedure)<a href="LinearRegressionAndANOVA.html#recipe-id210" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id210" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id210" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to improve your linear model by applying a power transformation
to the response variable.</p>
</div>
<div id="solution-id210" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id210" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the BoxâCox procedure, which is implemented by the <code>boxcox</code> function
of the <code>MASS</code> package. The procedure will identify a power, <em>Î»</em>, such
that transforming <em>y</em> into <em>y</em><sup><em>Î»</em></sup> will improve the fit of your model:</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="LinearRegressionAndANOVA.html#cb783-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb783-2"><a href="LinearRegressionAndANOVA.html#cb783-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb783-3"><a href="LinearRegressionAndANOVA.html#cb783-3" tabindex="-1"></a><span class="fu">boxcox</span>(m)</span></code></pre></div>
</div>
<div id="discussion-id210" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id210" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To illustrate the BoxâCox transformation, letâs create some artificial
data using the equation <em>y</em><sup>â1.5</sup> = <em>x</em> + <em>Îµ</em>, where <em>Îµ</em> is an error
term:</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="LinearRegressionAndANOVA.html#cb784-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb784-2"><a href="LinearRegressionAndANOVA.html#cb784-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb784-3"><a href="LinearRegressionAndANOVA.html#cb784-3" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb784-4"><a href="LinearRegressionAndANOVA.html#cb784-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> (x <span class="sc">+</span> eps) <span class="sc">^</span> (<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p>Then we will (mistakenly) model the data using a simple linear
regression and derive an adjusted <em>R</em><sup>2</sup> of 0.637:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="LinearRegressionAndANOVA.html#cb785-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb785-2"><a href="LinearRegressionAndANOVA.html#cb785-2" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb785-3"><a href="LinearRegressionAndANOVA.html#cb785-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb785-4"><a href="LinearRegressionAndANOVA.html#cb785-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb785-5"><a href="LinearRegressionAndANOVA.html#cb785-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x)</span></span>
<span id="cb785-6"><a href="LinearRegressionAndANOVA.html#cb785-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb785-7"><a href="LinearRegressionAndANOVA.html#cb785-7" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb785-8"><a href="LinearRegressionAndANOVA.html#cb785-8" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb785-9"><a href="LinearRegressionAndANOVA.html#cb785-9" tabindex="-1"></a><span class="co">#&gt; -0.04032 -0.01633 -0.00792  0.00996  0.14516 </span></span>
<span id="cb785-10"><a href="LinearRegressionAndANOVA.html#cb785-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb785-11"><a href="LinearRegressionAndANOVA.html#cb785-11" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb785-12"><a href="LinearRegressionAndANOVA.html#cb785-12" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb785-13"><a href="LinearRegressionAndANOVA.html#cb785-13" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.166885   0.007078    23.6   &lt;2e-16 ***</span></span>
<span id="cb785-14"><a href="LinearRegressionAndANOVA.html#cb785-14" tabindex="-1"></a><span class="co">#&gt; x           -0.001465   0.000116   -12.6   &lt;2e-16 ***</span></span>
<span id="cb785-15"><a href="LinearRegressionAndANOVA.html#cb785-15" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb785-16"><a href="LinearRegressionAndANOVA.html#cb785-16" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb785-17"><a href="LinearRegressionAndANOVA.html#cb785-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb785-18"><a href="LinearRegressionAndANOVA.html#cb785-18" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.0291 on 89 degrees of freedom</span></span>
<span id="cb785-19"><a href="LinearRegressionAndANOVA.html#cb785-19" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.641,  Adjusted R-squared:  0.637 </span></span>
<span id="cb785-20"><a href="LinearRegressionAndANOVA.html#cb785-20" tabindex="-1"></a><span class="co">#&gt; F-statistic:  159 on 1 and 89 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>When plotting the residuals against the fitted values, we get a clue
that something is wrong. We can get a <code>ggplot</code> residual plot using the <code>broom</code> library. The <code>augment</code> function from <code>broom</code> will put our residuals (and other things) into a data frame for easier plotting. Then we can use <code>ggplot</code> to plot:</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="LinearRegressionAndANOVA.html#cb786-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb786-2"><a href="LinearRegressionAndANOVA.html#cb786-2" tabindex="-1"></a>augmented_m <span class="ot">&lt;-</span> <span class="fu">augment</span>(m)</span>
<span id="cb786-3"><a href="LinearRegressionAndANOVA.html#cb786-3" tabindex="-1"></a></span>
<span id="cb786-4"><a href="LinearRegressionAndANOVA.html#cb786-4" tabindex="-1"></a><span class="fu">ggplot</span>(augmented_m, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb786-5"><a href="LinearRegressionAndANOVA.html#cb786-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fitplot1"></span>
<img src="11_LinearRegression_files/figure-html/fitplot1-1.png" alt="Fitted values versus residuals" width="85%" />
<p class="caption">
Figure 11.2: Fitted values versus residuals
</p>
</div>
<p>If you just need a fast peek at the residual plot and donât care if the result is a <code>ggplot</code> figure, you can use Base Râs <code>plot</code> method on the model object, <code>m</code>:</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="LinearRegressionAndANOVA.html#cb787-1" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="at">which =</span> <span class="dv">1</span>)  <span class="co"># which = 1 plots only the fitted vs residuals</span></span></code></pre></div>
<p>We can see in Figure <a href="LinearRegressionAndANOVA.html#fig:fitplot1">11.2</a> that this plot has a clear parabolic
shape. A possible fix is a power transformation on <em>y</em>, so we run the
BoxâCox procedure:</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="LinearRegressionAndANOVA.html#cb788-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb788-2"><a href="LinearRegressionAndANOVA.html#cb788-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb788-3"><a href="LinearRegressionAndANOVA.html#cb788-3" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;MASS&#39;</span></span>
<span id="cb788-4"><a href="LinearRegressionAndANOVA.html#cb788-4" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:patchwork&#39;:</span></span>
<span id="cb788-5"><a href="LinearRegressionAndANOVA.html#cb788-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb788-6"><a href="LinearRegressionAndANOVA.html#cb788-6" tabindex="-1"></a><span class="co">#&gt;     area</span></span>
<span id="cb788-7"><a href="LinearRegressionAndANOVA.html#cb788-7" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb788-8"><a href="LinearRegressionAndANOVA.html#cb788-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb788-9"><a href="LinearRegressionAndANOVA.html#cb788-9" tabindex="-1"></a><span class="co">#&gt;     select</span></span>
<span id="cb788-10"><a href="LinearRegressionAndANOVA.html#cb788-10" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(m)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxcox"></span>
<img src="11_LinearRegression_files/figure-html/boxcox-1.png" alt="Output of boxcox on the model (m)" width="85%" />
<p class="caption">
Figure 11.3: Output of boxcox on the model (m)
</p>
</div>
<p>The <code>boxcox</code> function plots values
of <em>Î»</em> against the log-likelihood of the resulting model, as shown in Figure <a href="LinearRegressionAndANOVA.html#fig:boxcox">11.3</a>. We want to
maximize that log-likelihood, so the function draws a line at the best
value and also draws lines at the limits of its confidence interval. In
this case, it looks like the best value is around â1.5, with a
confidence interval of about (â1.75, â1.25).</p>
<p>Oddly, the <code>boxcox</code> function does not return the best value of <em>Î»</em>.
Rather, it returns the (<em>x</em>, <em>y</em>) pairs displayed in the plot. Itâs
pretty easy to find the values of <em>Î»</em> that yield the largest
log-likelihood <em>y</em>. We use the <code>which.max</code> function:</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="LinearRegressionAndANOVA.html#cb789-1" tabindex="-1"></a><span class="fu">which.max</span>(bc<span class="sc">$</span>y)</span>
<span id="cb789-2"><a href="LinearRegressionAndANOVA.html#cb789-2" tabindex="-1"></a><span class="co">#&gt; [1] 13</span></span></code></pre></div>
<p>Then this gives us the position of the corresponding <em>Î»</em>:</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="LinearRegressionAndANOVA.html#cb790-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> bc<span class="sc">$</span>x[<span class="fu">which.max</span>(bc<span class="sc">$</span>y)]</span>
<span id="cb790-2"><a href="LinearRegressionAndANOVA.html#cb790-2" tabindex="-1"></a>lambda</span>
<span id="cb790-3"><a href="LinearRegressionAndANOVA.html#cb790-3" tabindex="-1"></a><span class="co">#&gt; [1] -1.52</span></span></code></pre></div>
<p>The function reports that the best <em>Î»</em> is â1.52. In an actual
application, we would urge you to interpret this number and choose the
power that makes sense to youârather than blindly accepting this âbestâ
value. Use the graph to assist you in that interpretation. Here, weâll go
with â1.52.</p>
<p>We can apply the power transform to <em>y</em> and then fit the revised model;
this gives a much better <em>R</em><sup>2</sup> of 0.967:</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="LinearRegressionAndANOVA.html#cb791-1" tabindex="-1"></a>z <span class="ot">&lt;-</span> y <span class="sc">^</span> lambda</span>
<span id="cb791-2"><a href="LinearRegressionAndANOVA.html#cb791-2" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(z <span class="sc">~</span> x)</span>
<span id="cb791-3"><a href="LinearRegressionAndANOVA.html#cb791-3" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb791-4"><a href="LinearRegressionAndANOVA.html#cb791-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb791-5"><a href="LinearRegressionAndANOVA.html#cb791-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb791-6"><a href="LinearRegressionAndANOVA.html#cb791-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = z ~ x)</span></span>
<span id="cb791-7"><a href="LinearRegressionAndANOVA.html#cb791-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb791-8"><a href="LinearRegressionAndANOVA.html#cb791-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb791-9"><a href="LinearRegressionAndANOVA.html#cb791-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb791-10"><a href="LinearRegressionAndANOVA.html#cb791-10" tabindex="-1"></a><span class="co">#&gt; -13.459  -3.711  -0.228   2.206  14.188 </span></span>
<span id="cb791-11"><a href="LinearRegressionAndANOVA.html#cb791-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb791-12"><a href="LinearRegressionAndANOVA.html#cb791-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb791-13"><a href="LinearRegressionAndANOVA.html#cb791-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb791-14"><a href="LinearRegressionAndANOVA.html#cb791-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.6426     1.2517   -0.51     0.61    </span></span>
<span id="cb791-15"><a href="LinearRegressionAndANOVA.html#cb791-15" tabindex="-1"></a><span class="co">#&gt; x             1.0514     0.0205   51.20   &lt;2e-16 ***</span></span>
<span id="cb791-16"><a href="LinearRegressionAndANOVA.html#cb791-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb791-17"><a href="LinearRegressionAndANOVA.html#cb791-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb791-18"><a href="LinearRegressionAndANOVA.html#cb791-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb791-19"><a href="LinearRegressionAndANOVA.html#cb791-19" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 5.15 on 89 degrees of freedom</span></span>
<span id="cb791-20"><a href="LinearRegressionAndANOVA.html#cb791-20" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.967,  Adjusted R-squared:  0.967 </span></span>
<span id="cb791-21"><a href="LinearRegressionAndANOVA.html#cb791-21" tabindex="-1"></a><span class="co">#&gt; F-statistic: 2.62e+03 on 1 and 89 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>For those who prefer one-liners, the transformation can be embedded
right into the revised regression formula:</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="LinearRegressionAndANOVA.html#cb792-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(y <span class="sc">^</span> lambda) <span class="sc">~</span> x)</span></code></pre></div>
<p>By default, <code>boxcox</code> searches for values of <em>Î»</em> in the range â2 to +2.
You can change that via the <code>lambda</code> argument; see the help page for
details.</p>
<p>We suggest viewing the BoxâCox result as a starting point, not as a
definitive answer. If the confidence interval for <em>Î»</em> includes 1.0, it
may be that no power transformation is actually helpful. As always,
inspect the residuals before and after the transformation. Did they
really improve?</p>
<p>Compare Figure <a href="#fitplot"><strong>??</strong></a> (transformed data) with Figure <a href="#fitplot1"><strong>??</strong></a> (no transformation).</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="LinearRegressionAndANOVA.html#cb793-1" tabindex="-1"></a>augmented_m2 <span class="ot">&lt;-</span> <span class="fu">augment</span>(m2)</span>
<span id="cb793-2"><a href="LinearRegressionAndANOVA.html#cb793-2" tabindex="-1"></a></span>
<span id="cb793-3"><a href="LinearRegressionAndANOVA.html#cb793-3" tabindex="-1"></a><span class="fu">ggplot</span>(augmented_m2, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb793-4"><a href="LinearRegressionAndANOVA.html#cb793-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fitplot"></span>
<img src="11_LinearRegression_files/figure-html/fitplot-1.png" alt="Fitted values versus residuals: m2" width="85%" />
<p class="caption">
Figure 11.4: Fitted values versus residuals: m2
</p>
</div>
</div>
<div id="see_also-id210" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id210" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipes @ref(recipe-id208,) <a href="LinearRegressionAndANOVA.html#recipe-id208">âRegressing on Transformed Dataâ</a>, and <a href="LinearRegressionAndANOVA.html#recipe-id212">11.16</a>,
<a href="LinearRegressionAndANOVA.html#recipe-id212">âDiagnosing a Linear Regressionâ</a>.</p>
</div>
</div>
<div id="recipe-id211" class="section level2 hasAnchor" number="11.14">
<h2><span class="header-section-number">11.14</span> Forming Confidence Intervals for Regression Coefficients<a href="LinearRegressionAndANOVA.html#recipe-id211" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id211" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id211" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You are performing linear regression and you need the confidence
intervals for the regression coefficients.</p>
</div>
<div id="solution-id211" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id211" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Save the regression model in an object; then use the <code>confint</code> function
to extract confidence intervals:</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="LinearRegressionAndANOVA.html#cb794-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/conf.rdata&#39;</span>)</span>
<span id="cb794-2"><a href="LinearRegressionAndANOVA.html#cb794-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb794-3"><a href="LinearRegressionAndANOVA.html#cb794-3" tabindex="-1"></a><span class="fu">confint</span>(m)</span>
<span id="cb794-4"><a href="LinearRegressionAndANOVA.html#cb794-4" tabindex="-1"></a><span class="co">#&gt;             2.5 % 97.5 %</span></span>
<span id="cb794-5"><a href="LinearRegressionAndANOVA.html#cb794-5" tabindex="-1"></a><span class="co">#&gt; (Intercept) -3.90   6.47</span></span>
<span id="cb794-6"><a href="LinearRegressionAndANOVA.html#cb794-6" tabindex="-1"></a><span class="co">#&gt; x1          -2.58   6.24</span></span>
<span id="cb794-7"><a href="LinearRegressionAndANOVA.html#cb794-7" tabindex="-1"></a><span class="co">#&gt; x2           4.67   5.17</span></span></code></pre></div>
</div>
<div id="discussion-id211" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id211" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Solution uses the model <em>y</em> = <em>Î²</em><sub>0</sub> + <em>Î²</em><sub>1</sub>(<em>x</em><sub>1</sub>)<sub><em>i</em></sub> +
<em>Î²</em><sub>2</sub>(<em>x</em><sub>2</sub>)<sub><em>i</em></sub> + <em>Îµ</em><sub>i</sub>. The <code>confint</code> function returns the
confidence intervals for the intercept (<em>Î²</em><sub>0</sub>), the coefficient of
<em>x</em><sub>1</sub> (<em>Î²</em><sub>1</sub>), and the coefficient of <em>x</em><sub>2</sub> (<em>Î²</em><sub>2</sub>):</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="LinearRegressionAndANOVA.html#cb795-1" tabindex="-1"></a><span class="fu">confint</span>(m)</span>
<span id="cb795-2"><a href="LinearRegressionAndANOVA.html#cb795-2" tabindex="-1"></a><span class="co">#&gt;             2.5 % 97.5 %</span></span>
<span id="cb795-3"><a href="LinearRegressionAndANOVA.html#cb795-3" tabindex="-1"></a><span class="co">#&gt; (Intercept) -3.90   6.47</span></span>
<span id="cb795-4"><a href="LinearRegressionAndANOVA.html#cb795-4" tabindex="-1"></a><span class="co">#&gt; x1          -2.58   6.24</span></span>
<span id="cb795-5"><a href="LinearRegressionAndANOVA.html#cb795-5" tabindex="-1"></a><span class="co">#&gt; x2           4.67   5.17</span></span></code></pre></div>
<p>By default, <code>confint</code> uses a confidence level of 95%. Use the <code>level</code>
parameter to select a different level:</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="LinearRegressionAndANOVA.html#cb796-1" tabindex="-1"></a><span class="fu">confint</span>(m, <span class="at">level =</span> <span class="fl">0.99</span>)</span>
<span id="cb796-2"><a href="LinearRegressionAndANOVA.html#cb796-2" tabindex="-1"></a><span class="co">#&gt;             0.5 % 99.5 %</span></span>
<span id="cb796-3"><a href="LinearRegressionAndANOVA.html#cb796-3" tabindex="-1"></a><span class="co">#&gt; (Intercept) -5.72   8.28</span></span>
<span id="cb796-4"><a href="LinearRegressionAndANOVA.html#cb796-4" tabindex="-1"></a><span class="co">#&gt; x1          -4.12   7.79</span></span>
<span id="cb796-5"><a href="LinearRegressionAndANOVA.html#cb796-5" tabindex="-1"></a><span class="co">#&gt; x2           4.58   5.26</span></span></code></pre></div>
</div>
<div id="see_also-id211" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id211" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>coefplot</code> function of the <code>arm</code> package can plot confidence
intervals for regression coefficients.</p>
</div>
</div>
<div id="recipe-id216" class="section level2 hasAnchor" number="11.15">
<h2><span class="header-section-number">11.15</span> Plotting Regression Residuals<a href="LinearRegressionAndANOVA.html#recipe-id216" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id216" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id216" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want a visual display of your regression residuals.</p>
</div>
<div id="solution-id216" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id216" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can plot the model object by using <code>broom</code> to put model results in a data frame, then plot with <code>ggplot</code>:</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="LinearRegressionAndANOVA.html#cb797-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb797-2"><a href="LinearRegressionAndANOVA.html#cb797-2" tabindex="-1"></a></span>
<span id="cb797-3"><a href="LinearRegressionAndANOVA.html#cb797-3" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb797-4"><a href="LinearRegressionAndANOVA.html#cb797-4" tabindex="-1"></a>augmented_m <span class="ot">&lt;-</span> <span class="fu">augment</span>(m)</span>
<span id="cb797-5"><a href="LinearRegressionAndANOVA.html#cb797-5" tabindex="-1"></a></span>
<span id="cb797-6"><a href="LinearRegressionAndANOVA.html#cb797-6" tabindex="-1"></a><span class="fu">ggplot</span>(augmented_m, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb797-7"><a href="LinearRegressionAndANOVA.html#cb797-7" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</div>
<div id="discussion-id216" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id216" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the linear model <code>m</code> from the prior recipe, we can create a simply residual plot:</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="LinearRegressionAndANOVA.html#cb798-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb798-2"><a href="LinearRegressionAndANOVA.html#cb798-2" tabindex="-1"></a>augmented_m <span class="ot">&lt;-</span> <span class="fu">augment</span>(m)</span>
<span id="cb798-3"><a href="LinearRegressionAndANOVA.html#cb798-3" tabindex="-1"></a></span>
<span id="cb798-4"><a href="LinearRegressionAndANOVA.html#cb798-4" tabindex="-1"></a><span class="fu">ggplot</span>(augmented_m, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb798-5"><a href="LinearRegressionAndANOVA.html#cb798-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:residualplot"></span>
<img src="11_LinearRegression_files/figure-html/residualplot-1.png" alt="Model residual plot" width="85%" />
<p class="caption">
Figure 11.5: Model residual plot
</p>
</div>
<p>The output is shown in Figure <a href="LinearRegressionAndANOVA.html#fig:residualplot">11.5</a>.</p>
<p>You could also use the Base R <code>plot</code> method to get a quick peek, but it will produce Base R graphics output, instead of <code>ggplot</code>:</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="LinearRegressionAndANOVA.html#cb799-1" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="at">which =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="see_also-id216" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id216" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id212">11.16</a>, <a href="LinearRegressionAndANOVA.html#recipe-id212">âDiagnosing a Linear Regressionâ</a>, which contains
examples of residuals plots and other diagnostic plots.</p>
</div>
</div>
<div id="recipe-id212" class="section level2 hasAnchor" number="11.16">
<h2><span class="header-section-number">11.16</span> Diagnosing a Linear Regression<a href="LinearRegressionAndANOVA.html#recipe-id212" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id212" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id212" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have performed a linear regression. Now you want to verify the
modelâs quality by running diagnostic checks.</p>
</div>
<div id="solution-id212" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id212" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Start by plotting the model object, which will produce several
diagnostic plots using Base R graphics:</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="LinearRegressionAndANOVA.html#cb800-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb800-2"><a href="LinearRegressionAndANOVA.html#cb800-2" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code></pre></div>
<p>Next, identify possible outliers either by looking at the diagnostic
plot of the residuals or by using the <code>outlierTest</code> function of the
<code>car</code> package:</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="LinearRegressionAndANOVA.html#cb801-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb801-2"><a href="LinearRegressionAndANOVA.html#cb801-2" tabindex="-1"></a><span class="fu">outlierTest</span>(m)</span></code></pre></div>
<p>Finally, identify any overly influential observations. See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id233">11.17</a>, <a href="LinearRegressionAndANOVA.html#recipe-id233">âIdentifying Influential Observationsâ</a>.</p>
</div>
<div id="discussion-id212" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id212" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R fosters the impression that linear regression is easy: just use the
<code>lm</code> function. Yet fitting the data is only the beginning. Itâs your job
to decide whether the fitted model actually works and works well.</p>
<p>Before anything else, you must have a statistically significant model.
Check the <em>F</em> statistic from the model summary
(Recipe <a href="LinearRegressionAndANOVA.html#recipe-id240">11.4</a>, <a href="LinearRegressionAndANOVA.html#recipe-id240">âUnderstanding the Regression Summaryâ</a>) and be sure that
the <em>p</em>-value is small enough for your purposes. Conventionally, it
should be less than 0.05 or else your model is likely not very meaningful.</p>
<p>Simply plotting the model object produces several useful diagnostic
plots, shown in Figure <a href="LinearRegressionAndANOVA.html#fig:goodfit">11.6</a>:</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="LinearRegressionAndANOVA.html#cb802-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb802-2"><a href="LinearRegressionAndANOVA.html#cb802-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> (<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))) <span class="co"># this gives us a 2x2 plot</span></span>
<span id="cb802-3"><a href="LinearRegressionAndANOVA.html#cb802-3" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:goodfit"></span>
<img src="11_LinearRegression_files/figure-html/goodfit-1.png" alt="Diagnostics of a good fit" width="85%" />
<p class="caption">
Figure 11.6: Diagnostics of a good fit
</p>
</div>
<p>Figure <a href="LinearRegressionAndANOVA.html#fig:goodfit">11.6</a> shows diagnostic
plots for a pretty good regression:</p>
<ul>
<li><p>The points in the Residuals vs Fitted plot are randomly scattered
with no particular pattern.</p></li>
<li><p>The points in the normal QâQ plot are more or less on the line,
indicating that the residuals follow a normal distribution.</p></li>
<li><p>In both the ScaleâLocation plot and the Residuals vs Leverage plots,
the points are in a group with none too far from the center.</p></li>
</ul>
<p>In contrast, the series of graphs shown in Figure <a href="LinearRegressionAndANOVA.html#fig:badfit">11.7</a> show
the diagnostics for a not-so-good regression:</p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="LinearRegressionAndANOVA.html#cb803-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/bad.rdata&#39;</span>)</span>
<span id="cb803-2"><a href="LinearRegressionAndANOVA.html#cb803-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2 <span class="sc">~</span> x3 <span class="sc">+</span> x4)</span>
<span id="cb803-3"><a href="LinearRegressionAndANOVA.html#cb803-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> (<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)))      <span class="co"># this gives us a 2x2 plot</span></span>
<span id="cb803-4"><a href="LinearRegressionAndANOVA.html#cb803-4" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:badfit"></span>
<img src="11_LinearRegression_files/figure-html/badfit-1.png" alt="Diagnostics of a poor fit" width="85%" />
<p class="caption">
Figure 11.7: Diagnostics of a poor fit
</p>
</div>
<p>Observe that the Residuals
vs Fitted plot has a definite parabolic shape. This tells us that the
model is incomplete: a quadratic factor is missing that could explain
more variation in <em>y</em>. Other patterns in residuals would be suggestive of
additional problems: a cone shape, for example, may indicate nonconstant
variance in <em>y</em>. Interpreting those patterns is a bit of an art, so we
suggest reviewing a good book on linear regression while evaluating the
plot of residuals.</p>
<p>There are other problems with these not-so-good diagnostics. The normal
QâQ plot has more points off the line than it does for the good
regression. Both the ScaleâLocation and Residuals vs Leverage plots show
points scattered away from the center, which suggests that some points
have excessive leverage.</p>
<p>Another pattern is that point number 28 sticks out in every plot. This
warns us that something is odd with that observation. The point could be
an outlier, for example. We can check that hunch with the <code>outlierTest</code>
function of the <code>car</code> package:</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="LinearRegressionAndANOVA.html#cb804-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb804-2"><a href="LinearRegressionAndANOVA.html#cb804-2" tabindex="-1"></a><span class="fu">outlierTest</span>(m)</span>
<span id="cb804-3"><a href="LinearRegressionAndANOVA.html#cb804-3" tabindex="-1"></a><span class="co">#&gt;    rstudent unadjusted p-value Bonferroni p</span></span>
<span id="cb804-4"><a href="LinearRegressionAndANOVA.html#cb804-4" tabindex="-1"></a><span class="co">#&gt; 28     4.46           7.76e-05       0.0031</span></span></code></pre></div>
<p>The <code>outlierTest</code> identifies the modelâs most outlying observation. In
this case, it identified observation number 28 and so confirmed that it
could be an outlier.</p>
</div>
<div id="see_also-id212" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id212" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipes <a href="LinearRegressionAndANOVA.html#recipe-id240">11.4</a>, <a href="LinearRegressionAndANOVA.html#recipe-id240">âUnderstanding the Regression Summaryâ</a>, and <a href="LinearRegressionAndANOVA.html#recipe-id233">11.17</a>, <a href="LinearRegressionAndANOVA.html#recipe-id233">âIdentifying Influential Observationsâ</a>. The <code>car</code> package
is not part of the standard distribution of R; see Recipe <a href="NavigatingTheSoftware.html#recipe-id012">3.10</a>, <a href="NavigatingTheSoftware.html#recipe-id012">âInstalling Packages from CRANâ</a>.</p>
</div>
</div>
<div id="recipe-id233" class="section level2 hasAnchor" number="11.17">
<h2><span class="header-section-number">11.17</span> Identifying Influential Observations<a href="LinearRegressionAndANOVA.html#recipe-id233" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id233" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id233" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to identify the observations that are having the most influence
on the regression model. This is useful for diagnosing possible problems
with the data.</p>
</div>
<div id="solution-id233" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id233" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>influence.measures</code> function reports several useful statistics for
identifying influential observations, and it flags the significant ones
with an asterisk (<code>*</code>). Its main argument is the model object from your
regression:</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="LinearRegressionAndANOVA.html#cb805-1" tabindex="-1"></a><span class="fu">influence.measures</span>(m)</span></code></pre></div>
</div>
<div id="discussion-id233" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id233" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The title of this recipe could be âIdentifying <em>Overly</em> Influential
Observations,â but that would be redundant. All observations influence
the regression model, even if only a little. When a statistician says
that an observation is influential, it means that removing the
observation would significantly change the fitted regression model. We
want to identify those observations because they might be outliers that
distort our model; we owe it to ourselves to investigate them.</p>
<p>The <code>influence.measures</code> function reports several statistics: DFBETAS,
DFFITS, covariance ratio, Cookâs distance, and hat matrix values. If any
of these measures indicate that an observation is influential, the
function flags that observation with an asterisk (<code>*</code>) along the
righthand side:</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="LinearRegressionAndANOVA.html#cb806-1" tabindex="-1"></a><span class="fu">influence.measures</span>(m)</span>
<span id="cb806-2"><a href="LinearRegressionAndANOVA.html#cb806-2" tabindex="-1"></a><span class="co">#&gt; Influence measures of</span></span>
<span id="cb806-3"><a href="LinearRegressionAndANOVA.html#cb806-3" tabindex="-1"></a><span class="co">#&gt;   lm(formula = y2 ~ x3 + x4) :</span></span>
<span id="cb806-4"><a href="LinearRegressionAndANOVA.html#cb806-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb806-5"><a href="LinearRegressionAndANOVA.html#cb806-5" tabindex="-1"></a><span class="co">#&gt;      dfb.1_   dfb.x3   dfb.x4    dffit cov.r   cook.d    hat inf</span></span>
<span id="cb806-6"><a href="LinearRegressionAndANOVA.html#cb806-6" tabindex="-1"></a><span class="co">#&gt; 1  -0.18784  0.15174  0.07081 -0.22344 1.059 1.67e-02 0.0506    </span></span>
<span id="cb806-7"><a href="LinearRegressionAndANOVA.html#cb806-7" tabindex="-1"></a><span class="co">#&gt; 2   0.27637 -0.04367 -0.39042  0.45416 1.027 6.71e-02 0.0964    </span></span>
<span id="cb806-8"><a href="LinearRegressionAndANOVA.html#cb806-8" tabindex="-1"></a><span class="co">#&gt; 3  -0.01775 -0.02786  0.01088 -0.03876 1.175 5.15e-04 0.0772    </span></span>
<span id="cb806-9"><a href="LinearRegressionAndANOVA.html#cb806-9" tabindex="-1"></a><span class="co">#&gt; 4   0.15922 -0.14322  0.25615  0.35766 1.133 4.27e-02 0.1156    </span></span>
<span id="cb806-10"><a href="LinearRegressionAndANOVA.html#cb806-10" tabindex="-1"></a><span class="co">#&gt; 5  -0.10537  0.00814 -0.06368 -0.13175 1.078 5.87e-03 0.0335    </span></span>
<span id="cb806-11"><a href="LinearRegressionAndANOVA.html#cb806-11" tabindex="-1"></a><span class="co">#&gt; 6   0.16942  0.07465  0.42467  0.48572 1.034 7.66e-02 0.1062    </span></span>
<span id="cb806-12"><a href="LinearRegressionAndANOVA.html#cb806-12" tabindex="-1"></a><span class="co">#&gt; 7  -0.10128 -0.05936  0.01661 -0.13021 1.078 5.73e-03 0.0333    </span></span>
<span id="cb806-13"><a href="LinearRegressionAndANOVA.html#cb806-13" tabindex="-1"></a><span class="co">#&gt; 8  -0.15696  0.04801  0.01441 -0.15827 1.038 8.38e-03 0.0276    </span></span>
<span id="cb806-14"><a href="LinearRegressionAndANOVA.html#cb806-14" tabindex="-1"></a><span class="co">#&gt; 9  -0.04582 -0.12089 -0.01032 -0.14010 1.188 6.69e-03 0.0995    </span></span>
<span id="cb806-15"><a href="LinearRegressionAndANOVA.html#cb806-15" tabindex="-1"></a><span class="co">#&gt; 10 -0.01901  0.00624  0.01740 -0.02416 1.147 2.00e-04 0.0544    </span></span>
<span id="cb806-16"><a href="LinearRegressionAndANOVA.html#cb806-16" tabindex="-1"></a><span class="co">#&gt; 11 -0.06725 -0.01214  0.04382 -0.08174 1.113 2.28e-03 0.0381    </span></span>
<span id="cb806-17"><a href="LinearRegressionAndANOVA.html#cb806-17" tabindex="-1"></a><span class="co">#&gt; 12  0.17580  0.35102  0.62952  0.74889 0.961 1.75e-01 0.1406    </span></span>
<span id="cb806-18"><a href="LinearRegressionAndANOVA.html#cb806-18" tabindex="-1"></a><span class="co">#&gt; 13 -0.14288  0.06667  0.06786 -0.15451 1.071 8.04e-03 0.0372    </span></span>
<span id="cb806-19"><a href="LinearRegressionAndANOVA.html#cb806-19" tabindex="-1"></a><span class="co">#&gt; 14 -0.02784  0.02366 -0.02727 -0.04790 1.173 7.85e-04 0.0767    </span></span>
<span id="cb806-20"><a href="LinearRegressionAndANOVA.html#cb806-20" tabindex="-1"></a><span class="co">#&gt; 15  0.01934  0.03440 -0.01575  0.04729 1.197 7.66e-04 0.0944    </span></span>
<span id="cb806-21"><a href="LinearRegressionAndANOVA.html#cb806-21" tabindex="-1"></a><span class="co">#&gt; 16  0.35521 -0.53827 -0.44441  0.68457 1.294 1.55e-01 0.2515   *</span></span>
<span id="cb806-22"><a href="LinearRegressionAndANOVA.html#cb806-22" tabindex="-1"></a><span class="co">#&gt; 17 -0.09184 -0.07199  0.01456 -0.13057 1.089 5.77e-03 0.0381    </span></span>
<span id="cb806-23"><a href="LinearRegressionAndANOVA.html#cb806-23" tabindex="-1"></a><span class="co">#&gt; 18 -0.05807 -0.00534 -0.05725 -0.08825 1.119 2.66e-03 0.0433    </span></span>
<span id="cb806-24"><a href="LinearRegressionAndANOVA.html#cb806-24" tabindex="-1"></a><span class="co">#&gt; 19  0.00288  0.00438  0.00511  0.00761 1.176 1.99e-05 0.0770    </span></span>
<span id="cb806-25"><a href="LinearRegressionAndANOVA.html#cb806-25" tabindex="-1"></a><span class="co">#&gt; 20  0.08795  0.06854  0.19526  0.23490 1.136 1.86e-02 0.0884    </span></span>
<span id="cb806-26"><a href="LinearRegressionAndANOVA.html#cb806-26" tabindex="-1"></a><span class="co">#&gt; 21  0.22148  0.42533 -0.33557  0.64699 1.047 1.34e-01 0.1471    </span></span>
<span id="cb806-27"><a href="LinearRegressionAndANOVA.html#cb806-27" tabindex="-1"></a><span class="co">#&gt; 22  0.20974 -0.19946  0.36117  0.49631 1.085 8.06e-02 0.1275    </span></span>
<span id="cb806-28"><a href="LinearRegressionAndANOVA.html#cb806-28" tabindex="-1"></a><span class="co">#&gt; 23 -0.03333 -0.05436  0.01568 -0.07316 1.167 1.83e-03 0.0747    </span></span>
<span id="cb806-29"><a href="LinearRegressionAndANOVA.html#cb806-29" tabindex="-1"></a><span class="co">#&gt; 24 -0.04534 -0.12827 -0.03282 -0.14844 1.189 7.51e-03 0.1016    </span></span>
<span id="cb806-30"><a href="LinearRegressionAndANOVA.html#cb806-30" tabindex="-1"></a><span class="co">#&gt; 25 -0.11334  0.00112 -0.05748 -0.13580 1.067 6.22e-03 0.0307    </span></span>
<span id="cb806-31"><a href="LinearRegressionAndANOVA.html#cb806-31" tabindex="-1"></a><span class="co">#&gt; 26 -0.23215  0.37364  0.16153 -0.41638 1.258 5.82e-02 0.1883   *</span></span>
<span id="cb806-32"><a href="LinearRegressionAndANOVA.html#cb806-32" tabindex="-1"></a><span class="co">#&gt; 27  0.29815  0.01963 -0.43678  0.51616 0.990 8.55e-02 0.0986    </span></span>
<span id="cb806-33"><a href="LinearRegressionAndANOVA.html#cb806-33" tabindex="-1"></a><span class="co">#&gt; 28  0.83069 -0.50577 -0.35404  0.92249 0.303 1.88e-01 0.0411   *</span></span>
<span id="cb806-34"><a href="LinearRegressionAndANOVA.html#cb806-34" tabindex="-1"></a><span class="co">#&gt; 29 -0.09920 -0.07828 -0.02499 -0.14292 1.077 6.89e-03 0.0361    </span></span>
<span id="cb806-35"><a href="LinearRegressionAndANOVA.html#cb806-35" tabindex="-1"></a>etc ...</span></code></pre></div>
<p>This is the model from Recipe <a href="LinearRegressionAndANOVA.html#recipe-id212">11.16</a>, <a href="LinearRegressionAndANOVA.html#recipe-id212">âDiagnosing a Linear Regressionâ</a>,
where we suspected that observation 28 was an outlier. An asterisk is
flagging that observation, confirming that itâs overly influential.</p>
<p>This recipe can identify influential observations, but you shouldnât
reflexively delete them. Some judgment is required here. Are those
observations improving your model or damaging it?</p>
</div>
<div id="see_also-id233" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id233" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id212">11.16</a>, <a href="LinearRegressionAndANOVA.html#recipe-id212">âDiagnosing a Linear Regressionâ</a>. Use
<code>help(influence.measures)</code> to get a list of influence measures and some
related functions. See a regression textbook for interpretations of the
various influence measures.</p>
</div>
</div>
<div id="recipe-id213" class="section level2 hasAnchor" number="11.18">
<h2><span class="header-section-number">11.18</span> Testing Residuals for Autocorrelation (DurbinâWatson Test)<a href="LinearRegressionAndANOVA.html#recipe-id213" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id213" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id213" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have performed a linear regression and want to check the residuals
for autocorrelation.</p>
</div>
<div id="solution-id213" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id213" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The DurbinâWatson test can check the residuals for autocorrelation. The
test is implemented by the <code>dwtest</code> function of the <code>lmtest</code> package:</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="LinearRegressionAndANOVA.html#cb807-1" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb807-2"><a href="LinearRegressionAndANOVA.html#cb807-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)           <span class="co"># Create a model object</span></span>
<span id="cb807-3"><a href="LinearRegressionAndANOVA.html#cb807-3" tabindex="-1"></a><span class="fu">dwtest</span>(m)                <span class="co"># Test the model residuals</span></span></code></pre></div>
<p>The output includes a <em>p</em>-value. Conventionally, if <em>p</em> &lt; 0.05 then
the residuals are significantly correlated, whereas <em>p</em> &gt; 0.05
provides no evidence of correlation.</p>
<p>You can perform a visual check for autocorrelation by graphing the
<em>autocorrelation function</em> (ACF) of the residuals:</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="LinearRegressionAndANOVA.html#cb808-1" tabindex="-1"></a><span class="fu">acf</span>(m)                   <span class="co"># Plot the ACF of the model residuals</span></span></code></pre></div>
</div>
<div id="discussion-id213" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id213" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The DurbinâWatson test is often used in time series analysis, but it was
originally created for diagnosing autocorrelation in regression
residuals. Autocorrelation in the residuals is a scourge because it
distorts the regression statistics, such as the <em>F</em> statistic and the
<em>t</em> statistics for the regression coefficients. The presence of
autocorrelation suggests that your model is missing a useful predictor
variable or that it should include a time series component, such as a
trend or a seasonal indicator.</p>
<p>This first example builds a simple regression model and then tests the
residuals for autocorrelation. The test returns a <em>p</em>-value well above zero,
which indicates that there is no significant autocorrelation:</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="LinearRegressionAndANOVA.html#cb809-1" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb809-2"><a href="LinearRegressionAndANOVA.html#cb809-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: zoo</span></span>
<span id="cb809-3"><a href="LinearRegressionAndANOVA.html#cb809-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb809-4"><a href="LinearRegressionAndANOVA.html#cb809-4" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;zoo&#39;</span></span>
<span id="cb809-5"><a href="LinearRegressionAndANOVA.html#cb809-5" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb809-6"><a href="LinearRegressionAndANOVA.html#cb809-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb809-7"><a href="LinearRegressionAndANOVA.html#cb809-7" tabindex="-1"></a><span class="co">#&gt;     as.Date, as.Date.numeric</span></span>
<span id="cb809-8"><a href="LinearRegressionAndANOVA.html#cb809-8" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/ac.rdata&#39;</span>)</span>
<span id="cb809-9"><a href="LinearRegressionAndANOVA.html#cb809-9" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1 <span class="sc">~</span> x)</span>
<span id="cb809-10"><a href="LinearRegressionAndANOVA.html#cb809-10" tabindex="-1"></a><span class="fu">dwtest</span>(m)</span>
<span id="cb809-11"><a href="LinearRegressionAndANOVA.html#cb809-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb809-12"><a href="LinearRegressionAndANOVA.html#cb809-12" tabindex="-1"></a><span class="co">#&gt;  Durbin-Watson test</span></span>
<span id="cb809-13"><a href="LinearRegressionAndANOVA.html#cb809-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb809-14"><a href="LinearRegressionAndANOVA.html#cb809-14" tabindex="-1"></a><span class="co">#&gt; data:  m</span></span>
<span id="cb809-15"><a href="LinearRegressionAndANOVA.html#cb809-15" tabindex="-1"></a><span class="co">#&gt; DW = 2, p-value = 0.4</span></span>
<span id="cb809-16"><a href="LinearRegressionAndANOVA.html#cb809-16" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true autocorrelation is greater than 0</span></span></code></pre></div>
<p>This second example exhibits autocorrelation in the residuals. The
<em>p</em>-value is near zero, so the autocorrelation is likely positive:</p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="LinearRegressionAndANOVA.html#cb810-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2 <span class="sc">~</span> x)</span>
<span id="cb810-2"><a href="LinearRegressionAndANOVA.html#cb810-2" tabindex="-1"></a><span class="fu">dwtest</span>(m)</span>
<span id="cb810-3"><a href="LinearRegressionAndANOVA.html#cb810-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb810-4"><a href="LinearRegressionAndANOVA.html#cb810-4" tabindex="-1"></a><span class="co">#&gt;  Durbin-Watson test</span></span>
<span id="cb810-5"><a href="LinearRegressionAndANOVA.html#cb810-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb810-6"><a href="LinearRegressionAndANOVA.html#cb810-6" tabindex="-1"></a><span class="co">#&gt; data:  m</span></span>
<span id="cb810-7"><a href="LinearRegressionAndANOVA.html#cb810-7" tabindex="-1"></a><span class="co">#&gt; DW = 2, p-value = 0.01</span></span>
<span id="cb810-8"><a href="LinearRegressionAndANOVA.html#cb810-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true autocorrelation is greater than 0</span></span></code></pre></div>
<p>By default, <code>dwtest</code> performs a one-sided test and answers this
question: Is the autocorrelation of the residuals greater than zero? If
your model could exhibit negative autocorrelation (yes, that is
possible), then you should use the <code>alternative</code> option to perform a
two-sided test:</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="LinearRegressionAndANOVA.html#cb811-1" tabindex="-1"></a><span class="fu">dwtest</span>(m, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<p>The DurbinâWatson test is also implemented by the <code>durbinWatsonTest</code>
function of the <code>car</code> package. We suggested the <code>dwtest</code> function primarily
because we think the output is easier to read.</p>
</div>
<div id="see_also-id213" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id213" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Neither the <code>lmtest</code> package nor the <code>car</code> package is included in
the standard distribution of R; see Recipes <a href="NavigatingTheSoftware.html#recipe-id013">3.8</a>, <a href="NavigatingTheSoftware.html#recipe-id013">âAccessing the Functions in a Packageâ</a>, and <a href="NavigatingTheSoftware.html#recipe-id012">3.10</a>, <a href="NavigatingTheSoftware.html#recipe-id012">âInstalling Packages from CRANâ</a>. See Recipes <a href="TimeSeriesAnalysis.html#recipe-id082">14.13</a>, <a href="TimeSeriesAnalysis.html#recipe-id082">âPlotting the Autocorrelation Functionâ</a>, and <a href="TimeSeriesAnalysis.html#recipe-id084">14.16</a>,
<a href="TimeSeriesAnalysis.html#recipe-id084">âFinding Lagged Correlations Between Two Time Seriesâ</a>, for more regarding tests of autocorrelation.</p>
</div>
</div>
<div id="recipe-id214" class="section level2 hasAnchor" number="11.19">
<h2><span class="header-section-number">11.19</span> Predicting New Values<a href="LinearRegressionAndANOVA.html#recipe-id214" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id214" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id214" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to predict new values from your regression model.</p>
</div>
<div id="solution-id214" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id214" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Save the predictor data in a data frame. Use the <code>predict</code> function,
setting the <code>newdata</code> parameter to the data frame:</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="LinearRegressionAndANOVA.html#cb812-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/pred2.rdata&#39;</span>)</span>
<span id="cb812-2"><a href="LinearRegressionAndANOVA.html#cb812-2" tabindex="-1"></a></span>
<span id="cb812-3"><a href="LinearRegressionAndANOVA.html#cb812-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w)</span>
<span id="cb812-4"><a href="LinearRegressionAndANOVA.html#cb812-4" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">u =</span> <span class="fl">3.1</span>, <span class="at">v =</span> <span class="fl">4.0</span>, <span class="at">w =</span> <span class="fl">5.5</span>)</span>
<span id="cb812-5"><a href="LinearRegressionAndANOVA.html#cb812-5" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> preds)</span>
<span id="cb812-6"><a href="LinearRegressionAndANOVA.html#cb812-6" tabindex="-1"></a><span class="co">#&gt;  1 </span></span>
<span id="cb812-7"><a href="LinearRegressionAndANOVA.html#cb812-7" tabindex="-1"></a><span class="co">#&gt; 45</span></span></code></pre></div>
</div>
<div id="discussion-id214" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id214" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once you have a linear model, making predictions is quite easy because
the <code>predict</code> function does all the heavy lifting. The only annoyance is
arranging for a data frame to contain your data.</p>
<p>The <code>predict</code> function returns a vector of predicted values with one
prediction for every row in the data. The example in the Solution
contains one row, so <code>predict</code> returned one value.</p>
<p>If your predictor data contains several rows, you get one prediction per
row:</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="LinearRegressionAndANOVA.html#cb813-1" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb813-2"><a href="LinearRegressionAndANOVA.html#cb813-2" tabindex="-1"></a>  <span class="at">u =</span> <span class="fu">c</span>(<span class="fl">3.0</span>, <span class="fl">3.1</span>, <span class="fl">3.2</span>, <span class="fl">3.3</span>),</span>
<span id="cb813-3"><a href="LinearRegressionAndANOVA.html#cb813-3" tabindex="-1"></a>  <span class="at">v =</span> <span class="fu">c</span>(<span class="fl">3.9</span>, <span class="fl">4.0</span>, <span class="fl">4.1</span>, <span class="fl">4.2</span>),</span>
<span id="cb813-4"><a href="LinearRegressionAndANOVA.html#cb813-4" tabindex="-1"></a>  <span class="at">w =</span> <span class="fu">c</span>(<span class="fl">5.3</span>, <span class="fl">5.5</span>, <span class="fl">5.7</span>, <span class="fl">5.9</span>)</span>
<span id="cb813-5"><a href="LinearRegressionAndANOVA.html#cb813-5" tabindex="-1"></a>)</span>
<span id="cb813-6"><a href="LinearRegressionAndANOVA.html#cb813-6" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> preds)</span>
<span id="cb813-7"><a href="LinearRegressionAndANOVA.html#cb813-7" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4 </span></span>
<span id="cb813-8"><a href="LinearRegressionAndANOVA.html#cb813-8" tabindex="-1"></a><span class="co">#&gt; 43.8 45.0 46.3 47.5</span></span></code></pre></div>
<p>In case itâs not obvious: the new data neednât contain values for
response variables, only predictor variables. After all, you are trying
to <em>calculate</em> the response, so it would be unreasonable of R to expect
you to supply it.</p>
</div>
<div id="see_also-id214" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id214" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are just the point estimates of the predictions. See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id215">11.20</a>,
<a href="LinearRegressionAndANOVA.html#recipe-id215">âForming Prediction Intervalsâ</a> for the confidence
intervals.</p>
</div>
</div>
<div id="recipe-id215" class="section level2 hasAnchor" number="11.20">
<h2><span class="header-section-number">11.20</span> Forming Prediction Intervals<a href="LinearRegressionAndANOVA.html#recipe-id215" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id215" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id215" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You are making predictions using a linear regression model. You want to
know the prediction intervals: the range of the distribution of the
prediction.</p>
</div>
<div id="solution-id215" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id215" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>predict</code> function and specify <code>interval = "prediction"</code>:</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="LinearRegressionAndANOVA.html#cb814-1" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> preds, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
</div>
<div id="discussion-id215" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id215" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a continuation of Recipe <a href="LinearRegressionAndANOVA.html#recipe-id214">11.19</a>, <a href="LinearRegressionAndANOVA.html#recipe-id214">âPredicting New Valuesâ</a>, which
described packaging your data into a data frame for the <code>predict</code>
function. We are adding <code>interval = "prediction"</code> to obtain prediction
intervals.</p>
<p>Here is the example from Recipe <a href="LinearRegressionAndANOVA.html#recipe-id214">11.19</a>, <a href="LinearRegressionAndANOVA.html#recipe-id214">âPredicting New Valuesâ</a>, now
with prediction intervals. The new <code>lwr</code> and <code>upr</code> columns are the lower
and upper limits, respectively, for the interval:</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="LinearRegressionAndANOVA.html#cb815-1" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> preds, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb815-2"><a href="LinearRegressionAndANOVA.html#cb815-2" tabindex="-1"></a><span class="co">#&gt;    fit  lwr  upr</span></span>
<span id="cb815-3"><a href="LinearRegressionAndANOVA.html#cb815-3" tabindex="-1"></a><span class="co">#&gt; 1 43.8 38.2 49.4</span></span>
<span id="cb815-4"><a href="LinearRegressionAndANOVA.html#cb815-4" tabindex="-1"></a><span class="co">#&gt; 2 45.0 39.4 50.7</span></span>
<span id="cb815-5"><a href="LinearRegressionAndANOVA.html#cb815-5" tabindex="-1"></a><span class="co">#&gt; 3 46.3 40.6 51.9</span></span>
<span id="cb815-6"><a href="LinearRegressionAndANOVA.html#cb815-6" tabindex="-1"></a><span class="co">#&gt; 4 47.5 41.8 53.2</span></span></code></pre></div>
<p>By default, <code>predict</code> uses a confidence level of 0.95. You can change
this via the <code>level</code> argument.</p>
<p>A word of caution: these prediction intervals are extremely sensitive to
deviations from normality. If you suspect that your response variable is
not normally distributed, consider a nonparametric technique, such as
the bootstrap (see Recipe <a href="BeyondBasics.html#recipe-id159">13.8</a>, <a href="BeyondBasics.html#recipe-id159">âBootstrapping a Statisticâ</a>), for prediction intervals.</p>
</div>
</div>
<div id="recipe-id218" class="section level2 hasAnchor" number="11.21">
<h2><span class="header-section-number">11.21</span> Performing One-Way ANOVA<a href="LinearRegressionAndANOVA.html#recipe-id218" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id218" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id218" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your data is divided into groups, and the groups are normally
distributed. You want to know if the groups have significantly different
means.</p>
</div>
<div id="solution-id218" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id218" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use a factor to define the groups. Then apply the <code>oneway.test</code>
function:</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="LinearRegressionAndANOVA.html#cb816-1" tabindex="-1"></a><span class="fu">oneway.test</span>(x <span class="sc">~</span> f)</span></code></pre></div>
<p>Here, <code>x</code> is a vector of numeric values and <code>f</code> is a factor that
identifies the groups. The output includes a <em>p</em>-value. Conventionally,
a <em>p</em>-value of less than 0.05 indicates that two or more groups have
significantly different means, whereas a value exceeding 0.05 provides no
such evidence.</p>
</div>
<div id="discussion-id218" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id218" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comparing the means of groups is a common task. One-way ANOVA performs
that comparison and computes the probability that they are statistically
identical. A small <em>p</em>-value indicates that two or more groups likely
have different means. (It does <em>not</em> indicate that <em>all</em> groups have
different means.)</p>
<p>The basic ANOVA test assumes that your data has a normal distribution or
that, at least, it is pretty close to bell-shaped. If not, use the
KruskalâWallis test instead
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id228">11.24</a>, <a href="LinearRegressionAndANOVA.html#recipe-id228">âPerforming Robust ANOVA (KruskalâWallis Test)â</a>).</p>
<p>We can illustrate ANOVA with stock market historical data. Is the stock
market more profitable in some months than in others? For instance, a
common folk myth says that October is a bad month for stock market
investors.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> We explored this question by creating a data frame <code>GSPC_df</code> containing two columns, <code>r</code> and <code>mon</code>. The factor <code>r</code> is the daily returns in the
Standard &amp; Poorâs 500 index, a broad measure of stock market
performance. The factor <code>mon</code> indicates the calendar month in which
that change occurred: Jan, Feb, Mar, and so forth. The data covers the
period 1950 though 2009.</p>
<p>The one-way ANOVA shows a <em>p</em>-value of 0.03347:</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="LinearRegressionAndANOVA.html#cb817-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/anova.rdata&#39;</span>)</span>
<span id="cb817-2"><a href="LinearRegressionAndANOVA.html#cb817-2" tabindex="-1"></a><span class="fu">oneway.test</span>(r <span class="sc">~</span> mon, <span class="at">data =</span> GSPC_df)</span>
<span id="cb817-3"><a href="LinearRegressionAndANOVA.html#cb817-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb817-4"><a href="LinearRegressionAndANOVA.html#cb817-4" tabindex="-1"></a><span class="co">#&gt;  One-way analysis of means (not assuming equal variances)</span></span>
<span id="cb817-5"><a href="LinearRegressionAndANOVA.html#cb817-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb817-6"><a href="LinearRegressionAndANOVA.html#cb817-6" tabindex="-1"></a><span class="co">#&gt; data:  r and mon</span></span>
<span id="cb817-7"><a href="LinearRegressionAndANOVA.html#cb817-7" tabindex="-1"></a><span class="co">#&gt; F = 2, num df = 11, denom df = 6723, p-value = 0.03</span></span></code></pre></div>
<p>We can conclude that stock market changes varied significantly according
to the calendar month.</p>
<p>Before you run to your broker and start flipping your portfolio monthly,
however, we should check something: did the pattern change recently? We
can limit the analysis to recent data by specifying a <code>subset</code>
parameter. This works for <code>oneway.test</code> just as it does for the <code>lm</code>
function. The <code>subset</code> contains the indexes of observations to be
analyzed; all other observations are ignored. Here, we give the indexes
of the 2,500 most recent observations, which is about 10 years of data:</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="LinearRegressionAndANOVA.html#cb818-1" tabindex="-1"></a><span class="fu">oneway.test</span>(r <span class="sc">~</span> mon, <span class="at">data =</span> GSPC_df, <span class="at">subset =</span> <span class="fu">tail</span>(<span class="fu">seq_along</span>(r), <span class="dv">2500</span>))</span>
<span id="cb818-2"><a href="LinearRegressionAndANOVA.html#cb818-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-3"><a href="LinearRegressionAndANOVA.html#cb818-3" tabindex="-1"></a><span class="co">#&gt;  One-way analysis of means (not assuming equal variances)</span></span>
<span id="cb818-4"><a href="LinearRegressionAndANOVA.html#cb818-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-5"><a href="LinearRegressionAndANOVA.html#cb818-5" tabindex="-1"></a><span class="co">#&gt; data:  r and mon</span></span>
<span id="cb818-6"><a href="LinearRegressionAndANOVA.html#cb818-6" tabindex="-1"></a><span class="co">#&gt; F = 0.7, num df = 11, denom df = 976, p-value = 0.8</span></span></code></pre></div>
<p>Uh-oh! Those monthly differences evaporated during the past 10 years.
The large <em>p</em>-value, 0.8, indicates that changes have not recently
varied according to calendar month. Apparently, those differences are a
thing of the past.</p>
<p>Notice that the <code>oneway.test</code> output says â(not assuming equal
variances)â. If you know the groups have equal variances, youâll get a
less conservative test by specifying <code>var.equal = TRUE</code>:</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="LinearRegressionAndANOVA.html#cb819-1" tabindex="-1"></a><span class="fu">oneway.test</span>(x <span class="sc">~</span> f, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>You can also perform one-way ANOVA by using the <code>aov</code> function like
this:</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="LinearRegressionAndANOVA.html#cb820-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(x <span class="sc">~</span> f)</span>
<span id="cb820-2"><a href="LinearRegressionAndANOVA.html#cb820-2" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<p>However, the <code>aov</code> function always assumes equal variances and so is
somewhat less flexible than <code>oneway.test</code>.</p>
</div>
<div id="see_also-id218" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id218" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If the means are significantly different, use Recipe <a href="LinearRegressionAndANOVA.html#recipe-id220">11.23</a>,
<a href="LinearRegressionAndANOVA.html#recipe-id220">âFinding Differences Between Means of Groupsâ</a>, to see the
actual differences. Use Recipe <a href="LinearRegressionAndANOVA.html#recipe-id228">11.24</a>,
<a href="LinearRegressionAndANOVA.html#recipe-id228">âPerforming Robust ANOVA (KruskalâWallis Test)â</a>, if your
data is not normally distributed, as required by ANOVA.</p>
</div>
</div>
<div id="recipe-id221" class="section level2 hasAnchor" number="11.22">
<h2><span class="header-section-number">11.22</span> Creating an Interaction Plot<a href="LinearRegressionAndANOVA.html#recipe-id221" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id221" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id221" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You are performing multiway ANOVA: using two or more categorical
variables as predictors. You want a visual check of possible interaction
between the predictors.</p>
</div>
<div id="solution-id221" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id221" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>interaction.plot</code> function:</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="LinearRegressionAndANOVA.html#cb821-1" tabindex="-1"></a><span class="fu">interaction.plot</span>(pred1, pred2, resp)</span></code></pre></div>
<p>Here, <code>pred1</code> and <code>pred2</code> are two categorical predictors and <code>resp</code> is
the response variable.</p>
</div>
<div id="discussion-id221" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id221" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ANOVA is a form of linear regression, so ideally there is a linear
relationship between every predictor and the response variable. One
source of nonlinearity is an <em>interaction</em> between two predictors: as
one predictor changes value, the other predictor changes its
relationship to the response variable. Checking for interaction between
predictors is a basic diagnostic.</p>
<p>The <code>faraway</code> package contains a dataset called <code>rats</code>. In it, <code>treat</code>
and <code>poison</code> are categorical variables and <code>time</code> is the response
variable. When plotting <code>poison</code> against <code>time</code> we are looking for
straight, parallel lines, which indicate a linear relationship. However,
using the <code>interaction.plot</code> function produces Figure <a href="LinearRegressionAndANOVA.html#fig:interactionplot">11.8</a>, which reveals that something is not
right:</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="LinearRegressionAndANOVA.html#cb822-1" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb822-2"><a href="LinearRegressionAndANOVA.html#cb822-2" tabindex="-1"></a><span class="fu">data</span>(rats)</span>
<span id="cb822-3"><a href="LinearRegressionAndANOVA.html#cb822-3" tabindex="-1"></a><span class="fu">interaction.plot</span>(rats<span class="sc">$</span>poison, rats<span class="sc">$</span>treat, rats<span class="sc">$</span>time)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:interactionplot"></span>
<img src="11_LinearRegression_files/figure-html/interactionplot-1.png" alt="Interaction plot example" width="85%" />
<p class="caption">
Figure 11.8: Interaction plot example
</p>
</div>
<p>Each line graphs
<code>time</code> against <code>poison</code>. The difference between lines is that each line
is for a different value of <code>treat</code>. The lines should be parallel, but
the top two are not exactly parallel. Evidently, varying the value of
<code>treat</code> âwarpedâ the lines, introducing a nonlinearity into the
relationship between <code>poison</code> and <code>time</code>.</p>
<p>This signals a possible interaction that we should check. For this data
it just so happens that yes, there is an interaction, but no, it is not
statistically significant. The moral is clear: the visual check is
useful, but itâs not foolproof. Follow up with a statistical check.</p>
</div>
<div id="see_also-id221" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id221" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id206">11.7</a>, <a href="LinearRegressionAndANOVA.html#recipe-id206">âPerforming Linear Regression with Interaction Termsâ</a>.</p>
</div>
</div>
<div id="recipe-id220" class="section level2 hasAnchor" number="11.23">
<h2><span class="header-section-number">11.23</span> Finding Differences Between Means of Groups<a href="LinearRegressionAndANOVA.html#recipe-id220" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id220" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id220" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your data is divided into groups, and an ANOVA test indicates that the
groups have significantly different means. You want to know the
differences between those means for all groups.</p>
</div>
<div id="solution-id220" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id220" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Perform the ANOVA test using the <code>aov</code> function, which returns a model
object. Then apply the <code>TukeyHSD</code> function to the model object:</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="LinearRegressionAndANOVA.html#cb823-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(x <span class="sc">~</span> f)</span>
<span id="cb823-2"><a href="LinearRegressionAndANOVA.html#cb823-2" tabindex="-1"></a><span class="fu">TukeyHSD</span>(m)</span></code></pre></div>
<p>Here, <code>x</code> is your data and <code>f</code> is the grouping factor. You can plot the
<code>TukeyHSD</code> result to obtain a graphical display of the differences:</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="LinearRegressionAndANOVA.html#cb824-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(m))</span></code></pre></div>
</div>
<div id="discussion-id220" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id220" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ANOVA test is important because it tells you whether or not the
groupsâ means are different. But the test does not identify <em>which</em>
groups are different, and it does not report their differences.</p>
<p>The <code>TukeyHSD</code> function can calculate those differences and help you
identify the largest ones. It uses the âhonest significant differencesâ
method invented by John Tukey.</p>
<p>Weâll illustrate <code>TukeyHSD</code> by continuing the example from Recipe <a href="LinearRegressionAndANOVA.html#recipe-id218">11.21</a>, <a href="LinearRegressionAndANOVA.html#recipe-id218">âPerforming One-Way ANOVAâ</a>, which grouped daily stock
market changes by month. Here, we group them by weekday instead,
using a factor called <code>wday</code> that identifies the day of the week (Mon,
â¦, Fri) on which the change occurred. Weâll use the first 2,500
observations, which roughly cover the period from 1950 to 1960:</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="LinearRegressionAndANOVA.html#cb825-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/anova.rdata&#39;</span>)</span>
<span id="cb825-2"><a href="LinearRegressionAndANOVA.html#cb825-2" tabindex="-1"></a><span class="fu">oneway.test</span>(r <span class="sc">~</span> wday, <span class="at">subset =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2500</span>, <span class="at">data =</span> GSPC_df)</span>
<span id="cb825-3"><a href="LinearRegressionAndANOVA.html#cb825-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb825-4"><a href="LinearRegressionAndANOVA.html#cb825-4" tabindex="-1"></a><span class="co">#&gt;  One-way analysis of means (not assuming equal variances)</span></span>
<span id="cb825-5"><a href="LinearRegressionAndANOVA.html#cb825-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb825-6"><a href="LinearRegressionAndANOVA.html#cb825-6" tabindex="-1"></a><span class="co">#&gt; data:  r and wday</span></span>
<span id="cb825-7"><a href="LinearRegressionAndANOVA.html#cb825-7" tabindex="-1"></a><span class="co">#&gt; F = 13, num df = 4, denom df = 1243, p-value = 5e-10</span></span></code></pre></div>
<p>The <em>p</em>-value is essentially zero, indicating that average changes
varied significantly depending on the weekday. To use the <code>TukeyHSD</code>
function, we first perform the ANOVA test using the <code>aov</code> function, which
returns a model object, and then apply the <code>TukeyHSD</code> function to the
object:</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="LinearRegressionAndANOVA.html#cb826-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(r <span class="sc">~</span> wday, <span class="at">subset =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2500</span>, <span class="at">data =</span> GSPC_df)</span>
<span id="cb826-2"><a href="LinearRegressionAndANOVA.html#cb826-2" tabindex="-1"></a><span class="fu">TukeyHSD</span>(m)</span>
<span id="cb826-3"><a href="LinearRegressionAndANOVA.html#cb826-3" tabindex="-1"></a><span class="co">#&gt;   Tukey multiple comparisons of means</span></span>
<span id="cb826-4"><a href="LinearRegressionAndANOVA.html#cb826-4" tabindex="-1"></a><span class="co">#&gt;     95% family-wise confidence level</span></span>
<span id="cb826-5"><a href="LinearRegressionAndANOVA.html#cb826-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb826-6"><a href="LinearRegressionAndANOVA.html#cb826-6" tabindex="-1"></a><span class="co">#&gt; Fit: aov(formula = r ~ wday, data = GSPC_df, subset = 1:2500)</span></span>
<span id="cb826-7"><a href="LinearRegressionAndANOVA.html#cb826-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb826-8"><a href="LinearRegressionAndANOVA.html#cb826-8" tabindex="-1"></a><span class="co">#&gt; $wday</span></span>
<span id="cb826-9"><a href="LinearRegressionAndANOVA.html#cb826-9" tabindex="-1"></a><span class="co">#&gt;              diff       lwr       upr p adj</span></span>
<span id="cb826-10"><a href="LinearRegressionAndANOVA.html#cb826-10" tabindex="-1"></a><span class="co">#&gt; Mon-Fri -0.003153 -4.40e-03 -0.001911 0.000</span></span>
<span id="cb826-11"><a href="LinearRegressionAndANOVA.html#cb826-11" tabindex="-1"></a><span class="co">#&gt; Thu-Fri -0.000934 -2.17e-03  0.000304 0.238</span></span>
<span id="cb826-12"><a href="LinearRegressionAndANOVA.html#cb826-12" tabindex="-1"></a><span class="co">#&gt; Tue-Fri -0.001855 -3.09e-03 -0.000618 0.000</span></span>
<span id="cb826-13"><a href="LinearRegressionAndANOVA.html#cb826-13" tabindex="-1"></a><span class="co">#&gt; Wed-Fri -0.000783 -2.01e-03  0.000448 0.412</span></span>
<span id="cb826-14"><a href="LinearRegressionAndANOVA.html#cb826-14" tabindex="-1"></a><span class="co">#&gt; Thu-Mon  0.002219  9.79e-04  0.003460 0.000</span></span>
<span id="cb826-15"><a href="LinearRegressionAndANOVA.html#cb826-15" tabindex="-1"></a><span class="co">#&gt; Tue-Mon  0.001299  5.85e-05  0.002538 0.035</span></span>
<span id="cb826-16"><a href="LinearRegressionAndANOVA.html#cb826-16" tabindex="-1"></a><span class="co">#&gt; Wed-Mon  0.002370  1.14e-03  0.003605 0.000</span></span>
<span id="cb826-17"><a href="LinearRegressionAndANOVA.html#cb826-17" tabindex="-1"></a><span class="co">#&gt; Tue-Thu -0.000921 -2.16e-03  0.000314 0.249</span></span>
<span id="cb826-18"><a href="LinearRegressionAndANOVA.html#cb826-18" tabindex="-1"></a><span class="co">#&gt; Wed-Thu  0.000151 -1.08e-03  0.001380 0.997</span></span>
<span id="cb826-19"><a href="LinearRegressionAndANOVA.html#cb826-19" tabindex="-1"></a><span class="co">#&gt; Wed-Tue  0.001072 -1.57e-04  0.002300 0.121</span></span></code></pre></div>
<p>Each line in the output table includes the difference between the means
of two groups (<code>diff</code>) as well as the lower and upper bounds of the
confidence interval (<code>lwr</code> and <code>upr</code>) for the difference. The first line
in the table, for example,compares the Mon group and the Fri group: the
difference of their means is 0.003 with a confidence interval of
(â0.0044 â0.0019).</p>
<p>Scanning the table, we see that the WedâMon comparison had the largest
difference, which was 0.00237.</p>
<p>A cool feature of <code>TukeyHSD</code> is that it can display these differences
visually, too. Simply plot the functionâs return value to get output, as shown in Figure <a href="LinearRegressionAndANOVA.html#fig:tukeyhsd">11.9</a>.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="LinearRegressionAndANOVA.html#cb827-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(m))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tukeyhsd"></span>
<img src="11_LinearRegression_files/figure-html/tukeyhsd-1.png" alt="TukeyHSD Plot" width="85%" />
<p class="caption">
Figure 11.9: TukeyHSD Plot
</p>
</div>
<p>The horizontal lines plot the
confidence intervals for each pair. With this visual representation you
can quickly see that several confidence intervals cross over zero,
indicating that the difference is not necessarily significant. You can
also see that the WedâMon pair has the largest difference because their
confidence interval is farthest to the right.</p>
</div>
<div id="see_also-id220" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="LinearRegressionAndANOVA.html#see_also-id220" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id218">11.21</a>, <a href="LinearRegressionAndANOVA.html#recipe-id218">âPerforming One-Way ANOVAâ</a>.</p>
</div>
</div>
<div id="recipe-id228" class="section level2 hasAnchor" number="11.24">
<h2><span class="header-section-number">11.24</span> Performing Robust ANOVA (KruskalâWallis Test)<a href="LinearRegressionAndANOVA.html#recipe-id228" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id228" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id228" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your data is divided into groups. The groups are not normally
distributed, but their distributions have similar shapes. You want to
perform a test similar to ANOVAâyou want to know if the group medians
are significantly different.</p>
</div>
<div id="solution-id228" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id228" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a factor that defines the groups of your data. Use the
<code>kruskal.test</code> function, which implements the KruskalâWallis test.
Unlike the ANOVA test, this test does not depend upon the normality of
the data:</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="LinearRegressionAndANOVA.html#cb828-1" tabindex="-1"></a><span class="fu">kruskal.test</span>(x <span class="sc">~</span> f)</span></code></pre></div>
<p>Here, <code>x</code> is a vector of data and <code>f</code> is a grouping factor. The output
includes a <em>p</em>-value. Conventionally, <em>p</em> &lt; 0.05 indicates that there
is a significant difference between the medians of two or more groups,
whereas <em>p</em> &gt; 0.05 provides no such evidence.</p>
</div>
<div id="discussion-id228" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id228" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Regular ANOVA assumes that your data has a normal distribution. It can
tolerate some deviation from normality, but extreme deviations will
produce meaningless <em>p</em>-values.</p>
<p>The KruskalâWallis test is a nonparametric version of ANOVA, which means
that it does not assume normality. However, it does assume same-shaped
distributions. You should use the KruskalâWallis test whenever your data
distribution is nonnormal or simply unknown.</p>
<p>The null hypothesis is that all groups have the same median. Rejecting
the null hypothesis (with <em>p</em> &lt; 0.05) does not indicate that <em>all</em>
groups are different, but it does suggest that two or more groups are
different.</p>
<p>One year, Paul taught Business Statistics to 94 undergraduate students. The
class included a midterm examination, and there were four homework
assignments prior to the exam. He wanted to know: What is the
relationship between completing the homework and doing well on the exam?
If there is no relation, then the homework is irrelevant and needs
rethinking.</p>
<p>He created a vector of grades, one per student, and he also created a parallel
factor that captured the number of homework assignments completed by
that student. The data is in a data frame named <code>student_data</code>:</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="LinearRegressionAndANOVA.html#cb829-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/student_data.rdata&#39;</span>)</span>
<span id="cb829-2"><a href="LinearRegressionAndANOVA.html#cb829-2" tabindex="-1"></a><span class="fu">head</span>(student_data)</span>
<span id="cb829-3"><a href="LinearRegressionAndANOVA.html#cb829-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 Ã 4</span></span>
<span id="cb829-4"><a href="LinearRegressionAndANOVA.html#cb829-4" tabindex="-1"></a><span class="co">#&gt;   att.fact hw.mean midterm hw   </span></span>
<span id="cb829-5"><a href="LinearRegressionAndANOVA.html#cb829-5" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;</span></span>
<span id="cb829-6"><a href="LinearRegressionAndANOVA.html#cb829-6" tabindex="-1"></a><span class="co">#&gt; 1 3          0.808   0.818 4    </span></span>
<span id="cb829-7"><a href="LinearRegressionAndANOVA.html#cb829-7" tabindex="-1"></a><span class="co">#&gt; 2 3          0.830   0.682 4    </span></span>
<span id="cb829-8"><a href="LinearRegressionAndANOVA.html#cb829-8" tabindex="-1"></a><span class="co">#&gt; 3 3          0.444   0.511 2    </span></span>
<span id="cb829-9"><a href="LinearRegressionAndANOVA.html#cb829-9" tabindex="-1"></a><span class="co">#&gt; 4 3          0.663   0.670 3    </span></span>
<span id="cb829-10"><a href="LinearRegressionAndANOVA.html#cb829-10" tabindex="-1"></a><span class="co">#&gt; 5 2          0.9     0.682 4    </span></span>
<span id="cb829-11"><a href="LinearRegressionAndANOVA.html#cb829-11" tabindex="-1"></a><span class="co">#&gt; 6 3          0.948   0.954 4</span></span></code></pre></div>
<p>Notice that the <code>hw</code> variableâalthough it appears to be numericâis
actually a factor. It assigns each midterm grade to one of five groups
depending upon how many homework assignments the student completed.</p>
<p>The distribution of exam grades is definitely not normal: the students
have a wide range of math skills, so there are an unusual number of A
and F grades. Hence, regular ANOVA would not be appropriate. Instead we
used the KruskalâWallis test and obtained a <em>p</em>-value of essentially
zero (4 Ã 10<sup>â5</sup>, or 0.00004):</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="LinearRegressionAndANOVA.html#cb830-1" tabindex="-1"></a><span class="fu">kruskal.test</span>(midterm <span class="sc">~</span> hw, <span class="at">data =</span> student_data)</span>
<span id="cb830-2"><a href="LinearRegressionAndANOVA.html#cb830-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb830-3"><a href="LinearRegressionAndANOVA.html#cb830-3" tabindex="-1"></a><span class="co">#&gt;  Kruskal-Wallis rank sum test</span></span>
<span id="cb830-4"><a href="LinearRegressionAndANOVA.html#cb830-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb830-5"><a href="LinearRegressionAndANOVA.html#cb830-5" tabindex="-1"></a><span class="co">#&gt; data:  midterm by hw</span></span>
<span id="cb830-6"><a href="LinearRegressionAndANOVA.html#cb830-6" tabindex="-1"></a><span class="co">#&gt; Kruskal-Wallis chi-squared = 26, df = 4, p-value = 4e-05</span></span></code></pre></div>
<p>Obviously, there is a significant performance difference between
students who complete their homework and those who do not. But what
could Paul actually conclude? At first, Paul was pleased that the homework
appeared so effective. Then it dawned on him that this was a classic
error in statistical reasoning: he assumed that correlation implied
causality. It does not, of course. Perhaps strongly motivated students
do well on both homework and exams, whereas lazy students do not. In that
case, the causal factor is degree of motivation, not the brilliance of
Paulâs homework selection. In the end, he could only conclude something very
simple: students who complete the homework will likely do well on the
midterm exam, but he still doesnât really know why.</p>
</div>
</div>
<div id="recipe-id232" class="section level2 hasAnchor" number="11.25">
<h2><span class="header-section-number">11.25</span> Comparing Models by Using ANOVA<a href="LinearRegressionAndANOVA.html#recipe-id232" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id232" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="LinearRegressionAndANOVA.html#problem-id232" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have two models of the same data, and you want to know whether they
produce different results.</p>
</div>
<div id="solution-id232" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="LinearRegressionAndANOVA.html#solution-id232" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>anova</code> function can compare two models and report if they are
significantly different:</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="LinearRegressionAndANOVA.html#cb831-1" tabindex="-1"></a><span class="fu">anova</span>(m1, m2)</span></code></pre></div>
<p>Here, <code>m1</code> and <code>m2</code> are both model objects returned by <code>lm</code>. The output
from <code>anova</code> includes a <em>p</em>-value. Conventionally, a <em>p</em>-value of less
than 0.05 indicates that the models are significantly different, whereas
a value exceeding 0.05 provides no such evidence.</p>
</div>
<div id="discussion-id232" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="LinearRegressionAndANOVA.html#discussion-id232" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Recipe <a href="LinearRegressionAndANOVA.html#recipe-id231">11.3</a>, <a href="LinearRegressionAndANOVA.html#recipe-id231">âGetting Regression Statisticsâ</a>, we used the <code>anova</code>
function to print the ANOVA table for one regression model. Now we are
using the two-argument form to compare two models.</p>
<p>The <code>anova</code> function has one strong requirement when comparing two
models: one model must be contained within the other. That is, all the
terms of the smaller model must appear in the larger model. Otherwise,
the comparison is impossible.</p>
<p>The ANOVA analysis performs an <em>F</em> test that is similar to the <em>F</em> test
for a linear regression. The difference is that this test is between two
models, whereas the regression <em>F</em> test is between using the regression
model and using no model.</p>
<p>Suppose we build three models of <code>y</code>, adding terms as we go:</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="LinearRegressionAndANOVA.html#cb832-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/anova2.rdata&#39;</span>)</span>
<span id="cb832-2"><a href="LinearRegressionAndANOVA.html#cb832-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> u)</span>
<span id="cb832-3"><a href="LinearRegressionAndANOVA.html#cb832-3" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v)</span>
<span id="cb832-4"><a href="LinearRegressionAndANOVA.html#cb832-4" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> u <span class="sc">+</span> v <span class="sc">+</span> w)</span></code></pre></div>
<p>Is <code>m2</code> really different from <code>m1</code>? We can use <code>anova</code> to compare them,
and the result is a <em>p</em>-value of 0.0091:</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="LinearRegressionAndANOVA.html#cb833-1" tabindex="-1"></a><span class="fu">anova</span>(m1, m2)</span>
<span id="cb833-2"><a href="LinearRegressionAndANOVA.html#cb833-2" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb833-3"><a href="LinearRegressionAndANOVA.html#cb833-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb833-4"><a href="LinearRegressionAndANOVA.html#cb833-4" tabindex="-1"></a><span class="co">#&gt; Model 1: y ~ u</span></span>
<span id="cb833-5"><a href="LinearRegressionAndANOVA.html#cb833-5" tabindex="-1"></a><span class="co">#&gt; Model 2: y ~ u + v</span></span>
<span id="cb833-6"><a href="LinearRegressionAndANOVA.html#cb833-6" tabindex="-1"></a><span class="co">#&gt;   Res.Df RSS Df Sum of Sq    F Pr(&gt;F)   </span></span>
<span id="cb833-7"><a href="LinearRegressionAndANOVA.html#cb833-7" tabindex="-1"></a><span class="co">#&gt; 1     18 197                            </span></span>
<span id="cb833-8"><a href="LinearRegressionAndANOVA.html#cb833-8" tabindex="-1"></a><span class="co">#&gt; 2     17 130  1      66.4 8.67 0.0091 **</span></span>
<span id="cb833-9"><a href="LinearRegressionAndANOVA.html#cb833-9" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb833-10"><a href="LinearRegressionAndANOVA.html#cb833-10" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The small <em>p</em>-value indicates that the models are significantly
different. Comparing <code>m2</code> and <code>m3</code>, however, yields a <em>p</em>-value of
0.055:</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="LinearRegressionAndANOVA.html#cb834-1" tabindex="-1"></a><span class="fu">anova</span>(m2, m3)</span>
<span id="cb834-2"><a href="LinearRegressionAndANOVA.html#cb834-2" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb834-3"><a href="LinearRegressionAndANOVA.html#cb834-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb834-4"><a href="LinearRegressionAndANOVA.html#cb834-4" tabindex="-1"></a><span class="co">#&gt; Model 1: y ~ u + v</span></span>
<span id="cb834-5"><a href="LinearRegressionAndANOVA.html#cb834-5" tabindex="-1"></a><span class="co">#&gt; Model 2: y ~ u + v + w</span></span>
<span id="cb834-6"><a href="LinearRegressionAndANOVA.html#cb834-6" tabindex="-1"></a><span class="co">#&gt;   Res.Df RSS Df Sum of Sq    F Pr(&gt;F)  </span></span>
<span id="cb834-7"><a href="LinearRegressionAndANOVA.html#cb834-7" tabindex="-1"></a><span class="co">#&gt; 1     17 130                           </span></span>
<span id="cb834-8"><a href="LinearRegressionAndANOVA.html#cb834-8" tabindex="-1"></a><span class="co">#&gt; 2     16 103  1      27.5 4.27  0.055 .</span></span>
<span id="cb834-9"><a href="LinearRegressionAndANOVA.html#cb834-9" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb834-10"><a href="LinearRegressionAndANOVA.html#cb834-10" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>This is right on the edge. Strictly speaking, it does not pass our
requirement to be smaller than 0.05; however, itâs close enough that you
might judge the models to be âdifferent enough.â</p>
<p>This example is a bit contrived, so it does not show the larger power of
<code>anova</code>. We use <code>anova</code> when, while experimenting with complicated models
by adding and deleting multiple terms, we need to know whether or not the
new model is really different from the original one. In other words: if
we add terms and the new model is essentially unchanged, then the extra
terms are not worth the additional complications.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Unless you performed the linear regression without an intercept
term
(see Recipe <a href="LinearRegressionAndANOVA.html#recipe-id205">11.5</a>, <a href="LinearRegressionAndANOVA.html#recipe-id205">âPerforming Linear Regression Without an Interceptâ</a>).<a href="LinearRegressionAndANOVA.html#fnref2" class="footnote-back">â©ï¸</a></p></li>
<li id="fn3"><p>The significance level of <em>Î±</em> = 0.05 is the convention observed in
this book. Your application might instead use <em>Î±</em> = 0.10, <em>Î±</em> =
0.01, or some other value. See the Introduction to Chapter <a href="GeneralStatistics.html#GeneralStatistics">9</a>.<a href="LinearRegressionAndANOVA.html#fnref3" class="footnote-back">â©ï¸</a></p></li>
<li id="fn4"><p>In the words of Mark Twain, âOctober: This is one of the
peculiarly dangerous months to speculate in stocks in. The others
are July, January, September, April, November, May, March, June,
December, August, and February.â<a href="LinearRegressionAndANOVA.html#fnref4" class="footnote-back">â©ï¸</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="UsefulTricks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/CerebralMastication/R-Cookbook/edit/master/11_LinearRegression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
