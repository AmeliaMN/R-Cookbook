<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Graphics | R Cookbook, 2nd Edition</title>
  <meta name="description" content="Second edition of R Cookbook" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Graphics | R Cookbook, 2nd Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Second edition of R Cookbook" />
  <meta name="github-repo" content="CerebralMastication/R-Cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Graphics | R Cookbook, 2nd Edition" />
  
  <meta name="twitter:description" content="Second edition of R Cookbook" />
  

<meta name="author" content="James (JD) Long" />
<meta name="author" content="Paul Teetor" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="GeneralStatistics.html"/>
<link rel="next" href="LinearRegressionAndANOVA.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129487349-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-129487349-3');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R Cookbook 2nd Edition</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to the R Cookbook 2nd Edition</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-recipes"><i class="fa fa-check"></i>The Recipes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-note-on-terminology"><i class="fa fa-check"></i>A Note on Terminology</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-and-platform-notes"><i class="fa fa-check"></i>Software and Platform Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions Used in This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-code-examples"><i class="fa fa-check"></i>Using Code Examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#safari-books-online"><i class="fa fa-check"></i>Safari® Books Online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i><b>1</b> Getting Started and Getting Help</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#intro-GettingStarted"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1.1" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id001"><i class="fa fa-check"></i><b>1.1</b> Downloading and Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id002b"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-startingrstudio"><i class="fa fa-check"></i><b>1.3</b> Starting RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id007"><i class="fa fa-check"></i><b>1.4</b> Entering Commands</a></li>
<li class="chapter" data-level="1.5" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id097"><i class="fa fa-check"></i><b>1.5</b> Exiting from RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id100"><i class="fa fa-check"></i><b>1.6</b> Interrupting R</a></li>
<li class="chapter" data-level="1.7" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id265"><i class="fa fa-check"></i><b>1.7</b> Viewing the Supplied Documentation</a></li>
<li class="chapter" data-level="1.8" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id003"><i class="fa fa-check"></i><b>1.8</b> Getting Help on a Function</a></li>
<li class="chapter" data-level="1.9" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id267"><i class="fa fa-check"></i><b>1.9</b> Searching the Supplied Documentation</a></li>
<li class="chapter" data-level="1.10" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id266"><i class="fa fa-check"></i><b>1.10</b> Getting Help on a Package</a></li>
<li class="chapter" data-level="1.11" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id005"><i class="fa fa-check"></i><b>1.11</b> Searching the Web for Help</a></li>
<li class="chapter" data-level="1.12" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id270"><i class="fa fa-check"></i><b>1.12</b> Finding Relevant Functions and Packages</a></li>
<li class="chapter" data-level="1.13" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id268"><i class="fa fa-check"></i><b>1.13</b> Searching the Mailing Lists</a></li>
<li class="chapter" data-level="1.14" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id269"><i class="fa fa-check"></i><b>1.14</b> Submitting Questions to Stack Overflow or Elsewhere in the Community</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="SomeBasics.html"><a href="SomeBasics.html"><i class="fa fa-check"></i><b>2</b> Some Basics</a>
<ul>
<li class="chapter" data-level="" data-path="SomeBasics.html"><a href="SomeBasics.html#intro-SomeBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2.1" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id017"><i class="fa fa-check"></i><b>2.1</b> Printing Something to the Screen</a></li>
<li class="chapter" data-level="2.2" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id016"><i class="fa fa-check"></i><b>2.2</b> Setting Variables</a></li>
<li class="chapter" data-level="2.3" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id091"><i class="fa fa-check"></i><b>2.3</b> Listing Variables</a></li>
<li class="chapter" data-level="2.4" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id075"><i class="fa fa-check"></i><b>2.4</b> Deleting Variables</a></li>
<li class="chapter" data-level="2.5" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id038"><i class="fa fa-check"></i><b>2.5</b> Creating a Vector</a></li>
<li class="chapter" data-level="2.6" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id101"><i class="fa fa-check"></i><b>2.6</b> Computing Basic Statistics</a></li>
<li class="chapter" data-level="2.7" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id021"><i class="fa fa-check"></i><b>2.7</b> Creating Sequences</a></li>
<li class="chapter" data-level="2.8" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id020"><i class="fa fa-check"></i><b>2.8</b> Comparing Vectors</a></li>
<li class="chapter" data-level="2.9" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id039"><i class="fa fa-check"></i><b>2.9</b> Selecting Vector Elements</a></li>
<li class="chapter" data-level="2.10" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id019"><i class="fa fa-check"></i><b>2.10</b> Performing Vector Arithmetic</a></li>
<li class="chapter" data-level="2.11" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id018"><i class="fa fa-check"></i><b>2.11</b> Getting Operator Precedence Right</a></li>
<li class="chapter" data-level="2.12" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id022"><i class="fa fa-check"></i><b>2.12</b> Typing Less and Accomplishing More</a></li>
<li class="chapter" data-level="2.13" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-pipe-2"><i class="fa fa-check"></i><b>2.13</b> Creating a Pipeline of Function Calls</a></li>
<li class="chapter" data-level="2.14" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id025"><i class="fa fa-check"></i><b>2.14</b> Avoiding Some Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html"><i class="fa fa-check"></i><b>3</b> Navigating the Software</a>
<ul>
<li class="chapter" data-level="" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#intro-NavigatingTheSoftware"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="3.1" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id008"><i class="fa fa-check"></i><b>3.1</b> Getting and Setting the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-CreateProject"><i class="fa fa-check"></i><b>3.2</b> Creating a New RStudio Project</a></li>
<li class="chapter" data-level="3.3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id009"><i class="fa fa-check"></i><b>3.3</b> Saving Your Workspace</a></li>
<li class="chapter" data-level="3.4" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id023"><i class="fa fa-check"></i><b>3.4</b> Viewing Your Command History</a></li>
<li class="chapter" data-level="3.5" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id024"><i class="fa fa-check"></i><b>3.5</b> Saving the Result of the Previous Command</a></li>
<li class="chapter" data-level="3.6" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id010"><i class="fa fa-check"></i><b>3.6</b> Displaying Loaded Packages via the Search Path</a></li>
<li class="chapter" data-level="3.7" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id094"><i class="fa fa-check"></i><b>3.7</b> Viewing the List of Installed Packages</a></li>
<li class="chapter" data-level="3.8" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id013"><i class="fa fa-check"></i><b>3.8</b> Accessing the Functions in a Package</a></li>
<li class="chapter" data-level="3.9" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id257"><i class="fa fa-check"></i><b>3.9</b> Accessing Built-in Datasets</a></li>
<li class="chapter" data-level="3.10" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id012"><i class="fa fa-check"></i><b>3.10</b> Installing Packages from CRAN</a></li>
<li class="chapter" data-level="3.11" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-installGH"><i class="fa fa-check"></i><b>3.11</b> Installing a Package from GitHub</a></li>
<li class="chapter" data-level="3.12" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id272"><i class="fa fa-check"></i><b>3.12</b> Setting or Changing a Default CRAN Mirror</a></li>
<li class="chapter" data-level="3.13" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id014"><i class="fa fa-check"></i><b>3.13</b> Running a Script</a></li>
<li class="chapter" data-level="3.14" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id015"><i class="fa fa-check"></i><b>3.14</b> Running a Batch Script</a></li>
<li class="chapter" data-level="3.15" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id102"><i class="fa fa-check"></i><b>3.15</b> Locating the R Home Directory</a></li>
<li class="chapter" data-level="3.16" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id099"><i class="fa fa-check"></i><b>3.16</b> Customizing R Startup</a></li>
<li class="chapter" data-level="3.17" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-Rcloud"><i class="fa fa-check"></i><b>3.17</b> Using R and RStudio in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="InputAndOutput.html"><a href="InputAndOutput.html"><i class="fa fa-check"></i><b>4</b> Input and Output</a>
<ul>
<li class="chapter" data-level="" data-path="InputAndOutput.html"><a href="InputAndOutput.html#intro-InputAndOutput"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="4.1" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id035"><i class="fa fa-check"></i><b>4.1</b> Entering Data from the Keyboard</a></li>
<li class="chapter" data-level="4.2" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id036"><i class="fa fa-check"></i><b>4.2</b> Printing Fewer Digits (or More Digits)</a></li>
<li class="chapter" data-level="4.3" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id034"><i class="fa fa-check"></i><b>4.3</b> Redirecting Output to a File</a></li>
<li class="chapter" data-level="4.4" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id030"><i class="fa fa-check"></i><b>4.4</b> Listing Files</a></li>
<li class="chapter" data-level="4.5" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id033"><i class="fa fa-check"></i><b>4.5</b> Dealing with “Cannot Open File” in Windows</a></li>
<li class="chapter" data-level="4.6" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id136"><i class="fa fa-check"></i><b>4.6</b> Reading Fixed-Width Records</a></li>
<li class="chapter" data-level="4.7" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id245"><i class="fa fa-check"></i><b>4.7</b> Reading Tabular Data Files</a></li>
<li class="chapter" data-level="4.8" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id027"><i class="fa fa-check"></i><b>4.8</b> Reading from CSV Files</a></li>
<li class="chapter" data-level="4.9" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id028"><i class="fa fa-check"></i><b>4.9</b> Writing to CSV Files</a></li>
<li class="chapter" data-level="4.10" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id031"><i class="fa fa-check"></i><b>4.10</b> Reading Tabular or CSV Data from the Web</a></li>
<li class="chapter" data-level="4.11" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readexcel"><i class="fa fa-check"></i><b>4.11</b> Reading Data from Excel</a></li>
<li class="chapter" data-level="4.12" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-writeexcel"><i class="fa fa-check"></i><b>4.12</b> Writing a Data Frame to Excel</a></li>
<li class="chapter" data-level="4.13" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readsas"><i class="fa fa-check"></i><b>4.13</b> Reading Data from a SAS file</a></li>
<li class="chapter" data-level="4.14" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id246"><i class="fa fa-check"></i><b>4.14</b> Reading Data from HTML Tables</a></li>
<li class="chapter" data-level="4.15" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id098"><i class="fa fa-check"></i><b>4.15</b> Reading Files with a Complex Structure</a></li>
<li class="chapter" data-level="4.16" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id037"><i class="fa fa-check"></i><b>4.16</b> Reading from MySQL Databases</a></li>
<li class="chapter" data-level="4.17" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-dbplyr"><i class="fa fa-check"></i><b>4.17</b> Accessing a Database with dbplyr</a></li>
<li class="chapter" data-level="4.18" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id029"><i class="fa fa-check"></i><b>4.18</b> Saving and Transporting Objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DataStructures.html"><a href="DataStructures.html"><i class="fa fa-check"></i><b>5</b> Data Structures</a>
<ul>
<li class="chapter" data-level="" data-path="DataStructures.html"><a href="DataStructures.html#intro-DataStructures"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="5.1" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id048"><i class="fa fa-check"></i><b>5.1</b> Appending Data to a Vector</a></li>
<li class="chapter" data-level="5.2" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id049"><i class="fa fa-check"></i><b>5.2</b> Inserting Data into a Vector</a></li>
<li class="chapter" data-level="5.3" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id050"><i class="fa fa-check"></i><b>5.3</b> Understanding the Recycling Rule</a></li>
<li class="chapter" data-level="5.4" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id051"><i class="fa fa-check"></i><b>5.4</b> Creating a Factor (Categorical Variable)</a></li>
<li class="chapter" data-level="5.5" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id227"><i class="fa fa-check"></i><b>5.5</b> Combining Multiple Vectors into One Vector and a Factor</a></li>
<li class="chapter" data-level="5.6" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id053"><i class="fa fa-check"></i><b>5.6</b> Creating a List</a></li>
<li class="chapter" data-level="5.7" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id054"><i class="fa fa-check"></i><b>5.7</b> Selecting List Elements by Position</a></li>
<li class="chapter" data-level="5.8" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id253"><i class="fa fa-check"></i><b>5.8</b> Selecting List Elements by Name</a></li>
<li class="chapter" data-level="5.9" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id158"><i class="fa fa-check"></i><b>5.9</b> Building a Name/Value Association List</a></li>
<li class="chapter" data-level="5.10" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id056"><i class="fa fa-check"></i><b>5.10</b> Removing an Element from a List</a></li>
<li class="chapter" data-level="5.11" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id152"><i class="fa fa-check"></i><b>5.11</b> Flatten a List into a Vector</a></li>
<li class="chapter" data-level="5.12" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id058"><i class="fa fa-check"></i><b>5.12</b> Removing NULL Elements from a List</a></li>
<li class="chapter" data-level="5.13" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id060"><i class="fa fa-check"></i><b>5.13</b> Removing List Elements Using a Condition</a></li>
<li class="chapter" data-level="5.14" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id062"><i class="fa fa-check"></i><b>5.14</b> Initializing a Matrix</a></li>
<li class="chapter" data-level="5.15" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id139"><i class="fa fa-check"></i><b>5.15</b> Performing Matrix Operations</a></li>
<li class="chapter" data-level="5.16" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id063"><i class="fa fa-check"></i><b>5.16</b> Giving Descriptive Names to the Rows and Columns of a Matrix</a></li>
<li class="chapter" data-level="5.17" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id250"><i class="fa fa-check"></i><b>5.17</b> Selecting One Row or Column from a Matrix</a></li>
<li class="chapter" data-level="5.18" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id251"><i class="fa fa-check"></i><b>5.18</b> Initializing a Data Frame from Column Data</a></li>
<li class="chapter" data-level="5.19" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id252"><i class="fa fa-check"></i><b>5.19</b> Initializing a Data Frame from Row Data</a></li>
<li class="chapter" data-level="5.20" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id071"><i class="fa fa-check"></i><b>5.20</b> Appending Rows to a Data Frame</a></li>
<li class="chapter" data-level="5.21" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id068"><i class="fa fa-check"></i><b>5.21</b> Selecting Data Frame Columns by Position</a></li>
<li class="chapter" data-level="5.22" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id254"><i class="fa fa-check"></i><b>5.22</b> Selecting Data Frame Columns by Name</a></li>
<li class="chapter" data-level="5.23" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id069"><i class="fa fa-check"></i><b>5.23</b> Changing the Names of Data Frame Columns</a></li>
<li class="chapter" data-level="5.24" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id249"><i class="fa fa-check"></i><b>5.24</b> Removing NAs from a Data Frame</a></li>
<li class="chapter" data-level="5.25" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id072"><i class="fa fa-check"></i><b>5.25</b> Excluding Columns by Name</a></li>
<li class="chapter" data-level="5.26" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id155"><i class="fa fa-check"></i><b>5.26</b> Combining Two Data Frames</a></li>
<li class="chapter" data-level="5.27" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id057"><i class="fa fa-check"></i><b>5.27</b> Merging Data Frames by Common Column</a></li>
<li class="chapter" data-level="5.28" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id248"><i class="fa fa-check"></i><b>5.28</b> Converting One Atomic Value into Another</a></li>
<li class="chapter" data-level="5.29" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id074"><i class="fa fa-check"></i><b>5.29</b> Converting One Structured Data Type into Another</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="DataTransformations.html"><a href="DataTransformations.html"><i class="fa fa-check"></i><b>6</b> Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="DataTransformations.html"><a href="DataTransformations.html#intro-DataTransformations"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="6.1" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id149"><i class="fa fa-check"></i><b>6.1</b> Applying a Function to Each List Element</a></li>
<li class="chapter" data-level="6.2" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-row_df"><i class="fa fa-check"></i><b>6.2</b> Applying a Function to Every Row of a Data Frame</a></li>
<li class="chapter" data-level="6.3" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id146"><i class="fa fa-check"></i><b>6.3</b> Applying a Function to Every Row of a Matrix</a></li>
<li class="chapter" data-level="6.4" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id157"><i class="fa fa-check"></i><b>6.4</b> Applying a Function to Every Column</a></li>
<li class="chapter" data-level="6.5" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id275"><i class="fa fa-check"></i><b>6.5</b> Applying a Function to Parallel Vectors or Lists</a></li>
<li class="chapter" data-level="6.6" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id148"><i class="fa fa-check"></i><b>6.6</b> Applying a Function to Groups of Data</a></li>
<li class="chapter" data-level="6.7" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-casewhen"><i class="fa fa-check"></i><b>6.7</b> Creating a New Column Based on Some Condition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="StringsAndDates.html"><a href="StringsAndDates.html"><i class="fa fa-check"></i><b>7</b> Strings and Dates</a>
<ul>
<li class="chapter" data-level="" data-path="StringsAndDates.html"><a href="StringsAndDates.html#I_sect17_d1e17434"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="7.1" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id093"><i class="fa fa-check"></i><b>7.1</b> Getting the Length of a String</a></li>
<li class="chapter" data-level="7.2" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id040"><i class="fa fa-check"></i><b>7.2</b> Concatenating Strings</a></li>
<li class="chapter" data-level="7.3" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id041"><i class="fa fa-check"></i><b>7.3</b> Extracting Substrings</a></li>
<li class="chapter" data-level="7.4" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id276"><i class="fa fa-check"></i><b>7.4</b> Splitting a String According to a Delimiter</a></li>
<li class="chapter" data-level="7.5" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id277"><i class="fa fa-check"></i><b>7.5</b> Replacing Substrings</a></li>
<li class="chapter" data-level="7.6" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id109"><i class="fa fa-check"></i><b>7.6</b> Generating All Pairwise Combinations of Strings</a></li>
<li class="chapter" data-level="7.7" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id045"><i class="fa fa-check"></i><b>7.7</b> Getting the Current Date</a></li>
<li class="chapter" data-level="7.8" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id043"><i class="fa fa-check"></i><b>7.8</b> Converting a String into a Date</a></li>
<li class="chapter" data-level="7.9" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id044"><i class="fa fa-check"></i><b>7.9</b> Converting a Date into a String</a></li>
<li class="chapter" data-level="7.10" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id241"><i class="fa fa-check"></i><b>7.10</b> Converting Year, Month, and Day into a Date</a></li>
<li class="chapter" data-level="7.11" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id042"><i class="fa fa-check"></i><b>7.11</b> Getting the Julian Date</a></li>
<li class="chapter" data-level="7.12" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id046"><i class="fa fa-check"></i><b>7.12</b> Extracting the Parts of a Date</a></li>
<li class="chapter" data-level="7.13" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id047"><i class="fa fa-check"></i><b>7.13</b> Creating a Sequence of Dates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Probability.html"><a href="Probability.html"><i class="fa fa-check"></i><b>8</b> Probability</a>
<ul>
<li class="chapter" data-level="" data-path="Probability.html"><a href="Probability.html#intro-Probability"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="8.1" data-path="Probability.html"><a href="Probability.html#recipe-id163"><i class="fa fa-check"></i><b>8.1</b> Counting the Number of Combinations</a></li>
<li class="chapter" data-level="8.2" data-path="Probability.html"><a href="Probability.html#recipe-id198"><i class="fa fa-check"></i><b>8.2</b> Generating Combinations</a></li>
<li class="chapter" data-level="8.3" data-path="Probability.html"><a href="Probability.html#recipe-id165"><i class="fa fa-check"></i><b>8.3</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="8.4" data-path="Probability.html"><a href="Probability.html#recipe-id201"><i class="fa fa-check"></i><b>8.4</b> Generating Reproducible Random Numbers</a></li>
<li class="chapter" data-level="8.5" data-path="Probability.html"><a href="Probability.html#recipe-id199"><i class="fa fa-check"></i><b>8.5</b> Generating a Random Sample</a></li>
<li class="chapter" data-level="8.6" data-path="Probability.html"><a href="Probability.html#recipe-id200"><i class="fa fa-check"></i><b>8.6</b> Generating Random Sequences</a></li>
<li class="chapter" data-level="8.7" data-path="Probability.html"><a href="Probability.html#recipe-id151"><i class="fa fa-check"></i><b>8.7</b> Randomly Permuting a Vector</a></li>
<li class="chapter" data-level="8.8" data-path="Probability.html"><a href="Probability.html#recipe-id196"><i class="fa fa-check"></i><b>8.8</b> Calculating Probabilities for Discrete Distributions</a></li>
<li class="chapter" data-level="8.9" data-path="Probability.html"><a href="Probability.html#recipe-id197"><i class="fa fa-check"></i><b>8.9</b> Calculating Probabilities for Continuous Distributions</a></li>
<li class="chapter" data-level="8.10" data-path="Probability.html"><a href="Probability.html#recipe-id168"><i class="fa fa-check"></i><b>8.10</b> Converting Probabilities to Quantiles</a></li>
<li class="chapter" data-level="8.11" data-path="Probability.html"><a href="Probability.html#recipe-id166"><i class="fa fa-check"></i><b>8.11</b> Plotting a Density Function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html"><i class="fa fa-check"></i><b>9</b> General Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#intro-GeneralStatistics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="9.1" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id119"><i class="fa fa-check"></i><b>9.1</b> Summarizing Your Data</a></li>
<li class="chapter" data-level="9.2" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id229"><i class="fa fa-check"></i><b>9.2</b> Calculating Relative Frequencies</a></li>
<li class="chapter" data-level="9.3" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id124"><i class="fa fa-check"></i><b>9.3</b> Tabulating Factors and Creating Contingency Tables</a></li>
<li class="chapter" data-level="9.4" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id125"><i class="fa fa-check"></i><b>9.4</b> Testing Categorical Variables for Independence</a></li>
<li class="chapter" data-level="9.5" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id143"><i class="fa fa-check"></i><b>9.5</b> Calculating Quantiles (and Quartiles) of a Dataset</a></li>
<li class="chapter" data-level="9.6" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id142"><i class="fa fa-check"></i><b>9.6</b> Inverting a Quantile</a></li>
<li class="chapter" data-level="9.7" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id133"><i class="fa fa-check"></i><b>9.7</b> Converting Data to z-Scores</a></li>
<li class="chapter" data-level="9.8" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id121"><i class="fa fa-check"></i><b>9.8</b> Testing the Mean of a Sample (t Test)</a></li>
<li class="chapter" data-level="9.9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id123"><i class="fa fa-check"></i><b>9.9</b> Forming a Confidence Interval for a Mean</a></li>
<li class="chapter" data-level="9.10" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id135"><i class="fa fa-check"></i><b>9.10</b> Forming a Confidence Interval for a Median</a></li>
<li class="chapter" data-level="9.11" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id225"><i class="fa fa-check"></i><b>9.11</b> Testing a Sample Proportion</a></li>
<li class="chapter" data-level="9.12" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id226"><i class="fa fa-check"></i><b>9.12</b> Forming a Confidence Interval for a Proportion</a></li>
<li class="chapter" data-level="9.13" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id126"><i class="fa fa-check"></i><b>9.13</b> Testing for Normality</a></li>
<li class="chapter" data-level="9.14" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id131"><i class="fa fa-check"></i><b>9.14</b> Testing for Runs</a></li>
<li class="chapter" data-level="9.15" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id122"><i class="fa fa-check"></i><b>9.15</b> Comparing the Means of Two Samples</a></li>
<li class="chapter" data-level="9.16" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id130"><i class="fa fa-check"></i><b>9.16</b> Comparing the Locations of Two Samples Nonparametrically</a></li>
<li class="chapter" data-level="9.17" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id132"><i class="fa fa-check"></i><b>9.17</b> Testing a Correlation for Significance</a></li>
<li class="chapter" data-level="9.18" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id134"><i class="fa fa-check"></i><b>9.18</b> Testing Groups for Equal Proportions</a></li>
<li class="chapter" data-level="9.19" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id127"><i class="fa fa-check"></i><b>9.19</b> Performing Pairwise Comparisons Between Group Means</a></li>
<li class="chapter" data-level="9.20" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id129"><i class="fa fa-check"></i><b>9.20</b> Testing Two Samples for the Same Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Graphics.html"><a href="Graphics.html"><i class="fa fa-check"></i><b>10</b> Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="Graphics.html"><a href="Graphics.html#intro-Graphics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10.1" data-path="Graphics.html"><a href="Graphics.html#recipe-id171"><i class="fa fa-check"></i><b>10.1</b> Creating a Scatter Plot</a></li>
<li class="chapter" data-level="10.2" data-path="Graphics.html"><a href="Graphics.html#recipe-id259"><i class="fa fa-check"></i><b>10.2</b> Adding a Title and Labels</a></li>
<li class="chapter" data-level="10.3" data-path="Graphics.html"><a href="Graphics.html#recipe-id261"><i class="fa fa-check"></i><b>10.3</b> Adding (or Removing) a Grid</a></li>
<li class="chapter" data-level="10.4" data-path="Graphics.html"><a href="Graphics.html#recipe-theme"><i class="fa fa-check"></i><b>10.4</b> Applying a Theme to a ggplot Figure</a></li>
<li class="chapter" data-level="10.5" data-path="Graphics.html"><a href="Graphics.html#recipe-id262"><i class="fa fa-check"></i><b>10.5</b> Creating a Scatter Plot of Multiple Groups</a></li>
<li class="chapter" data-level="10.6" data-path="Graphics.html"><a href="Graphics.html#recipe-id260"><i class="fa fa-check"></i><b>10.6</b> Adding (or Removing) a Legend</a></li>
<li class="chapter" data-level="10.7" data-path="Graphics.html"><a href="Graphics.html#recipe-id217"><i class="fa fa-check"></i><b>10.7</b> Plotting the Regression Line of a Scatter Plot</a></li>
<li class="chapter" data-level="10.8" data-path="Graphics.html"><a href="Graphics.html#recipe-id184"><i class="fa fa-check"></i><b>10.8</b> Plotting All Variables Against All Other Variables</a></li>
<li class="chapter" data-level="10.9" data-path="Graphics.html"><a href="Graphics.html#recipe-id185"><i class="fa fa-check"></i><b>10.9</b> Creating One Scatter Plot for Each Group</a></li>
<li class="chapter" data-level="10.10" data-path="Graphics.html"><a href="Graphics.html#recipe-id175"><i class="fa fa-check"></i><b>10.10</b> Creating a Bar Chart</a></li>
<li class="chapter" data-level="10.11" data-path="Graphics.html"><a href="Graphics.html#recipe-id177"><i class="fa fa-check"></i><b>10.11</b> Adding Confidence Intervals to a Bar Chart</a></li>
<li class="chapter" data-level="10.12" data-path="Graphics.html"><a href="Graphics.html#recipe-id176"><i class="fa fa-check"></i><b>10.12</b> Coloring a Bar Chart</a></li>
<li class="chapter" data-level="10.13" data-path="Graphics.html"><a href="Graphics.html#recipe-id174"><i class="fa fa-check"></i><b>10.13</b> Plotting a Line from x and y Points</a></li>
<li class="chapter" data-level="10.14" data-path="Graphics.html"><a href="Graphics.html#recipe-id256"><i class="fa fa-check"></i><b>10.14</b> Changing the Type, Width, or Color of a Line</a></li>
<li class="chapter" data-level="10.15" data-path="Graphics.html"><a href="Graphics.html#recipe-id263"><i class="fa fa-check"></i><b>10.15</b> Plotting Multiple Datasets</a></li>
<li class="chapter" data-level="10.16" data-path="Graphics.html"><a href="Graphics.html#recipe-id186"><i class="fa fa-check"></i><b>10.16</b> Adding Vertical or Horizontal Lines</a></li>
<li class="chapter" data-level="10.17" data-path="Graphics.html"><a href="Graphics.html#recipe-id178"><i class="fa fa-check"></i><b>10.17</b> Creating a Boxplot</a></li>
<li class="chapter" data-level="10.18" data-path="Graphics.html"><a href="Graphics.html#recipe-id179"><i class="fa fa-check"></i><b>10.18</b> Creating One Boxplot for Each Factor Level</a></li>
<li class="chapter" data-level="10.19" data-path="Graphics.html"><a href="Graphics.html#recipe-id182"><i class="fa fa-check"></i><b>10.19</b> Creating a Histogram</a></li>
<li class="chapter" data-level="10.20" data-path="Graphics.html"><a href="Graphics.html#recipe-id183"><i class="fa fa-check"></i><b>10.20</b> Adding a Density Estimate to a Histogram</a></li>
<li class="chapter" data-level="10.21" data-path="Graphics.html"><a href="Graphics.html#recipe-id180"><i class="fa fa-check"></i><b>10.21</b> Creating a Normal Quantile–Quantile Plot</a></li>
<li class="chapter" data-level="10.22" data-path="Graphics.html"><a href="Graphics.html#recipe-id181"><i class="fa fa-check"></i><b>10.22</b> Creating Other Quantile–Quantile Plots</a></li>
<li class="chapter" data-level="10.23" data-path="Graphics.html"><a href="Graphics.html#recipe-id191"><i class="fa fa-check"></i><b>10.23</b> Plotting a Variable in Multiple Colors</a></li>
<li class="chapter" data-level="10.24" data-path="Graphics.html"><a href="Graphics.html#recipe-id192"><i class="fa fa-check"></i><b>10.24</b> Graphing a Function</a></li>
<li class="chapter" data-level="10.25" data-path="Graphics.html"><a href="Graphics.html#recipe-id190"><i class="fa fa-check"></i><b>10.25</b> Displaying Several Figures on One Page</a></li>
<li class="chapter" data-level="10.26" data-path="Graphics.html"><a href="Graphics.html#recipe-id188"><i class="fa fa-check"></i><b>10.26</b> Writing Your Plot to a File</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html"><i class="fa fa-check"></i><b>11</b> Linear Regression and ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#intro-LinearRegressionAndANOVA"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id203"><i class="fa fa-check"></i><b>11.1</b> Performing Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id204"><i class="fa fa-check"></i><b>11.2</b> Performing Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.3" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id231"><i class="fa fa-check"></i><b>11.3</b> Getting Regression Statistics</a></li>
<li class="chapter" data-level="11.4" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id240"><i class="fa fa-check"></i><b>11.4</b> Understanding the Regression Summary</a></li>
<li class="chapter" data-level="11.5" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id205"><i class="fa fa-check"></i><b>11.5</b> Performing Linear Regression Without an Intercept</a></li>
<li class="chapter" data-level="11.6" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#title-highcor"><i class="fa fa-check"></i><b>11.6</b> Regressing Only Variables That Highly Correlate with Your Dependent Variable</a></li>
<li class="chapter" data-level="11.7" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id206"><i class="fa fa-check"></i><b>11.7</b> Performing Linear Regression with Interaction Terms</a></li>
<li class="chapter" data-level="11.8" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id236"><i class="fa fa-check"></i><b>11.8</b> Selecting the Best Regression Variables</a></li>
<li class="chapter" data-level="11.9" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id209"><i class="fa fa-check"></i><b>11.9</b> Regressing on a Subset of Your Data</a></li>
<li class="chapter" data-level="11.10" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id244"><i class="fa fa-check"></i><b>11.10</b> Using an Expression Inside a Regression Formula</a></li>
<li class="chapter" data-level="11.11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id243"><i class="fa fa-check"></i><b>11.11</b> Regressing on a Polynomial</a></li>
<li class="chapter" data-level="11.12" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id208"><i class="fa fa-check"></i><b>11.12</b> Regressing on Transformed Data</a></li>
<li class="chapter" data-level="11.13" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id210"><i class="fa fa-check"></i><b>11.13</b> Finding the Best Power Transformation (Box–Cox Procedure)</a></li>
<li class="chapter" data-level="11.14" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id211"><i class="fa fa-check"></i><b>11.14</b> Forming Confidence Intervals for Regression Coefficients</a></li>
<li class="chapter" data-level="11.15" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id216"><i class="fa fa-check"></i><b>11.15</b> Plotting Regression Residuals</a></li>
<li class="chapter" data-level="11.16" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id212"><i class="fa fa-check"></i><b>11.16</b> Diagnosing a Linear Regression</a></li>
<li class="chapter" data-level="11.17" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id233"><i class="fa fa-check"></i><b>11.17</b> Identifying Influential Observations</a></li>
<li class="chapter" data-level="11.18" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id213"><i class="fa fa-check"></i><b>11.18</b> Testing Residuals for Autocorrelation (Durbin–Watson Test)</a></li>
<li class="chapter" data-level="11.19" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id214"><i class="fa fa-check"></i><b>11.19</b> Predicting New Values</a></li>
<li class="chapter" data-level="11.20" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id215"><i class="fa fa-check"></i><b>11.20</b> Forming Prediction Intervals</a></li>
<li class="chapter" data-level="11.21" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id218"><i class="fa fa-check"></i><b>11.21</b> Performing One-Way ANOVA</a></li>
<li class="chapter" data-level="11.22" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id221"><i class="fa fa-check"></i><b>11.22</b> Creating an Interaction Plot</a></li>
<li class="chapter" data-level="11.23" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id220"><i class="fa fa-check"></i><b>11.23</b> Finding Differences Between Means of Groups</a></li>
<li class="chapter" data-level="11.24" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id228"><i class="fa fa-check"></i><b>11.24</b> Performing Robust ANOVA (Kruskal–Wallis Test)</a></li>
<li class="chapter" data-level="11.25" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id232"><i class="fa fa-check"></i><b>11.25</b> Comparing Models by Using ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="UsefulTricks.html"><a href="UsefulTricks.html"><i class="fa fa-check"></i><b>12</b> Useful Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="UsefulTricks.html"><a href="UsefulTricks.html#intro-UsefulTricks"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12.1" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id278"><i class="fa fa-check"></i><b>12.1</b> Peeking at Your Data</a></li>
<li class="chapter" data-level="12.2" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id271"><i class="fa fa-check"></i><b>12.2</b> Printing the Result of an Assignment</a></li>
<li class="chapter" data-level="12.3" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id138"><i class="fa fa-check"></i><b>12.3</b> Summing Rows and Columns</a></li>
<li class="chapter" data-level="12.4" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id112"><i class="fa fa-check"></i><b>12.4</b> Printing Data in Columns</a></li>
<li class="chapter" data-level="12.5" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id137"><i class="fa fa-check"></i><b>12.5</b> Binning Your Data</a></li>
<li class="chapter" data-level="12.6" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id116"><i class="fa fa-check"></i><b>12.6</b> Finding the Position of a Particular Value</a></li>
<li class="chapter" data-level="12.7" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id103"><i class="fa fa-check"></i><b>12.7</b> Selecting Every nth Element of a Vector</a></li>
<li class="chapter" data-level="12.8" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id107"><i class="fa fa-check"></i><b>12.8</b> Finding Minimums or Maximums</a></li>
<li class="chapter" data-level="12.9" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id110"><i class="fa fa-check"></i><b>12.9</b> Generating All Combinations of Several Variables</a></li>
<li class="chapter" data-level="12.10" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id153"><i class="fa fa-check"></i><b>12.10</b> Flattening a Data Frame</a></li>
<li class="chapter" data-level="12.11" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id247"><i class="fa fa-check"></i><b>12.11</b> Sorting a Data Frame</a></li>
<li class="chapter" data-level="12.12" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id223"><i class="fa fa-check"></i><b>12.12</b> Stripping Attributes from a Variable</a></li>
<li class="chapter" data-level="12.13" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id202"><i class="fa fa-check"></i><b>12.13</b> Revealing the Structure of an Object</a></li>
<li class="chapter" data-level="12.14" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id224"><i class="fa fa-check"></i><b>12.14</b> Timing Your Code</a></li>
<li class="chapter" data-level="12.15" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id113"><i class="fa fa-check"></i><b>12.15</b> Suppressing Warnings and Error Messages</a></li>
<li class="chapter" data-level="12.16" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id118"><i class="fa fa-check"></i><b>12.16</b> Taking Function Arguments from a List</a></li>
<li class="chapter" data-level="12.17" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id114"><i class="fa fa-check"></i><b>12.17</b> Defining Your Own Binary Operators</a></li>
<li class="chapter" data-level="12.18" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id111"><i class="fa fa-check"></i><b>12.18</b> Suppressing the Startup Message</a></li>
<li class="chapter" data-level="12.19" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id106"><i class="fa fa-check"></i><b>12.19</b> Getting and Setting Environment Variables</a></li>
<li class="chapter" data-level="12.20" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-codesections"><i class="fa fa-check"></i><b>12.20</b> Use Code Sections</a></li>
<li class="chapter" data-level="12.21" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_local"><i class="fa fa-check"></i><b>12.21</b> Executing R in Parallel Locally</a></li>
<li class="chapter" data-level="12.22" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_remote"><i class="fa fa-check"></i><b>12.22</b> Executing R in Parallel Remotely</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="BeyondBasics.html"><a href="BeyondBasics.html"><i class="fa fa-check"></i><b>13</b> Beyond Basic Numerics and Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="BeyondBasics.html"><a href="BeyondBasics.html#intro-BeyondBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="13.1" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id234"><i class="fa fa-check"></i><b>13.1</b> Minimizing or Maximizing a Single-Parameter Function</a></li>
<li class="chapter" data-level="13.2" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id235"><i class="fa fa-check"></i><b>13.2</b> Minimizing or Maximizing a Multiparameter Function</a></li>
<li class="chapter" data-level="13.3" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id140"><i class="fa fa-check"></i><b>13.3</b> Calculating Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="13.4" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id162"><i class="fa fa-check"></i><b>13.4</b> Performing Principal Component Analysis</a></li>
<li class="chapter" data-level="13.5" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id264"><i class="fa fa-check"></i><b>13.5</b> Performing Simple Orthogonal Regression</a></li>
<li class="chapter" data-level="13.6" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id160"><i class="fa fa-check"></i><b>13.6</b> Finding Clusters in Your Data</a></li>
<li class="chapter" data-level="13.7" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id161"><i class="fa fa-check"></i><b>13.7</b> Predicting a Binary-Valued Variable (Logistic Regression)</a></li>
<li class="chapter" data-level="13.8" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id159"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping a Statistic</a></li>
<li class="chapter" data-level="13.9" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id193"><i class="fa fa-check"></i><b>13.9</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html"><i class="fa fa-check"></i><b>14</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14.1" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id076"><i class="fa fa-check"></i><b>14.1</b> Representing Time Series Data</a></li>
<li class="chapter" data-level="14.2" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id089"><i class="fa fa-check"></i><b>14.2</b> Plotting Time Series Data</a></li>
<li class="chapter" data-level="14.3" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id077"><i class="fa fa-check"></i><b>14.3</b> Extracting the Oldest or Newest Observations</a></li>
<li class="chapter" data-level="14.4" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id281"><i class="fa fa-check"></i><b>14.4</b> Subsetting a Time Series</a></li>
<li class="chapter" data-level="14.5" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id079"><i class="fa fa-check"></i><b>14.5</b> Merging Several Time Series</a></li>
<li class="chapter" data-level="14.6" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id239"><i class="fa fa-check"></i><b>14.6</b> Filling or Padding a Time Series</a></li>
<li class="chapter" data-level="14.7" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id280"><i class="fa fa-check"></i><b>14.7</b> Lagging a Time Series</a></li>
<li class="chapter" data-level="14.8" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id141"><i class="fa fa-check"></i><b>14.8</b> Computing Successive Differences</a></li>
<li class="chapter" data-level="14.9" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id080"><i class="fa fa-check"></i><b>14.9</b> Performing Calculations on Time Series</a></li>
<li class="chapter" data-level="14.10" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id279"><i class="fa fa-check"></i><b>14.10</b> Computing a Moving Average</a></li>
<li class="chapter" data-level="14.11" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id282"><i class="fa fa-check"></i><b>14.11</b> Applying a Function by Calendar Period</a></li>
<li class="chapter" data-level="14.12" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id081"><i class="fa fa-check"></i><b>14.12</b> Applying a Rolling Function</a></li>
<li class="chapter" data-level="14.13" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id082"><i class="fa fa-check"></i><b>14.13</b> Plotting the Autocorrelation Function</a></li>
<li class="chapter" data-level="14.14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id104"><i class="fa fa-check"></i><b>14.14</b> Testing a Time Series for Autocorrelation</a></li>
<li class="chapter" data-level="14.15" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id083"><i class="fa fa-check"></i><b>14.15</b> Plotting the Partial Autocorrelation Function</a></li>
<li class="chapter" data-level="14.16" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id084"><i class="fa fa-check"></i><b>14.16</b> Finding Lagged Correlations Between Two Time Series</a></li>
<li class="chapter" data-level="14.17" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id088"><i class="fa fa-check"></i><b>14.17</b> Detrending a Time Series</a></li>
<li class="chapter" data-level="14.18" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id085"><i class="fa fa-check"></i><b>14.18</b> Fitting an ARIMA Model</a></li>
<li class="chapter" data-level="14.19" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id237"><i class="fa fa-check"></i><b>14.19</b> Removing Insignificant ARIMA Coefficients</a></li>
<li class="chapter" data-level="14.20" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id238"><i class="fa fa-check"></i><b>14.20</b> Running Diagnostics on an ARIMA Model</a></li>
<li class="chapter" data-level="14.21" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id086"><i class="fa fa-check"></i><b>14.21</b> Making Forecasts from an ARIMA Model</a></li>
<li class="chapter" data-level="14.22" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-plotting_forecast"><i class="fa fa-check"></i><b>14.22</b> Plotting a Forecast</a></li>
<li class="chapter" data-level="14.23" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id087"><i class="fa fa-check"></i><b>14.23</b> Testing for Mean Reversion</a></li>
<li class="chapter" data-level="14.24" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id195"><i class="fa fa-check"></i><b>14.24</b> Smoothing a Time Series</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html"><i class="fa fa-check"></i><b>15</b> Simple Programming</a>
<ul>
<li class="chapter" data-level="" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#intro-SimpleProgramming"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="15.1" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-creating_if_logic"><i class="fa fa-check"></i><b>15.1</b> Choosing Between Two Alternatives: if-else</a></li>
<li class="chapter" data-level="15.2" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-for_loop"><i class="fa fa-check"></i><b>15.2</b> Iterating with a Loop</a></li>
<li class="chapter" data-level="15.3" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-id117"><i class="fa fa-check"></i><b>15.3</b> Defining a Function</a></li>
<li class="chapter" data-level="15.4" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-variable"><i class="fa fa-check"></i><b>15.4</b> Creating a Local Variable</a></li>
<li class="chapter" data-level="15.5" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#choosing-between-multiple-alternatives-switch"><i class="fa fa-check"></i><b>15.5</b> Choosing Between Multiple Alternatives: switch</a></li>
<li class="chapter" data-level="15.6" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-title"><i class="fa fa-check"></i><b>15.6</b> Defining Defaults for Function Parameters</a></li>
<li class="chapter" data-level="15.7" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#signaling-errors"><i class="fa fa-check"></i><b>15.7</b> Signaling Errors</a></li>
<li class="chapter" data-level="15.8" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#protecting-against-errors"><i class="fa fa-check"></i><b>15.8</b> Protecting Against Errors</a></li>
<li class="chapter" data-level="15.9" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-anon-function"><i class="fa fa-check"></i><b>15.9</b> Creating an Anonymous Function</a></li>
<li class="chapter" data-level="15.10" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#creating-a-collection-of-reusable-functions"><i class="fa fa-check"></i><b>15.10</b> Creating a Collection of Reusable Functions</a></li>
<li class="chapter" data-level="15.11" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-indent"><i class="fa fa-check"></i><b>15.11</b> Automatically Reindent Code</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RMarkdown.html"><a href="RMarkdown.html"><i class="fa fa-check"></i><b>16</b> R Markdown and Publishing</a>
<ul>
<li class="chapter" data-level="" data-path="RMarkdown.html"><a href="RMarkdown.html#intro-Rmd_pub"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="16.1" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-new_doc"><i class="fa fa-check"></i><b>16.1</b> Creating a New Document</a></li>
<li class="chapter" data-level="16.2" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-metadata"><i class="fa fa-check"></i><b>16.2</b> Adding a Title, Author, or Date</a></li>
<li class="chapter" data-level="16.3" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc-text"><i class="fa fa-check"></i><b>16.3</b> Formatting Document Text</a></li>
<li class="chapter" data-level="16.4" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-headings"><i class="fa fa-check"></i><b>16.4</b> Inserting Document Headings</a></li>
<li class="chapter" data-level="16.5" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-list"><i class="fa fa-check"></i><b>16.5</b> Inserting a List</a></li>
<li class="chapter" data-level="16.6" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-exec_r"><i class="fa fa-check"></i><b>16.6</b> Showing Output from R Code</a></li>
<li class="chapter" data-level="16.7" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-code-results"><i class="fa fa-check"></i><b>16.7</b> Controlling Which Code and Results Are Shown</a></li>
<li class="chapter" data-level="16.8" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc_plot"><i class="fa fa-check"></i><b>16.8</b> Inserting a Plot</a></li>
<li class="chapter" data-level="16.9" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-static-table"><i class="fa fa-check"></i><b>16.9</b> Inserting a Table</a></li>
<li class="chapter" data-level="16.10" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-tables"><i class="fa fa-check"></i><b>16.10</b> Inserting a Table of Data</a></li>
<li class="chapter" data-level="16.11" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-equations"><i class="fa fa-check"></i><b>16.11</b> Inserting Math Equations</a></li>
<li class="chapter" data-level="16.12" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-html"><i class="fa fa-check"></i><b>16.12</b> Generating HTML Output</a></li>
<li class="chapter" data-level="16.13" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-pdf"><i class="fa fa-check"></i><b>16.13</b> Generating PDF Output</a></li>
<li class="chapter" data-level="16.14" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-word"><i class="fa fa-check"></i><b>16.14</b> Generating Microsoft Word Output</a></li>
<li class="chapter" data-level="16.15" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-prez"><i class="fa fa-check"></i><b>16.15</b> Generating Presentation Output</a></li>
<li class="chapter" data-level="16.16" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-param_report"><i class="fa fa-check"></i><b>16.16</b> Creating a Parameterized Report</a></li>
<li class="chapter" data-level="16.17" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-rmd_org"><i class="fa fa-check"></i><b>16.17</b> Organizing Your R Markdown Workflow</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cookbook, 2nd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Graphics" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Graphics<a href="Graphics.html#Graphics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro-Graphics" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="Graphics.html#intro-Graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Graphics is a great strength of R. The <code>graphics</code> package is part of the
standard distribution and contains many useful functions for creating a
variety of graphic displays. The base functionality has been expanded and made easier with <code>ggplot2</code>, part of the tidyverse of packages. In this chapter we will focus on examples using <code>ggplot2</code>, and we will occasionally suggest other packages. In this chapter’s See Also sections we mention functions in other packages that do the same job in a different way. We suggest that you explore those alternatives if you
are dissatisfied with what’s offered by <code>ggplot2</code> or base graphics.</p>
<p>Graphics is a vast subject, and we can only scratch the surface here.
Winston Chang’s <a href="http://shop.oreilly.com/product/0636920063704.do"><em>R Graphics Cookbook, 2nd Edition</em></a>, is part of the O’Reilly Cookbook series
and walks through many useful recipes with a focus on <code>ggplot2</code>.
If you want to delve deeper, we recommend <em>R Graphics</em> by Paul Murrell
(Chapman &amp; Hall, 2006). <em>R Graphics</em> discusses the paradigms behind R
graphics, explains how to use the graphics functions, and contains
numerous examples—including the code to re-create them. Some of the
examples are pretty amazing.</p>
<div id="the-illustrations" class="section level3 unnumbered hasAnchor">
<h3>The Illustrations<a href="Graphics.html#the-illustrations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The graphs in this chapter are mostly plain and unadorned. We did that
intentionally. When you call the <code>ggplot</code> function, as in:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="Graphics.html#cb610-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="Graphics.html#cb611-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb611-2"><a href="Graphics.html#cb611-2" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb611-3"><a href="Graphics.html#cb611-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:simpleplot"></span>
<img src="10_Graphics_files/figure-html/simpleplot-1.png" alt="Simple plot" width="85%" />
<p class="caption">
Figure 10.1: Simple plot
</p>
</div>
<p>you get a plain, graphical representation of <em>x</em> and <em>y</em> as shown in Figure <a href="Graphics.html#fig:simpleplot">10.1</a>.
You could adorn the
graph with colors, a title, labels, a legend, text, and so forth, but
then the call to <code>ggplot</code> becomes more and more crowded, obscuring the
basic intention.</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="Graphics.html#cb612-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb612-2"><a href="Graphics.html#cb612-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb612-3"><a href="Graphics.html#cb612-3" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb612-4"><a href="Graphics.html#cb612-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Simple Plot Example&quot;</span>,</span>
<span id="cb612-5"><a href="Graphics.html#cb612-5" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;with a subtitle&quot;</span>,</span>
<span id="cb612-6"><a href="Graphics.html#cb612-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;x-values&quot;</span>,</span>
<span id="cb612-7"><a href="Graphics.html#cb612-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y-values&quot;</span></span>
<span id="cb612-8"><a href="Graphics.html#cb612-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb612-9"><a href="Graphics.html#cb612-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;grey50&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:complicatedplot"></span>
<img src="10_Graphics_files/figure-html/complicatedplot-1.png" alt="Slightly more complicated plot" width="85%" />
<p class="caption">
Figure 10.2: Slightly more complicated plot
</p>
</div>
<p>The resulting plot is shown in Figure <a href="Graphics.html#fig:complicatedplot">10.2</a>. We want to keep the recipes clean, so we emphasize the basic plot and then show later (as in Recipe <a href="Graphics.html#recipe-id259">10.2</a>, <a href="Graphics.html#recipe-id259">“Adding a Title and Labels”</a>) how to add adornments.</p>
</div>
<div id="notes-on-ggplot2-basics" class="section level3 unnumbered hasAnchor">
<h3>Notes on ggplot2 basics<a href="Graphics.html#notes-on-ggplot2-basics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While the package is called <code>ggplot2</code>, the primary plotting function in the package is called <code>ggplot</code>. It is important to understand the basic pieces of a <code>ggplot2</code> graph. In the preceding examples, you can see that we pass data into <code>ggplot</code>, then define how the graph is created by stacking together small phrases that describe some aspect of the plot. This stacking together of phrases is part of the “grammar of graphics” ethos (that’s where the <code>gg</code> comes from).
To learn more, you can read <a href="http://vita.had.co.nz/papers/layered-grammar.pdf">“A Layered Grammar of Graphics”</a> written by <code>ggplot2</code> author Hadley Wickham.
The “grammar of graphics” concept originated with Leland Wilkinson, who articulated the idea of building graphics up from a set of primitives (i.e., verbs and nouns). With <code>ggplot</code>, the underlying data need not be fundamentally reshaped for each type of graphical representation. In general, the data stays the same and the user then changes syntax slightly to illustrate the data differently. This is significantly more consistent than base graphics, which often require reshaping the data in order to change the way it is visualized.</p>
<p>As we talk about <code>ggplot</code> graphics, it’s worth defining the components of a <code>ggplot</code> graph:</p>
<dl>
<dt><code>geometric object functions</code></dt>
<dd>
<p>These are geometric objects that describe the type of graph being created. These start with <code>geom_</code> and examples include <code>geom_line</code>, <code>geom_boxplot</code>, and <code>geom_point,</code> along with dozens more.</p>
</dd>
<dt><code>aesthetics</code></dt>
<dd>
<p>The aesthetics, or aesthetic mappings, communicate to <code>ggplot</code> which fields in the source data get mapped to which visual elements in the graphic. This is the <code>aes</code> line in a <code>ggplot</code> call.</p>
</dd>
<dt><code>stats</code></dt>
<dd>
<p>Stats are statistical transformations that are done before displaying the data. Not all graphs will have stats, but a few common stats are <code>stat_ecdf</code> (the empirical cumulative distribution function) and <code>stat_identity</code>, which tells <code>ggplot</code> to pass the data without doing any stats at all.</p>
</dd>
<dt><code>facet functions</code></dt>
<dd>
<p>Facets are subplots where each small plot represents a subgroup of the data. The faceting functions include <code>facet_wrap</code> and <code>facet_grid</code>.</p>
</dd>
<dt><code>themes</code></dt>
<dd>
<p>Themes are the visual elements of the plot that are not tied to data. These might include titles, margins, table of contents locations, or font choices.</p>
</dd>
<dt><code>layer</code></dt>
<dd>
<p>A layer is a combination of data, aesthetics, a geometric object, a stat, and other options to produce a visual layer in the <code>ggplot</code> graphic.</p>
</dd>
</dl>
</div>
<div id="long-versus-wide-data-with-ggplot" class="section level3 unnumbered hasAnchor">
<h3>“Long” Versus “Wide” Data with ggplot<a href="Graphics.html#long-versus-wide-data-with-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the first sources of confusion for new <code>ggplot</code> users is that they are inclined to reshape their data to be “wide” before plotting it. “Wide” here means every variable they are plotting is its own column in the underlying data frame. This is an approach that many users develop while using Excel and then bring with them to R. <code>ggplot</code> works most easily with “long” data where additional variables are added as rows in the data frame rather than columns. The great side effect of adding more measurements as rows is that any properly constructed <code>ggplot</code> graphs will automatically update to reflect the new data without changing the <code>ggplot</code> code. If each additional variable were added as a column, then the plotting code would have to be changed to introduce additional variables. This idea of “long” versus “wide” data will become more obvious in the examples in the rest of this chapter.</p>
</div>
<div id="graphics-in-other-packages" class="section level3 unnumbered hasAnchor">
<h3>Graphics in Other Packages<a href="Graphics.html#graphics-in-other-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R is highly programmable, and many people have extended its graphics
machinery with additional features. Quite often, packages include
specialized functions for plotting their results and objects. The <code>zoo</code>
package, for example, implements a time series object. If you create a
<code>zoo</code> object <code>z</code> and call <code>plot(z)</code>, then the <code>zoo</code> package does the
plotting; it creates a graphic that is customized for displaying a time
series. <code>zoo</code> uses base graphics so the resulting graph will not be a <code>ggplot</code> graphic.</p>
<p>There are even entire packages devoted to extending R with new graphics
paradigms. The <code>lattice</code> package is an alternative to base
graphics that predates <code>ggplot2</code>. It uses a powerful graphics paradigm that enables you to
create informative graphics more easily. It was implemented by Deepayan Sarkar, who also
wrote <em>Lattice: Multivariate Data Visualization with R</em> (Springer, 2008),
which explains the package and how to use it. The lattice package is
also described in <a href="http://oreilly.com/catalog/9780596801717"><em>R in a Nutshell</em></a> (O’Reilly).</p>
<p>There are two chapters in Hadley Wickham’s excellent book <em>R for Data Science</em> that deal with graphics. Chapter 7, “Exploratory Data Analysis,” focuses on exploring data with <code>ggplot2</code>, while Chapter 28, “Graphics for Communication,” explores communicating to others with graphics. <em>R for Data Science</em> is available in a printed version from O’Reilly or <a href="http://r4ds.had.co.nz/graphics-for-communication.html">online</a>.</p>
</div>
</div>
<div id="recipe-id171" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Creating a Scatter Plot<a href="Graphics.html#recipe-id171" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id171" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id171" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have paired observations: (<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>), (<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>), …,
(<em>x<sub>n</sub></em>, <em>y<sub>n</sub></em>). You want to create a scatter plot of the pairs.</p>
</div>
<div id="solution-id171" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id171" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can plot the data by calling <code>ggplot</code>, passing in the data frame, and invoking a geometric point function:</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="Graphics.html#cb613-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb613-2"><a href="Graphics.html#cb613-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>In this example, the data frame is called <code>df</code> and the <em>x</em> and <em>y</em> data are in fields named <code>x</code> and <code>y</code>, which we pass to the aesthetic in the call <code>aes(x, y)</code>.</p>
</div>
<div id="discussion-id171" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id171" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A scatter plot is a common first attack on a new dataset. It’s a quick
way to see the relationship, if any, between <em>x</em> and <em>y</em>.</p>
<p>Plotting with <code>ggplot</code> requires telling <code>ggplot</code> what data frame to use, then what type of graph to create, and which aesthetic mapping (<code>aes</code>) to use. The <code>aes</code> in this case defines which field from <code>df</code> goes into which axis on the plot. Then the command <code>geom_point</code> communicates that you want a point graph, as opposed to a line or other type of graphic.</p>
<p>We can use the built-in <code>mtcars</code> dataset to illustrate plotting horsepower (<code>hp</code>) on the x-axis and fuel economy (<code>mpg</code>) on the y-axis:</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="Graphics.html#cb614-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb614-2"><a href="Graphics.html#cb614-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:point-ex"></span>
<img src="10_Graphics_files/figure-html/point-ex-1.png" alt="Scatter plot example" width="85%" />
<p class="caption">
Figure 10.3: Scatter plot example
</p>
</div>
<p>The resulting plot is shown in Figure <a href="Graphics.html#fig:point-ex">10.3</a>.</p>
</div>
<div id="see_also-id171" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id171" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id259">10.2</a>, <a href="Graphics.html#recipe-id259">“Adding a Title and Labels”</a>, for adding a title and labels; see Recipes @ref(recipe-id261,) <a href="Graphics.html#recipe-id261">“Adding a Grid”</a>, and <a href="Graphics.html#recipe-id260">10.6</a>,
<a href="Graphics.html#recipe-id260">“Adding (or Removing) a Legend”</a>, for adding a grid and a legend
(respectively). See Recipe <a href="Graphics.html#recipe-id184">10.8</a>, <a href="Graphics.html#recipe-id184">“Plotting All Variables Against All Other Variables”</a>, for
plotting multiple variables.</p>
</div>
</div>
<div id="recipe-id259" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Adding a Title and Labels<a href="Graphics.html#recipe-id259" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id259" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id259" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to add a title to your plot or add labels for the axes.</p>
</div>
<div id="solution-id259" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id259" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> we add a <code>labs</code> element that controls the labels for the title and axes.</p>
<p>When calling <code>labs</code> in <code>ggplot</code>, specify:</p>
<dl>
<dt><code>title</code></dt>
<dd>
<p>The desired title text</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>x-axis label</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>y-axis label</p>
</dd>
</dl>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="Graphics.html#cb615-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb615-2"><a href="Graphics.html#cb615-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb615-3"><a href="Graphics.html#cb615-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;The Title&quot;</span>,</span>
<span id="cb615-4"><a href="Graphics.html#cb615-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;X-axis Label&quot;</span>,</span>
<span id="cb615-5"><a href="Graphics.html#cb615-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Y-axis Label&quot;</span>)</span></code></pre></div>
</div>
<div id="discussion-id259" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id259" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The graph created in Recipe <a href="Graphics.html#recipe-id171">10.1</a>, <a href="Graphics.html#recipe-id171">“Creating a Scatter Plot”</a>, is quite plain. A title and better labels will make it more interesting and easier to interpret.</p>
<p>Note that in <code>ggplot</code> you build up the elements of the graph by connecting the parts with the plus sign, <code>+</code>. So we add further graphical elements by stringing together phrases. You can see this in the following code, which uses the built-in <code>mtcars</code> dataset and plots horsepower versus fuel economy in a scatter plot, shown in Figure <a href="Graphics.html#fig:car-plot">10.4</a></p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="Graphics.html#cb616-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb616-2"><a href="Graphics.html#cb616-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb616-3"><a href="Graphics.html#cb616-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cars: Horsepower vs. Fuel Economy&quot;</span>,</span>
<span id="cb616-4"><a href="Graphics.html#cb616-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;HP&quot;</span>,</span>
<span id="cb616-5"><a href="Graphics.html#cb616-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Economy (miles per gallon)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:car-plot"></span>
<img src="10_Graphics_files/figure-html/car-plot-1.png" alt="Labeled axis and title" width="85%" />
<p class="caption">
Figure 10.4: Labeled axis and title
</p>
</div>
</div>
</div>
<div id="recipe-id261" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Adding (or Removing) a Grid<a href="Graphics.html#recipe-id261" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id261" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id261" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to change the background grid to your graphic.</p>
</div>
<div id="solution-id261" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id261" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> background grids come as a default, as you have seen in other recipes. However, we can alter the background grid using the <code>theme</code> function or by applying a prepackaged theme to our graph.</p>
<p>We can use <code>theme</code> to alter the background panel of our graphic:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="Graphics.html#cb617-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb617-2"><a href="Graphics.html#cb617-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb617-3"><a href="Graphics.html#cb617-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;grey50&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:whitebackground"></span>
<img src="10_Graphics_files/figure-html/whitebackground-1.png" alt="White background" width="85%" />
<p class="caption">
Figure 10.5: White background
</p>
</div>
</div>
<div id="discussion-id261" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id261" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot</code> fills in the background with a grey grid by default. So you may find yourself wanting to remove that grid completely or change it to something else. Let’s create a <code>ggplot</code> graphic and then incrementally change the background style.</p>
<p>We can add or change aspects of our graphic by creating a <code>ggplot</code> object, then calling the object and using the <code>+</code> to add to it. The background shading in a <code>ggplot</code> graphic is actually three different graph elements:</p>
<p><code>panel.grid.major</code>:</p>
<p>These are white by default and heavy.</p>
<p><code>panel.grid.minor</code>:</p>
<p>These are white by default and light.</p>
<p><code>panel.background</code>:</p>
<p>This is the background that is grey by default.</p>
<p>You can see these elements if you look carefully at the background of Figure <a href="Graphics.html#fig:car-plot">10.4</a>:</p>
<p>If we set the background as <code>element_blank</code>, then the major and minor grids are there, but they are white on white so we can’t see them in Figure <a href="Graphics.html#fig:examplebackground">10.6</a>:</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="Graphics.html#cb618-1" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb618-2"><a href="Graphics.html#cb618-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb618-3"><a href="Graphics.html#cb618-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cars: Horsepower vs. Fuel Economy&quot;</span>,</span>
<span id="cb618-4"><a href="Graphics.html#cb618-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;HP&quot;</span>,</span>
<span id="cb618-5"><a href="Graphics.html#cb618-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Economy (miles per gallon)&quot;</span>) <span class="sc">+</span></span>
<span id="cb618-6"><a href="Graphics.html#cb618-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb618-7"><a href="Graphics.html#cb618-7" tabindex="-1"></a>g1</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:examplebackground"></span>
<img src="10_Graphics_files/figure-html/examplebackground-1.png" alt="Blank background" width="85%" />
<p class="caption">
Figure 10.6: Blank background
</p>
</div>
<p>Notice in the previous code we put the <code>ggplot</code> graph into a variable called <code>g1</code>. Then we printed the graphic by just calling <code>g1</code>. By having the graph inside of <code>g1</code>, we can then add further graphical components without rebuilding the graph.</p>
<p>But if we wanted to show the background grid with unusual patterns for illustration, it’s as easy as setting its components to a color and setting a line type, which is shown in Figure <a href="Graphics.html#fig:majorgrid">10.7</a>.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="Graphics.html#cb619-1" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> g1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span></span>
<span id="cb619-2"><a href="Graphics.html#cb619-2" tabindex="-1"></a>                   <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb619-3"><a href="Graphics.html#cb619-3" tabindex="-1"></a>  <span class="co"># linetype = 3 is dash</span></span>
<span id="cb619-4"><a href="Graphics.html#cb619-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span></span>
<span id="cb619-5"><a href="Graphics.html#cb619-5" tabindex="-1"></a>          <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">linetype =</span> <span class="dv">4</span>)) </span>
<span id="cb619-6"><a href="Graphics.html#cb619-6" tabindex="-1"></a>  <span class="co"># linetype = 4 is dot dash</span></span>
<span id="cb619-7"><a href="Graphics.html#cb619-7" tabindex="-1"></a>g2</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:majorgrid"></span>
<img src="10_Graphics_files/figure-html/majorgrid-1.png" alt="Major and minor gridlines" width="85%" />
<p class="caption">
Figure 10.7: Major and minor gridlines
</p>
</div>
<p>Figure <a href="Graphics.html#fig:majorgrid">10.7</a> lacks visual appeal, but you can clearly see that the doted black lines make up the major grid and the dashed grey lines are the minor grid.</p>
<p>Or we could do something less garish and take the <code>ggplot</code> object <code>g1</code> from before and add grey gridlines to the white background, shown in Figure <a href="Graphics.html#fig:backgrids">10.8</a>.</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="Graphics.html#cb620-1" tabindex="-1"></a>g1 <span class="sc">+</span></span>
<span id="cb620-2"><a href="Graphics.html#cb620-2" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:backgrids"></span>
<img src="10_Graphics_files/figure-html/backgrids-1.png" alt="Grey major gridlines" width="85%" />
<p class="caption">
Figure 10.8: Grey major gridlines
</p>
</div>
</div>
<div id="see_also-id261" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id261" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-theme">10.4</a>, <a href="Graphics.html#recipe-theme">“Applying a Theme to a ggplot Figure”</a>, to see how to apply an entire canned theme to your figure.</p>
</div>
</div>
<div id="recipe-theme" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Applying a Theme to a ggplot Figure<a href="Graphics.html#recipe-theme" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-theme" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-theme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want your plot to use a preset collection of colors, styles, and formatting.</p>
</div>
<div id="solution-theme" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-theme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot</code> supports <em>themes</em>, which are collections of settings for your figures. To use one of the themes, just add the desired theme function to your <code>ggplot</code> with a <code>+</code>:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="Graphics.html#cb621-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb621-2"><a href="Graphics.html#cb621-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb621-3"><a href="Graphics.html#cb621-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>The <code>ggplot2</code> package contains the following themes:</p>
<pre><code>theme_bw()
theme_dark() 
theme_classic()
theme_gray()
theme_linedraw()
theme_light()
theme_minimal()
theme_test()
theme_void()</code></pre>
</div>
<div id="discussion-theme" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-theme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start with a simple plot and then show how it looks with a few of the built-in themes. Figure <a href="Graphics.html#fig:startingfigure">10.9</a> shows a basic <code>ggplot</code> figure with no theme applied.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="Graphics.html#cb623-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> disp, <span class="at">y =</span> hp)) <span class="sc">+</span></span>
<span id="cb623-2"><a href="Graphics.html#cb623-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb623-3"><a href="Graphics.html#cb623-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;mtcars: Displacement vs. Horsepower&quot;</span>,</span>
<span id="cb623-4"><a href="Graphics.html#cb623-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Displacement (cubic inches)&quot;</span>,</span>
<span id="cb623-5"><a href="Graphics.html#cb623-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Horsepower&quot;</span>)</span>
<span id="cb623-6"><a href="Graphics.html#cb623-6" tabindex="-1"></a>p</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:startingfigure"></span>
<img src="10_Graphics_files/figure-html/startingfigure-1.png" alt="Starting plot" width="85%" />
<p class="caption">
Figure 10.9: Starting plot
</p>
</div>
<p>Let’s create the same plot multiple times, but apply a different theme to each one:</p>
<dl>
<dt><code>theme_bw</code></dt>
<dd>
<p>(Figure <a href="Graphics.html#fig:themebw">10.10</a>):</p>
</dd>
</dl>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="Graphics.html#cb624-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:themebw"></span>
<img src="10_Graphics_files/figure-html/themebw-1.png" alt="(ref:bw)" width="85%" />
<p class="caption">
Figure 10.10: (ref:bw)
</p>
</div>
<dl>
<dt><code>theme_classic</code></dt>
<dd>
<p>(Figure <a href="Graphics.html#fig:themeclassic">10.11</a>):</p>
</dd>
</dl>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="Graphics.html#cb625-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:themeclassic"></span>
<img src="10_Graphics_files/figure-html/themeclassic-1.png" alt="(ref:classic)" width="85%" />
<p class="caption">
Figure 10.11: (ref:classic)
</p>
</div>
<dl>
<dt><code>theme_minimal</code></dt>
<dd>
<p>(Figure <a href="Graphics.html#fig:thememinimal">10.12</a>):</p>
</dd>
</dl>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="Graphics.html#cb626-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:thememinimal"></span>
<img src="10_Graphics_files/figure-html/thememinimal-1.png" alt="(ref:minimal)" width="85%" />
<p class="caption">
Figure 10.12: (ref:minimal)
</p>
</div>
<dl>
<dt><code>theme_void</code></dt>
<dd>
<p>(Figure <a href="Graphics.html#fig:themevoid">10.13</a>):</p>
</dd>
</dl>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="Graphics.html#cb627-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_void</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:themevoid"></span>
<img src="10_Graphics_files/figure-html/themevoid-1.png" alt="(ref:void)" width="85%" />
<p class="caption">
Figure 10.13: (ref:void)
</p>
</div>
<p>In addition to the themes included in <code>ggplot2</code>, there are packages, like <code>ggtheme</code>, that include themes to help you make your figures look more like the figures found in popular tools and publications such as Stata or <em>The Economist</em>.</p>
</div>
<div id="see_also-theme" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-theme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id261">10.3</a>, <a href="Graphics.html#recipe-id261">“Adding (or Removing) a Grid”</a>, to see how to change a single theme element.</p>
</div>
</div>
<div id="recipe-id262" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Creating a Scatter Plot of Multiple Groups<a href="Graphics.html#recipe-id262" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id262" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id262" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have data in a data frame with multiple observations per record: <em>x</em>, <em>y</em>, and a
factor <em>f</em> that indicates the group. You want to create a scatter
plot of <em>x</em> and <em>y</em> that distinguishes among the groups.</p>
</div>
<div id="solution-id262" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id262" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> we control the mapping of shapes to the factor <code>f</code> by passing <code>shape = f</code> to the <code>aes</code>.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="Graphics.html#cb628-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">shape =</span> f)) <span class="sc">+</span></span>
<span id="cb628-2"><a href="Graphics.html#cb628-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</div>
<div id="discussion-id262" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id262" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting multiple groups in one scatter plot creates an uninformative
mess unless we distinguish one group from another. We make this distinction in <code>ggplot</code> by setting the <code>shape</code> parameter of the <code>aes</code> function.</p>
<p>The built-in <code>iris</code> dataset contains paired measures of <code>Petal.Length</code> and
<code>Petal.Width</code>. Each measurement also has a <code>Species</code> property indicating
the species of the flower that was measured. If we plot all the data at
once, we just get the scatter plot shown in Figure <a href="Graphics.html#fig:irisnoshape">10.14</a>:</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="Graphics.html#cb629-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris,</span>
<span id="cb629-2"><a href="Graphics.html#cb629-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length,</span>
<span id="cb629-3"><a href="Graphics.html#cb629-3" tabindex="-1"></a>           <span class="at">y =</span> Petal.Width)) <span class="sc">+</span></span>
<span id="cb629-4"><a href="Graphics.html#cb629-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:irisnoshape"></span>
<img src="10_Graphics_files/figure-html/irisnoshape-1.png" alt="iris: length vs. width" width="85%" />
<p class="caption">
Figure 10.14: iris: length vs. width
</p>
</div>
<p>The graphic would be far more informative if we distinguished the points
by species. In addition to distinguishing species by shape, we could also differentiate by color. We can add <code>shape = Species</code> and <code>color = Species</code> to our <code>aes</code> call, to get each species with a different shape and color, shown in Figure <a href="Graphics.html#fig:irisshape">10.15</a>.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="Graphics.html#cb630-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris,</span>
<span id="cb630-2"><a href="Graphics.html#cb630-2" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb630-3"><a href="Graphics.html#cb630-3" tabindex="-1"></a>         <span class="at">x =</span> Petal.Length,</span>
<span id="cb630-4"><a href="Graphics.html#cb630-4" tabindex="-1"></a>         <span class="at">y =</span> Petal.Width,</span>
<span id="cb630-5"><a href="Graphics.html#cb630-5" tabindex="-1"></a>         <span class="at">shape =</span> Species,</span>
<span id="cb630-6"><a href="Graphics.html#cb630-6" tabindex="-1"></a>         <span class="at">color =</span> Species</span>
<span id="cb630-7"><a href="Graphics.html#cb630-7" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb630-8"><a href="Graphics.html#cb630-8" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:irisshape"></span>
<img src="10_Graphics_files/figure-html/irisshape-1.png" alt="iris: shape and color" width="85%" />
<p class="caption">
Figure 10.15: iris: shape and color
</p>
</div>
<p><code>ggplot</code> conveniently sets up a legend for you as well, which is handy.</p>
</div>
<div id="see_also-id262" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id262" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id260">10.6</a>, <a href="Graphics.html#recipe-id260">“Adding (or Removing) a Legend”</a>, for more on how to add a legend.</p>
</div>
</div>
<div id="recipe-id260" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Adding (or Removing) a Legend<a href="Graphics.html#recipe-id260" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id260" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id260" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want your plot to include a <em>legend</em>, the little box that decodes
the graphic for the viewer.</p>
</div>
<div id="solution-id260" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id260" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In most cases <code>ggplot</code> will add the legends automatically, as you can see in the previous recipe. If you do not have explicit grouping in the <code>aes</code>, then <code>ggplot</code> will not show a legend by default. If we want to force <code>ggplot</code> to show a legend, we can set the shape or line type of our graph to a constant. <code>ggplot</code> will then show a legend with one group. We then use <code>guides</code> to guide <code>ggplot</code> in how to label the legend.</p>
<p>This can be illustrated with our <code>iris</code> scatter plot:</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="Graphics.html#cb631-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> iris,</span>
<span id="cb631-2"><a href="Graphics.html#cb631-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length,</span>
<span id="cb631-3"><a href="Graphics.html#cb631-3" tabindex="-1"></a>           <span class="at">y =</span> Petal.Width, </span>
<span id="cb631-4"><a href="Graphics.html#cb631-4" tabindex="-1"></a>           <span class="at">shape=</span><span class="st">&quot;Observation&quot;</span>)) <span class="sc">+</span></span>
<span id="cb631-5"><a href="Graphics.html#cb631-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb631-6"><a href="Graphics.html#cb631-6" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;My Legend Title&quot;</span>)) </span>
<span id="cb631-7"><a href="Graphics.html#cb631-7" tabindex="-1"></a>g</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:needslegend"></span>
<img src="10_Graphics_files/figure-html/needslegend-1.png" alt="Legend added" width="85%" />
<p class="caption">
Figure 10.16: Legend added
</p>
</div>
<p>Figure <a href="Graphics.html#fig:needslegend">10.16</a> illustrates the result of setting the shape to a string value and then relabeling the legend using <code>guides</code>.</p>
<p>More commonly, you may want to turn legends off, which you can do by setting the <code>legend.position = "none"</code> in the <code>theme</code>. We can use the <code>iris</code> plot from the prior recipe and add the <code>theme</code> call as shown in Figure <a href="Graphics.html#fig:irisshapelegend">10.17</a>:</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="Graphics.html#cb632-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> iris,</span>
<span id="cb632-2"><a href="Graphics.html#cb632-2" tabindex="-1"></a>            <span class="fu">aes</span>(</span>
<span id="cb632-3"><a href="Graphics.html#cb632-3" tabindex="-1"></a>              <span class="at">x =</span> Petal.Length,</span>
<span id="cb632-4"><a href="Graphics.html#cb632-4" tabindex="-1"></a>              <span class="at">y =</span> Petal.Width,</span>
<span id="cb632-5"><a href="Graphics.html#cb632-5" tabindex="-1"></a>              <span class="at">shape =</span> Species,</span>
<span id="cb632-6"><a href="Graphics.html#cb632-6" tabindex="-1"></a>              <span class="at">color =</span> Species</span>
<span id="cb632-7"><a href="Graphics.html#cb632-7" tabindex="-1"></a>            )) <span class="sc">+</span></span>
<span id="cb632-8"><a href="Graphics.html#cb632-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb632-9"><a href="Graphics.html#cb632-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb632-10"><a href="Graphics.html#cb632-10" tabindex="-1"></a>g</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:irisshapelegend"></span>
<img src="10_Graphics_files/figure-html/irisshapelegend-1.png" alt="Legend removed" width="85%" />
<p class="caption">
Figure 10.17: Legend removed
</p>
</div>
</div>
<div id="discussion-id260" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id260" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Adding legends to <code>ggplot</code> when there is no grouping is an exercise in “tricking” <code>ggplot</code> into showing the legend by passing a string to a grouping parameter in <code>aes</code>. While this will not change the grouping (as there is only one group), it will result in a legend being shown with a name.</p>
<p>Then we can use <code>guides</code> to alter the legend title. It’s worth noting that we are not changing anything about the data, just exploiting settings in order to coerce <code>ggplot</code> into showing a legend when it typically would not.</p>
<p>One of the huge benefits of <code>ggplot</code> is its very good defaults. Getting positions and correspondence between labels and their point types is done automatically, but can be overridden if needed. To remove a legend totally, we set <code>theme</code> parameters with <code>theme(legend.position = "none")</code>. In addition to <code>"none"</code> you can set the <code>legend.position</code> to be <code>"left"</code>, <code>"right"</code>, <code>"bottom"</code>, <code>"top"</code>, or a two-element numeric vector. Use a two-element numeric vector in order to pass <code>ggplot</code> specific coordinates of where you want the legend. If you’re using the coordinate positions, the values passed are between 0 and 1 for the <em>x</em> and <em>y</em> position, respectively.</p>
<p>Figure <a href="Graphics.html#fig:irisshapelegend-moved">10.18</a> shows an example of a legend positioned at the bottom, created with this adjustment to the <code>legend.position</code>:</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="Graphics.html#cb633-1" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:irisshapelegend-moved"></span>
<img src="10_Graphics_files/figure-html/irisshapelegend-moved-1.png" alt="Legend on the bottom" width="85%" />
<p class="caption">
Figure 10.18: Legend on the bottom
</p>
</div>
<p>Or we could use the two-element numeric vector to put the legend in a specific location, as in Figure <a href="Graphics.html#fig:irisshapelegend-moved2">10.19</a>. The example puts the center of the legend at 80% to the right and 20% up from the bottom.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="Graphics.html#cb634-1" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">2</span>))</span>
<span id="cb634-2"><a href="Graphics.html#cb634-2" tabindex="-1"></a><span class="co">#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2</span></span>
<span id="cb634-3"><a href="Graphics.html#cb634-3" tabindex="-1"></a><span class="co">#&gt; 3.5.0.</span></span>
<span id="cb634-4"><a href="Graphics.html#cb634-4" tabindex="-1"></a><span class="co">#&gt; ℹ Please use the `legend.position.inside` argument of `theme()` instead.</span></span>
<span id="cb634-5"><a href="Graphics.html#cb634-5" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb634-6"><a href="Graphics.html#cb634-6" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb634-7"><a href="Graphics.html#cb634-7" tabindex="-1"></a><span class="co">#&gt; generated.</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:irisshapelegend-moved2"></span>
<img src="10_Graphics_files/figure-html/irisshapelegend-moved2-1.png" alt="Legend at a point" width="85%" />
<p class="caption">
Figure 10.19: Legend at a point
</p>
</div>
<p>In many aspects beyond legends, <code>ggplot</code> uses sane defaults but offers the flexibility to override them and tweak the details. You can find more details on <code>ggplot</code> options related to legends in the help for <code>theme</code> by typing <code>**?theme**</code> or looking in the <code>ggplot</code> <a href="http://ggplot2.tidyverse.org/reference/theme.html">online reference material</a>.</p>
</div>
</div>
<div id="recipe-id217" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> Plotting the Regression Line of a Scatter Plot<a href="Graphics.html#recipe-id217" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id217" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id217" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You are plotting pairs of data points, and you want to add a line that
illustrates their linear regression.</p>
</div>
<div id="solution-id217" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id217" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> there is no need to calculate the linear model first using the R <code>lm</code> function. We can instead use the <code>geom_smooth</code> function to calculate the linear regression inside of our <code>ggplot</code> call.</p>
<p>If our data is in a data frame <code>df</code> and the <em>x</em> and <em>y</em> data are in columns <code>x</code> and <code>y</code>, we plot the regression line like this:</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="Graphics.html#cb635-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb635-2"><a href="Graphics.html#cb635-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb635-3"><a href="Graphics.html#cb635-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb635-4"><a href="Graphics.html#cb635-4" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb635-5"><a href="Graphics.html#cb635-5" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The <code>se = FALSE</code> parameter tells <code>ggplot</code> not to plot the standard error bands around our regression line.</p>
</div>
<div id="discussion-id217" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id217" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we are modeling the <code>strongx</code> dataset found in the <code>faraway</code> package. We can create a linear model using the built-in <code>lm</code> function in R. We can predict the variable <code>crossx</code> as a linear function of <code>energy</code>. First, let’s look at a simple scatter plot of our data:</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="Graphics.html#cb636-1" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb636-2"><a href="Graphics.html#cb636-2" tabindex="-1"></a><span class="fu">data</span>(strongx)</span>
<span id="cb636-3"><a href="Graphics.html#cb636-3" tabindex="-1"></a></span>
<span id="cb636-4"><a href="Graphics.html#cb636-4" tabindex="-1"></a><span class="fu">ggplot</span>(strongx, <span class="fu">aes</span>(energy, crossx)) <span class="sc">+</span></span>
<span id="cb636-5"><a href="Graphics.html#cb636-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:strongx-scatter"></span>
<img src="10_Graphics_files/figure-html/strongx-scatter-1.png" alt="strongx scatter plot" width="85%" />
<p class="caption">
Figure 10.20: strongx scatter plot
</p>
</div>
<p><code>ggplot</code> can calculate a linear model on the fly and then plot the regression line along with our data:</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="Graphics.html#cb637-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(strongx, <span class="fu">aes</span>(energy, crossx)) <span class="sc">+</span></span>
<span id="cb637-2"><a href="Graphics.html#cb637-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb637-3"><a href="Graphics.html#cb637-3" tabindex="-1"></a></span>
<span id="cb637-4"><a href="Graphics.html#cb637-4" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb637-5"><a href="Graphics.html#cb637-5" tabindex="-1"></a>                <span class="at">formula =</span> y <span class="sc">~</span> x)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:one-step"></span>
<img src="10_Graphics_files/figure-html/one-step-1.png" alt="Simple linear model ggplot" width="85%" />
<p class="caption">
Figure 10.21: Simple linear model ggplot
</p>
</div>
<p>We can turn the confidence bands off by adding the <code>se = FALSE</code> option, as shown in Figure <a href="Graphics.html#fig:one-step-nose">10.22</a>:</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="Graphics.html#cb638-1" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb638-2"><a href="Graphics.html#cb638-2" tabindex="-1"></a>                <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb638-3"><a href="Graphics.html#cb638-3" tabindex="-1"></a>                <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:one-step-nose"></span>
<img src="10_Graphics_files/figure-html/one-step-nose-1.png" alt="Simple linear model ggplot without se" width="85%" />
<p class="caption">
Figure 10.22: Simple linear model ggplot without se
</p>
</div>
<p>Notice that in the <code>geom_smooth</code> we use <code>x</code> and <code>y</code> rather than the variable names. <code>ggplot</code> has set the <code>x</code> and <code>y</code> inside the plot based on the aesthetic. Multiple smoothing methods are supported by <code>geom_smooth</code>. You can explore those, and other options in the help, by typing <code>**?geom_smooth**</code>.</p>
<p>If we had a line we wanted to plot that was stored in another R object, we could use <code>geom_abline</code> to plot the line on our graph. In the following example we pull the intercept term and the slope from the regression model <code>m</code> and add those to our graph in Figure <a href="Graphics.html#fig:slopeintercept">10.23</a>:</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="Graphics.html#cb639-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(crossx <span class="sc">~</span> energy, <span class="at">data =</span> strongx)</span>
<span id="cb639-2"><a href="Graphics.html#cb639-2" tabindex="-1"></a></span>
<span id="cb639-3"><a href="Graphics.html#cb639-3" tabindex="-1"></a><span class="fu">ggplot</span>(strongx, <span class="fu">aes</span>(energy, crossx)) <span class="sc">+</span></span>
<span id="cb639-4"><a href="Graphics.html#cb639-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb639-5"><a href="Graphics.html#cb639-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb639-6"><a href="Graphics.html#cb639-6" tabindex="-1"></a>    <span class="at">intercept =</span> m<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb639-7"><a href="Graphics.html#cb639-7" tabindex="-1"></a>    <span class="at">slope =</span> m<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb639-8"><a href="Graphics.html#cb639-8" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slopeintercept"></span>
<img src="10_Graphics_files/figure-html/slopeintercept-1.png" alt="Simple line from slope and intercept" width="85%" />
<p class="caption">
Figure 10.23: Simple line from slope and intercept
</p>
</div>
<p>This produces a plot very similar to Figure <a href="Graphics.html#fig:one-step-nose">10.22</a>. The <code>geom_abline</code> method can be handy if you are plotting a line from a source other than a simple linear model.</p>
</div>
<div id="see_also-id217" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id217" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Chapter <a href="LinearRegressionAndANOVA.html#LinearRegressionAndANOVA">11</a> for more about linear regression and the <code>lm</code> function.</p>
</div>
</div>
<div id="recipe-id184" class="section level2 hasAnchor" number="10.8">
<h2><span class="header-section-number">10.8</span> Plotting All Variables Against All Other Variables<a href="Graphics.html#recipe-id184" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id184" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id184" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your dataset contains multiple numeric variables. You want to see
scatter plots for all pairs of variables.</p>
</div>
<div id="solution-id184" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id184" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot</code> does not have any built-in method to create pairs plots; however, the package <code>GGally</code> provides this functionality with the <code>ggpairs</code> function:</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="Graphics.html#cb640-1" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb640-2"><a href="Graphics.html#cb640-2" tabindex="-1"></a><span class="fu">ggpairs</span>(df)</span></code></pre></div>
</div>
<div id="discussion-id184" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id184" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you have a large number of variables, finding interrelationships
between them is difficult. One useful technique is looking at scatter
plots of all pairs of variables. This would be quite tedious if coded
pair-by-pair, but the <code>ggpairs</code> function from the package <code>GGally</code> provides an easy way to produce all those scatter
plots at once.</p>
<p>The <code>iris</code> dataset contains four numeric variables and one categorical
variable:</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="Graphics.html#cb641-1" tabindex="-1"></a><span class="fu">head</span>(iris)</span>
<span id="cb641-2"><a href="Graphics.html#cb641-2" tabindex="-1"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb641-3"><a href="Graphics.html#cb641-3" tabindex="-1"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb641-4"><a href="Graphics.html#cb641-4" tabindex="-1"></a><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span id="cb641-5"><a href="Graphics.html#cb641-5" tabindex="-1"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb641-6"><a href="Graphics.html#cb641-6" tabindex="-1"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb641-7"><a href="Graphics.html#cb641-7" tabindex="-1"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span id="cb641-8"><a href="Graphics.html#cb641-8" tabindex="-1"></a><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span></code></pre></div>
<p>What is the relationship, if any, between the columns? Plotting
the columns with <code>ggpairs</code> produces multiple scatter plots, as seen in Figure <a href="Graphics.html#fig:ggpairsiris">10.24</a>.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="Graphics.html#cb642-1" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb642-2"><a href="Graphics.html#cb642-2" tabindex="-1"></a><span class="fu">ggpairs</span>(iris)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ggpairsiris"></span>
<img src="10_Graphics_files/figure-html/ggpairsiris-1.png" alt="ggpairs plot of iris data" width="85%" />
<p class="caption">
Figure 10.24: ggpairs plot of iris data
</p>
</div>
<p>The <code>ggpairs</code> function is pretty, but not particularly fast. If you’re just doing interactive work and want a quick peek at the data, the base R <code>plot</code> function provides faster output (see Figure <a href="Graphics.html#fig:basepairs">10.25</a>).</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="Graphics.html#cb643-1" tabindex="-1"></a><span class="fu">plot</span>(iris)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:basepairs"></span>
<img src="10_Graphics_files/figure-html/basepairs-1.png" alt="Base plot pairs plot" width="85%" />
<p class="caption">
Figure 10.25: Base plot pairs plot
</p>
</div>
<p>While the <code>ggpairs</code> function is not as fast to plot as the Base R <code>plot</code> function, it produces density graphs on the diagonal and reports correlation in the upper triangle of the graph. When factors or character columns are present, <code>ggpairs</code> produces histograms on the lower triangle of the graph and boxplots on the upper triangle. These are nice additions to understanding relationships in your data.</p>
</div>
</div>
<div id="recipe-id185" class="section level2 hasAnchor" number="10.9">
<h2><span class="header-section-number">10.9</span> Creating One Scatter Plot for Each Group<a href="Graphics.html#recipe-id185" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id185" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id185" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your dataset contains (at least) two numeric variables and a factor or character field defining a group. You
want to create several scatter plots for the numeric variables, with one
scatter plot for each level of the factor or character field.</p>
</div>
<div id="solution-id185" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id185" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We produce this kind of plot, called a <em>conditioning plot</em>, in <code>ggplot</code> by adding <code>facet_wrap</code> to our plot.
In this example we use the data frame <code>df</code>, which contains three columns: <em>x</em>, <em>y</em>, and <em>f</em>, with <em>f</em> being a factor (or a character string).</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="Graphics.html#cb644-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb644-2"><a href="Graphics.html#cb644-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb644-3"><a href="Graphics.html#cb644-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> f)</span></code></pre></div>
</div>
<div id="discussion-id185" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id185" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conditioning plots (coplots) are another way to explore and illustrate the effect
of a factor or to compare different groups to each other.</p>
<p>The <code>Cars93</code> dataset contains 27 variables describing 93 car models as
of 1993. Two numeric variables are <code>MPG.city</code>, the miles per gallon in
the city, and <code>Horsepower</code>, the engine horsepower. One categorical
variable is <code>Origin</code>, which can be USA or non-USA according to where the
model was built.</p>
<p>Exploring the relationship between MPG and horsepower, we might ask: Is
there a different relationship for USA models and non-USA models?</p>
<p>Let’s examine this as a facet plot:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="Graphics.html#cb645-1" tabindex="-1"></a><span class="fu">data</span>(Cars93, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb645-2"><a href="Graphics.html#cb645-2" tabindex="-1"></a><span class="fu">ggplot</span>(Cars93, <span class="fu">aes</span>(MPG.city, Horsepower)) <span class="sc">+</span></span>
<span id="cb645-3"><a href="Graphics.html#cb645-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb645-4"><a href="Graphics.html#cb645-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Origin)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:facet-cars"></span>
<img src="10_Graphics_files/figure-html/facet-cars-1.png" alt="Cars data with facet" width="85%" />
<p class="caption">
Figure 10.26: Cars data with facet
</p>
</div>
<p>The resulting plot in Figure <a href="Graphics.html#fig:facet-cars">10.26</a> reveals a few insights. If we really crave that 300-horsepower
monster, then we’ll have to buy a car built in the USA; but if we want
high MPG, we have more choices among non-USA models. These insights could be teased out of a statistical analysis, but the visual presentation reveals them much more quickly.</p>
<p>Note that using <code>facet</code> results in subplots with the same x- and y-axis ranges. This helps ensure that visual inspection of the data is not misleading because of differing axis ranges.</p>
</div>
<div id="see_also-id185" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id185" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Base R graphics function <code>coplot</code> can accomplish very similar plots using only Base graphics.</p>
</div>
</div>
<div id="recipe-id175" class="section level2 hasAnchor" number="10.10">
<h2><span class="header-section-number">10.10</span> Creating a Bar Chart<a href="Graphics.html#recipe-id175" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id175" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id175" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to create a bar chart.</p>
</div>
<div id="solution-id175" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id175" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A common situation is to have a column of data that represents a group and then another column that represents a measure about that group. This format is “long” data because the data runs vertically instead of having a column for each group.</p>
<p>Using the <code>geom_bar</code> function in <code>ggplot</code>, we can plot the heights as bars. If the data is already aggregated, we add <code>stat = "identity"</code> so that <code>ggplot</code> knows it needs to do no aggregation on the groups of values before plotting.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="Graphics.html#cb646-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb646-2"><a href="Graphics.html#cb646-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
</div>
<div id="discussion-id175" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id175" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s use the cars made by Ford in the <code>Cars93</code> data in an example:</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="Graphics.html#cb647-1" tabindex="-1"></a>ford_cars <span class="ot">&lt;-</span> Cars93 <span class="sc">%&gt;%</span></span>
<span id="cb647-2"><a href="Graphics.html#cb647-2" tabindex="-1"></a>  <span class="fu">filter</span>(Manufacturer <span class="sc">==</span> <span class="st">&quot;Ford&quot;</span>) </span>
<span id="cb647-3"><a href="Graphics.html#cb647-3" tabindex="-1"></a></span>
<span id="cb647-4"><a href="Graphics.html#cb647-4" tabindex="-1"></a><span class="fu">ggplot</span>(ford_cars, <span class="fu">aes</span>(Model, Horsepower)) <span class="sc">+</span></span>
<span id="cb647-5"><a href="Graphics.html#cb647-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fordcars"></span>
<img src="10_Graphics_files/figure-html/fordcars-1.png" alt="Ford cars bar chart" width="85%" />
<p class="caption">
Figure 10.27: Ford cars bar chart
</p>
</div>
<p>Figure <a href="Graphics.html#fig:fordcars">10.27</a> shows the resulting bar chart.</p>
<p>This example uses <code>stat = "identity"</code>, which assumes that the heights of your bars are conveniently stored as a value in one field with only one record per column. That is not always the case, however. Often you have a vector of numeric data and a
parallel factor or character field that groups the data, and you want to produce a bar
chart of the group means or the group totals.</p>
<p>Let’s work up an example using the built-in <code>airquality</code> dataset, which contains daily temperature data for a single location for five months. The data frame has a numeric <code>Temp</code> column and <code>Month</code> and <code>Day</code> columns. If we want to plot the mean temp by month using <code>ggplot</code>, we don’t need to precompute the mean; instead, we can have <code>ggplot</code> do that in the plot command logic. To tell <code>ggplot</code> to calculate the mean, we pass <code>stat = "summary", fun.y = "mean"</code> to the <code>geom_bar</code> command. We can also turn the month numbers into dates using the built-in constant <code>month.abb</code>, which contains the abbreviations for the months.</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="Graphics.html#cb648-1" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(month.abb[Month], Temp)) <span class="sc">+</span></span>
<span id="cb648-2"><a href="Graphics.html#cb648-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun.y =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb648-3"><a href="Graphics.html#cb648-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean Temp by Month&quot;</span>,</span>
<span id="cb648-4"><a href="Graphics.html#cb648-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb648-5"><a href="Graphics.html#cb648-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Temp (deg. F)&quot;</span>)</span>
<span id="cb648-6"><a href="Graphics.html#cb648-6" tabindex="-1"></a><span class="co">#&gt; Warning in geom_bar(stat = &quot;summary&quot;, fun.y = &quot;mean&quot;): Ignoring unknown</span></span>
<span id="cb648-7"><a href="Graphics.html#cb648-7" tabindex="-1"></a><span class="co">#&gt; parameters: `fun.y`</span></span>
<span id="cb648-8"><a href="Graphics.html#cb648-8" tabindex="-1"></a><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:aq1"></span>
<img src="10_Graphics_files/figure-html/aq1-1.png" alt="Bar chart: Temp by month" width="85%" />
<p class="caption">
Figure 10.28: Bar chart: Temp by month
</p>
</div>
<p>Figure <a href="Graphics.html#fig:aq1">10.28</a> shows the resulting plot. But you might notice the sort order on the months is alphabetical, which is not how we typically like to see months sorted.</p>
<p>We can fix the sorting issue using a few functions from <code>dplyr</code> combined with <code>fct_inorder</code> from the <code>forcats</code> tidyverse package. To get the months in the correct order, we can sort the data frame by <code>Month</code>, which is the month number. Then we can apply <code>fct_inorder</code>, which will arrange our factors in the order they appear in the data. You can see in Figure <a href="Graphics.html#fig:aq2">10.29</a> that the bars are now sorted properly.</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="Graphics.html#cb649-1" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb649-2"><a href="Graphics.html#cb649-2" tabindex="-1"></a></span>
<span id="cb649-3"><a href="Graphics.html#cb649-3" tabindex="-1"></a>aq_data <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb649-4"><a href="Graphics.html#cb649-4" tabindex="-1"></a>  <span class="fu">arrange</span>(Month) <span class="sc">%&gt;%</span></span>
<span id="cb649-5"><a href="Graphics.html#cb649-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month_abb =</span> <span class="fu">fct_inorder</span>(month.abb[Month]))</span>
<span id="cb649-6"><a href="Graphics.html#cb649-6" tabindex="-1"></a></span>
<span id="cb649-7"><a href="Graphics.html#cb649-7" tabindex="-1"></a><span class="fu">ggplot</span>(aq_data, <span class="fu">aes</span>(month_abb, Temp)) <span class="sc">+</span></span>
<span id="cb649-8"><a href="Graphics.html#cb649-8" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun.y =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb649-9"><a href="Graphics.html#cb649-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean Temp by Month&quot;</span>,</span>
<span id="cb649-10"><a href="Graphics.html#cb649-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb649-11"><a href="Graphics.html#cb649-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Temp (deg. F)&quot;</span>)</span>
<span id="cb649-12"><a href="Graphics.html#cb649-12" tabindex="-1"></a><span class="co">#&gt; Warning in geom_bar(stat = &quot;summary&quot;, fun.y = &quot;mean&quot;): Ignoring unknown</span></span>
<span id="cb649-13"><a href="Graphics.html#cb649-13" tabindex="-1"></a><span class="co">#&gt; parameters: `fun.y`</span></span>
<span id="cb649-14"><a href="Graphics.html#cb649-14" tabindex="-1"></a><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:aq2"></span>
<img src="10_Graphics_files/figure-html/aq2-1.png" alt="Bar chart properly sorted" width="85%" />
<p class="caption">
Figure 10.29: Bar chart properly sorted
</p>
</div>
</div>
<div id="see_also-id175" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id175" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id177">10.11</a>, <a href="Graphics.html#recipe-id177">“Adding Confidence Intervals to a Bar Chart”</a>, for
adding confidence intervals and Recipe <a href="Graphics.html#recipe-id176">10.12</a>, <a href="Graphics.html#recipe-id176">“Coloring a Bar Chart”</a>, for adding color.</p>
<p><code>?geom_bar</code> for help with bar charts in <code>ggplot</code>.</p>
<p><code>barplot</code> for Base R bar charts or the <code>barchart</code> function in the <code>lattice</code> package.</p>
</div>
</div>
<div id="recipe-id177" class="section level2 hasAnchor" number="10.11">
<h2><span class="header-section-number">10.11</span> Adding Confidence Intervals to a Bar Chart<a href="Graphics.html#recipe-id177" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id177" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id177" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to augment a bar chart with confidence intervals.</p>
</div>
<div id="solution-id177" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id177" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose you have a data frame <code>df</code> with columns <code>group</code>, which are group names; <code>stat</code>, which is a column of statistics; and <code>lower</code> and <code>upper</code>, which represent the corresponding limits for the confidence intervals. We can display a bar chart of <code>stat</code> for each <code>group</code> and its confidence intervals using the <code>geom_bar</code> combined with <code>geom_errorbar</code>.</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="Graphics.html#cb650-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(group, stat)) <span class="sc">+</span></span>
<span id="cb650-2"><a href="Graphics.html#cb650-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb650-3"><a href="Graphics.html#cb650-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> .<span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:confbars"></span>
<img src="10_Graphics_files/figure-html/confbars-1.png" alt="Bar chart with confidence intervals" width="85%" />
<p class="caption">
Figure 10.30: Bar chart with confidence intervals
</p>
</div>
<p>Figure <a href="Graphics.html#fig:confbars">10.30</a> shows the resulting bar chart with confidence intervals.</p>
</div>
<div id="discussion-id177" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id177" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Most bar charts display point estimates, which are shown by the heights
of the bars, but rarely do they include confidence intervals. Our inner
statisticians dislike this intensely. The point estimate is only
half of the story; the confidence interval gives the full story.</p>
<p>Fortunately, we can plot the error bars using <code>ggplot</code>. The hard part is calculating the intervals. In the previous examples our data had a simple –15% and +20% interval. However, in
Recipe <a href="Graphics.html#recipe-id175">10.10</a>, <a href="Graphics.html#recipe-id175">“Creating a Bar Chart”</a>, we calculated group means before
plotting them. If we let <code>ggplot</code> do the calculations for us, we can use the built-in <code>mean_se</code> along with the <code>stat_summary</code> function to get the standard errors of the mean measures.</p>
<p>Let’s use the <code>airquality</code> data we used previously. First we’ll do the sorted factor procedure (from the prior recipe) to get the month names in the desired order:</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="Graphics.html#cb651-1" tabindex="-1"></a>aq_data <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb651-2"><a href="Graphics.html#cb651-2" tabindex="-1"></a>  <span class="fu">arrange</span>(Month) <span class="sc">%&gt;%</span></span>
<span id="cb651-3"><a href="Graphics.html#cb651-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month_abb =</span> <span class="fu">fct_inorder</span>(month.abb[Month]))</span></code></pre></div>
<p>Now we can plot the bars along with the associated standard errors as in Figure <a href="Graphics.html#fig:airqual">10.31</a>:</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="Graphics.html#cb652-1" tabindex="-1"></a><span class="fu">ggplot</span>(aq_data, <span class="fu">aes</span>(month_abb, Temp)) <span class="sc">+</span></span>
<span id="cb652-2"><a href="Graphics.html#cb652-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>,</span>
<span id="cb652-3"><a href="Graphics.html#cb652-3" tabindex="-1"></a>           <span class="at">fun.y =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb652-4"><a href="Graphics.html#cb652-4" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb652-5"><a href="Graphics.html#cb652-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>) <span class="sc">+</span></span>
<span id="cb652-6"><a href="Graphics.html#cb652-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean Temp by Month&quot;</span>,</span>
<span id="cb652-7"><a href="Graphics.html#cb652-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb652-8"><a href="Graphics.html#cb652-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Temp (deg. F)&quot;</span>)</span>
<span id="cb652-9"><a href="Graphics.html#cb652-9" tabindex="-1"></a><span class="co">#&gt; Warning in geom_bar(stat = &quot;summary&quot;, fun.y = &quot;mean&quot;, fill = &quot;cornflowerblue&quot;):</span></span>
<span id="cb652-10"><a href="Graphics.html#cb652-10" tabindex="-1"></a><span class="co">#&gt; Ignoring unknown parameters: `fun.y`</span></span>
<span id="cb652-11"><a href="Graphics.html#cb652-11" tabindex="-1"></a><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:airqual"></span>
<img src="10_Graphics_files/figure-html/airqual-1.png" alt="Mean temp by month with error bars" width="85%" />
<p class="caption">
Figure 10.31: Mean temp by month with error bars
</p>
</div>
<p>Sometimes you’ll want to sort your columns in your bar chart in descending order based on their height. This can be a little bit confusing when you’re using summary stats in <code>ggplot</code>, but the secret is to use <code>mean</code> in the <code>reorder</code> statement to sort the factor by the mean of the temp. Note that the reference to <code>mean</code> in <code>reorder</code> is not quoted, while the reference to <code>mean</code> in <code>geom_bar</code> is quoted:</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="Graphics.html#cb653-1" tabindex="-1"></a><span class="fu">ggplot</span>(aq_data, <span class="fu">aes</span>(<span class="fu">reorder</span>(month_abb, <span class="sc">-</span>Temp, mean), Temp)) <span class="sc">+</span></span>
<span id="cb653-2"><a href="Graphics.html#cb653-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>,</span>
<span id="cb653-3"><a href="Graphics.html#cb653-3" tabindex="-1"></a>           <span class="at">fun.y =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb653-4"><a href="Graphics.html#cb653-4" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;tomato&quot;</span>) <span class="sc">+</span></span>
<span id="cb653-5"><a href="Graphics.html#cb653-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>) <span class="sc">+</span></span>
<span id="cb653-6"><a href="Graphics.html#cb653-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean Temp by Month&quot;</span>,</span>
<span id="cb653-7"><a href="Graphics.html#cb653-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb653-8"><a href="Graphics.html#cb653-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Temp (deg. F)&quot;</span>)</span>
<span id="cb653-9"><a href="Graphics.html#cb653-9" tabindex="-1"></a><span class="co">#&gt; Warning in geom_bar(stat = &quot;summary&quot;, fun.y = &quot;mean&quot;, fill = &quot;tomato&quot;):</span></span>
<span id="cb653-10"><a href="Graphics.html#cb653-10" tabindex="-1"></a><span class="co">#&gt; Ignoring unknown parameters: `fun.y`</span></span>
<span id="cb653-11"><a href="Graphics.html#cb653-11" tabindex="-1"></a><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:airqual2"></span>
<img src="10_Graphics_files/figure-html/airqual2-1.png" alt="Mean temp by month in descending order" width="85%" />
<p class="caption">
Figure 10.32: Mean temp by month in descending order
</p>
</div>
<p>You may look at this example and the result in Figure <a href="Graphics.html#fig:airqual2">10.32</a> and wonder, “Why didn’t they just use <code>reorder(month_abb, Month)</code> in the first example instead of that sorting business with <code>forcats::fct_inorder</code> to get the months in the right order?” Well, we could have. But sorting using <code>fct_inorder</code> is a design pattern that provides flexibility for more complicated things. Plus it’s quite easy to read in a script. Using <code>reorder</code> inside the <code>aes</code> is a bit more dense and hard to read later. But either approach is reasonable.</p>
</div>
<div id="see_also-id177" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id177" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="GeneralStatistics.html#recipe-id123">9.9</a>, <a href="GeneralStatistics.html#recipe-id123">“Forming a Confidence Interval for a Mean”</a>, for more about <code>t.test</code>.</p>
</div>
</div>
<div id="recipe-id176" class="section level2 hasAnchor" number="10.12">
<h2><span class="header-section-number">10.12</span> Coloring a Bar Chart<a href="Graphics.html#recipe-id176" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id176" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id176" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to color or shade the bars of a bar chart.</p>
</div>
<div id="solution-id176" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id176" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>gplot</code> we add the <code>fill =</code> call to our <code>aes</code> and let <code>ggplot</code> pick the colors for us:</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="Graphics.html#cb654-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> group))</span></code></pre></div>
</div>
<div id="discussion-id176" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id176" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <code>ggplot</code> we can use the <code>fill</code> parameter in <code>aes</code> to tell <code>ggplot</code> what field to base the colors on. If we pass a numeric field to <code>ggplot</code>, we will get a continuous gradient of colors; and if we pass a factor or character field to <code>fill</code>, we will get contrasting colors for each group. Here we pass the character name of each month to the <code>fill</code> parameter:</p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="Graphics.html#cb655-1" tabindex="-1"></a>aq_data <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb655-2"><a href="Graphics.html#cb655-2" tabindex="-1"></a>  <span class="fu">arrange</span>(Month) <span class="sc">%&gt;%</span></span>
<span id="cb655-3"><a href="Graphics.html#cb655-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month_abb =</span> <span class="fu">fct_inorder</span>(month.abb[Month]))</span>
<span id="cb655-4"><a href="Graphics.html#cb655-4" tabindex="-1"></a></span>
<span id="cb655-5"><a href="Graphics.html#cb655-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aq_data, <span class="fu">aes</span>(month_abb, Temp, <span class="at">fill =</span> month_abb)) <span class="sc">+</span></span>
<span id="cb655-6"><a href="Graphics.html#cb655-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun.y =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb655-7"><a href="Graphics.html#cb655-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean Temp by Month&quot;</span>,</span>
<span id="cb655-8"><a href="Graphics.html#cb655-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb655-9"><a href="Graphics.html#cb655-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Temp (deg. F)&quot;</span>) <span class="sc">+</span></span>
<span id="cb655-10"><a href="Graphics.html#cb655-10" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Paired&quot;</span>)</span>
<span id="cb655-11"><a href="Graphics.html#cb655-11" tabindex="-1"></a><span class="co">#&gt; Warning in geom_bar(stat = &quot;summary&quot;, fun.y = &quot;mean&quot;): Ignoring unknown</span></span>
<span id="cb655-12"><a href="Graphics.html#cb655-12" tabindex="-1"></a><span class="co">#&gt; parameters: `fun.y`</span></span>
<span id="cb655-13"><a href="Graphics.html#cb655-13" tabindex="-1"></a><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:colored-air"></span>
<img src="10_Graphics_files/figure-html/colored-air-1.png" alt="Colored monthly temp bar chart" width="85%" />
<p class="caption">
Figure 10.33: Colored monthly temp bar chart
</p>
</div>
<p>We define the colors in the resulting bar chart (Figure <a href="Graphics.html#fig:colored-air">10.33</a>) by calling <code>scale_fill_brewer(palette="Paired")</code>. The <code>"Paired"</code> color palette comes, along with many other color palettes, in the package <code>RColorBrewer</code>.</p>
<p>If we wanted to change the color of each bar based on the temperature, we can’t just set <code>fill = Temp</code>—as might seem intuitive—because <code>ggplot</code> would not understand we want the mean temperature after the grouping by month. So the way we get around this is to access a special field inside of our graph called <code>..y..</code>, which is the calculated value on the y-axis. But we don’t want the legend labeled <code>..y..</code> so we add <code>fill = "Temp"</code> to our <code>labs</code> call in order to change the name of the legend. The result is shown in Figure <a href="Graphics.html#fig:barsshaded">10.34</a>.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="Graphics.html#cb656-1" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(month.abb[Month], Temp, <span class="at">fill =</span> ..y..)) <span class="sc">+</span></span>
<span id="cb656-2"><a href="Graphics.html#cb656-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun.y =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb656-3"><a href="Graphics.html#cb656-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean Temp by Month&quot;</span>,</span>
<span id="cb656-4"><a href="Graphics.html#cb656-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb656-5"><a href="Graphics.html#cb656-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Temp (deg. F)&quot;</span>,</span>
<span id="cb656-6"><a href="Graphics.html#cb656-6" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Temp&quot;</span>)</span>
<span id="cb656-7"><a href="Graphics.html#cb656-7" tabindex="-1"></a><span class="co">#&gt; Warning in geom_bar(stat = &quot;summary&quot;, fun.y = &quot;mean&quot;): Ignoring unknown</span></span>
<span id="cb656-8"><a href="Graphics.html#cb656-8" tabindex="-1"></a><span class="co">#&gt; parameters: `fun.y`</span></span>
<span id="cb656-9"><a href="Graphics.html#cb656-9" tabindex="-1"></a><span class="co">#&gt; Warning: The dot-dot notation (`..y..`) was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb656-10"><a href="Graphics.html#cb656-10" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `after_stat(y)` instead.</span></span>
<span id="cb656-11"><a href="Graphics.html#cb656-11" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb656-12"><a href="Graphics.html#cb656-12" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb656-13"><a href="Graphics.html#cb656-13" tabindex="-1"></a><span class="co">#&gt; generated.</span></span>
<span id="cb656-14"><a href="Graphics.html#cb656-14" tabindex="-1"></a><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:barsshaded"></span>
<img src="10_Graphics_files/figure-html/barsshaded-1.png" alt="Bar chart shaded by value" width="85%" />
<p class="caption">
Figure 10.34: Bar chart shaded by value
</p>
</div>
<p>If we want to reverse the color scale, we can just add a negative sign, <code>-</code>, in front of the field we are filling by: <code>fill= -..y..</code>, for example.</p>
</div>
<div id="see_also-id176" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id176" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id175">10.10</a>, <a href="Graphics.html#recipe-id175">“Creating a bar chart”</a>, for creating a bar chart.</p>
</div>
</div>
<div id="recipe-id174" class="section level2 hasAnchor" number="10.13">
<h2><span class="header-section-number">10.13</span> Plotting a Line from x and y Points<a href="Graphics.html#recipe-id174" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id174" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id174" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have paired observations in a data frame: (<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>), (<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>), …,
(<em>x</em><sub><em>n</em></sub>, <em>y</em><sub><em>n</em></sub>). You want to plot a series of line segments that
connect the data points.</p>
</div>
<div id="solution-id174" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id174" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> we can use <code>geom_point</code> to plot the points:</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="Graphics.html#cb657-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb657-2"><a href="Graphics.html#cb657-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>Since <code>ggplot</code> graphics are built up, element by element, we can have both a point and a line in the same graphic very easily by having two geoms:</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="Graphics.html#cb658-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x , y)) <span class="sc">+</span></span>
<span id="cb658-2"><a href="Graphics.html#cb658-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb658-3"><a href="Graphics.html#cb658-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
</div>
<div id="discussion-id174" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id174" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To illustrate, let’s look at some example US economic data that comes with <code>ggplot2</code>. This example data frame has a column called <code>date</code>, which we’ll plot on the x-axis and a field <code>unemploy</code>, which is the number of unemployed people.</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="Graphics.html#cb659-1" tabindex="-1"></a><span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date , unemploy)) <span class="sc">+</span></span>
<span id="cb659-2"><a href="Graphics.html#cb659-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb659-3"><a href="Graphics.html#cb659-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:linechart"></span>
<img src="10_Graphics_files/figure-html/linechart-1.png" alt="Line chart example" width="85%" />
<p class="caption">
Figure 10.35: Line chart example
</p>
</div>
<p>Figure <a href="Graphics.html#fig:linechart">10.35</a> shows the resulting chart, which contains both lines and points because we used both geoms.</p>
</div>
<div id="see_also-id174" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id174" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe @ref(recipe-id171,) <a href="Graphics.html#recipe-id171">“Creating a Scatter Plot”</a>.</p>
</div>
</div>
<div id="recipe-id256" class="section level2 hasAnchor" number="10.14">
<h2><span class="header-section-number">10.14</span> Changing the Type, Width, or Color of a Line<a href="Graphics.html#recipe-id256" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id256" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id256" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You are plotting a line. You want to change the type, width, or color of
the line.</p>
</div>
<div id="solution-id256" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id256" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot</code> uses the <code>linetype</code> parameter for controlling the appearance of lines:</p>
<ul>
<li><p><code>linetype="solid"</code> or <code>linetype=1</code> (default)</p></li>
<li><p><code>linetype="dashed"</code> or <code>linetype=2</code></p></li>
<li><p><code>linetype="dotted"</code> or <code>linetype=3</code></p></li>
<li><p><code>linetype="dotdash"</code> or <code>linetype=4</code></p></li>
<li><p><code>linetype="longdash"</code> or <code>linetype=5</code></p></li>
<li><p><code>linetype="twodash"</code> or <code>linetype=6</code></p></li>
<li><p><code>linetype="blank"</code> or <code>linetype=0</code> (inhibits drawing)</p></li>
</ul>
<p>You can change the line characteristics by passing <code>linetype</code>, <code>col</code>, and/or <code>size</code> as parameters to the <code>geom_line</code>.
So if we want to change the line type to dashed, red, and heavy, we could pass the <code>linetype</code>, <code>col</code>, and <code>size</code> params to <code>geom_line</code>:</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="Graphics.html#cb660-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb660-2"><a href="Graphics.html#cb660-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb660-3"><a href="Graphics.html#cb660-3" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb660-4"><a href="Graphics.html#cb660-4" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
<div id="discussion-id256" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id256" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The example syntax shows how to draw one line and specify its style, width, or color. A common scenario involves drawing multiple lines, each with its own style, width, or color.</p>
<p>Let’s set up some example data:</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="Graphics.html#cb661-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb661-2"><a href="Graphics.html#cb661-2" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x<span class="sc">**</span><span class="fl">1.5</span></span>
<span id="cb661-3"><a href="Graphics.html#cb661-3" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> x<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb661-4"><a href="Graphics.html#cb661-4" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> x<span class="sc">**</span><span class="fl">2.5</span></span>
<span id="cb661-5"><a href="Graphics.html#cb661-5" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y1, y2, y3)</span></code></pre></div>
<p>In <code>ggplot</code> this can be a conundrum for many users. The challenge is that <code>ggplot</code> works best with “long” data instead of “wide” data,
as was mentioned in the Introduction to this chapter.
Our example data frame has four columns of wide data:</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="Graphics.html#cb662-1" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">3</span>)</span>
<span id="cb662-2"><a href="Graphics.html#cb662-2" tabindex="-1"></a><span class="co">#&gt;   x   y1 y2    y3</span></span>
<span id="cb662-3"><a href="Graphics.html#cb662-3" tabindex="-1"></a><span class="co">#&gt; 1 1 1.00  1  1.00</span></span>
<span id="cb662-4"><a href="Graphics.html#cb662-4" tabindex="-1"></a><span class="co">#&gt; 2 2 2.83  4  5.66</span></span>
<span id="cb662-5"><a href="Graphics.html#cb662-5" tabindex="-1"></a><span class="co">#&gt; 3 3 5.20  9 15.59</span></span></code></pre></div>
<p>We can make our wide data long by using the <code>gather</code> function from the core tidyverse package <code>tidyr</code>. In this example, we use <code>gather</code> to create a new column named <code>bucket</code> and put our column names in there while keeping our <code>x</code> and <code>y</code> variables.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="Graphics.html#cb663-1" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(df, bucket, y, <span class="sc">-</span>x)</span>
<span id="cb663-2"><a href="Graphics.html#cb663-2" tabindex="-1"></a><span class="fu">head</span>(df_long, <span class="dv">3</span>)</span>
<span id="cb663-3"><a href="Graphics.html#cb663-3" tabindex="-1"></a><span class="co">#&gt;   x bucket    y</span></span>
<span id="cb663-4"><a href="Graphics.html#cb663-4" tabindex="-1"></a><span class="co">#&gt; 1 1     y1 1.00</span></span>
<span id="cb663-5"><a href="Graphics.html#cb663-5" tabindex="-1"></a><span class="co">#&gt; 2 2     y1 2.83</span></span>
<span id="cb663-6"><a href="Graphics.html#cb663-6" tabindex="-1"></a><span class="co">#&gt; 3 3     y1 5.20</span></span>
<span id="cb663-7"><a href="Graphics.html#cb663-7" tabindex="-1"></a><span class="fu">tail</span>(df_long, <span class="dv">3</span>)</span>
<span id="cb663-8"><a href="Graphics.html#cb663-8" tabindex="-1"></a><span class="co">#&gt;     x bucket   y</span></span>
<span id="cb663-9"><a href="Graphics.html#cb663-9" tabindex="-1"></a><span class="co">#&gt; 28  8     y3 181</span></span>
<span id="cb663-10"><a href="Graphics.html#cb663-10" tabindex="-1"></a><span class="co">#&gt; 29  9     y3 243</span></span>
<span id="cb663-11"><a href="Graphics.html#cb663-11" tabindex="-1"></a><span class="co">#&gt; 30 10     y3 316</span></span></code></pre></div>
<p>Now we can pass <code>bucket</code> to the <code>col</code> parameter and get multiple lines, each a different color:</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="Graphics.html#cb664-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(x, y, <span class="at">col =</span> bucket)) <span class="sc">+</span></span>
<span id="cb664-2"><a href="Graphics.html#cb664-2" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiplelines"></span>
<img src="10_Graphics_files/figure-html/multiplelines-1.png" alt="Multiple line chart" width="85%" />
<p class="caption">
Figure 10.36: Multiple line chart
</p>
</div>
<p>Figure <a href="Graphics.html#fig:multiplelines">10.36</a> shows the resulting graph with each variable represented in a different color.</p>
<p>It’s straightforward to vary the line weight by a variable by passing a numerical variable to <code>size</code>:</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="Graphics.html#cb665-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y1, <span class="at">size =</span> y2)) <span class="sc">+</span></span>
<span id="cb665-2"><a href="Graphics.html#cb665-2" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb665-3"><a href="Graphics.html#cb665-3" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">name =</span> <span class="st">&quot;Thickness based on y2&quot;</span>)</span>
<span id="cb665-4"><a href="Graphics.html#cb665-4" tabindex="-1"></a><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb665-5"><a href="Graphics.html#cb665-5" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `linewidth` instead.</span></span>
<span id="cb665-6"><a href="Graphics.html#cb665-6" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb665-7"><a href="Graphics.html#cb665-7" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb665-8"><a href="Graphics.html#cb665-8" tabindex="-1"></a><span class="co">#&gt; generated.</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:thickness"></span>
<img src="10_Graphics_files/figure-html/thickness-1.png" alt="Thickness as a function of x" width="85%" />
<p class="caption">
Figure 10.37: Thickness as a function of x
</p>
</div>
<p>The result of varying the thickness with <em>x</em> is shown in Figure <a href="Graphics.html#fig:thickness">10.37</a>.</p>
</div>
<div id="see_also-id256" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id256" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id174">10.13</a>, <a href="Graphics.html#recipe-id174">“Plotting a Line from x and y Points”</a>, for plotting a
basic line.</p>
</div>
</div>
<div id="recipe-id263" class="section level2 hasAnchor" number="10.15">
<h2><span class="header-section-number">10.15</span> Plotting Multiple Datasets<a href="Graphics.html#recipe-id263" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id263" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id263" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to show multiple datasets in one plot.</p>
</div>
<div id="solution-id263" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id263" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can add multiple data frames to a <code>ggplot</code> figure by creating an empty plot and then adding two different geoms to the plot:</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="Graphics.html#cb666-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb666-2"><a href="Graphics.html#cb666-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(x1, y1)) <span class="sc">+</span></span>
<span id="cb666-3"><a href="Graphics.html#cb666-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(x2, y2))</span></code></pre></div>
<p>This code uses <code>geom_line</code> but these could be any geom.</p>
</div>
<div id="discussion-id263" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id263" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We could combine the data into one data frame before plotting using one of the join functions from <code>dplyr</code>. However, next we will create two separate data frames and then add them each to a <code>ggplot</code> graph.</p>
<p>First let’s set up our example data frames, <code>df1</code> and <code>df2</code>:</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="Graphics.html#cb667-1" tabindex="-1"></a><span class="co"># example data</span></span>
<span id="cb667-2"><a href="Graphics.html#cb667-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb667-3"><a href="Graphics.html#cb667-3" tabindex="-1"></a></span>
<span id="cb667-4"><a href="Graphics.html#cb667-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb667-5"><a href="Graphics.html#cb667-5" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, .<span class="dv">5</span>)</span>
<span id="cb667-6"><a href="Graphics.html#cb667-6" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y1)</span>
<span id="cb667-7"><a href="Graphics.html#cb667-7" tabindex="-1"></a></span>
<span id="cb667-8"><a href="Graphics.html#cb667-8" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> (.<span class="dv">5</span> <span class="sc">*</span> n)<span class="sc">:</span>((<span class="fl">1.5</span> <span class="sc">*</span> n) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb667-9"><a href="Graphics.html#cb667-9" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">1</span>, .<span class="dv">5</span>)</span>
<span id="cb667-10"><a href="Graphics.html#cb667-10" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x2, y2)</span></code></pre></div>
<p>Typically we would pass the data frame directly into the <code>ggplot</code> function call. Since we want two geoms with two different data sources, we will initiate a plot with <code>ggplot</code> and then add in two calls to <code>geom_line</code>, each with its own data source.</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="Graphics.html#cb668-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb668-2"><a href="Graphics.html#cb668-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(x1, y1), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb668-3"><a href="Graphics.html#cb668-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(x2, y2), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:twolines"></span>
<img src="10_Graphics_files/figure-html/twolines-1.png" alt="Two lines, one plot" width="85%" />
<p class="caption">
Figure 10.38: Two lines, one plot
</p>
</div>
<p><code>ggplot</code> allows us to make multiple calls to different <code>geom_</code> functions, each with its own data source, if desired. Then <code>ggplot</code> will look at all the data we are plotting and adjust the ranges to accommodate all the data.</p>
<p>The graph with expanded limits is shown in Figure <a href="Graphics.html#fig:twolines">10.38</a>.</p>
</div>
</div>
<div id="recipe-id186" class="section level2 hasAnchor" number="10.16">
<h2><span class="header-section-number">10.16</span> Adding Vertical or Horizontal Lines<a href="Graphics.html#recipe-id186" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id186" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id186" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to add a vertical or horizontal line to your plot, such as an
axis through the origin or a pointer to a threshold.</p>
</div>
<div id="solution-id186" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id186" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>ggplot</code> functions <code>geom_vline</code> and <code>geom_hline</code> produce vertical and horizontal lines, respectively. The functions can also take <code>color</code>, <code>linetype</code>, and <code>size</code> parameters to set the line style:</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="Graphics.html#cb669-1" tabindex="-1"></a><span class="co"># using the data.frame df1 from the prior recipe</span></span>
<span id="cb669-2"><a href="Graphics.html#cb669-2" tabindex="-1"></a><span class="fu">ggplot</span>(df1) <span class="sc">+</span></span>
<span id="cb669-3"><a href="Graphics.html#cb669-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y1) <span class="sc">+</span></span>
<span id="cb669-4"><a href="Graphics.html#cb669-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb669-5"><a href="Graphics.html#cb669-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb669-6"><a href="Graphics.html#cb669-6" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="dv">10</span>,</span>
<span id="cb669-7"><a href="Graphics.html#cb669-7" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb669-8"><a href="Graphics.html#cb669-8" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb669-9"><a href="Graphics.html#cb669-9" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb669-10"><a href="Graphics.html#cb669-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb669-11"><a href="Graphics.html#cb669-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vhlines"></span>
<img src="10_Graphics_files/figure-html/vhlines-1.png" alt="Vertical and horizontal lines" width="85%" />
<p class="caption">
Figure 10.39: Vertical and horizontal lines
</p>
</div>
<p>Figure <a href="Graphics.html#fig:vhlines">10.39</a> shows the resulting plot with added horizontal and vertical lines.</p>
</div>
<div id="discussion-id186" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id186" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A typical use of lines would be drawing regularly spaced lines. Suppose we have a sample of points, <code>samp</code>. First, we plot them with a solid line through the mean. Then we calculate and draw dotted lines at ±1 and ±2 standard deviations away
from the mean. We can add the lines into our plot with <code>geom_hline</code>:</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="Graphics.html#cb670-1" tabindex="-1"></a>samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb670-2"><a href="Graphics.html#cb670-2" tabindex="-1"></a>samp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(samp, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(samp))</span>
<span id="cb670-3"><a href="Graphics.html#cb670-3" tabindex="-1"></a></span>
<span id="cb670-4"><a href="Graphics.html#cb670-4" tabindex="-1"></a>mean_line <span class="ot">&lt;-</span> <span class="fu">mean</span>(samp_df<span class="sc">$</span>samp)</span>
<span id="cb670-5"><a href="Graphics.html#cb670-5" tabindex="-1"></a>sd_lines <span class="ot">&lt;-</span> mean_line <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sd</span>(samp_df<span class="sc">$</span>samp)</span>
<span id="cb670-6"><a href="Graphics.html#cb670-6" tabindex="-1"></a></span>
<span id="cb670-7"><a href="Graphics.html#cb670-7" tabindex="-1"></a><span class="fu">ggplot</span>(samp_df) <span class="sc">+</span></span>
<span id="cb670-8"><a href="Graphics.html#cb670-8" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> samp) <span class="sc">+</span></span>
<span id="cb670-9"><a href="Graphics.html#cb670-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb670-10"><a href="Graphics.html#cb670-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_line, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb670-11"><a href="Graphics.html#cb670-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> sd_lines, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spacedlines"></span>
<img src="10_Graphics_files/figure-html/spacedlines-1.png" alt="Mean and SD bands in a plot" width="85%" />
<p class="caption">
Figure 10.40: Mean and SD bands in a plot
</p>
</div>
<p>Figure <a href="Graphics.html#fig:spacedlines">10.40</a> shows the sampled data along with the mean and standard deviation lines.</p>
</div>
<div id="see_also-id186" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id186" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id256">10.14</a>, <a href="Graphics.html#recipe-id256">“Changing the Type, Width, or Color of a Line”</a>, for more about changing line types.</p>
</div>
</div>
<div id="recipe-id178" class="section level2 hasAnchor" number="10.17">
<h2><span class="header-section-number">10.17</span> Creating a Boxplot<a href="Graphics.html#recipe-id178" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id178" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id178" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to create a boxplot of your data.</p>
</div>
<div id="solution-id178" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id178" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>geom_boxplot</code> from <code>ggplot</code> to add a boxplot geom to a <code>ggplot</code> graphic. Using the <code>samp_df</code> data frame from the prior recipe, we can create a boxplot of the values in the <code>x</code> column. The resulting graph is shown in Figure <a href="Graphics.html#fig:boxplot">10.41</a>.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="Graphics.html#cb671-1" tabindex="-1"></a><span class="fu">ggplot</span>(samp_df) <span class="sc">+</span></span>
<span id="cb671-2"><a href="Graphics.html#cb671-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> samp) <span class="sc">+</span></span>
<span id="cb671-3"><a href="Graphics.html#cb671-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxplot"></span>
<img src="10_Graphics_files/figure-html/boxplot-1.png" alt="Single boxplot" width="85%" />
<p class="caption">
Figure 10.41: Single boxplot
</p>
</div>
</div>
<div id="discussion-id178" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id178" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A boxplot provides a quick and easy visual summary of a dataset.</p>
<ul>
<li><p>The thick line in the middle is the median.</p></li>
<li><p>The box surrounding the median identifies the first and third
quartiles; the bottom of the box is Q1, and the top is Q3.</p></li>
<li><p>The “whiskers” above and below the box show the range of the data,
excluding outliers.</p></li>
<li><p>The circles identify outliers. By default, an outlier is defined as
any value that is farther than 1.5×IQR away from the box. (IQR is
the <em>interquartile range</em>, or Q3–Q1.) In this example, there are
a few outliers on the high side.</p></li>
</ul>
<p>We can rotate the boxplot by flipping the coordinates. There are some situations where this makes a more appealing graphic, as shown in Figure <a href="Graphics.html#fig:boxplotrotate">10.42</a>.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="Graphics.html#cb672-1" tabindex="-1"></a><span class="fu">ggplot</span>(samp_df) <span class="sc">+</span></span>
<span id="cb672-2"><a href="Graphics.html#cb672-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> samp) <span class="sc">+</span></span>
<span id="cb672-3"><a href="Graphics.html#cb672-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb672-4"><a href="Graphics.html#cb672-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxplotrotate"></span>
<img src="10_Graphics_files/figure-html/boxplotrotate-1.png" alt="Single Boxplot" width="85%" />
<p class="caption">
Figure 10.42: Single Boxplot
</p>
</div>
</div>
<div id="see_also-id178" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id178" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One boxplot alone is pretty boring. See Recipe <a href="Graphics.html#recipe-id179">10.18</a>,
<a href="Graphics.html#recipe-id179">“Creating One Boxplot for Each Factor Level”</a>, for
creating multiple boxplots.</p>
</div>
</div>
<div id="recipe-id179" class="section level2 hasAnchor" number="10.18">
<h2><span class="header-section-number">10.18</span> Creating One Boxplot for Each Factor Level<a href="Graphics.html#recipe-id179" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id179" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id179" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your dataset contains a numeric variable and a factor (or other catagorical text). You want to create several boxplots of the numeric variable broken out by levels.</p>
</div>
<div id="solution-id179" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id179" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> we pass the name of the categorical variable to the <code>x</code> parameter in the <code>aes</code> call. The resulting boxplot will then be grouped by the values in the categorical variable:</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="Graphics.html#cb673-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb673-2"><a href="Graphics.html#cb673-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> factor, <span class="at">y =</span> values) <span class="sc">+</span></span>
<span id="cb673-3"><a href="Graphics.html#cb673-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
</div>
<div id="discussion-id179" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id179" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This recipe is another great way to explore and illustrate the
relationship between two variables. In this case, we want to know
whether the numeric variable changes according to the level of a category.</p>
<p>The <code>UScereal</code> dataset from the <code>MASS</code> package contains many variables regarding breakfast
cereals. One variable is the amount of sugar per portion and another is
the shelf position (counting from the floor). Cereal manufacturers can
negotiate for shelf position, placing their product for the best sales
potential. We wonder: Where do they put the high-sugar cereals? We can produce Figure <a href="Graphics.html#fig:cerealboxplot">10.43</a> and
explore that question by creating one boxplot per shelf:</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="Graphics.html#cb674-1" tabindex="-1"></a><span class="fu">data</span>(UScereal, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb674-2"><a href="Graphics.html#cb674-2" tabindex="-1"></a></span>
<span id="cb674-3"><a href="Graphics.html#cb674-3" tabindex="-1"></a><span class="fu">ggplot</span>(UScereal) <span class="sc">+</span></span>
<span id="cb674-4"><a href="Graphics.html#cb674-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(shelf), <span class="at">y =</span> sugars) <span class="sc">+</span></span>
<span id="cb674-5"><a href="Graphics.html#cb674-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb674-6"><a href="Graphics.html#cb674-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb674-7"><a href="Graphics.html#cb674-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Sugar Content by Shelf&quot;</span>,</span>
<span id="cb674-8"><a href="Graphics.html#cb674-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Shelf&quot;</span>,</span>
<span id="cb674-9"><a href="Graphics.html#cb674-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Sugar (grams per portion)&quot;</span></span>
<span id="cb674-10"><a href="Graphics.html#cb674-10" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cerealboxplot"></span>
<img src="10_Graphics_files/figure-html/cerealboxplot-1.png" alt="Boxplot by shelf number" width="85%" />
<p class="caption">
Figure 10.43: Boxplot by shelf number
</p>
</div>
<p>The boxplots suggest that shelf #2 has the most high-sugar cereals.
Could it be that this shelf is at eye level for young children who can
influence their parents’ choice of cereals?</p>
<p>Note that in the <code>aes</code> call we had to tell <code>ggplot</code> to treat the shelf number as a factor. Otherwise, <code>ggplot</code> would not react to the shelf as a grouping and print only a single boxplot.</p>
</div>
<div id="see_also-id179" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id179" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe @ref(recipe-id178,) <a href="Graphics.html#recipe-id178">“Creating a Boxplot”</a>, for creating a basic boxplot.</p>
</div>
</div>
<div id="recipe-id182" class="section level2 hasAnchor" number="10.19">
<h2><span class="header-section-number">10.19</span> Creating a Histogram<a href="Graphics.html#recipe-id182" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id182" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id182" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to create a histogram of your data.</p>
</div>
<div id="solution-id182" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id182" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>geom_histogram</code>, and set <code>x</code> to a vector of numeric values.</p>
</div>
<div id="discussion-id182" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id182" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Figure <a href="Graphics.html#fig:carshist">10.44</a> is a histogram of the <code>MPG.city</code> column taken from the <code>Cars93</code> dataset:</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="Graphics.html#cb675-1" tabindex="-1"></a><span class="fu">data</span>(Cars93, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb675-2"><a href="Graphics.html#cb675-2" tabindex="-1"></a></span>
<span id="cb675-3"><a href="Graphics.html#cb675-3" tabindex="-1"></a><span class="fu">ggplot</span>(Cars93) <span class="sc">+</span></span>
<span id="cb675-4"><a href="Graphics.html#cb675-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> MPG.city))</span>
<span id="cb675-5"><a href="Graphics.html#cb675-5" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:carshist"></span>
<img src="10_Graphics_files/figure-html/carshist-1.png" alt="Histogram of counts by MPG" width="85%" />
<p class="caption">
Figure 10.44: Histogram of counts by MPG
</p>
</div>
<p>The <code>geom_histogram</code> function must decide how many cells (bins) to create for
binning the data. In this example, the default algorithm chose 30
bins. If we wanted fewer bins, we would include the <code>bins</code> parameter to tell <code>geom_histogram</code> how many bins we want:</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="Graphics.html#cb676-1" tabindex="-1"></a><span class="fu">ggplot</span>(Cars93) <span class="sc">+</span></span>
<span id="cb676-2"><a href="Graphics.html#cb676-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> MPG.city), <span class="at">bins =</span> <span class="dv">13</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:carshistbins"></span>
<img src="10_Graphics_files/figure-html/carshistbins-1.png" alt="Histogram of counts by MPG with fewer bins" width="85%" />
<p class="caption">
Figure 10.45: Histogram of counts by MPG with fewer bins
</p>
</div>
<p>Figure <a href="Graphics.html#fig:carshistbins">10.45</a> shows the histogram with 13 bins.</p>
</div>
<div id="see_also-id182" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id182" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Base R function <code>hist</code> provides much of the same functionality, as does the <code>histogram</code> function of the <code>lattice</code> package.</p>
</div>
</div>
<div id="recipe-id183" class="section level2 hasAnchor" number="10.20">
<h2><span class="header-section-number">10.20</span> Adding a Density Estimate to a Histogram<a href="Graphics.html#recipe-id183" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id183" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id183" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a histogram of your data sample, and you want to add a curve to
illustrate the apparent density.</p>
</div>
<div id="solution-id183" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id183" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>geom_density</code> function to approximate the sample density, as shown in Figure <a href="Graphics.html#fig:histdensity">10.46</a>:</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="Graphics.html#cb677-1" tabindex="-1"></a><span class="fu">ggplot</span>(Cars93) <span class="sc">+</span></span>
<span id="cb677-2"><a href="Graphics.html#cb677-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> MPG.city) <span class="sc">+</span></span>
<span id="cb677-3"><a href="Graphics.html#cb677-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb677-4"><a href="Graphics.html#cb677-4" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:histdensity"></span>
<img src="10_Graphics_files/figure-html/histdensity-1.png" alt="Histogram with density plot" width="85%" />
<p class="caption">
Figure 10.46: Histogram with density plot
</p>
</div>
</div>
<div id="discussion-id183" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id183" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A histogram suggests the density function of your data, but it is rough.
A smoother estimate could help you better visualize the underlying
distribution. A <em>kernel density estimation</em> (KDE) is a smoother representation of univariate data.</p>
<p>In <code>ggplot</code> we tell the <code>geom_histogram</code> function to use the <code>geom_density</code> function by passing it <code>aes(y = ..density..)</code>.</p>
<p>The following example takes a sample from a gamma distribution and then plots the
histogram and the estimated density, as shown in Figure <a href="Graphics.html#fig:gammahistdens">10.47</a>.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="Graphics.html#cb678-1" tabindex="-1"></a>samp <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">500</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb678-2"><a href="Graphics.html#cb678-2" tabindex="-1"></a></span>
<span id="cb678-3"><a href="Graphics.html#cb678-3" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb678-4"><a href="Graphics.html#cb678-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> samp) <span class="sc">+</span></span>
<span id="cb678-5"><a href="Graphics.html#cb678-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb678-6"><a href="Graphics.html#cb678-6" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gammahistdens"></span>
<img src="10_Graphics_files/figure-html/gammahistdens-1.png" alt="Histogram and density: Gamma distribution" width="85%" />
<p class="caption">
Figure 10.47: Histogram and density: Gamma distribution
</p>
</div>
</div>
<div id="see_also-id183" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id183" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>geom_density</code> function approximates the shape of the density
nonparametrically. If you know the actual underlying distribution, use
instead Recipe <a href="Probability.html#recipe-id166">8.11</a>, <a href="Probability.html#recipe-id166">“Plotting a Density Function”</a>, to plot the density function.</p>
</div>
</div>
<div id="recipe-id180" class="section level2 hasAnchor" number="10.21">
<h2><span class="header-section-number">10.21</span> Creating a Normal Quantile–Quantile Plot<a href="Graphics.html#recipe-id180" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id180" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id180" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to create a <em>quantile–quantile</em> (Q–Q) plot of your data,
typically because you want to know how the data differs from a normal distribution.</p>
</div>
<div id="solution-id180" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id180" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> we can use the <code>stat_qq</code> and <code>stat_qq_line</code> functions to create a Q–Q plot that shows both the observed points as well as the Q–Q line. Figure <a href="Graphics.html#fig:qqplot">10.48</a> shows the resulting plot.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="Graphics.html#cb679-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb679-2"><a href="Graphics.html#cb679-2" tabindex="-1"></a></span>
<span id="cb679-3"><a href="Graphics.html#cb679-3" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span></span>
<span id="cb679-4"><a href="Graphics.html#cb679-4" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb679-5"><a href="Graphics.html#cb679-5" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqplot"></span>
<img src="10_Graphics_files/figure-html/qqplot-1.png" alt="Q–Q plot" width="85%" />
<p class="caption">
Figure 10.48: Q–Q plot
</p>
</div>
</div>
<div id="discussion-id180" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id180" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes it’s important to know if your data is normally distributed. A
quantile–quantile (Q–Q) plot is a good first check.</p>
<p>The <code>Cars93</code> dataset contains a Price column. Is it normally
distributed? This code snippet creates a Q–Q plot of Price, as shown in Figure <a href="Graphics.html#fig:qqcars">10.49</a>:</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="Graphics.html#cb680-1" tabindex="-1"></a><span class="fu">ggplot</span>(Cars93, <span class="fu">aes</span>(<span class="at">sample =</span> Price)) <span class="sc">+</span></span>
<span id="cb680-2"><a href="Graphics.html#cb680-2" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb680-3"><a href="Graphics.html#cb680-3" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqcars"></span>
<img src="10_Graphics_files/figure-html/qqcars-1.png" alt="Q–Q plot of car prices" width="85%" />
<p class="caption">
Figure 10.49: Q–Q plot of car prices
</p>
</div>
<p>If the data had a perfect normal distribution, then the points would
fall exactly on the diagonal line. Many points are close, especially in
the middle section, but the points in the tails are pretty far off. Too
many points are above the line, indicating a general skew to the left.</p>
<p>The leftward skew might be cured by a logarithmic transformation. We can
plot <code>log(Price)</code>, which yields Figure <a href="Graphics.html#fig:qqcarslog">10.50</a>:</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="Graphics.html#cb681-1" tabindex="-1"></a><span class="fu">ggplot</span>(Cars93, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">log</span>(Price))) <span class="sc">+</span></span>
<span id="cb681-2"><a href="Graphics.html#cb681-2" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb681-3"><a href="Graphics.html#cb681-3" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqcarslog"></span>
<img src="10_Graphics_files/figure-html/qqcarslog-1.png" alt="Q–Q plot of log car prices" width="85%" />
<p class="caption">
Figure 10.50: Q–Q plot of log car prices
</p>
</div>
<p>Notice that the points in the new plot are much better behaved, staying
close to the line except in the extreme left tail. It appears that
<code>log(Price)</code> is approximately normal.</p>
</div>
<div id="see_also-id180" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id180" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="Graphics.html#recipe-id181">10.22</a>, <a href="Graphics.html#recipe-id181">“Creating Other Quantile–Quantile Plots”</a>, for creating
Q–Q plots for other distributions. See Recipe <a href="LinearRegressionAndANOVA.html#recipe-id212">11.16</a>, <a href="LinearRegressionAndANOVA.html#recipe-id212">“Diagnosing a Linear Regression”</a>, for an
application of normal Q–Q plots to diagnose linear regression.</p>
</div>
</div>
<div id="recipe-id181" class="section level2 hasAnchor" number="10.22">
<h2><span class="header-section-number">10.22</span> Creating Other Quantile–Quantile Plots<a href="Graphics.html#recipe-id181" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id181" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id181" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to view a quantile-quantile plot for your data, but the data is
not normally distributed.</p>
</div>
<div id="solution-id181" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id181" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this recipe, you must have some idea of the underlying distribution,
of course. The solution is built from the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Use the <code>ppoints</code> function to generate a sequence of points between
0 and 1.</p></li>
<li><p>Transform those points into quantiles, using the quantile function
for the assumed distribution.</p></li>
<li><p>Sort your sample data.</p></li>
<li><p>Plot the sorted data against the computed quantiles.</p></li>
<li><p>Use <code>abline</code> to plot the diagonal line.</p></li>
</ol>
<p>This can all be done in two lines of R code. Here is an example that
assumes your data, <code>y</code>, has a Student’s <em>t</em> distribution with 5 degrees
of freedom. Recall that the quantile function for Student’s <em>t</em> is <code>qt</code>
and that its second argument is the degrees of freedom.</p>
<p>First let’s make some example data:</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="Graphics.html#cb682-1" tabindex="-1"></a>df_t <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">rt</span>(<span class="dv">100</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>In order to create the Q–Q plot we need to estimate the parameters of the distribution we’re wanting to plot. Since this is a Student’s <em>t</em> distribution, we only need to estimate one parameter, the degrees of freedom. Of course we know the actual degrees of freedom is 5, but in most situations we’ll need to calcuate that value. So, we’ll use the <code>MASS::fitdistr</code> function to estimate the degrees of freedom:</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="Graphics.html#cb683-1" tabindex="-1"></a>est_df <span class="ot">&lt;-</span> <span class="fu">as.list</span>(MASS<span class="sc">::</span><span class="fu">fitdistr</span>(df_t<span class="sc">$</span>y, <span class="st">&quot;t&quot;</span>)<span class="sc">$</span>estimate)[[<span class="st">&quot;df&quot;</span>]]</span>
<span id="cb683-2"><a href="Graphics.html#cb683-2" tabindex="-1"></a>est_df</span>
<span id="cb683-3"><a href="Graphics.html#cb683-3" tabindex="-1"></a><span class="co">#&gt; [1] 19.5</span></span></code></pre></div>
<p>As expected, that’s pretty close to what was used to generate the simulated data, so let’s pass the estimated degrees of freedom to the Q–Q functions and create Figure <a href="Graphics.html#fig:qqt">10.51</a>:</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="Graphics.html#cb684-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_t) <span class="sc">+</span></span>
<span id="cb684-2"><a href="Graphics.html#cb684-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">sample =</span> y) <span class="sc">+</span></span>
<span id="cb684-3"><a href="Graphics.html#cb684-3" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">distribution =</span> qt, <span class="at">dparams =</span> est_df) <span class="sc">+</span></span>
<span id="cb684-4"><a href="Graphics.html#cb684-4" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">distribution =</span> qt, <span class="at">dparams =</span> est_df)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqt"></span>
<img src="10_Graphics_files/figure-html/qqt-1.png" alt="Student's t distribution Q–Q plot" width="85%" />
<p class="caption">
Figure 10.51: Student’s t distribution Q–Q plot
</p>
</div>
</div>
<div id="discussion-id181" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id181" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Solution looks complicated, but the gist of it is picking a distribution, fitting the parameters, and then passing those parameters to the Q–Q functions in <code>ggplot</code>.</p>
<p>We can illustrate this recipe by taking a random sample from an
exponential distribution with a mean of 10 (or, equivalently, a rate of
1/10):</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="Graphics.html#cb685-1" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb685-2"><a href="Graphics.html#cb685-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb685-3"><a href="Graphics.html#cb685-3" tabindex="-1"></a>df_exp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> rate))</span></code></pre></div>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="Graphics.html#cb686-1" tabindex="-1"></a>est_exp <span class="ot">&lt;-</span> <span class="fu">as.list</span>(MASS<span class="sc">::</span><span class="fu">fitdistr</span>(df_exp<span class="sc">$</span>y, <span class="st">&quot;exponential&quot;</span>)<span class="sc">$</span>estimate)[[<span class="st">&quot;rate&quot;</span>]]</span>
<span id="cb686-2"><a href="Graphics.html#cb686-2" tabindex="-1"></a>est_exp</span>
<span id="cb686-3"><a href="Graphics.html#cb686-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.101</span></span></code></pre></div>
<p>Notice that for an exponential distribution, the parameter we estimate is called <code>rate</code> as opposed to <code>df</code>, which was the parameter in the <em>t</em> distribution.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="Graphics.html#cb687-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_exp) <span class="sc">+</span></span>
<span id="cb687-2"><a href="Graphics.html#cb687-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">sample =</span> y) <span class="sc">+</span></span>
<span id="cb687-3"><a href="Graphics.html#cb687-3" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">distribution =</span> qexp, <span class="at">dparams =</span> est_exp) <span class="sc">+</span></span>
<span id="cb687-4"><a href="Graphics.html#cb687-4" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">distribution =</span> qexp, <span class="at">dparams =</span> est_exp)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqexp"></span>
<img src="10_Graphics_files/figure-html/qqexp-1.png" alt="Exponential distribution Q–Q plot" width="85%" />
<p class="caption">
Figure 10.52: Exponential distribution Q–Q plot
</p>
</div>
<p>The quantile function for the exponential distribution is <code>qexp</code>, which
takes the <code>rate</code> argument. Figure <a href="Graphics.html#fig:qqexp">10.52</a> shows the resulting Q–Q plot using a theoretical exponential distribution.</p>
</div>
</div>
<div id="recipe-id191" class="section level2 hasAnchor" number="10.23">
<h2><span class="header-section-number">10.23</span> Plotting a Variable in Multiple Colors<a href="Graphics.html#recipe-id191" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id191" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id191" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to plot your data in multiple colors, typically to make the
plot more informative, readable, or interesting.</p>
</div>
<div id="solution-id191" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id191" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can pass a color to a <code>geom_</code> function in order to produce colored output:</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="Graphics.html#cb688-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>), <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>))</span>
<span id="cb688-2"><a href="Graphics.html#cb688-2" tabindex="-1"></a></span>
<span id="cb688-3"><a href="Graphics.html#cb688-3" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb688-4"><a href="Graphics.html#cb688-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y) <span class="sc">+</span></span>
<span id="cb688-5"><a href="Graphics.html#cb688-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:colorscatter"></span>
<img src="10_Graphics_files/figure-html/colorscatter-1.png" alt="Point data in color" width="85%" />
<p class="caption">
Figure 10.53: Point data in color
</p>
</div>
<p>If you are reading this in print you may see only black. Try it out on your own in order to see the graph in full color.</p>
<p>The value of <code>color</code> can be:</p>
<ul>
<li><p>One color, in which case all data points are that color.</p></li>
<li><p>A vector of colors, the same length as <code>x</code>, in which case each value
of <code>x</code> is colored with its corresponding color.</p></li>
<li><p>A short vector, in which case the vector of colors is recycled.</p></li>
</ul>
</div>
<div id="discussion-id191" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id191" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The default color in <code>ggplot</code> is black. While it’s not very exciting, black is high contrast and easy for almost anyone to see.</p>
<p>However, it is much more useful (and interesting) to vary the color in a
way that illuminates the data. Let’s illustrate this by plotting a
graphic two ways, once in black and white and once with simple shading.</p>
<p>This produces the basic black-and-white graphic in Figure <a href="Graphics.html#fig:plainpoints">10.54</a>:</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="Graphics.html#cb689-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb689-2"><a href="Graphics.html#cb689-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb689-3"><a href="Graphics.html#cb689-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb689-4"><a href="Graphics.html#cb689-4" tabindex="-1"></a>)</span>
<span id="cb689-5"><a href="Graphics.html#cb689-5" tabindex="-1"></a></span>
<span id="cb689-6"><a href="Graphics.html#cb689-6" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb689-7"><a href="Graphics.html#cb689-7" tabindex="-1"></a>  <span class="fu">aes</span>(x, y) <span class="sc">+</span></span>
<span id="cb689-8"><a href="Graphics.html#cb689-8" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plainpoints"></span>
<img src="10_Graphics_files/figure-html/plainpoints-1.png" alt="Simple point plot" width="85%" />
<p class="caption">
Figure 10.54: Simple point plot
</p>
</div>
<p>Now we can make it more interesting by
creating a vector of <code>"gray"</code> and <code>"black"</code> values, according to the sign of <code>x</code>, and then plotting <code>x</code> using those colors, as shown in Figure <a href="Graphics.html#fig:shadepoints">10.55</a>:</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="Graphics.html#cb690-1" tabindex="-1"></a>shade <span class="ot">&lt;-</span> <span class="fu">if_else</span>(df<span class="sc">$</span>y <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb690-2"><a href="Graphics.html#cb690-2" tabindex="-1"></a></span>
<span id="cb690-3"><a href="Graphics.html#cb690-3" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb690-4"><a href="Graphics.html#cb690-4" tabindex="-1"></a>  <span class="fu">aes</span>(x, y) <span class="sc">+</span></span>
<span id="cb690-5"><a href="Graphics.html#cb690-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> shade)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:shadepoints"></span>
<img src="10_Graphics_files/figure-html/shadepoints-1.png" alt="Color-shaded point plot" width="85%" />
<p class="caption">
Figure 10.55: Color-shaded point plot
</p>
</div>
<p>The negative values are now plotted in gray because the corresponding
element of <code>colors</code> is <code>"gray"</code>.</p>
</div>
<div id="see_also-id191" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id191" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="DataStructures.html#recipe-id050">5.3</a>, <a href="DataStructures.html#recipe-id050">“Understanding the Recycling Rule”</a>, regarding the Recycling Rule. Execute <code>colors</code> to see a list of available colors, and use <code>geom_segment</code> in <code>ggplot</code> to plot line segments in multiple colors.</p>
</div>
</div>
<div id="recipe-id192" class="section level2 hasAnchor" number="10.24">
<h2><span class="header-section-number">10.24</span> Graphing a Function<a href="Graphics.html#recipe-id192" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id192" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id192" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to graph the value of a function.</p>
</div>
<div id="solution-id192" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id192" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>ggplot</code> function <code>stat_function</code> will graph a function across a range. In Figure <a href="Graphics.html#fig:functionplot">10.56</a>, we plot a sine wave across the range –3 to 3.</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="Graphics.html#cb691-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb691-2"><a href="Graphics.html#cb691-2" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb691-3"><a href="Graphics.html#cb691-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> sin)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:functionplot"></span>
<img src="10_Graphics_files/figure-html/functionplot-1.png" alt="Sine wave plot" width="85%" />
<p class="caption">
Figure 10.56: Sine wave plot
</p>
</div>
</div>
<div id="discussion-id192" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id192" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It’s pretty common to want to plot a statistical function, such as a normal distribution, across a given range. The <code>stat_function</code> in <code>ggplot</code> allows us to do this. We need only supply a data frame with <code>x</code> value limits and <code>stat_function</code> will calculate the <code>y</code> values, and plot the results as in Figure <a href="Graphics.html#fig:std-norm-density">10.57</a>:</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="Graphics.html#cb692-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>))) <span class="sc">+</span></span>
<span id="cb692-2"><a href="Graphics.html#cb692-2" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb692-3"><a href="Graphics.html#cb692-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm) <span class="sc">+</span></span>
<span id="cb692-4"><a href="Graphics.html#cb692-4" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Standard Normal Density&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:std-norm-density"></span>
<img src="10_Graphics_files/figure-html/std-norm-density-1.png" alt="Standard normal density plot" width="85%" />
<p class="caption">
Figure 10.57: Standard normal density plot
</p>
</div>
<p>Notice in Figure <a href="Graphics.html#fig:std-norm-density">10.57</a> we use <code>ggtitle</code> to set the title. If setting multiple text elements in a <code>ggplot</code>, we use <code>labs</code> but when we’re just adding a title, <code>ggtitle</code> is more concise than <code>labs(title='Standard Normal Density')</code> although they accomplish the same thing. See <code>?labs</code> for more discussion of labels with <code>ggplot</code>.</p>
<p><code>stat_function</code> can graph any function that takes one argument and returns one
value. Let’s create a function and then plot it. Our function is a damped sine wave—that is, a sine wave that loses amplitude as it moves away from 0:</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="Graphics.html#cb693-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)) <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x)</span></code></pre></div>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="Graphics.html#cb694-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>))) <span class="sc">+</span></span>
<span id="cb694-2"><a href="Graphics.html#cb694-2" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb694-3"><a href="Graphics.html#cb694-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> f) <span class="sc">+</span></span>
<span id="cb694-4"><a href="Graphics.html#cb694-4" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Dampened Sine Wave&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:damp-sin-wave"></span>
<img src="10_Graphics_files/figure-html/damp-sin-wave-1.png" alt="Dampened sine wave" width="85%" />
<p class="caption">
Figure 10.58: Dampened sine wave
</p>
</div>
<p>The resulting plot is shown in Figure <a href="Graphics.html#fig:damp-sin-wave">10.58</a>.</p>
</div>
<div id="see_also-id192" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id192" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="SimpleProgramming.html#recipe-id117">15.3</a>, <a href="SimpleProgramming.html#recipe-id117">“Defining a Function”</a>, for how to define a function.</p>
</div>
</div>
<div id="recipe-id190" class="section level2 hasAnchor" number="10.25">
<h2><span class="header-section-number">10.25</span> Displaying Several Figures on One Page<a href="Graphics.html#recipe-id190" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id190" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id190" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to display several plots side-by-side on one page.</p>
</div>
<div id="solution-id190" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id190" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of ways to put <code>ggplot</code> graphics into a grid, but one of the easiest to use and understand is <code>patchwork</code> by Thomas Lin Pedersen. <code>patchwork</code> is not currently available on CRAN, but you can install it from GitHub using the <code>devtools</code> package:</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="Graphics.html#cb695-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;thomasp85/patchwork&quot;</span>)</span></code></pre></div>
<p>After installing the package, we can use it to plot multiple <code>ggplot</code> objects using a <code>+</code> between the objects, then a call to <code>plot_layout</code> to arrange the images into a grid, as shown in Figure <a href="Graphics.html#fig:patchwork1">10.59</a>. Our example code here has four <code>ggplot</code> objects:</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="Graphics.html#cb696-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb696-2"><a href="Graphics.html#cb696-2" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:patchwork1"></span>
<img src="10_Graphics_files/figure-html/patchwork1-1.png" alt="A patchwork plot" width="85%" />
<p class="caption">
Figure 10.59: A patchwork plot
</p>
</div>
<p><code>patchwork</code> supports grouping with parentheses and using <code>/</code> to put groupings under other elements, as illustrated in Figure <a href="Graphics.html#fig:patchwork3">10.60</a>.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="Graphics.html#cb697-1" tabindex="-1"></a>p3 <span class="sc">/</span> (p1 <span class="sc">+</span> p2 <span class="sc">+</span> p4)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:patchwork3"></span>
<img src="10_Graphics_files/figure-html/patchwork3-1.png" alt="A patchwork 1 / 2 plot" width="85%" />
<p class="caption">
Figure 10.60: A patchwork 1 / 2 plot
</p>
</div>
</div>
<div id="discussion-id190" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id190" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s use a multifigure plot to display four different beta
distributions. Using <code>ggplot</code> and the <code>patchwork</code> package, we can create a 2x2 layout effect by creating four graphics objects and then print them using the <code>+</code> notation from <code>patchwork</code>:</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="Graphics.html#cb698-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb698-2"><a href="Graphics.html#cb698-2" tabindex="-1"></a></span>
<span id="cb698-3"><a href="Graphics.html#cb698-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb698-4"><a href="Graphics.html#cb698-4" tabindex="-1"></a></span>
<span id="cb698-5"><a href="Graphics.html#cb698-5" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb698-6"><a href="Graphics.html#cb698-6" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb698-7"><a href="Graphics.html#cb698-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb698-8"><a href="Graphics.html#cb698-8" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb698-9"><a href="Graphics.html#cb698-9" tabindex="-1"></a>      <span class="fu">dbeta</span>(x, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb698-10"><a href="Graphics.html#cb698-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb698-11"><a href="Graphics.html#cb698-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;First&quot;</span>)</span>
<span id="cb698-12"><a href="Graphics.html#cb698-12" tabindex="-1"></a></span>
<span id="cb698-13"><a href="Graphics.html#cb698-13" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb698-14"><a href="Graphics.html#cb698-14" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb698-15"><a href="Graphics.html#cb698-15" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb698-16"><a href="Graphics.html#cb698-16" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb698-17"><a href="Graphics.html#cb698-17" tabindex="-1"></a>      <span class="fu">dbeta</span>(x, <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb698-18"><a href="Graphics.html#cb698-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb698-19"><a href="Graphics.html#cb698-19" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Second&quot;</span>)</span>
<span id="cb698-20"><a href="Graphics.html#cb698-20" tabindex="-1"></a></span>
<span id="cb698-21"><a href="Graphics.html#cb698-21" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb698-22"><a href="Graphics.html#cb698-22" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb698-23"><a href="Graphics.html#cb698-23" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb698-24"><a href="Graphics.html#cb698-24" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb698-25"><a href="Graphics.html#cb698-25" tabindex="-1"></a>      <span class="fu">dbeta</span>(x, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb698-26"><a href="Graphics.html#cb698-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb698-27"><a href="Graphics.html#cb698-27" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Third&quot;</span>)</span>
<span id="cb698-28"><a href="Graphics.html#cb698-28" tabindex="-1"></a></span>
<span id="cb698-29"><a href="Graphics.html#cb698-29" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb698-30"><a href="Graphics.html#cb698-30" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb698-31"><a href="Graphics.html#cb698-31" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb698-32"><a href="Graphics.html#cb698-32" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb698-33"><a href="Graphics.html#cb698-33" tabindex="-1"></a>      <span class="fu">dbeta</span>(x, .<span class="dv">5</span>, .<span class="dv">5</span>)</span>
<span id="cb698-34"><a href="Graphics.html#cb698-34" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb698-35"><a href="Graphics.html#cb698-35" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fourth&quot;</span>)</span>
<span id="cb698-36"><a href="Graphics.html#cb698-36" tabindex="-1"></a></span>
<span id="cb698-37"><a href="Graphics.html#cb698-37" tabindex="-1"></a>g1 <span class="sc">+</span> g2 <span class="sc">+</span> g3 <span class="sc">+</span> g4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:patchwork2"></span>
<img src="10_Graphics_files/figure-html/patchwork2-1.png" alt="Four plots using patchwork" width="85%" />
<p class="caption">
Figure 10.61: Four plots using patchwork
</p>
</div>
<p>The output is shown in Figure <a href="Graphics.html#fig:patchwork2">10.61</a>.</p>
<p>To lay the images out in columns order, we could pass the <code>byrow=FALSE</code> to <code>plot_layout</code>:</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="Graphics.html#cb699-1" tabindex="-1"></a>g1 <span class="sc">+</span> g2 <span class="sc">+</span> g3 <span class="sc">+</span> g4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="see_also-id190" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id190" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recipe <a href="Probability.html#recipe-id166">8.11</a>, <a href="Probability.html#recipe-id166">“Plotting a Density Function”</a>, discusses plotting density functions as we do here.</p>
<p>Recipe <a href="Graphics.html#recipe-id185">10.9</a>, <a href="Graphics.html#recipe-id185">“Creating One Scatter Plot for Each Group”</a>, shows how you can create a matrix of plots using a facet function.</p>
<p>The <code>grid</code> package and the <code>lattice</code> package contain additional tools
for multifigure layouts with Base graphics.</p>
</div>
</div>
<div id="recipe-id188" class="section level2 hasAnchor" number="10.26">
<h2><span class="header-section-number">10.26</span> Writing Your Plot to a File<a href="Graphics.html#recipe-id188" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id188" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="Graphics.html#problem-id188" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to save your graphics in a file, such as a PNG, JPEG, or
PostScript file.</p>
</div>
<div id="solution-id188" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="Graphics.html#solution-id188" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggplot</code> figures we can use <code>ggsave</code> to save a displayed image to a file. <code>ggsave</code> will make some default assumptions about size and file type for you, allowing you to specify only a filename:</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="Graphics.html#cb700-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;filename.jpg&quot;</span>)</span></code></pre></div>
<p>The file type is derived from the extension you use in the filename you pass to <code>ggsave</code>. You can control details of size, file type, and scale by passing parameters to <code>ggsave</code>. See <code>?ggsave</code> for specific details.</p>
</div>
<div id="discussion-id188" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="Graphics.html#discussion-id188" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In RStudio, a shortcut is to click on <code>Export</code> in the Plots window and then click on “Save as Image,” “Save as PDF,” or “Copy to Clipboard.” The save options will prompt you for a file type
and a filename before writing the file. The “Copy to Clipboard” option can be handy if you are manually copying and pasting your graphics into a presentation or word processor.</p>
<p>Remember that the file will be written to your current working directory
(unless you use an absolute filepath), so be certain you know which
directory is your working directory before calling <code>savePlot</code>.</p>
<p>In a noninteractive script using <code>ggplot</code>, you can pass plot objects directly to <code>ggsave</code> so they need not be displayed before saving. In the prior recipe we created a plot object called <code>g1</code>. We can save it to a file like this:</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="Graphics.html#cb701-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;g1.png&quot;</span>, <span class="at">plot =</span> g1, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Note that the units for <code>height</code> and <code>width</code> in <code>ggsave</code> are specified with the <code>units</code> parameter. In this case we used <code>in</code> for inches, but <code>ggsave</code> also supports <code>mm</code> and <code>cm</code> for the more metricly inclined.</p>
</div>
<div id="see_also-id188" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="Graphics.html#see_also-id188" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="NavigatingTheSoftware.html#recipe-id008">3.1</a>, <a href="NavigatingTheSoftware.html#recipe-id008">“Getting and Setting the Working Directory”</a>, for more about the current working directory.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="GeneralStatistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="LinearRegressionAndANOVA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/CerebralMastication/R-Cookbook/edit/master/10_Graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
