<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Useful Tricks | R Cookbook, 2nd Edition</title>
  <meta name="description" content="Second edition of R Cookbook" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Useful Tricks | R Cookbook, 2nd Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Second edition of R Cookbook" />
  <meta name="github-repo" content="CerebralMastication/R-Cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Useful Tricks | R Cookbook, 2nd Edition" />
  
  <meta name="twitter:description" content="Second edition of R Cookbook" />
  

<meta name="author" content="James (JD) Long" />
<meta name="author" content="Paul Teetor" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="LinearRegressionAndANOVA.html"/>
<link rel="next" href="BeyondBasics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129487349-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-129487349-3');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R Cookbook 2nd Edition</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to the R Cookbook 2nd Edition</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-recipes"><i class="fa fa-check"></i>The Recipes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-note-on-terminology"><i class="fa fa-check"></i>A Note on Terminology</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-and-platform-notes"><i class="fa fa-check"></i>Software and Platform Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions Used in This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-code-examples"><i class="fa fa-check"></i>Using Code Examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#safari-books-online"><i class="fa fa-check"></i>Safari® Books Online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i><b>1</b> Getting Started and Getting Help</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#intro-GettingStarted"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1.1" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id001"><i class="fa fa-check"></i><b>1.1</b> Downloading and Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id002b"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-startingrstudio"><i class="fa fa-check"></i><b>1.3</b> Starting RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id007"><i class="fa fa-check"></i><b>1.4</b> Entering Commands</a></li>
<li class="chapter" data-level="1.5" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id097"><i class="fa fa-check"></i><b>1.5</b> Exiting from RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id100"><i class="fa fa-check"></i><b>1.6</b> Interrupting R</a></li>
<li class="chapter" data-level="1.7" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id265"><i class="fa fa-check"></i><b>1.7</b> Viewing the Supplied Documentation</a></li>
<li class="chapter" data-level="1.8" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id003"><i class="fa fa-check"></i><b>1.8</b> Getting Help on a Function</a></li>
<li class="chapter" data-level="1.9" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id267"><i class="fa fa-check"></i><b>1.9</b> Searching the Supplied Documentation</a></li>
<li class="chapter" data-level="1.10" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id266"><i class="fa fa-check"></i><b>1.10</b> Getting Help on a Package</a></li>
<li class="chapter" data-level="1.11" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id005"><i class="fa fa-check"></i><b>1.11</b> Searching the Web for Help</a></li>
<li class="chapter" data-level="1.12" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id270"><i class="fa fa-check"></i><b>1.12</b> Finding Relevant Functions and Packages</a></li>
<li class="chapter" data-level="1.13" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id268"><i class="fa fa-check"></i><b>1.13</b> Searching the Mailing Lists</a></li>
<li class="chapter" data-level="1.14" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id269"><i class="fa fa-check"></i><b>1.14</b> Submitting Questions to Stack Overflow or Elsewhere in the Community</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="SomeBasics.html"><a href="SomeBasics.html"><i class="fa fa-check"></i><b>2</b> Some Basics</a>
<ul>
<li class="chapter" data-level="" data-path="SomeBasics.html"><a href="SomeBasics.html#intro-SomeBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2.1" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id017"><i class="fa fa-check"></i><b>2.1</b> Printing Something to the Screen</a></li>
<li class="chapter" data-level="2.2" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id016"><i class="fa fa-check"></i><b>2.2</b> Setting Variables</a></li>
<li class="chapter" data-level="2.3" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id091"><i class="fa fa-check"></i><b>2.3</b> Listing Variables</a></li>
<li class="chapter" data-level="2.4" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id075"><i class="fa fa-check"></i><b>2.4</b> Deleting Variables</a></li>
<li class="chapter" data-level="2.5" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id038"><i class="fa fa-check"></i><b>2.5</b> Creating a Vector</a></li>
<li class="chapter" data-level="2.6" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id101"><i class="fa fa-check"></i><b>2.6</b> Computing Basic Statistics</a></li>
<li class="chapter" data-level="2.7" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id021"><i class="fa fa-check"></i><b>2.7</b> Creating Sequences</a></li>
<li class="chapter" data-level="2.8" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id020"><i class="fa fa-check"></i><b>2.8</b> Comparing Vectors</a></li>
<li class="chapter" data-level="2.9" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id039"><i class="fa fa-check"></i><b>2.9</b> Selecting Vector Elements</a></li>
<li class="chapter" data-level="2.10" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id019"><i class="fa fa-check"></i><b>2.10</b> Performing Vector Arithmetic</a></li>
<li class="chapter" data-level="2.11" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id018"><i class="fa fa-check"></i><b>2.11</b> Getting Operator Precedence Right</a></li>
<li class="chapter" data-level="2.12" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id022"><i class="fa fa-check"></i><b>2.12</b> Typing Less and Accomplishing More</a></li>
<li class="chapter" data-level="2.13" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-pipe-2"><i class="fa fa-check"></i><b>2.13</b> Creating a Pipeline of Function Calls</a></li>
<li class="chapter" data-level="2.14" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id025"><i class="fa fa-check"></i><b>2.14</b> Avoiding Some Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html"><i class="fa fa-check"></i><b>3</b> Navigating the Software</a>
<ul>
<li class="chapter" data-level="" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#intro-NavigatingTheSoftware"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="3.1" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id008"><i class="fa fa-check"></i><b>3.1</b> Getting and Setting the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-CreateProject"><i class="fa fa-check"></i><b>3.2</b> Creating a New RStudio Project</a></li>
<li class="chapter" data-level="3.3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id009"><i class="fa fa-check"></i><b>3.3</b> Saving Your Workspace</a></li>
<li class="chapter" data-level="3.4" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id023"><i class="fa fa-check"></i><b>3.4</b> Viewing Your Command History</a></li>
<li class="chapter" data-level="3.5" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id024"><i class="fa fa-check"></i><b>3.5</b> Saving the Result of the Previous Command</a></li>
<li class="chapter" data-level="3.6" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id010"><i class="fa fa-check"></i><b>3.6</b> Displaying Loaded Packages via the Search Path</a></li>
<li class="chapter" data-level="3.7" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id094"><i class="fa fa-check"></i><b>3.7</b> Viewing the List of Installed Packages</a></li>
<li class="chapter" data-level="3.8" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id013"><i class="fa fa-check"></i><b>3.8</b> Accessing the Functions in a Package</a></li>
<li class="chapter" data-level="3.9" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id257"><i class="fa fa-check"></i><b>3.9</b> Accessing Built-in Datasets</a></li>
<li class="chapter" data-level="3.10" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id012"><i class="fa fa-check"></i><b>3.10</b> Installing Packages from CRAN</a></li>
<li class="chapter" data-level="3.11" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-installGH"><i class="fa fa-check"></i><b>3.11</b> Installing a Package from GitHub</a></li>
<li class="chapter" data-level="3.12" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id272"><i class="fa fa-check"></i><b>3.12</b> Setting or Changing a Default CRAN Mirror</a></li>
<li class="chapter" data-level="3.13" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id014"><i class="fa fa-check"></i><b>3.13</b> Running a Script</a></li>
<li class="chapter" data-level="3.14" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id015"><i class="fa fa-check"></i><b>3.14</b> Running a Batch Script</a></li>
<li class="chapter" data-level="3.15" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id102"><i class="fa fa-check"></i><b>3.15</b> Locating the R Home Directory</a></li>
<li class="chapter" data-level="3.16" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id099"><i class="fa fa-check"></i><b>3.16</b> Customizing R Startup</a></li>
<li class="chapter" data-level="3.17" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-Rcloud"><i class="fa fa-check"></i><b>3.17</b> Using R and RStudio in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="InputAndOutput.html"><a href="InputAndOutput.html"><i class="fa fa-check"></i><b>4</b> Input and Output</a>
<ul>
<li class="chapter" data-level="" data-path="InputAndOutput.html"><a href="InputAndOutput.html#intro-InputAndOutput"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="4.1" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id035"><i class="fa fa-check"></i><b>4.1</b> Entering Data from the Keyboard</a></li>
<li class="chapter" data-level="4.2" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id036"><i class="fa fa-check"></i><b>4.2</b> Printing Fewer Digits (or More Digits)</a></li>
<li class="chapter" data-level="4.3" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id034"><i class="fa fa-check"></i><b>4.3</b> Redirecting Output to a File</a></li>
<li class="chapter" data-level="4.4" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id030"><i class="fa fa-check"></i><b>4.4</b> Listing Files</a></li>
<li class="chapter" data-level="4.5" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id033"><i class="fa fa-check"></i><b>4.5</b> Dealing with “Cannot Open File” in Windows</a></li>
<li class="chapter" data-level="4.6" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id136"><i class="fa fa-check"></i><b>4.6</b> Reading Fixed-Width Records</a></li>
<li class="chapter" data-level="4.7" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id245"><i class="fa fa-check"></i><b>4.7</b> Reading Tabular Data Files</a></li>
<li class="chapter" data-level="4.8" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id027"><i class="fa fa-check"></i><b>4.8</b> Reading from CSV Files</a></li>
<li class="chapter" data-level="4.9" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id028"><i class="fa fa-check"></i><b>4.9</b> Writing to CSV Files</a></li>
<li class="chapter" data-level="4.10" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id031"><i class="fa fa-check"></i><b>4.10</b> Reading Tabular or CSV Data from the Web</a></li>
<li class="chapter" data-level="4.11" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readexcel"><i class="fa fa-check"></i><b>4.11</b> Reading Data from Excel</a></li>
<li class="chapter" data-level="4.12" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-writeexcel"><i class="fa fa-check"></i><b>4.12</b> Writing a Data Frame to Excel</a></li>
<li class="chapter" data-level="4.13" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readsas"><i class="fa fa-check"></i><b>4.13</b> Reading Data from a SAS file</a></li>
<li class="chapter" data-level="4.14" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id246"><i class="fa fa-check"></i><b>4.14</b> Reading Data from HTML Tables</a></li>
<li class="chapter" data-level="4.15" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id098"><i class="fa fa-check"></i><b>4.15</b> Reading Files with a Complex Structure</a></li>
<li class="chapter" data-level="4.16" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id037"><i class="fa fa-check"></i><b>4.16</b> Reading from MySQL Databases</a></li>
<li class="chapter" data-level="4.17" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-dbplyr"><i class="fa fa-check"></i><b>4.17</b> Accessing a Database with dbplyr</a></li>
<li class="chapter" data-level="4.18" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id029"><i class="fa fa-check"></i><b>4.18</b> Saving and Transporting Objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DataStructures.html"><a href="DataStructures.html"><i class="fa fa-check"></i><b>5</b> Data Structures</a>
<ul>
<li class="chapter" data-level="" data-path="DataStructures.html"><a href="DataStructures.html#intro-DataStructures"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="5.1" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id048"><i class="fa fa-check"></i><b>5.1</b> Appending Data to a Vector</a></li>
<li class="chapter" data-level="5.2" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id049"><i class="fa fa-check"></i><b>5.2</b> Inserting Data into a Vector</a></li>
<li class="chapter" data-level="5.3" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id050"><i class="fa fa-check"></i><b>5.3</b> Understanding the Recycling Rule</a></li>
<li class="chapter" data-level="5.4" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id051"><i class="fa fa-check"></i><b>5.4</b> Creating a Factor (Categorical Variable)</a></li>
<li class="chapter" data-level="5.5" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id227"><i class="fa fa-check"></i><b>5.5</b> Combining Multiple Vectors into One Vector and a Factor</a></li>
<li class="chapter" data-level="5.6" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id053"><i class="fa fa-check"></i><b>5.6</b> Creating a List</a></li>
<li class="chapter" data-level="5.7" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id054"><i class="fa fa-check"></i><b>5.7</b> Selecting List Elements by Position</a></li>
<li class="chapter" data-level="5.8" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id253"><i class="fa fa-check"></i><b>5.8</b> Selecting List Elements by Name</a></li>
<li class="chapter" data-level="5.9" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id158"><i class="fa fa-check"></i><b>5.9</b> Building a Name/Value Association List</a></li>
<li class="chapter" data-level="5.10" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id056"><i class="fa fa-check"></i><b>5.10</b> Removing an Element from a List</a></li>
<li class="chapter" data-level="5.11" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id152"><i class="fa fa-check"></i><b>5.11</b> Flatten a List into a Vector</a></li>
<li class="chapter" data-level="5.12" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id058"><i class="fa fa-check"></i><b>5.12</b> Removing NULL Elements from a List</a></li>
<li class="chapter" data-level="5.13" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id060"><i class="fa fa-check"></i><b>5.13</b> Removing List Elements Using a Condition</a></li>
<li class="chapter" data-level="5.14" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id062"><i class="fa fa-check"></i><b>5.14</b> Initializing a Matrix</a></li>
<li class="chapter" data-level="5.15" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id139"><i class="fa fa-check"></i><b>5.15</b> Performing Matrix Operations</a></li>
<li class="chapter" data-level="5.16" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id063"><i class="fa fa-check"></i><b>5.16</b> Giving Descriptive Names to the Rows and Columns of a Matrix</a></li>
<li class="chapter" data-level="5.17" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id250"><i class="fa fa-check"></i><b>5.17</b> Selecting One Row or Column from a Matrix</a></li>
<li class="chapter" data-level="5.18" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id251"><i class="fa fa-check"></i><b>5.18</b> Initializing a Data Frame from Column Data</a></li>
<li class="chapter" data-level="5.19" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id252"><i class="fa fa-check"></i><b>5.19</b> Initializing a Data Frame from Row Data</a></li>
<li class="chapter" data-level="5.20" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id071"><i class="fa fa-check"></i><b>5.20</b> Appending Rows to a Data Frame</a></li>
<li class="chapter" data-level="5.21" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id068"><i class="fa fa-check"></i><b>5.21</b> Selecting Data Frame Columns by Position</a></li>
<li class="chapter" data-level="5.22" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id254"><i class="fa fa-check"></i><b>5.22</b> Selecting Data Frame Columns by Name</a></li>
<li class="chapter" data-level="5.23" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id069"><i class="fa fa-check"></i><b>5.23</b> Changing the Names of Data Frame Columns</a></li>
<li class="chapter" data-level="5.24" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id249"><i class="fa fa-check"></i><b>5.24</b> Removing NAs from a Data Frame</a></li>
<li class="chapter" data-level="5.25" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id072"><i class="fa fa-check"></i><b>5.25</b> Excluding Columns by Name</a></li>
<li class="chapter" data-level="5.26" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id155"><i class="fa fa-check"></i><b>5.26</b> Combining Two Data Frames</a></li>
<li class="chapter" data-level="5.27" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id057"><i class="fa fa-check"></i><b>5.27</b> Merging Data Frames by Common Column</a></li>
<li class="chapter" data-level="5.28" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id248"><i class="fa fa-check"></i><b>5.28</b> Converting One Atomic Value into Another</a></li>
<li class="chapter" data-level="5.29" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id074"><i class="fa fa-check"></i><b>5.29</b> Converting One Structured Data Type into Another</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="DataTransformations.html"><a href="DataTransformations.html"><i class="fa fa-check"></i><b>6</b> Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="DataTransformations.html"><a href="DataTransformations.html#intro-DataTransformations"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="6.1" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id149"><i class="fa fa-check"></i><b>6.1</b> Applying a Function to Each List Element</a></li>
<li class="chapter" data-level="6.2" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-row_df"><i class="fa fa-check"></i><b>6.2</b> Applying a Function to Every Row of a Data Frame</a></li>
<li class="chapter" data-level="6.3" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id146"><i class="fa fa-check"></i><b>6.3</b> Applying a Function to Every Row of a Matrix</a></li>
<li class="chapter" data-level="6.4" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id157"><i class="fa fa-check"></i><b>6.4</b> Applying a Function to Every Column</a></li>
<li class="chapter" data-level="6.5" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id275"><i class="fa fa-check"></i><b>6.5</b> Applying a Function to Parallel Vectors or Lists</a></li>
<li class="chapter" data-level="6.6" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id148"><i class="fa fa-check"></i><b>6.6</b> Applying a Function to Groups of Data</a></li>
<li class="chapter" data-level="6.7" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-casewhen"><i class="fa fa-check"></i><b>6.7</b> Creating a New Column Based on Some Condition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="StringsAndDates.html"><a href="StringsAndDates.html"><i class="fa fa-check"></i><b>7</b> Strings and Dates</a>
<ul>
<li class="chapter" data-level="" data-path="StringsAndDates.html"><a href="StringsAndDates.html#I_sect17_d1e17434"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="7.1" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id093"><i class="fa fa-check"></i><b>7.1</b> Getting the Length of a String</a></li>
<li class="chapter" data-level="7.2" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id040"><i class="fa fa-check"></i><b>7.2</b> Concatenating Strings</a></li>
<li class="chapter" data-level="7.3" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id041"><i class="fa fa-check"></i><b>7.3</b> Extracting Substrings</a></li>
<li class="chapter" data-level="7.4" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id276"><i class="fa fa-check"></i><b>7.4</b> Splitting a String According to a Delimiter</a></li>
<li class="chapter" data-level="7.5" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id277"><i class="fa fa-check"></i><b>7.5</b> Replacing Substrings</a></li>
<li class="chapter" data-level="7.6" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id109"><i class="fa fa-check"></i><b>7.6</b> Generating All Pairwise Combinations of Strings</a></li>
<li class="chapter" data-level="7.7" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id045"><i class="fa fa-check"></i><b>7.7</b> Getting the Current Date</a></li>
<li class="chapter" data-level="7.8" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id043"><i class="fa fa-check"></i><b>7.8</b> Converting a String into a Date</a></li>
<li class="chapter" data-level="7.9" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id044"><i class="fa fa-check"></i><b>7.9</b> Converting a Date into a String</a></li>
<li class="chapter" data-level="7.10" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id241"><i class="fa fa-check"></i><b>7.10</b> Converting Year, Month, and Day into a Date</a></li>
<li class="chapter" data-level="7.11" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id042"><i class="fa fa-check"></i><b>7.11</b> Getting the Julian Date</a></li>
<li class="chapter" data-level="7.12" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id046"><i class="fa fa-check"></i><b>7.12</b> Extracting the Parts of a Date</a></li>
<li class="chapter" data-level="7.13" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id047"><i class="fa fa-check"></i><b>7.13</b> Creating a Sequence of Dates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Probability.html"><a href="Probability.html"><i class="fa fa-check"></i><b>8</b> Probability</a>
<ul>
<li class="chapter" data-level="" data-path="Probability.html"><a href="Probability.html#intro-Probability"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="8.1" data-path="Probability.html"><a href="Probability.html#recipe-id163"><i class="fa fa-check"></i><b>8.1</b> Counting the Number of Combinations</a></li>
<li class="chapter" data-level="8.2" data-path="Probability.html"><a href="Probability.html#recipe-id198"><i class="fa fa-check"></i><b>8.2</b> Generating Combinations</a></li>
<li class="chapter" data-level="8.3" data-path="Probability.html"><a href="Probability.html#recipe-id165"><i class="fa fa-check"></i><b>8.3</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="8.4" data-path="Probability.html"><a href="Probability.html#recipe-id201"><i class="fa fa-check"></i><b>8.4</b> Generating Reproducible Random Numbers</a></li>
<li class="chapter" data-level="8.5" data-path="Probability.html"><a href="Probability.html#recipe-id199"><i class="fa fa-check"></i><b>8.5</b> Generating a Random Sample</a></li>
<li class="chapter" data-level="8.6" data-path="Probability.html"><a href="Probability.html#recipe-id200"><i class="fa fa-check"></i><b>8.6</b> Generating Random Sequences</a></li>
<li class="chapter" data-level="8.7" data-path="Probability.html"><a href="Probability.html#recipe-id151"><i class="fa fa-check"></i><b>8.7</b> Randomly Permuting a Vector</a></li>
<li class="chapter" data-level="8.8" data-path="Probability.html"><a href="Probability.html#recipe-id196"><i class="fa fa-check"></i><b>8.8</b> Calculating Probabilities for Discrete Distributions</a></li>
<li class="chapter" data-level="8.9" data-path="Probability.html"><a href="Probability.html#recipe-id197"><i class="fa fa-check"></i><b>8.9</b> Calculating Probabilities for Continuous Distributions</a></li>
<li class="chapter" data-level="8.10" data-path="Probability.html"><a href="Probability.html#recipe-id168"><i class="fa fa-check"></i><b>8.10</b> Converting Probabilities to Quantiles</a></li>
<li class="chapter" data-level="8.11" data-path="Probability.html"><a href="Probability.html#recipe-id166"><i class="fa fa-check"></i><b>8.11</b> Plotting a Density Function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html"><i class="fa fa-check"></i><b>9</b> General Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#intro-GeneralStatistics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="9.1" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id119"><i class="fa fa-check"></i><b>9.1</b> Summarizing Your Data</a></li>
<li class="chapter" data-level="9.2" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id229"><i class="fa fa-check"></i><b>9.2</b> Calculating Relative Frequencies</a></li>
<li class="chapter" data-level="9.3" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id124"><i class="fa fa-check"></i><b>9.3</b> Tabulating Factors and Creating Contingency Tables</a></li>
<li class="chapter" data-level="9.4" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id125"><i class="fa fa-check"></i><b>9.4</b> Testing Categorical Variables for Independence</a></li>
<li class="chapter" data-level="9.5" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id143"><i class="fa fa-check"></i><b>9.5</b> Calculating Quantiles (and Quartiles) of a Dataset</a></li>
<li class="chapter" data-level="9.6" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id142"><i class="fa fa-check"></i><b>9.6</b> Inverting a Quantile</a></li>
<li class="chapter" data-level="9.7" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id133"><i class="fa fa-check"></i><b>9.7</b> Converting Data to z-Scores</a></li>
<li class="chapter" data-level="9.8" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id121"><i class="fa fa-check"></i><b>9.8</b> Testing the Mean of a Sample (t Test)</a></li>
<li class="chapter" data-level="9.9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id123"><i class="fa fa-check"></i><b>9.9</b> Forming a Confidence Interval for a Mean</a></li>
<li class="chapter" data-level="9.10" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id135"><i class="fa fa-check"></i><b>9.10</b> Forming a Confidence Interval for a Median</a></li>
<li class="chapter" data-level="9.11" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id225"><i class="fa fa-check"></i><b>9.11</b> Testing a Sample Proportion</a></li>
<li class="chapter" data-level="9.12" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id226"><i class="fa fa-check"></i><b>9.12</b> Forming a Confidence Interval for a Proportion</a></li>
<li class="chapter" data-level="9.13" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id126"><i class="fa fa-check"></i><b>9.13</b> Testing for Normality</a></li>
<li class="chapter" data-level="9.14" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id131"><i class="fa fa-check"></i><b>9.14</b> Testing for Runs</a></li>
<li class="chapter" data-level="9.15" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id122"><i class="fa fa-check"></i><b>9.15</b> Comparing the Means of Two Samples</a></li>
<li class="chapter" data-level="9.16" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id130"><i class="fa fa-check"></i><b>9.16</b> Comparing the Locations of Two Samples Nonparametrically</a></li>
<li class="chapter" data-level="9.17" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id132"><i class="fa fa-check"></i><b>9.17</b> Testing a Correlation for Significance</a></li>
<li class="chapter" data-level="9.18" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id134"><i class="fa fa-check"></i><b>9.18</b> Testing Groups for Equal Proportions</a></li>
<li class="chapter" data-level="9.19" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id127"><i class="fa fa-check"></i><b>9.19</b> Performing Pairwise Comparisons Between Group Means</a></li>
<li class="chapter" data-level="9.20" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id129"><i class="fa fa-check"></i><b>9.20</b> Testing Two Samples for the Same Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Graphics.html"><a href="Graphics.html"><i class="fa fa-check"></i><b>10</b> Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="Graphics.html"><a href="Graphics.html#intro-Graphics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10.1" data-path="Graphics.html"><a href="Graphics.html#recipe-id171"><i class="fa fa-check"></i><b>10.1</b> Creating a Scatter Plot</a></li>
<li class="chapter" data-level="10.2" data-path="Graphics.html"><a href="Graphics.html#recipe-id259"><i class="fa fa-check"></i><b>10.2</b> Adding a Title and Labels</a></li>
<li class="chapter" data-level="10.3" data-path="Graphics.html"><a href="Graphics.html#recipe-id261"><i class="fa fa-check"></i><b>10.3</b> Adding (or Removing) a Grid</a></li>
<li class="chapter" data-level="10.4" data-path="Graphics.html"><a href="Graphics.html#recipe-theme"><i class="fa fa-check"></i><b>10.4</b> Applying a Theme to a ggplot Figure</a></li>
<li class="chapter" data-level="10.5" data-path="Graphics.html"><a href="Graphics.html#recipe-id262"><i class="fa fa-check"></i><b>10.5</b> Creating a Scatter Plot of Multiple Groups</a></li>
<li class="chapter" data-level="10.6" data-path="Graphics.html"><a href="Graphics.html#recipe-id260"><i class="fa fa-check"></i><b>10.6</b> Adding (or Removing) a Legend</a></li>
<li class="chapter" data-level="10.7" data-path="Graphics.html"><a href="Graphics.html#recipe-id217"><i class="fa fa-check"></i><b>10.7</b> Plotting the Regression Line of a Scatter Plot</a></li>
<li class="chapter" data-level="10.8" data-path="Graphics.html"><a href="Graphics.html#recipe-id184"><i class="fa fa-check"></i><b>10.8</b> Plotting All Variables Against All Other Variables</a></li>
<li class="chapter" data-level="10.9" data-path="Graphics.html"><a href="Graphics.html#recipe-id185"><i class="fa fa-check"></i><b>10.9</b> Creating One Scatter Plot for Each Group</a></li>
<li class="chapter" data-level="10.10" data-path="Graphics.html"><a href="Graphics.html#recipe-id175"><i class="fa fa-check"></i><b>10.10</b> Creating a Bar Chart</a></li>
<li class="chapter" data-level="10.11" data-path="Graphics.html"><a href="Graphics.html#recipe-id177"><i class="fa fa-check"></i><b>10.11</b> Adding Confidence Intervals to a Bar Chart</a></li>
<li class="chapter" data-level="10.12" data-path="Graphics.html"><a href="Graphics.html#recipe-id176"><i class="fa fa-check"></i><b>10.12</b> Coloring a Bar Chart</a></li>
<li class="chapter" data-level="10.13" data-path="Graphics.html"><a href="Graphics.html#recipe-id174"><i class="fa fa-check"></i><b>10.13</b> Plotting a Line from x and y Points</a></li>
<li class="chapter" data-level="10.14" data-path="Graphics.html"><a href="Graphics.html#recipe-id256"><i class="fa fa-check"></i><b>10.14</b> Changing the Type, Width, or Color of a Line</a></li>
<li class="chapter" data-level="10.15" data-path="Graphics.html"><a href="Graphics.html#recipe-id263"><i class="fa fa-check"></i><b>10.15</b> Plotting Multiple Datasets</a></li>
<li class="chapter" data-level="10.16" data-path="Graphics.html"><a href="Graphics.html#recipe-id186"><i class="fa fa-check"></i><b>10.16</b> Adding Vertical or Horizontal Lines</a></li>
<li class="chapter" data-level="10.17" data-path="Graphics.html"><a href="Graphics.html#recipe-id178"><i class="fa fa-check"></i><b>10.17</b> Creating a Boxplot</a></li>
<li class="chapter" data-level="10.18" data-path="Graphics.html"><a href="Graphics.html#recipe-id179"><i class="fa fa-check"></i><b>10.18</b> Creating One Boxplot for Each Factor Level</a></li>
<li class="chapter" data-level="10.19" data-path="Graphics.html"><a href="Graphics.html#recipe-id182"><i class="fa fa-check"></i><b>10.19</b> Creating a Histogram</a></li>
<li class="chapter" data-level="10.20" data-path="Graphics.html"><a href="Graphics.html#recipe-id183"><i class="fa fa-check"></i><b>10.20</b> Adding a Density Estimate to a Histogram</a></li>
<li class="chapter" data-level="10.21" data-path="Graphics.html"><a href="Graphics.html#recipe-id180"><i class="fa fa-check"></i><b>10.21</b> Creating a Normal Quantile–Quantile Plot</a></li>
<li class="chapter" data-level="10.22" data-path="Graphics.html"><a href="Graphics.html#recipe-id181"><i class="fa fa-check"></i><b>10.22</b> Creating Other Quantile–Quantile Plots</a></li>
<li class="chapter" data-level="10.23" data-path="Graphics.html"><a href="Graphics.html#recipe-id191"><i class="fa fa-check"></i><b>10.23</b> Plotting a Variable in Multiple Colors</a></li>
<li class="chapter" data-level="10.24" data-path="Graphics.html"><a href="Graphics.html#recipe-id192"><i class="fa fa-check"></i><b>10.24</b> Graphing a Function</a></li>
<li class="chapter" data-level="10.25" data-path="Graphics.html"><a href="Graphics.html#recipe-id190"><i class="fa fa-check"></i><b>10.25</b> Displaying Several Figures on One Page</a></li>
<li class="chapter" data-level="10.26" data-path="Graphics.html"><a href="Graphics.html#recipe-id188"><i class="fa fa-check"></i><b>10.26</b> Writing Your Plot to a File</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html"><i class="fa fa-check"></i><b>11</b> Linear Regression and ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#intro-LinearRegressionAndANOVA"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id203"><i class="fa fa-check"></i><b>11.1</b> Performing Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id204"><i class="fa fa-check"></i><b>11.2</b> Performing Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.3" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id231"><i class="fa fa-check"></i><b>11.3</b> Getting Regression Statistics</a></li>
<li class="chapter" data-level="11.4" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id240"><i class="fa fa-check"></i><b>11.4</b> Understanding the Regression Summary</a></li>
<li class="chapter" data-level="11.5" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id205"><i class="fa fa-check"></i><b>11.5</b> Performing Linear Regression Without an Intercept</a></li>
<li class="chapter" data-level="11.6" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#title-highcor"><i class="fa fa-check"></i><b>11.6</b> Regressing Only Variables That Highly Correlate with Your Dependent Variable</a></li>
<li class="chapter" data-level="11.7" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id206"><i class="fa fa-check"></i><b>11.7</b> Performing Linear Regression with Interaction Terms</a></li>
<li class="chapter" data-level="11.8" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id236"><i class="fa fa-check"></i><b>11.8</b> Selecting the Best Regression Variables</a></li>
<li class="chapter" data-level="11.9" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id209"><i class="fa fa-check"></i><b>11.9</b> Regressing on a Subset of Your Data</a></li>
<li class="chapter" data-level="11.10" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id244"><i class="fa fa-check"></i><b>11.10</b> Using an Expression Inside a Regression Formula</a></li>
<li class="chapter" data-level="11.11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id243"><i class="fa fa-check"></i><b>11.11</b> Regressing on a Polynomial</a></li>
<li class="chapter" data-level="11.12" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id208"><i class="fa fa-check"></i><b>11.12</b> Regressing on Transformed Data</a></li>
<li class="chapter" data-level="11.13" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id210"><i class="fa fa-check"></i><b>11.13</b> Finding the Best Power Transformation (Box–Cox Procedure)</a></li>
<li class="chapter" data-level="11.14" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id211"><i class="fa fa-check"></i><b>11.14</b> Forming Confidence Intervals for Regression Coefficients</a></li>
<li class="chapter" data-level="11.15" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id216"><i class="fa fa-check"></i><b>11.15</b> Plotting Regression Residuals</a></li>
<li class="chapter" data-level="11.16" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id212"><i class="fa fa-check"></i><b>11.16</b> Diagnosing a Linear Regression</a></li>
<li class="chapter" data-level="11.17" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id233"><i class="fa fa-check"></i><b>11.17</b> Identifying Influential Observations</a></li>
<li class="chapter" data-level="11.18" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id213"><i class="fa fa-check"></i><b>11.18</b> Testing Residuals for Autocorrelation (Durbin–Watson Test)</a></li>
<li class="chapter" data-level="11.19" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id214"><i class="fa fa-check"></i><b>11.19</b> Predicting New Values</a></li>
<li class="chapter" data-level="11.20" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id215"><i class="fa fa-check"></i><b>11.20</b> Forming Prediction Intervals</a></li>
<li class="chapter" data-level="11.21" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id218"><i class="fa fa-check"></i><b>11.21</b> Performing One-Way ANOVA</a></li>
<li class="chapter" data-level="11.22" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id221"><i class="fa fa-check"></i><b>11.22</b> Creating an Interaction Plot</a></li>
<li class="chapter" data-level="11.23" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id220"><i class="fa fa-check"></i><b>11.23</b> Finding Differences Between Means of Groups</a></li>
<li class="chapter" data-level="11.24" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id228"><i class="fa fa-check"></i><b>11.24</b> Performing Robust ANOVA (Kruskal–Wallis Test)</a></li>
<li class="chapter" data-level="11.25" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id232"><i class="fa fa-check"></i><b>11.25</b> Comparing Models by Using ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="UsefulTricks.html"><a href="UsefulTricks.html"><i class="fa fa-check"></i><b>12</b> Useful Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="UsefulTricks.html"><a href="UsefulTricks.html#intro-UsefulTricks"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12.1" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id278"><i class="fa fa-check"></i><b>12.1</b> Peeking at Your Data</a></li>
<li class="chapter" data-level="12.2" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id271"><i class="fa fa-check"></i><b>12.2</b> Printing the Result of an Assignment</a></li>
<li class="chapter" data-level="12.3" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id138"><i class="fa fa-check"></i><b>12.3</b> Summing Rows and Columns</a></li>
<li class="chapter" data-level="12.4" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id112"><i class="fa fa-check"></i><b>12.4</b> Printing Data in Columns</a></li>
<li class="chapter" data-level="12.5" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id137"><i class="fa fa-check"></i><b>12.5</b> Binning Your Data</a></li>
<li class="chapter" data-level="12.6" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id116"><i class="fa fa-check"></i><b>12.6</b> Finding the Position of a Particular Value</a></li>
<li class="chapter" data-level="12.7" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id103"><i class="fa fa-check"></i><b>12.7</b> Selecting Every nth Element of a Vector</a></li>
<li class="chapter" data-level="12.8" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id107"><i class="fa fa-check"></i><b>12.8</b> Finding Minimums or Maximums</a></li>
<li class="chapter" data-level="12.9" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id110"><i class="fa fa-check"></i><b>12.9</b> Generating All Combinations of Several Variables</a></li>
<li class="chapter" data-level="12.10" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id153"><i class="fa fa-check"></i><b>12.10</b> Flattening a Data Frame</a></li>
<li class="chapter" data-level="12.11" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id247"><i class="fa fa-check"></i><b>12.11</b> Sorting a Data Frame</a></li>
<li class="chapter" data-level="12.12" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id223"><i class="fa fa-check"></i><b>12.12</b> Stripping Attributes from a Variable</a></li>
<li class="chapter" data-level="12.13" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id202"><i class="fa fa-check"></i><b>12.13</b> Revealing the Structure of an Object</a></li>
<li class="chapter" data-level="12.14" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id224"><i class="fa fa-check"></i><b>12.14</b> Timing Your Code</a></li>
<li class="chapter" data-level="12.15" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id113"><i class="fa fa-check"></i><b>12.15</b> Suppressing Warnings and Error Messages</a></li>
<li class="chapter" data-level="12.16" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id118"><i class="fa fa-check"></i><b>12.16</b> Taking Function Arguments from a List</a></li>
<li class="chapter" data-level="12.17" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id114"><i class="fa fa-check"></i><b>12.17</b> Defining Your Own Binary Operators</a></li>
<li class="chapter" data-level="12.18" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id111"><i class="fa fa-check"></i><b>12.18</b> Suppressing the Startup Message</a></li>
<li class="chapter" data-level="12.19" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id106"><i class="fa fa-check"></i><b>12.19</b> Getting and Setting Environment Variables</a></li>
<li class="chapter" data-level="12.20" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-codesections"><i class="fa fa-check"></i><b>12.20</b> Use Code Sections</a></li>
<li class="chapter" data-level="12.21" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_local"><i class="fa fa-check"></i><b>12.21</b> Executing R in Parallel Locally</a></li>
<li class="chapter" data-level="12.22" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_remote"><i class="fa fa-check"></i><b>12.22</b> Executing R in Parallel Remotely</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="BeyondBasics.html"><a href="BeyondBasics.html"><i class="fa fa-check"></i><b>13</b> Beyond Basic Numerics and Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="BeyondBasics.html"><a href="BeyondBasics.html#intro-BeyondBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="13.1" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id234"><i class="fa fa-check"></i><b>13.1</b> Minimizing or Maximizing a Single-Parameter Function</a></li>
<li class="chapter" data-level="13.2" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id235"><i class="fa fa-check"></i><b>13.2</b> Minimizing or Maximizing a Multiparameter Function</a></li>
<li class="chapter" data-level="13.3" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id140"><i class="fa fa-check"></i><b>13.3</b> Calculating Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="13.4" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id162"><i class="fa fa-check"></i><b>13.4</b> Performing Principal Component Analysis</a></li>
<li class="chapter" data-level="13.5" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id264"><i class="fa fa-check"></i><b>13.5</b> Performing Simple Orthogonal Regression</a></li>
<li class="chapter" data-level="13.6" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id160"><i class="fa fa-check"></i><b>13.6</b> Finding Clusters in Your Data</a></li>
<li class="chapter" data-level="13.7" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id161"><i class="fa fa-check"></i><b>13.7</b> Predicting a Binary-Valued Variable (Logistic Regression)</a></li>
<li class="chapter" data-level="13.8" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id159"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping a Statistic</a></li>
<li class="chapter" data-level="13.9" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id193"><i class="fa fa-check"></i><b>13.9</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html"><i class="fa fa-check"></i><b>14</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14.1" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id076"><i class="fa fa-check"></i><b>14.1</b> Representing Time Series Data</a></li>
<li class="chapter" data-level="14.2" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id089"><i class="fa fa-check"></i><b>14.2</b> Plotting Time Series Data</a></li>
<li class="chapter" data-level="14.3" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id077"><i class="fa fa-check"></i><b>14.3</b> Extracting the Oldest or Newest Observations</a></li>
<li class="chapter" data-level="14.4" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id281"><i class="fa fa-check"></i><b>14.4</b> Subsetting a Time Series</a></li>
<li class="chapter" data-level="14.5" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id079"><i class="fa fa-check"></i><b>14.5</b> Merging Several Time Series</a></li>
<li class="chapter" data-level="14.6" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id239"><i class="fa fa-check"></i><b>14.6</b> Filling or Padding a Time Series</a></li>
<li class="chapter" data-level="14.7" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id280"><i class="fa fa-check"></i><b>14.7</b> Lagging a Time Series</a></li>
<li class="chapter" data-level="14.8" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id141"><i class="fa fa-check"></i><b>14.8</b> Computing Successive Differences</a></li>
<li class="chapter" data-level="14.9" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id080"><i class="fa fa-check"></i><b>14.9</b> Performing Calculations on Time Series</a></li>
<li class="chapter" data-level="14.10" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id279"><i class="fa fa-check"></i><b>14.10</b> Computing a Moving Average</a></li>
<li class="chapter" data-level="14.11" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id282"><i class="fa fa-check"></i><b>14.11</b> Applying a Function by Calendar Period</a></li>
<li class="chapter" data-level="14.12" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id081"><i class="fa fa-check"></i><b>14.12</b> Applying a Rolling Function</a></li>
<li class="chapter" data-level="14.13" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id082"><i class="fa fa-check"></i><b>14.13</b> Plotting the Autocorrelation Function</a></li>
<li class="chapter" data-level="14.14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id104"><i class="fa fa-check"></i><b>14.14</b> Testing a Time Series for Autocorrelation</a></li>
<li class="chapter" data-level="14.15" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id083"><i class="fa fa-check"></i><b>14.15</b> Plotting the Partial Autocorrelation Function</a></li>
<li class="chapter" data-level="14.16" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id084"><i class="fa fa-check"></i><b>14.16</b> Finding Lagged Correlations Between Two Time Series</a></li>
<li class="chapter" data-level="14.17" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id088"><i class="fa fa-check"></i><b>14.17</b> Detrending a Time Series</a></li>
<li class="chapter" data-level="14.18" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id085"><i class="fa fa-check"></i><b>14.18</b> Fitting an ARIMA Model</a></li>
<li class="chapter" data-level="14.19" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id237"><i class="fa fa-check"></i><b>14.19</b> Removing Insignificant ARIMA Coefficients</a></li>
<li class="chapter" data-level="14.20" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id238"><i class="fa fa-check"></i><b>14.20</b> Running Diagnostics on an ARIMA Model</a></li>
<li class="chapter" data-level="14.21" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id086"><i class="fa fa-check"></i><b>14.21</b> Making Forecasts from an ARIMA Model</a></li>
<li class="chapter" data-level="14.22" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-plotting_forecast"><i class="fa fa-check"></i><b>14.22</b> Plotting a Forecast</a></li>
<li class="chapter" data-level="14.23" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id087"><i class="fa fa-check"></i><b>14.23</b> Testing for Mean Reversion</a></li>
<li class="chapter" data-level="14.24" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id195"><i class="fa fa-check"></i><b>14.24</b> Smoothing a Time Series</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html"><i class="fa fa-check"></i><b>15</b> Simple Programming</a>
<ul>
<li class="chapter" data-level="" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#intro-SimpleProgramming"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="15.1" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-creating_if_logic"><i class="fa fa-check"></i><b>15.1</b> Choosing Between Two Alternatives: if-else</a></li>
<li class="chapter" data-level="15.2" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-for_loop"><i class="fa fa-check"></i><b>15.2</b> Iterating with a Loop</a></li>
<li class="chapter" data-level="15.3" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-id117"><i class="fa fa-check"></i><b>15.3</b> Defining a Function</a></li>
<li class="chapter" data-level="15.4" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-variable"><i class="fa fa-check"></i><b>15.4</b> Creating a Local Variable</a></li>
<li class="chapter" data-level="15.5" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#choosing-between-multiple-alternatives-switch"><i class="fa fa-check"></i><b>15.5</b> Choosing Between Multiple Alternatives: switch</a></li>
<li class="chapter" data-level="15.6" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-title"><i class="fa fa-check"></i><b>15.6</b> Defining Defaults for Function Parameters</a></li>
<li class="chapter" data-level="15.7" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#signaling-errors"><i class="fa fa-check"></i><b>15.7</b> Signaling Errors</a></li>
<li class="chapter" data-level="15.8" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#protecting-against-errors"><i class="fa fa-check"></i><b>15.8</b> Protecting Against Errors</a></li>
<li class="chapter" data-level="15.9" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-anon-function"><i class="fa fa-check"></i><b>15.9</b> Creating an Anonymous Function</a></li>
<li class="chapter" data-level="15.10" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#creating-a-collection-of-reusable-functions"><i class="fa fa-check"></i><b>15.10</b> Creating a Collection of Reusable Functions</a></li>
<li class="chapter" data-level="15.11" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-indent"><i class="fa fa-check"></i><b>15.11</b> Automatically Reindent Code</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RMarkdown.html"><a href="RMarkdown.html"><i class="fa fa-check"></i><b>16</b> R Markdown and Publishing</a>
<ul>
<li class="chapter" data-level="" data-path="RMarkdown.html"><a href="RMarkdown.html#intro-Rmd_pub"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="16.1" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-new_doc"><i class="fa fa-check"></i><b>16.1</b> Creating a New Document</a></li>
<li class="chapter" data-level="16.2" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-metadata"><i class="fa fa-check"></i><b>16.2</b> Adding a Title, Author, or Date</a></li>
<li class="chapter" data-level="16.3" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc-text"><i class="fa fa-check"></i><b>16.3</b> Formatting Document Text</a></li>
<li class="chapter" data-level="16.4" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-headings"><i class="fa fa-check"></i><b>16.4</b> Inserting Document Headings</a></li>
<li class="chapter" data-level="16.5" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-list"><i class="fa fa-check"></i><b>16.5</b> Inserting a List</a></li>
<li class="chapter" data-level="16.6" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-exec_r"><i class="fa fa-check"></i><b>16.6</b> Showing Output from R Code</a></li>
<li class="chapter" data-level="16.7" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-code-results"><i class="fa fa-check"></i><b>16.7</b> Controlling Which Code and Results Are Shown</a></li>
<li class="chapter" data-level="16.8" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc_plot"><i class="fa fa-check"></i><b>16.8</b> Inserting a Plot</a></li>
<li class="chapter" data-level="16.9" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-static-table"><i class="fa fa-check"></i><b>16.9</b> Inserting a Table</a></li>
<li class="chapter" data-level="16.10" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-tables"><i class="fa fa-check"></i><b>16.10</b> Inserting a Table of Data</a></li>
<li class="chapter" data-level="16.11" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-equations"><i class="fa fa-check"></i><b>16.11</b> Inserting Math Equations</a></li>
<li class="chapter" data-level="16.12" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-html"><i class="fa fa-check"></i><b>16.12</b> Generating HTML Output</a></li>
<li class="chapter" data-level="16.13" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-pdf"><i class="fa fa-check"></i><b>16.13</b> Generating PDF Output</a></li>
<li class="chapter" data-level="16.14" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-word"><i class="fa fa-check"></i><b>16.14</b> Generating Microsoft Word Output</a></li>
<li class="chapter" data-level="16.15" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-prez"><i class="fa fa-check"></i><b>16.15</b> Generating Presentation Output</a></li>
<li class="chapter" data-level="16.16" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-param_report"><i class="fa fa-check"></i><b>16.16</b> Creating a Parameterized Report</a></li>
<li class="chapter" data-level="16.17" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-rmd_org"><i class="fa fa-check"></i><b>16.17</b> Organizing Your R Markdown Workflow</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cookbook, 2nd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="UsefulTricks" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Useful Tricks<a href="UsefulTricks.html#UsefulTricks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro-UsefulTricks" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="UsefulTricks.html#intro-UsefulTricks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The recipes in this chapter are neither obscure numerical calculations
nor deep statistical techniques. Yet they are useful functions and
idioms that you will likely need at one time or another.</p>
</div>
<div id="recipe-id278" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Peeking at Your Data<a href="UsefulTricks.html#recipe-id278" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id278" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id278" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a lot of data—too much to display at once. Nonetheless, you
want to see some of the data.</p>
</div>
<div id="solution-id278" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id278" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>head</code> to view the first few data values or rows:</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="UsefulTricks.html#cb835-1" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<p>Use <code>tail</code> to view the last few data values or rows:</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="UsefulTricks.html#cb836-1" tabindex="-1"></a><span class="fu">tail</span>(x)</span></code></pre></div>
<p>Or you can view the whole thing in an interactive viewer in RStudio:</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="UsefulTricks.html#cb837-1" tabindex="-1"></a><span class="fu">View</span>(x)</span></code></pre></div>
</div>
<div id="discussion-id278" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id278" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Printing a large dataset is pointless because everything just rolls off
your screen. Use <code>head</code> to see a little bit of the data (six rows by default):</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="UsefulTricks.html#cb838-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/lab_df.rdata&#39;</span>)</span>
<span id="cb838-2"><a href="UsefulTricks.html#cb838-2" tabindex="-1"></a><span class="fu">head</span>(lab_df)</span>
<span id="cb838-3"><a href="UsefulTricks.html#cb838-3" tabindex="-1"></a><span class="co">#&gt;         x lab      y</span></span>
<span id="cb838-4"><a href="UsefulTricks.html#cb838-4" tabindex="-1"></a><span class="co">#&gt; 1  0.0761  NJ  1.621</span></span>
<span id="cb838-5"><a href="UsefulTricks.html#cb838-5" tabindex="-1"></a><span class="co">#&gt; 2  1.4149  KY 10.338</span></span>
<span id="cb838-6"><a href="UsefulTricks.html#cb838-6" tabindex="-1"></a><span class="co">#&gt; 3  2.5176  KY 14.284</span></span>
<span id="cb838-7"><a href="UsefulTricks.html#cb838-7" tabindex="-1"></a><span class="co">#&gt; 4 -0.3043  KY  0.599</span></span>
<span id="cb838-8"><a href="UsefulTricks.html#cb838-8" tabindex="-1"></a><span class="co">#&gt; 5  2.3916  KY 13.091</span></span>
<span id="cb838-9"><a href="UsefulTricks.html#cb838-9" tabindex="-1"></a><span class="co">#&gt; 6  2.0602  NJ 16.321</span></span></code></pre></div>
<p>Use <code>tail</code> to see the last few rows and the number of rows:</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="UsefulTricks.html#cb839-1" tabindex="-1"></a><span class="fu">tail</span>(lab_df)</span>
<span id="cb839-2"><a href="UsefulTricks.html#cb839-2" tabindex="-1"></a><span class="co">#&gt;          x lab      y</span></span>
<span id="cb839-3"><a href="UsefulTricks.html#cb839-3" tabindex="-1"></a><span class="co">#&gt; 195  7.353  KY 38.880</span></span>
<span id="cb839-4"><a href="UsefulTricks.html#cb839-4" tabindex="-1"></a><span class="co">#&gt; 196 -0.742  KY -0.298</span></span>
<span id="cb839-5"><a href="UsefulTricks.html#cb839-5" tabindex="-1"></a><span class="co">#&gt; 197  2.116  NJ 11.629</span></span>
<span id="cb839-6"><a href="UsefulTricks.html#cb839-6" tabindex="-1"></a><span class="co">#&gt; 198  1.606  KY  9.408</span></span>
<span id="cb839-7"><a href="UsefulTricks.html#cb839-7" tabindex="-1"></a><span class="co">#&gt; 199 -0.523  KY -1.089</span></span>
<span id="cb839-8"><a href="UsefulTricks.html#cb839-8" tabindex="-1"></a><span class="co">#&gt; 200  0.675  KY  5.808</span></span></code></pre></div>
<p>Both <code>head</code> and <code>tail</code> allow you to pass a number to the function to set the number of rows returned:</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="UsefulTricks.html#cb840-1" tabindex="-1"></a><span class="fu">tail</span>(lab_df, <span class="dv">2</span>)</span>
<span id="cb840-2"><a href="UsefulTricks.html#cb840-2" tabindex="-1"></a><span class="co">#&gt;          x lab     y</span></span>
<span id="cb840-3"><a href="UsefulTricks.html#cb840-3" tabindex="-1"></a><span class="co">#&gt; 199 -0.523  KY -1.09</span></span>
<span id="cb840-4"><a href="UsefulTricks.html#cb840-4" tabindex="-1"></a><span class="co">#&gt; 200  0.675  KY  5.81</span></span></code></pre></div>
<p>RStudio comes with an interactive viewer built in. You can call the viewer from the console or a script:</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="UsefulTricks.html#cb841-1" tabindex="-1"></a><span class="fu">View</span>(lab_df)</span></code></pre></div>
<p>Or you can pipe an object to the viewer:</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="UsefulTricks.html#cb842-1" tabindex="-1"></a>lab_df <span class="sc">%&gt;%</span></span>
<span id="cb842-2"><a href="UsefulTricks.html#cb842-2" tabindex="-1"></a>  <span class="fu">View</span>()</span></code></pre></div>
<p>When piping to <code>View</code> you will notice that the viewer names the View tab simply <code>.</code> (just a dot). To get a more informative name, you can put a descriptive name in quotes:</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="UsefulTricks.html#cb843-1" tabindex="-1"></a>lab_df <span class="sc">%&gt;%</span></span>
<span id="cb843-2"><a href="UsefulTricks.html#cb843-2" tabindex="-1"></a>  <span class="fu">View</span>(<span class="st">&quot;lab_df test from pipe&quot;</span>)</span></code></pre></div>
<p>The resulting RStudio viewer is shown in Figure <a href="UsefulTricks.html#fig:rstudioview">12.1</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rstudioview"></span>
<img src="images_v2/View.png" alt="RStudio viewer" width="85%" />
<p class="caption">
Figure 12.1: RStudio viewer
</p>
</div>
</div>
<div id="see_also-id278" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id278" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="UsefulTricks.html#recipe-id202">12.13</a>, <a href="UsefulTricks.html#recipe-id202">“Revealing the Structure of an Object”</a> for seeing the
structure of your variable’s contents.</p>
</div>
</div>
<div id="recipe-id271" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Printing the Result of an Assignment<a href="UsefulTricks.html#recipe-id271" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id271" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id271" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You are assigning a value to a variable and you want to see its value.</p>
</div>
<div id="solution-id271" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id271" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simply put parentheses around the assignment:</p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="UsefulTricks.html#cb844-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>pi            <span class="co"># Prints nothing</span></span>
<span id="cb844-2"><a href="UsefulTricks.html#cb844-2" tabindex="-1"></a>(x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>pi)          <span class="co"># Prints assigned value</span></span>
<span id="cb844-3"><a href="UsefulTricks.html#cb844-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.318</span></span></code></pre></div>
</div>
<div id="discussion-id271" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id271" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Normally, R inhibits printing when it sees you enter a simple
assignment. When you surround the assignment with parentheses, however,
it is no longer a simple assignment and so R prints the value. This can be very handy for quick debugging in a script.</p>
</div>
<div id="see_also-id271" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id271" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="SomeBasics.html#recipe-id017">2.1</a>, <a href="SomeBasics.html#recipe-id017">“Printing Something to the Screen”</a>, for more ways to print things.</p>
</div>
</div>
<div id="recipe-id138" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Summing Rows and Columns<a href="UsefulTricks.html#recipe-id138" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id138" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id138" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to sum the rows or columns of a matrix or data frame.</p>
</div>
<div id="solution-id138" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id138" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>rowSums</code> to sum the rows:</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="UsefulTricks.html#cb845-1" tabindex="-1"></a><span class="fu">rowSums</span>(m)</span></code></pre></div>
<p>Use <code>colSums</code> to sum the columns:</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="UsefulTricks.html#cb846-1" tabindex="-1"></a><span class="fu">colSums</span>(m)</span></code></pre></div>
</div>
<div id="discussion-id138" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id138" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a mundane recipe, but it’s so common that it deserves
mentioning. We use this recipe, for example, when producing reports that
include column totals. In this example, <code>daily.prod</code> is a record of this
week’s factory production and we want totals by product and by day:</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="UsefulTricks.html#cb847-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/daily.prod.rdata&#39;</span>)</span>
<span id="cb847-2"><a href="UsefulTricks.html#cb847-2" tabindex="-1"></a>daily.prod</span>
<span id="cb847-3"><a href="UsefulTricks.html#cb847-3" tabindex="-1"></a><span class="co">#&gt;     Widgets Gadgets Thingys</span></span>
<span id="cb847-4"><a href="UsefulTricks.html#cb847-4" tabindex="-1"></a><span class="co">#&gt; Mon     179     167     182</span></span>
<span id="cb847-5"><a href="UsefulTricks.html#cb847-5" tabindex="-1"></a><span class="co">#&gt; Tue     153     193     166</span></span>
<span id="cb847-6"><a href="UsefulTricks.html#cb847-6" tabindex="-1"></a><span class="co">#&gt; Wed     183     190     170</span></span>
<span id="cb847-7"><a href="UsefulTricks.html#cb847-7" tabindex="-1"></a><span class="co">#&gt; Thu     153     161     171</span></span>
<span id="cb847-8"><a href="UsefulTricks.html#cb847-8" tabindex="-1"></a><span class="co">#&gt; Fri     154     181     186</span></span>
<span id="cb847-9"><a href="UsefulTricks.html#cb847-9" tabindex="-1"></a><span class="fu">colSums</span>(daily.prod)</span>
<span id="cb847-10"><a href="UsefulTricks.html#cb847-10" tabindex="-1"></a><span class="co">#&gt; Widgets Gadgets Thingys </span></span>
<span id="cb847-11"><a href="UsefulTricks.html#cb847-11" tabindex="-1"></a><span class="co">#&gt;     822     892     875</span></span>
<span id="cb847-12"><a href="UsefulTricks.html#cb847-12" tabindex="-1"></a><span class="fu">rowSums</span>(daily.prod)</span>
<span id="cb847-13"><a href="UsefulTricks.html#cb847-13" tabindex="-1"></a><span class="co">#&gt; Mon Tue Wed Thu Fri </span></span>
<span id="cb847-14"><a href="UsefulTricks.html#cb847-14" tabindex="-1"></a><span class="co">#&gt; 528 512 543 485 521</span></span></code></pre></div>
<p>These functions return a vector. In the case of column sums, we can
append the vector to the matrix and thereby neatly print the data and
totals together:</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="UsefulTricks.html#cb848-1" tabindex="-1"></a><span class="fu">rbind</span>(daily.prod, <span class="at">Totals=</span><span class="fu">colSums</span>(daily.prod))</span>
<span id="cb848-2"><a href="UsefulTricks.html#cb848-2" tabindex="-1"></a><span class="co">#&gt;        Widgets Gadgets Thingys</span></span>
<span id="cb848-3"><a href="UsefulTricks.html#cb848-3" tabindex="-1"></a><span class="co">#&gt; Mon        179     167     182</span></span>
<span id="cb848-4"><a href="UsefulTricks.html#cb848-4" tabindex="-1"></a><span class="co">#&gt; Tue        153     193     166</span></span>
<span id="cb848-5"><a href="UsefulTricks.html#cb848-5" tabindex="-1"></a><span class="co">#&gt; Wed        183     190     170</span></span>
<span id="cb848-6"><a href="UsefulTricks.html#cb848-6" tabindex="-1"></a><span class="co">#&gt; Thu        153     161     171</span></span>
<span id="cb848-7"><a href="UsefulTricks.html#cb848-7" tabindex="-1"></a><span class="co">#&gt; Fri        154     181     186</span></span>
<span id="cb848-8"><a href="UsefulTricks.html#cb848-8" tabindex="-1"></a><span class="co">#&gt; Totals     822     892     875</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id112" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Printing Data in Columns<a href="UsefulTricks.html#recipe-id112" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id112" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id112" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have several parallel data vectors, and you want to print them in
columns.</p>
</div>
<div id="solution-id112" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id112" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>cbind</code> to form the data into columns, then print the result.</p>
</div>
<div id="discussion-id112" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id112" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you have parallel vectors, it’s difficult to see their relationship
if you print them separately:</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="UsefulTricks.html#cb849-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/xy.rdata&#39;</span>)</span>
<span id="cb849-2"><a href="UsefulTricks.html#cb849-2" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb849-3"><a href="UsefulTricks.html#cb849-3" tabindex="-1"></a><span class="co">#&gt;  [1] -0.626  0.184 -0.836  1.595  0.330 -0.820  0.487  0.738  0.576 -0.305</span></span>
<span id="cb849-4"><a href="UsefulTricks.html#cb849-4" tabindex="-1"></a><span class="fu">print</span>(y)</span>
<span id="cb849-5"><a href="UsefulTricks.html#cb849-5" tabindex="-1"></a><span class="co">#&gt;  [1]  1.5118  0.3898 -0.6212 -2.2147  1.1249 -0.0449 -0.0162  0.9438  0.8212</span></span>
<span id="cb849-6"><a href="UsefulTricks.html#cb849-6" tabindex="-1"></a><span class="co">#&gt; [10]  0.5939</span></span></code></pre></div>
<p>Use the <code>cbind</code> function to form them into columns that, when printed,
show the data’s structure:</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="UsefulTricks.html#cb850-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cbind</span>(x,y))</span>
<span id="cb850-2"><a href="UsefulTricks.html#cb850-2" tabindex="-1"></a><span class="co">#&gt;            x       y</span></span>
<span id="cb850-3"><a href="UsefulTricks.html#cb850-3" tabindex="-1"></a><span class="co">#&gt;  [1,] -0.626  1.5118</span></span>
<span id="cb850-4"><a href="UsefulTricks.html#cb850-4" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.184  0.3898</span></span>
<span id="cb850-5"><a href="UsefulTricks.html#cb850-5" tabindex="-1"></a><span class="co">#&gt;  [3,] -0.836 -0.6212</span></span>
<span id="cb850-6"><a href="UsefulTricks.html#cb850-6" tabindex="-1"></a><span class="co">#&gt;  [4,]  1.595 -2.2147</span></span>
<span id="cb850-7"><a href="UsefulTricks.html#cb850-7" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.330  1.1249</span></span>
<span id="cb850-8"><a href="UsefulTricks.html#cb850-8" tabindex="-1"></a><span class="co">#&gt;  [6,] -0.820 -0.0449</span></span>
<span id="cb850-9"><a href="UsefulTricks.html#cb850-9" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.487 -0.0162</span></span>
<span id="cb850-10"><a href="UsefulTricks.html#cb850-10" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.738  0.9438</span></span>
<span id="cb850-11"><a href="UsefulTricks.html#cb850-11" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.576  0.8212</span></span>
<span id="cb850-12"><a href="UsefulTricks.html#cb850-12" tabindex="-1"></a><span class="co">#&gt; [10,] -0.305  0.5939</span></span></code></pre></div>
<p>You can include expressions in the output, too. Use a tag to give them a
column heading:</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="UsefulTricks.html#cb851-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cbind</span>(x, y, <span class="at">Total =</span> x <span class="sc">+</span> y))</span>
<span id="cb851-2"><a href="UsefulTricks.html#cb851-2" tabindex="-1"></a><span class="co">#&gt;            x       y  Total</span></span>
<span id="cb851-3"><a href="UsefulTricks.html#cb851-3" tabindex="-1"></a><span class="co">#&gt;  [1,] -0.626  1.5118  0.885</span></span>
<span id="cb851-4"><a href="UsefulTricks.html#cb851-4" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.184  0.3898  0.573</span></span>
<span id="cb851-5"><a href="UsefulTricks.html#cb851-5" tabindex="-1"></a><span class="co">#&gt;  [3,] -0.836 -0.6212 -1.457</span></span>
<span id="cb851-6"><a href="UsefulTricks.html#cb851-6" tabindex="-1"></a><span class="co">#&gt;  [4,]  1.595 -2.2147 -0.619</span></span>
<span id="cb851-7"><a href="UsefulTricks.html#cb851-7" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.330  1.1249  1.454</span></span>
<span id="cb851-8"><a href="UsefulTricks.html#cb851-8" tabindex="-1"></a><span class="co">#&gt;  [6,] -0.820 -0.0449 -0.865</span></span>
<span id="cb851-9"><a href="UsefulTricks.html#cb851-9" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.487 -0.0162  0.471</span></span>
<span id="cb851-10"><a href="UsefulTricks.html#cb851-10" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.738  0.9438  1.682</span></span>
<span id="cb851-11"><a href="UsefulTricks.html#cb851-11" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.576  0.8212  1.397</span></span>
<span id="cb851-12"><a href="UsefulTricks.html#cb851-12" tabindex="-1"></a><span class="co">#&gt; [10,] -0.305  0.5939  0.289</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id137" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Binning Your Data<a href="UsefulTricks.html#recipe-id137" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id137" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id137" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a vector, and you want to split the data into groups according
to intervals. Statisticians call this <em>binning</em> your data.</p>
</div>
<div id="solution-id137" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id137" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>cut</code> function. You must define a vector, say <code>breaks</code>, that
gives the ranges of the intervals. The <code>cut</code> function will group your
data according to those intervals. It returns a factor whose levels
(elements) identify each datum’s group:</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="UsefulTricks.html#cb852-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, breaks)</span></code></pre></div>
</div>
<div id="discussion-id137" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id137" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example generates 1,000 random numbers that have a standard normal
distribution. It breaks them into six groups by defining intervals at
±1, ±2, and ±3 standard deviations:</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="UsefulTricks.html#cb853-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb853-2"><a href="UsefulTricks.html#cb853-2" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb853-3"><a href="UsefulTricks.html#cb853-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, breaks)</span></code></pre></div>
<p>The result is a factor, <code>f</code>, that identifies the groups. The <code>summary</code>
function shows the number of elements by level. R creates names for each
level, using the mathematical notation for an interval:</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="UsefulTricks.html#cb854-1" tabindex="-1"></a><span class="fu">summary</span>(f)</span>
<span id="cb854-2"><a href="UsefulTricks.html#cb854-2" tabindex="-1"></a><span class="co">#&gt; (-3,-2] (-2,-1]  (-1,0]   (0,1]   (1,2]   (2,3]    NA&#39;s </span></span>
<span id="cb854-3"><a href="UsefulTricks.html#cb854-3" tabindex="-1"></a><span class="co">#&gt;      25     147     341     332     132      18       5</span></span></code></pre></div>
<p>The results are bell-shaped, which is what we expect from the <code>rnorm</code> function. There are five <code>NA</code>
values, indicating that two values in <code>x</code> fell outside the defined
intervals.</p>
<p>We can use the <code>labels</code> parameter to give nice, predefined names to the
six groups instead of the funky synthesized names:</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="UsefulTricks.html#cb855-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, breaks, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Bottom&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Neg&quot;</span>, <span class="st">&quot;Pos&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Top&quot;</span>))</span></code></pre></div>
<p>Now the <code>summary</code> function uses our names:</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="UsefulTricks.html#cb856-1" tabindex="-1"></a><span class="fu">summary</span>(f)</span>
<span id="cb856-2"><a href="UsefulTricks.html#cb856-2" tabindex="-1"></a><span class="co">#&gt; Bottom    Low    Neg    Pos   High    Top   NA&#39;s </span></span>
<span id="cb856-3"><a href="UsefulTricks.html#cb856-3" tabindex="-1"></a><span class="co">#&gt;     25    147    341    332    132     18      5</span></span></code></pre></div>
<p>Binning is useful for summaries such as histograms. But it results in
information loss, which can be harmful in modeling. Consider the extreme
case of binning a continuous variable into two values, <code>high</code> and <code>low</code>.
The binned data has only two possible values, so you have replaced a
rich source of information with <em>one bit</em> of information. Where the
continuous variable might be a powerful predictor, the binned variable
can distinguish at most two states and so will likely have only a
fraction of the original power. Before you bin, we suggest exploring
other transformations that are less lossy.</p>
</div>
</div>
<div id="recipe-id116" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Finding the Position of a Particular Value<a href="UsefulTricks.html#recipe-id116" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id116" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id116" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a vector. You know a particular value occurs in the contents,
and you want to know its position.</p>
</div>
<div id="solution-id116" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id116" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>match</code> function will search a vector for a particular value and
return the position:</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="UsefulTricks.html#cb857-1" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">80</span>, <span class="dv">70</span>, <span class="dv">60</span>, <span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">30</span>, <span class="dv">20</span>, <span class="dv">10</span>)</span>
<span id="cb857-2"><a href="UsefulTricks.html#cb857-2" tabindex="-1"></a><span class="fu">match</span>(<span class="dv">80</span>, vec)</span>
<span id="cb857-3"><a href="UsefulTricks.html#cb857-3" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>Here <code>match</code> returns <code>3</code>, which is the position of <code>80</code> within <code>vec</code>.</p>
</div>
<div id="discussion-id116" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id116" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are special functions for finding the location of the minimum and
maximum values—<code>which.min</code> and <code>which.max</code>, respectively:</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="UsefulTricks.html#cb858-1" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">90</span>,<span class="dv">80</span>,<span class="dv">70</span>,<span class="dv">60</span>,<span class="dv">50</span>,<span class="dv">40</span>,<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">10</span>)</span>
<span id="cb858-2"><a href="UsefulTricks.html#cb858-2" tabindex="-1"></a><span class="fu">which.min</span>(vec)          <span class="co"># Position of smallest element</span></span>
<span id="cb858-3"><a href="UsefulTricks.html#cb858-3" tabindex="-1"></a><span class="co">#&gt; [1] 10</span></span>
<span id="cb858-4"><a href="UsefulTricks.html#cb858-4" tabindex="-1"></a><span class="fu">which.max</span>(vec)          <span class="co"># Position of largest element</span></span>
<span id="cb858-5"><a href="UsefulTricks.html#cb858-5" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div id="see_also-id116" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id116" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This technique is used in Recipe <a href="LinearRegressionAndANOVA.html#recipe-id210">11.13</a>, <a href="LinearRegressionAndANOVA.html#recipe-id210">“Finding the Best Power Transformation”</a>.</p>
</div>
</div>
<div id="recipe-id103" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Selecting Every nth Element of a Vector<a href="UsefulTricks.html#recipe-id103" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id103" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id103" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to select every <em>n</em>th element of a vector.</p>
</div>
<div id="solution-id103" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id103" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a logical indexing vector that is <code>TRUE</code> for every <em>n</em>th element.
One approach is to find all subscripts that equal zero when taken modulo
<em>n</em>:</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="UsefulTricks.html#cb859-1" tabindex="-1"></a>v[<span class="fu">seq_along</span>(v) <span class="sc">%%</span> n <span class="sc">==</span> <span class="dv">0</span>]</span></code></pre></div>
</div>
<div id="discussion-id103" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id103" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This problem arises in systematic sampling: we want to sample a dataset
by selecting every <em>n</em>th element. The <code>seq_along(v)</code> function generates
the sequence of integers that can index <code>v</code>; it is equivalent to
<code>1:length(v)</code>. We compute each index value modulo <em>n</em> by the expression:</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="UsefulTricks.html#cb860-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb860-2"><a href="UsefulTricks.html#cb860-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb860-3"><a href="UsefulTricks.html#cb860-3" tabindex="-1"></a><span class="fu">seq_along</span>(v) <span class="sc">%%</span> n</span>
<span id="cb860-4"><a href="UsefulTricks.html#cb860-4" tabindex="-1"></a><span class="co">#&gt;  [1] 1 0 1 0 1 0 1 0 1 0</span></span></code></pre></div>
<p>Then we find those values that equal zero:</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="UsefulTricks.html#cb861-1" tabindex="-1"></a><span class="fu">seq_along</span>(v) <span class="sc">%%</span> n <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb861-2"><a href="UsefulTricks.html#cb861-2" tabindex="-1"></a><span class="co">#&gt;  [1] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE</span></span></code></pre></div>
<p>The result is a logical vector, the same length as <code>v</code> and with <code>TRUE</code>
at every <em>n</em>th element, that can index <code>v</code> to select the desired
elements:</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="UsefulTricks.html#cb862-1" tabindex="-1"></a>v</span>
<span id="cb862-2"><a href="UsefulTricks.html#cb862-2" tabindex="-1"></a><span class="co">#&gt;  [1]  2.325  0.524  0.971  0.377 -0.996 -0.597  0.165 -2.928 -0.848  0.799</span></span>
<span id="cb862-3"><a href="UsefulTricks.html#cb862-3" tabindex="-1"></a>v[ <span class="fu">seq_along</span>(v) <span class="sc">%%</span> n <span class="sc">==</span> <span class="dv">0</span> ]</span>
<span id="cb862-4"><a href="UsefulTricks.html#cb862-4" tabindex="-1"></a><span class="co">#&gt; [1]  0.524  0.377 -0.597 -2.928  0.799</span></span></code></pre></div>
<p>If you just want something simple like every second element, you can use
the Recycling Rule in a clever way. Index <code>v</code> with a two-element logical
vector, like this:</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="UsefulTricks.html#cb863-1" tabindex="-1"></a>v[<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>)]</span>
<span id="cb863-2"><a href="UsefulTricks.html#cb863-2" tabindex="-1"></a><span class="co">#&gt; [1]  0.524  0.377 -0.597 -2.928  0.799</span></span></code></pre></div>
<p>If <code>v</code> has more than two elements, then the indexing vector is too short.
Hence, R will invoke the Recycling Rule and expand the index vector to
the length of <code>v</code>, recycling its contents. That gives an index vector
that is <code>FALSE</code>, <code>TRUE</code>, <code>FALSE</code>, <code>TRUE</code>, <code>FALSE</code>, <code>TRUE</code>, and so forth.
Voilà! The final result is every second element of <code>v</code>.</p>
</div>
<div id="see_also-id103" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id103" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="DataStructures.html#recipe-id050">5.3</a>, <a href="DataStructures.html#recipe-id050">“Understanding the Recycling Rule”</a>, for more about the Recycling Rule.</p>
</div>
</div>
<div id="recipe-id107" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> Finding Minimums or Maximums<a href="UsefulTricks.html#recipe-id107" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id107" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id107" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have two vectors, <em>v</em> and <em>w</em>, and you want to find the minimums or
the maximums of pairwise elements. That is, you want to calculate:</p>
<blockquote>
<p>min(<em>v</em><sub>1</sub>, <em>w</em><sub>1</sub>), min(<em>v</em><sub>2</sub>, <em>w</em><sub>2</sub>), min(<em>v</em><sub>3</sub>, <em>w</em><sub>3</sub>), …</p>
</blockquote>
<p>or:</p>
<blockquote>
<p>max(<em>v</em><sub>1</sub>, <em>w</em><sub>1</sub>), max(<em>v</em><sub>2</sub>, <em>w</em><sub>2</sub>), max(<em>v</em><sub>3</sub>, <em>w</em><sub>3</sub>), …</p>
</blockquote>
</div>
<div id="solution-id107" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id107" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R calls these the <em>parallel minimum</em> and the <em>parallel maximum</em>. The
calculation is performed by <code>pmin(v,w)</code> and <code>pmax(v,w)</code>, respectively:</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="UsefulTricks.html#cb864-1" tabindex="-1"></a><span class="fu">pmin</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>)    <span class="co"># Find the element-by-element minimum</span></span>
<span id="cb864-2"><a href="UsefulTricks.html#cb864-2" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 2 1</span></span>
<span id="cb864-3"><a href="UsefulTricks.html#cb864-3" tabindex="-1"></a><span class="fu">pmax</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>)    <span class="co"># Find the element-by-element maximum</span></span>
<span id="cb864-4"><a href="UsefulTricks.html#cb864-4" tabindex="-1"></a><span class="co">#&gt; [1] 5 4 3 4 5</span></span></code></pre></div>
</div>
<div id="discussion-id107" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id107" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When an R beginner wants pairwise minimums or maximums, a common mistake
is to write <code>min(v,w)</code> or <code>max(v,w)</code>. Those are not pairwise operations:
<code>min(v,w)</code> returns a single value, the minimum over all <code>v</code> and <code>w</code>.
Likewise, <code>max(v,w)</code> returns a single value from all of <code>v</code> and <code>w</code>.</p>
<p>The <code>pmin</code> and <code>pmax</code> values compare their arguments in parallel,
picking the minimum or maximum for each subscript. They return a vector
that matches the length of the inputs.</p>
<p>You can combine <code>pmin</code> and <code>pmax</code> with the Recycling Rule to perform
useful hacks. Suppose the vector <code>v</code> contains both positive and negative
values, and you want to reset the negative values to zero. This does the
trick:</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="UsefulTricks.html#cb865-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb865-2"><a href="UsefulTricks.html#cb865-2" tabindex="-1"></a>v</span>
<span id="cb865-3"><a href="UsefulTricks.html#cb865-3" tabindex="-1"></a><span class="co">#&gt; [1] -3 -2 -1  0  1  2  3</span></span>
<span id="cb865-4"><a href="UsefulTricks.html#cb865-4" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">pmax</span>(v, <span class="dv">0</span>)</span>
<span id="cb865-5"><a href="UsefulTricks.html#cb865-5" tabindex="-1"></a>v</span>
<span id="cb865-6"><a href="UsefulTricks.html#cb865-6" tabindex="-1"></a><span class="co">#&gt; [1] 0 0 0 0 1 2 3</span></span></code></pre></div>
<p>By the Recycling Rule, R expands the zero-valued scalar into a vector of
zeros that is the same length as <code>v</code>. Then <code>pmax</code> does an
element-by-element comparison, taking the larger of zero and each
element of <code>v</code>.</p>
<p>Actually, <code>pmin</code> and <code>pmax</code> are more powerful than the Solution
indicates. They can take more than two vectors, comparing all vectors in
parallel.</p>
<p>It is not uncommon to use <code>pmin</code> or <code>pmax</code> to calculate a new variable in a data frame based on multiple fields. Let’s look at a quick example:</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="UsefulTricks.html#cb866-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">8</span>), </span>
<span id="cb866-2"><a href="UsefulTricks.html#cb866-2" tabindex="-1"></a>                 <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">7</span>),</span>
<span id="cb866-3"><a href="UsefulTricks.html#cb866-3" tabindex="-1"></a>                 <span class="at">c =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">9</span>))</span>
<span id="cb866-4"><a href="UsefulTricks.html#cb866-4" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb866-5"><a href="UsefulTricks.html#cb866-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">max_val =</span> <span class="fu">pmax</span>(a,b,c))</span>
<span id="cb866-6"><a href="UsefulTricks.html#cb866-6" tabindex="-1"></a><span class="co">#&gt;   a b c max_val</span></span>
<span id="cb866-7"><a href="UsefulTricks.html#cb866-7" tabindex="-1"></a><span class="co">#&gt; 1 1 2 0       2</span></span>
<span id="cb866-8"><a href="UsefulTricks.html#cb866-8" tabindex="-1"></a><span class="co">#&gt; 2 5 3 4       5</span></span>
<span id="cb866-9"><a href="UsefulTricks.html#cb866-9" tabindex="-1"></a><span class="co">#&gt; 3 8 7 9       9</span></span></code></pre></div>
<p>We can see the new column, <code>max_val</code>, now contains the row-by-row max value from the three input columns.</p>
</div>
<div id="see_also-id107" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id107" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="DataStructures.html#recipe-id050">5.3</a>, <a href="DataStructures.html#recipe-id050">“Understanding the Recycling Rule”</a>, for more about the Recycling Rule.</p>
</div>
</div>
<div id="recipe-id110" class="section level2 hasAnchor" number="12.9">
<h2><span class="header-section-number">12.9</span> Generating All Combinations of Several Variables<a href="UsefulTricks.html#recipe-id110" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id110" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id110" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have two or more variables. You want to generate all combinations of
their levels, also known as their <em>Cartesian product</em>.</p>
</div>
<div id="solution-id110" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id110" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>expand.grid</code> function. Here, <code>f</code> and <code>g</code> are vectors:</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="UsefulTricks.html#cb867-1" tabindex="-1"></a><span class="fu">expand.grid</span>(f, g)</span></code></pre></div>
</div>
<div id="discussion-id110" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id110" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This code snippet creates two vectors—<code>sides</code> represents the two sides
of a coin, and <code>faces</code> represents the six faces of a die (those little
spots on a die are called <em>pips</em>):</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="UsefulTricks.html#cb868-1" tabindex="-1"></a>sides <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>)</span>
<span id="cb868-2"><a href="UsefulTricks.html#cb868-2" tabindex="-1"></a>faces <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1 pip&quot;</span>, <span class="fu">paste</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">&quot;pips&quot;</span>))</span></code></pre></div>
<p>We can use <code>expand.grid</code> to find all combinations of one roll of the die
and one coin toss:</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="UsefulTricks.html#cb869-1" tabindex="-1"></a><span class="fu">expand.grid</span>(faces, sides)</span>
<span id="cb869-2"><a href="UsefulTricks.html#cb869-2" tabindex="-1"></a><span class="co">#&gt;      Var1  Var2</span></span>
<span id="cb869-3"><a href="UsefulTricks.html#cb869-3" tabindex="-1"></a><span class="co">#&gt; 1   1 pip Heads</span></span>
<span id="cb869-4"><a href="UsefulTricks.html#cb869-4" tabindex="-1"></a><span class="co">#&gt; 2  2 pips Heads</span></span>
<span id="cb869-5"><a href="UsefulTricks.html#cb869-5" tabindex="-1"></a><span class="co">#&gt; 3  3 pips Heads</span></span>
<span id="cb869-6"><a href="UsefulTricks.html#cb869-6" tabindex="-1"></a><span class="co">#&gt; 4  4 pips Heads</span></span>
<span id="cb869-7"><a href="UsefulTricks.html#cb869-7" tabindex="-1"></a><span class="co">#&gt; 5  5 pips Heads</span></span>
<span id="cb869-8"><a href="UsefulTricks.html#cb869-8" tabindex="-1"></a><span class="co">#&gt; 6  6 pips Heads</span></span>
<span id="cb869-9"><a href="UsefulTricks.html#cb869-9" tabindex="-1"></a><span class="co">#&gt; 7   1 pip Tails</span></span>
<span id="cb869-10"><a href="UsefulTricks.html#cb869-10" tabindex="-1"></a><span class="co">#&gt; 8  2 pips Tails</span></span>
<span id="cb869-11"><a href="UsefulTricks.html#cb869-11" tabindex="-1"></a><span class="co">#&gt; 9  3 pips Tails</span></span>
<span id="cb869-12"><a href="UsefulTricks.html#cb869-12" tabindex="-1"></a><span class="co">#&gt; 10 4 pips Tails</span></span>
<span id="cb869-13"><a href="UsefulTricks.html#cb869-13" tabindex="-1"></a><span class="co">#&gt; 11 5 pips Tails</span></span>
<span id="cb869-14"><a href="UsefulTricks.html#cb869-14" tabindex="-1"></a><span class="co">#&gt; 12 6 pips Tails</span></span></code></pre></div>
<p>Similarly, we could find all combinations of two dice. But we won’t print the output here because it’s 36 lines long:</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="UsefulTricks.html#cb870-1" tabindex="-1"></a><span class="fu">expand.grid</span>(faces, faces)</span></code></pre></div>
<p>The result of <code>expand.grid</code> is a data frame. R automatically provides the row names and
column names.</p>
<p>The Solution and the example show the Cartesian product of two vectors,
but <code>expand.grid</code> can handle three or more factors, too.</p>
</div>
<div id="see_also-id110" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id110" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you’re working with strings and want a bit more control over how you bring the combinations together, then you can also use Recipe <a href="StringsAndDates.html#recipe-id109">7.6</a>,
<a href="StringsAndDates.html#recipe-id109">“Generating All Pairwise Combinations of Strings”</a>, to generate combinations.</p>
</div>
</div>
<div id="recipe-id153" class="section level2 hasAnchor" number="12.10">
<h2><span class="header-section-number">12.10</span> Flattening a Data Frame<a href="UsefulTricks.html#recipe-id153" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id153" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id153" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a data frame of numeric values. You want to process all its
elements together, not as separate columns—for example, to find the mean
across all values.</p>
</div>
<div id="solution-id153" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id153" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Convert the data frame to a matrix and then process the matrix. This
example finds the mean of all elements in the data frame <code>dfrm</code>:</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="UsefulTricks.html#cb871-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.matrix</span>(dfrm))</span></code></pre></div>
<p>It is sometimes necessary then to convert the matrix to a vector. In
that case, use <code>as.vector(as.matrix(dfrm))</code>.</p>
</div>
<div id="discussion-id153" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id153" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have a data frame, such as the factory production data from Recipe <a href="UsefulTricks.html#recipe-id138">12.3</a>, <a href="UsefulTricks.html#recipe-id138">“Summing Rows and Columns”</a>:</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="UsefulTricks.html#cb872-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/daily.prod.rdata&#39;</span>)</span>
<span id="cb872-2"><a href="UsefulTricks.html#cb872-2" tabindex="-1"></a>daily.prod</span>
<span id="cb872-3"><a href="UsefulTricks.html#cb872-3" tabindex="-1"></a><span class="co">#&gt;     Widgets Gadgets Thingys</span></span>
<span id="cb872-4"><a href="UsefulTricks.html#cb872-4" tabindex="-1"></a><span class="co">#&gt; Mon     179     167     182</span></span>
<span id="cb872-5"><a href="UsefulTricks.html#cb872-5" tabindex="-1"></a><span class="co">#&gt; Tue     153     193     166</span></span>
<span id="cb872-6"><a href="UsefulTricks.html#cb872-6" tabindex="-1"></a><span class="co">#&gt; Wed     183     190     170</span></span>
<span id="cb872-7"><a href="UsefulTricks.html#cb872-7" tabindex="-1"></a><span class="co">#&gt; Thu     153     161     171</span></span>
<span id="cb872-8"><a href="UsefulTricks.html#cb872-8" tabindex="-1"></a><span class="co">#&gt; Fri     154     181     186</span></span></code></pre></div>
<p>Suppose also that we want the average daily production across all days
and products. This won’t work:</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="UsefulTricks.html#cb873-1" tabindex="-1"></a><span class="fu">mean</span>(daily.prod)</span>
<span id="cb873-2"><a href="UsefulTricks.html#cb873-2" tabindex="-1"></a><span class="co">#&gt; Warning in mean.default(daily.prod): argument is not numeric or logical:</span></span>
<span id="cb873-3"><a href="UsefulTricks.html#cb873-3" tabindex="-1"></a><span class="co">#&gt; returning NA</span></span>
<span id="cb873-4"><a href="UsefulTricks.html#cb873-4" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>The <code>mean</code> function doesn’t really know what to do with a data frame, so it just throws an error. But when you want the average across all
values, first collapse the data frame down to a matrix:</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="UsefulTricks.html#cb874-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.matrix</span>(daily.prod))</span>
<span id="cb874-2"><a href="UsefulTricks.html#cb874-2" tabindex="-1"></a><span class="co">#&gt; [1] 173</span></span></code></pre></div>
<p>This recipe works only on data frames with all-numeric data. Recall that
converting a data frame with mixed data (numeric columns mixed with
character columns or factors) into a matrix forces all columns to be
converted to characters.</p>
</div>
<div id="see_also-id153" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id153" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="DataStructures.html#recipe-id074">5.29</a>, <a href="DataStructures.html#recipe-id074">“Converting One Structured Data Type into Another”</a>, for more about converting between data types.</p>
</div>
</div>
<div id="recipe-id247" class="section level2 hasAnchor" number="12.11">
<h2><span class="header-section-number">12.11</span> Sorting a Data Frame<a href="UsefulTricks.html#recipe-id247" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id247" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id247" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a data frame. You want to sort the contents, using one column
as the sort key.</p>
</div>
<div id="solution-id247" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id247" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>arrange</code> function from the <code>dplyr</code> package:</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="UsefulTricks.html#cb875-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">arrange</span>(df, key)</span></code></pre></div>
<p>Here <code>df</code> is a data frame and <code>key</code> is the sort-key column.</p>
</div>
<div id="discussion-id247" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id247" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sort</code> function is great for vectors but is ineffective for data
frames. Suppose we have the following data frame and we want to sort by month:</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="UsefulTricks.html#cb876-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/outcome.rdata&#39;</span>)</span>
<span id="cb876-2"><a href="UsefulTricks.html#cb876-2" tabindex="-1"></a><span class="fu">print</span>(df)</span>
<span id="cb876-3"><a href="UsefulTricks.html#cb876-3" tabindex="-1"></a><span class="co">#&gt;   month day outcome</span></span>
<span id="cb876-4"><a href="UsefulTricks.html#cb876-4" tabindex="-1"></a><span class="co">#&gt; 1     7  11     Win</span></span>
<span id="cb876-5"><a href="UsefulTricks.html#cb876-5" tabindex="-1"></a><span class="co">#&gt; 2     8  10    Lose</span></span>
<span id="cb876-6"><a href="UsefulTricks.html#cb876-6" tabindex="-1"></a><span class="co">#&gt; 3     8  25     Tie</span></span>
<span id="cb876-7"><a href="UsefulTricks.html#cb876-7" tabindex="-1"></a><span class="co">#&gt; 4     6  27     Tie</span></span>
<span id="cb876-8"><a href="UsefulTricks.html#cb876-8" tabindex="-1"></a><span class="co">#&gt; 5     7  22     Win</span></span></code></pre></div>
<p>The <code>arrange</code> function rearranges the months into ascending
order and returns the entire data frame:</p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="UsefulTricks.html#cb877-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb877-2"><a href="UsefulTricks.html#cb877-2" tabindex="-1"></a><span class="fu">arrange</span>(df, month)</span>
<span id="cb877-3"><a href="UsefulTricks.html#cb877-3" tabindex="-1"></a><span class="co">#&gt;   month day outcome</span></span>
<span id="cb877-4"><a href="UsefulTricks.html#cb877-4" tabindex="-1"></a><span class="co">#&gt; 1     6  27     Tie</span></span>
<span id="cb877-5"><a href="UsefulTricks.html#cb877-5" tabindex="-1"></a><span class="co">#&gt; 2     7  11     Win</span></span>
<span id="cb877-6"><a href="UsefulTricks.html#cb877-6" tabindex="-1"></a><span class="co">#&gt; 3     7  22     Win</span></span>
<span id="cb877-7"><a href="UsefulTricks.html#cb877-7" tabindex="-1"></a><span class="co">#&gt; 4     8  10    Lose</span></span>
<span id="cb877-8"><a href="UsefulTricks.html#cb877-8" tabindex="-1"></a><span class="co">#&gt; 5     8  25     Tie</span></span></code></pre></div>
<p>After rearranging the data frame, the month column is in ascending
order—just as we wanted. If we want to sort the data in descending order, put a <code>-</code> in front of the column you want to sort by:</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="UsefulTricks.html#cb878-1" tabindex="-1"></a><span class="fu">arrange</span>(df,<span class="sc">-</span>month)</span>
<span id="cb878-2"><a href="UsefulTricks.html#cb878-2" tabindex="-1"></a><span class="co">#&gt;   month day outcome</span></span>
<span id="cb878-3"><a href="UsefulTricks.html#cb878-3" tabindex="-1"></a><span class="co">#&gt; 1     8  10    Lose</span></span>
<span id="cb878-4"><a href="UsefulTricks.html#cb878-4" tabindex="-1"></a><span class="co">#&gt; 2     8  25     Tie</span></span>
<span id="cb878-5"><a href="UsefulTricks.html#cb878-5" tabindex="-1"></a><span class="co">#&gt; 3     7  11     Win</span></span>
<span id="cb878-6"><a href="UsefulTricks.html#cb878-6" tabindex="-1"></a><span class="co">#&gt; 4     7  22     Win</span></span>
<span id="cb878-7"><a href="UsefulTricks.html#cb878-7" tabindex="-1"></a><span class="co">#&gt; 5     6  27     Tie</span></span></code></pre></div>
<p>If you want to sort by multiple columns, you can add them to the <code>arrange</code> function. The following example sorts by month first, then by day:</p>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="UsefulTricks.html#cb879-1" tabindex="-1"></a><span class="fu">arrange</span>(df, month, day)</span>
<span id="cb879-2"><a href="UsefulTricks.html#cb879-2" tabindex="-1"></a><span class="co">#&gt;   month day outcome</span></span>
<span id="cb879-3"><a href="UsefulTricks.html#cb879-3" tabindex="-1"></a><span class="co">#&gt; 1     6  27     Tie</span></span>
<span id="cb879-4"><a href="UsefulTricks.html#cb879-4" tabindex="-1"></a><span class="co">#&gt; 2     7  11     Win</span></span>
<span id="cb879-5"><a href="UsefulTricks.html#cb879-5" tabindex="-1"></a><span class="co">#&gt; 3     7  22     Win</span></span>
<span id="cb879-6"><a href="UsefulTricks.html#cb879-6" tabindex="-1"></a><span class="co">#&gt; 4     8  10    Lose</span></span>
<span id="cb879-7"><a href="UsefulTricks.html#cb879-7" tabindex="-1"></a><span class="co">#&gt; 5     8  25     Tie</span></span></code></pre></div>
<p>Within months 7 and 8, the days are now sorted into ascending order.</p>
</div>
</div>
<div id="recipe-id223" class="section level2 hasAnchor" number="12.12">
<h2><span class="header-section-number">12.12</span> Stripping Attributes from a Variable<a href="UsefulTricks.html#recipe-id223" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id223" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id223" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A variable is carrying around old attributes. You want to remove some or
all of them.</p>
</div>
<div id="solution-id223" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id223" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To remove all attributes, assign <code>NULL</code> to the variable’s <code>attributes</code>
property:</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="UsefulTricks.html#cb880-1" tabindex="-1"></a><span class="fu">attributes</span>(x) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>To remove a single attribute, select the attribute using the <code>attr</code>
function, and set it to <code>NULL</code>:</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="UsefulTricks.html#cb881-1" tabindex="-1"></a><span class="fu">attr</span>(x, <span class="st">&quot;attributeName&quot;</span>) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="discussion-id223" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id223" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Any variable in R can have attributes. An attribute is simply a
name/value pair, and the variable can have many of them. A common
example is the dimensions of a matrix variable, which are stored in an
attribute. The attribute name is <code>dim</code> and the attribute value is a
two-element vector giving the number of rows and columns.</p>
<p>You can view the attributes of <code>x</code> by printing <code>attributes(x)</code> or
<code>str(x)</code>.</p>
<p>Sometimes you want just a number and R insists on giving it attributes.
This can happen when you fit a simple linear model and extract the
slope, which is the second regression coefficient:</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="UsefulTricks.html#cb882-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/conf.rdata&#39;</span>)</span>
<span id="cb882-2"><a href="UsefulTricks.html#cb882-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1)</span>
<span id="cb882-3"><a href="UsefulTricks.html#cb882-3" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">coef</span>(m)[<span class="dv">2</span>]</span>
<span id="cb882-4"><a href="UsefulTricks.html#cb882-4" tabindex="-1"></a>slope</span>
<span id="cb882-5"><a href="UsefulTricks.html#cb882-5" tabindex="-1"></a><span class="co">#&gt;  x1 </span></span>
<span id="cb882-6"><a href="UsefulTricks.html#cb882-6" tabindex="-1"></a><span class="co">#&gt; -11</span></span></code></pre></div>
<p>When we print <code>slope</code>, R also prints <code>"x1"</code>. That is a name attribute
given by <code>lm</code> to the coefficient (because it’s the coefficient for the
<code>x1</code> variable). We can see that more clearly by printing the internals
of <code>slope</code>, which reveals a <code>"names"</code> attribute:</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="UsefulTricks.html#cb883-1" tabindex="-1"></a><span class="fu">str</span>(slope)</span>
<span id="cb883-2"><a href="UsefulTricks.html#cb883-2" tabindex="-1"></a><span class="co">#&gt;  Named num -11</span></span>
<span id="cb883-3"><a href="UsefulTricks.html#cb883-3" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;names&quot;)= chr &quot;x1&quot;</span></span></code></pre></div>
<p>It’s easy to strip out all the attributes, after which the slope value
becomes simply a number:</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="UsefulTricks.html#cb884-1" tabindex="-1"></a><span class="fu">attributes</span>(slope) <span class="ot">&lt;-</span> <span class="cn">NULL</span>    <span class="co"># Strip off all attributes</span></span>
<span id="cb884-2"><a href="UsefulTricks.html#cb884-2" tabindex="-1"></a><span class="fu">str</span>(slope)                   <span class="co"># Now the &quot;names&quot; attribute is gone</span></span>
<span id="cb884-3"><a href="UsefulTricks.html#cb884-3" tabindex="-1"></a><span class="co">#&gt;  num -11</span></span>
<span id="cb884-4"><a href="UsefulTricks.html#cb884-4" tabindex="-1"></a></span>
<span id="cb884-5"><a href="UsefulTricks.html#cb884-5" tabindex="-1"></a>slope                        <span class="co"># And the number prints cleanly without a label</span></span>
<span id="cb884-6"><a href="UsefulTricks.html#cb884-6" tabindex="-1"></a><span class="co">#&gt; [1] -11</span></span></code></pre></div>
<p>Alternatively, we could have stripped out the single offending attribute
this way:</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="UsefulTricks.html#cb885-1" tabindex="-1"></a><span class="fu">attr</span>(slope, <span class="st">&quot;names&quot;</span>) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<blockquote>
<p><strong>Warning</strong></p>
<p>Remember that a matrix is a vector (or list) with a <code>dim</code> attribute.
If you strip out all the attributes from a matrix, that will strip away
the dimensions and thereby turn it into a mere vector (or list).
Furthermore, stripping the attributes from an object (specifically, an
S3 object) can render it useless. So remove attributes with care.</p>
</blockquote>
</div>
<div id="see_also-id223" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id223" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="UsefulTricks.html#recipe-id202">12.13</a>, <a href="UsefulTricks.html#recipe-id202">“Revealing the Structure of an Object”</a>, for more about
seeing attributes.</p>
</div>
</div>
<div id="recipe-id202" class="section level2 hasAnchor" number="12.13">
<h2><span class="header-section-number">12.13</span> Revealing the Structure of an Object<a href="UsefulTricks.html#recipe-id202" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id202" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id202" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You called a function that returned something. Now you want to look
inside that something and learn more about it.</p>
</div>
<div id="solution-id202" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id202" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>class</code> to determine the thing’s object class:</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="UsefulTricks.html#cb886-1" tabindex="-1"></a><span class="fu">class</span>(x)</span></code></pre></div>
<p>Use <code>mode</code> to strip away the object-oriented features and reveal the
underlying structure:</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="UsefulTricks.html#cb887-1" tabindex="-1"></a><span class="fu">mode</span>(x)</span></code></pre></div>
<p>Use <code>str</code> to show the internal structure and contents:</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="UsefulTricks.html#cb888-1" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
</div>
<div id="discussion-id202" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id202" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are regularly amazed how often we call a function, get something back, and wonder:
“What the heck is this thing?” Theoretically, the function documentation
should explain the returned value, but somehow we feel better when we can
see its structure and contents ourselves. This is especially true for
objects with a nested structure: objects within objects.</p>
<p>Let’s dissect the value returned by <code>lm</code> (the linear modeling function)
in the simplest linear regression recipe, Recipe <a href="LinearRegressionAndANOVA.html#recipe-id203">11.1</a>, <a href="LinearRegressionAndANOVA.html#recipe-id203">“Performing Simple Linear Regression”</a>:</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="UsefulTricks.html#cb889-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/conf.rdata&#39;</span>)</span>
<span id="cb889-2"><a href="UsefulTricks.html#cb889-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1)</span>
<span id="cb889-3"><a href="UsefulTricks.html#cb889-3" tabindex="-1"></a><span class="fu">print</span>(m)</span>
<span id="cb889-4"><a href="UsefulTricks.html#cb889-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb889-5"><a href="UsefulTricks.html#cb889-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb889-6"><a href="UsefulTricks.html#cb889-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x1)</span></span>
<span id="cb889-7"><a href="UsefulTricks.html#cb889-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb889-8"><a href="UsefulTricks.html#cb889-8" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb889-9"><a href="UsefulTricks.html#cb889-9" tabindex="-1"></a><span class="co">#&gt; (Intercept)           x1  </span></span>
<span id="cb889-10"><a href="UsefulTricks.html#cb889-10" tabindex="-1"></a><span class="co">#&gt;        15.9        -11.0</span></span></code></pre></div>
<p>Always start by checking the thing’s class. The class indicates if it’s
a vector, matrix, list, data frame, or object:</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="UsefulTricks.html#cb890-1" tabindex="-1"></a><span class="fu">class</span>(m)</span>
<span id="cb890-2"><a href="UsefulTricks.html#cb890-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;lm&quot;</span></span></code></pre></div>
<p>Hmmm. It seems that <code>m</code> is an object of class <code>lm</code>. That may not mean
anything to you, however. But you know that all object classes are built upon
the native data structures (vector, matrix, list, or data frame), so we
use <code>mode</code> to strip away the object facade and reveal the underlying
structure:</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="UsefulTricks.html#cb891-1" tabindex="-1"></a><span class="fu">mode</span>(m)</span>
<span id="cb891-2"><a href="UsefulTricks.html#cb891-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;list&quot;</span></span></code></pre></div>
<p>Ah-ha! It seems that <code>m</code> is built on a list structure. Now we can use
list functions and operators to dig into its contents. First, we want to
know the names of its list elements:</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="UsefulTricks.html#cb892-1" tabindex="-1"></a><span class="fu">names</span>(m)</span>
<span id="cb892-2"><a href="UsefulTricks.html#cb892-2" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         </span></span>
<span id="cb892-3"><a href="UsefulTricks.html#cb892-3" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  </span></span>
<span id="cb892-4"><a href="UsefulTricks.html#cb892-4" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</span></span></code></pre></div>
<p>The first list element is called <code>*"coefficients"*</code>. We could guess those are
the regression coefficients. Let’s have a look:</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="UsefulTricks.html#cb893-1" tabindex="-1"></a>m<span class="sc">$</span>coefficients</span>
<span id="cb893-2"><a href="UsefulTricks.html#cb893-2" tabindex="-1"></a><span class="co">#&gt; (Intercept)          x1 </span></span>
<span id="cb893-3"><a href="UsefulTricks.html#cb893-3" tabindex="-1"></a><span class="co">#&gt;        15.9       -11.0</span></span></code></pre></div>
<p>Yes, that’s what they are. We recognize those values.</p>
<p>We could continue digging into the list structure of <code>m</code>, but that would
get tedious. The <code>str</code> function does a good job of revealing the
internal structure of any variable:</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="UsefulTricks.html#cb894-1" tabindex="-1"></a><span class="fu">str</span>(m)</span>
<span id="cb894-2"><a href="UsefulTricks.html#cb894-2" tabindex="-1"></a><span class="co">#&gt; List of 12</span></span>
<span id="cb894-3"><a href="UsefulTricks.html#cb894-3" tabindex="-1"></a><span class="co">#&gt;  $ coefficients : Named num [1:2] 15.9 -11</span></span>
<span id="cb894-4"><a href="UsefulTricks.html#cb894-4" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;(Intercept)&quot; &quot;x1&quot;</span></span>
<span id="cb894-5"><a href="UsefulTricks.html#cb894-5" tabindex="-1"></a><span class="co">#&gt;  $ residuals    : Named num [1:30] 36.6 58.6 112.1 -35.2 -61.7 ...</span></span>
<span id="cb894-6"><a href="UsefulTricks.html#cb894-6" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:30] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span></span>
<span id="cb894-7"><a href="UsefulTricks.html#cb894-7" tabindex="-1"></a><span class="co">#&gt;  $ effects      : Named num [1:30] -73.1 69.3 93.9 -31.1 -66.3 ...</span></span>
<span id="cb894-8"><a href="UsefulTricks.html#cb894-8" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:30] &quot;(Intercept)&quot; &quot;x1&quot; &quot;&quot; &quot;&quot; ...</span></span>
<span id="cb894-9"><a href="UsefulTricks.html#cb894-9" tabindex="-1"></a><span class="co">#&gt;  $ rank         : int 2</span></span>
<span id="cb894-10"><a href="UsefulTricks.html#cb894-10" tabindex="-1"></a><span class="co">#&gt;  $ fitted.values: Named num [1:30] 25.69 13.83 -1.55 28.25 16.74 ...</span></span>
<span id="cb894-11"><a href="UsefulTricks.html#cb894-11" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:30] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span></span>
<span id="cb894-12"><a href="UsefulTricks.html#cb894-12" tabindex="-1"></a><span class="co">#&gt;  $ assign       : int [1:2] 0 1</span></span>
<span id="cb894-13"><a href="UsefulTricks.html#cb894-13" tabindex="-1"></a><span class="co">#&gt;  $ qr           :List of 5</span></span>
<span id="cb894-14"><a href="UsefulTricks.html#cb894-14" tabindex="-1"></a><span class="co">#&gt;   ..$ qr   : num [1:30, 1:2] -5.477 0.183 0.183 0.183 0.183 ...</span></span>
<span id="cb894-15"><a href="UsefulTricks.html#cb894-15" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb894-16"><a href="UsefulTricks.html#cb894-16" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:30] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span></span>
<span id="cb894-17"><a href="UsefulTricks.html#cb894-17" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:2] &quot;(Intercept)&quot; &quot;x1&quot;</span></span>
<span id="cb894-18"><a href="UsefulTricks.html#cb894-18" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;assign&quot;)= int [1:2] 0 1</span></span>
<span id="cb894-19"><a href="UsefulTricks.html#cb894-19" tabindex="-1"></a><span class="co">#&gt;   ..$ qraux: num [1:2] 1.18 1.02</span></span>
<span id="cb894-20"><a href="UsefulTricks.html#cb894-20" tabindex="-1"></a><span class="co">#&gt;   ..$ pivot: int [1:2] 1 2</span></span>
<span id="cb894-21"><a href="UsefulTricks.html#cb894-21" tabindex="-1"></a><span class="co">#&gt;   ..$ tol  : num 1e-07</span></span>
<span id="cb894-22"><a href="UsefulTricks.html#cb894-22" tabindex="-1"></a><span class="co">#&gt;   ..$ rank : int 2</span></span>
<span id="cb894-23"><a href="UsefulTricks.html#cb894-23" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;</span></span>
<span id="cb894-24"><a href="UsefulTricks.html#cb894-24" tabindex="-1"></a><span class="co">#&gt;  $ df.residual  : int 28</span></span>
<span id="cb894-25"><a href="UsefulTricks.html#cb894-25" tabindex="-1"></a><span class="co">#&gt;  $ xlevels      : Named list()</span></span>
<span id="cb894-26"><a href="UsefulTricks.html#cb894-26" tabindex="-1"></a><span class="co">#&gt;  $ call         : language lm(formula = y ~ x1)</span></span>
<span id="cb894-27"><a href="UsefulTricks.html#cb894-27" tabindex="-1"></a><span class="co">#&gt;  $ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language y ~ x1</span></span>
<span id="cb894-28"><a href="UsefulTricks.html#cb894-28" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;variables&quot;)= language list(y, x1)</span></span>
<span id="cb894-29"><a href="UsefulTricks.html#cb894-29" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1</span></span>
<span id="cb894-30"><a href="UsefulTricks.html#cb894-30" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb894-31"><a href="UsefulTricks.html#cb894-31" tabindex="-1"></a><span class="co">#&gt;   .. .. .. ..$ : chr [1:2] &quot;y&quot; &quot;x1&quot;</span></span>
<span id="cb894-32"><a href="UsefulTricks.html#cb894-32" tabindex="-1"></a><span class="co">#&gt;   .. .. .. ..$ : chr &quot;x1&quot;</span></span>
<span id="cb894-33"><a href="UsefulTricks.html#cb894-33" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;x1&quot;</span></span>
<span id="cb894-34"><a href="UsefulTricks.html#cb894-34" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;order&quot;)= int 1</span></span>
<span id="cb894-35"><a href="UsefulTricks.html#cb894-35" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;intercept&quot;)= int 1</span></span>
<span id="cb894-36"><a href="UsefulTricks.html#cb894-36" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;response&quot;)= int 1</span></span>
<span id="cb894-37"><a href="UsefulTricks.html#cb894-37" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; </span></span>
<span id="cb894-38"><a href="UsefulTricks.html#cb894-38" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;predvars&quot;)= language list(y, x1)</span></span>
<span id="cb894-39"><a href="UsefulTricks.html#cb894-39" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;</span></span>
<span id="cb894-40"><a href="UsefulTricks.html#cb894-40" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;y&quot; &quot;x1&quot;</span></span>
<span id="cb894-41"><a href="UsefulTricks.html#cb894-41" tabindex="-1"></a><span class="co">#&gt;  $ model        :&#39;data.frame&#39;:   30 obs. of  2 variables:</span></span>
<span id="cb894-42"><a href="UsefulTricks.html#cb894-42" tabindex="-1"></a><span class="co">#&gt;   ..$ y : num [1:30] 62.25 72.45 110.59 -6.94 -44.99 ...</span></span>
<span id="cb894-43"><a href="UsefulTricks.html#cb894-43" tabindex="-1"></a><span class="co">#&gt;   ..$ x1: num [1:30] -0.8969 0.1848 1.5878 -1.1304 -0.0803 ...</span></span>
<span id="cb894-44"><a href="UsefulTricks.html#cb894-44" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language y ~ x1</span></span>
<span id="cb894-45"><a href="UsefulTricks.html#cb894-45" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;variables&quot;)= language list(y, x1)</span></span>
<span id="cb894-46"><a href="UsefulTricks.html#cb894-46" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1</span></span>
<span id="cb894-47"><a href="UsefulTricks.html#cb894-47" tabindex="-1"></a><span class="co">#&gt;   .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb894-48"><a href="UsefulTricks.html#cb894-48" tabindex="-1"></a><span class="co">#&gt;   .. .. .. .. ..$ : chr [1:2] &quot;y&quot; &quot;x1&quot;</span></span>
<span id="cb894-49"><a href="UsefulTricks.html#cb894-49" tabindex="-1"></a><span class="co">#&gt;   .. .. .. .. ..$ : chr &quot;x1&quot;</span></span>
<span id="cb894-50"><a href="UsefulTricks.html#cb894-50" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;x1&quot;</span></span>
<span id="cb894-51"><a href="UsefulTricks.html#cb894-51" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;order&quot;)= int 1</span></span>
<span id="cb894-52"><a href="UsefulTricks.html#cb894-52" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;intercept&quot;)= int 1</span></span>
<span id="cb894-53"><a href="UsefulTricks.html#cb894-53" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;response&quot;)= int 1</span></span>
<span id="cb894-54"><a href="UsefulTricks.html#cb894-54" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; </span></span>
<span id="cb894-55"><a href="UsefulTricks.html#cb894-55" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;predvars&quot;)= language list(y, x1)</span></span>
<span id="cb894-56"><a href="UsefulTricks.html#cb894-56" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;</span></span>
<span id="cb894-57"><a href="UsefulTricks.html#cb894-57" tabindex="-1"></a><span class="co">#&gt;   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;y&quot; &quot;x1&quot;</span></span>
<span id="cb894-58"><a href="UsefulTricks.html#cb894-58" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;lm&quot;</span></span></code></pre></div>
<p>Notice that <code>str</code> shows all the elements of <code>m</code> and then recursively
dumps each element’s contents and attributes. Long vectors and lists are
truncated to keep the output manageable.</p>
<p>There is an art to exploring an R object. Use <code>class</code>, <code>mode</code>, and <code>str</code>
to dig through the layers. We have found that often <code>str</code> tells you everything you want to know…and sometimes a lot more.</p>
</div>
</div>
<div id="recipe-id224" class="section level2 hasAnchor" number="12.14">
<h2><span class="header-section-number">12.14</span> Timing Your Code<a href="UsefulTricks.html#recipe-id224" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id224" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id224" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to know how much time is required to run your code. This is
useful, for example, when you are optimizing your code and need “before”
and “after” numbers to measure the improvement.</p>
</div>
<div id="solution-id224" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id224" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>tictoc</code> package contains a very easy way to time and label chunks of code. The <code>tic</code> function starts a timer and the <code>toc</code> function stops the timer and reports the
execution time:</p>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="UsefulTricks.html#cb895-1" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb895-2"><a href="UsefulTricks.html#cb895-2" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&#39;Optional helpful name here&#39;</span>)</span>
<span id="cb895-3"><a href="UsefulTricks.html#cb895-3" tabindex="-1"></a><span class="fu">aLongRunningExpression</span>()</span>
<span id="cb895-4"><a href="UsefulTricks.html#cb895-4" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<p>The output is the execution time in seconds.</p>
</div>
<div id="discussion-id224" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id224" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we want to know the time required to generate 10,000,000 random
normal numbers and sum them together:</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="UsefulTricks.html#cb896-1" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb896-2"><a href="UsefulTricks.html#cb896-2" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&#39;making big numbers&#39;</span>)</span>
<span id="cb896-3"><a href="UsefulTricks.html#cb896-3" tabindex="-1"></a>total_val <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rnorm</span>(<span class="fl">1e7</span>))</span>
<span id="cb896-4"><a href="UsefulTricks.html#cb896-4" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb896-5"><a href="UsefulTricks.html#cb896-5" tabindex="-1"></a><span class="co">#&gt; making big numbers: 0.345 sec elapsed</span></span></code></pre></div>
<p>The <code>toc</code> function returns the message set in <code>tic</code> along with the runtime in seconds.</p>
<p>If you assign the result of <code>toc</code> to an object, you can have access to the underlying start time, finish time, and message:</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="UsefulTricks.html#cb897-1" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&#39;two sums&#39;</span>)</span>
<span id="cb897-2"><a href="UsefulTricks.html#cb897-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">rnorm</span>(<span class="dv">10000000</span>))</span>
<span id="cb897-3"><a href="UsefulTricks.html#cb897-3" tabindex="-1"></a><span class="co">#&gt; [1] -84.1</span></span>
<span id="cb897-4"><a href="UsefulTricks.html#cb897-4" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">rnorm</span>(<span class="dv">10000000</span>))</span>
<span id="cb897-5"><a href="UsefulTricks.html#cb897-5" tabindex="-1"></a><span class="co">#&gt; [1] -3899</span></span>
<span id="cb897-6"><a href="UsefulTricks.html#cb897-6" tabindex="-1"></a>toc_result <span class="ot">&lt;-</span> <span class="fu">toc</span>()</span>
<span id="cb897-7"><a href="UsefulTricks.html#cb897-7" tabindex="-1"></a><span class="co">#&gt; two sums: 0.584 sec elapsed</span></span>
<span id="cb897-8"><a href="UsefulTricks.html#cb897-8" tabindex="-1"></a></span>
<span id="cb897-9"><a href="UsefulTricks.html#cb897-9" tabindex="-1"></a><span class="fu">print</span>(toc_result)</span>
<span id="cb897-10"><a href="UsefulTricks.html#cb897-10" tabindex="-1"></a><span class="co">#&gt; $tic</span></span>
<span id="cb897-11"><a href="UsefulTricks.html#cb897-11" tabindex="-1"></a><span class="co">#&gt; elapsed </span></span>
<span id="cb897-12"><a href="UsefulTricks.html#cb897-12" tabindex="-1"></a><span class="co">#&gt;    1.21 </span></span>
<span id="cb897-13"><a href="UsefulTricks.html#cb897-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb897-14"><a href="UsefulTricks.html#cb897-14" tabindex="-1"></a><span class="co">#&gt; $toc</span></span>
<span id="cb897-15"><a href="UsefulTricks.html#cb897-15" tabindex="-1"></a><span class="co">#&gt; elapsed </span></span>
<span id="cb897-16"><a href="UsefulTricks.html#cb897-16" tabindex="-1"></a><span class="co">#&gt;     1.8 </span></span>
<span id="cb897-17"><a href="UsefulTricks.html#cb897-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb897-18"><a href="UsefulTricks.html#cb897-18" tabindex="-1"></a><span class="co">#&gt; $msg</span></span>
<span id="cb897-19"><a href="UsefulTricks.html#cb897-19" tabindex="-1"></a><span class="co">#&gt; [1] &quot;two sums&quot;</span></span>
<span id="cb897-20"><a href="UsefulTricks.html#cb897-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb897-21"><a href="UsefulTricks.html#cb897-21" tabindex="-1"></a><span class="co">#&gt; $callback_msg</span></span>
<span id="cb897-22"><a href="UsefulTricks.html#cb897-22" tabindex="-1"></a><span class="co">#&gt; [1] &quot;two sums: 0.584 sec elapsed&quot;</span></span></code></pre></div>
<p>If you want to report the results in minutes (or hours!), you can use the elements of the output to get at the underlying start and finish times:</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="UsefulTricks.html#cb898-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;the code ran in&#39;</span>,</span>
<span id="cb898-2"><a href="UsefulTricks.html#cb898-2" tabindex="-1"></a>            <span class="fu">round</span>((toc_result<span class="sc">$</span>toc <span class="sc">-</span>  toc_result<span class="sc">$</span>tic) <span class="sc">/</span> <span class="dv">60</span>, <span class="dv">4</span>),</span>
<span id="cb898-3"><a href="UsefulTricks.html#cb898-3" tabindex="-1"></a>            <span class="st">&#39;minutes&#39;</span>))</span>
<span id="cb898-4"><a href="UsefulTricks.html#cb898-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;the code ran in 0.0097 minutes&quot;</span></span></code></pre></div>
<p>You can accomplish the same thing using just <code>Sys.time</code> calls but without the convenience of labeling and clarity of syntax provided by <code>toctoc</code>:</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="UsefulTricks.html#cb899-1" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb899-2"><a href="UsefulTricks.html#cb899-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">rnorm</span>(<span class="dv">10000000</span>))</span>
<span id="cb899-3"><a href="UsefulTricks.html#cb899-3" tabindex="-1"></a><span class="co">#&gt; [1] 3607</span></span>
<span id="cb899-4"><a href="UsefulTricks.html#cb899-4" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">rnorm</span>(<span class="dv">10000000</span>))</span>
<span id="cb899-5"><a href="UsefulTricks.html#cb899-5" tabindex="-1"></a><span class="co">#&gt; [1] 1893</span></span>
<span id="cb899-6"><a href="UsefulTricks.html#cb899-6" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start</span>
<span id="cb899-7"><a href="UsefulTricks.html#cb899-7" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.588 secs</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id113" class="section level2 hasAnchor" number="12.15">
<h2><span class="header-section-number">12.15</span> Suppressing Warnings and Error Messages<a href="UsefulTricks.html#recipe-id113" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id113" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id113" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A function is producing annoying error messages or warning messages. You
don’t want to see them.</p>
</div>
<div id="solution-id113" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id113" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Surround the function call with <code>suppressMessage(</code>…<code>)</code> or
<code>suppressWarnings(</code>…<code>)</code>:</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="UsefulTricks.html#cb900-1" tabindex="-1"></a><span class="fu">suppressMessage</span>(<span class="fu">annoyingFunction</span>())</span>
<span id="cb900-2"><a href="UsefulTricks.html#cb900-2" tabindex="-1"></a><span class="fu">suppressuWarnings</span>(<span class="fu">annoyingFunction</span>())</span></code></pre></div>
</div>
<div id="discussion-id113" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id113" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Augmented Dickey–Fuller Test, <code>adf.test</code>, is a popular time series function. However, it produces an
annoying warning message, shown here at the bottom of the output, when
the <em>p</em>-value is below 0.01:</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="UsefulTricks.html#cb901-1" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb901-2"><a href="UsefulTricks.html#cb901-2" tabindex="-1"></a><span class="co">#&gt; Registered S3 method overwritten by &#39;quantmod&#39;:</span></span>
<span id="cb901-3"><a href="UsefulTricks.html#cb901-3" tabindex="-1"></a><span class="co">#&gt;   method            from</span></span>
<span id="cb901-4"><a href="UsefulTricks.html#cb901-4" tabindex="-1"></a><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span id="cb901-5"><a href="UsefulTricks.html#cb901-5" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&#39;./data/adf.rdata&#39;</span>)</span>
<span id="cb901-6"><a href="UsefulTricks.html#cb901-6" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">adf.test</span>(x)</span>
<span id="cb901-7"><a href="UsefulTricks.html#cb901-7" tabindex="-1"></a><span class="co">#&gt; Warning in adf.test(x): p-value smaller than printed p-value</span></span></code></pre></div>
<p>Fortunately, we can muzzle the function by calling it inside
<code>suppressWarnings(</code>…<code>)</code>:</p>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="UsefulTricks.html#cb902-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">adf.test</span>(x))</span></code></pre></div>
<p>Notice that the warning message disappeared. The message is not entirely
lost because R retains it internally. We can retrieve the message at our
leisure by using the <code>warnings</code> function:</p>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="UsefulTricks.html#cb903-1" tabindex="-1"></a><span class="fu">warnings</span>()</span></code></pre></div>
<p>Some functions also produce “messages” (in R terminology), which are
even more benign than warnings. Typically, they are merely informative
and not signals of problems. If such a message is annoying you, call the
function inside <code>suppressMessages(...)</code>, and the message will
disappear.</p>
</div>
<div id="see_also-id113" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id113" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See the <code>options</code> function for other ways to control the reporting of
errors and warnings.</p>
</div>
</div>
<div id="recipe-id118" class="section level2 hasAnchor" number="12.16">
<h2><span class="header-section-number">12.16</span> Taking Function Arguments from a List<a href="UsefulTricks.html#recipe-id118" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id118" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id118" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your data is captured in a list structure. You want to pass the data to
a function, but the function does not accept a list.</p>
</div>
<div id="solution-id118" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id118" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In simple cases, convert the list to a vector. For more complex cases,
the <code>do.call</code> function can break the list into individual arguments and
call your function:</p>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="UsefulTricks.html#cb904-1" tabindex="-1"></a><span class="fu">do.call</span>(<span class="cf">function</span>, list)</span></code></pre></div>
</div>
<div id="discussion-id118" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id118" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If your data is in a vector, life is simple and most R
functions work as expected:</p>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="UsefulTricks.html#cb905-1" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb905-2"><a href="UsefulTricks.html#cb905-2" tabindex="-1"></a><span class="fu">mean</span>(vec)</span>
<span id="cb905-3"><a href="UsefulTricks.html#cb905-3" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<p>If your data is captured in a list, some functions complain and
return a useless result, like this:</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="UsefulTricks.html#cb906-1" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb906-2"><a href="UsefulTricks.html#cb906-2" tabindex="-1"></a><span class="fu">mean</span>(numbers)</span>
<span id="cb906-3"><a href="UsefulTricks.html#cb906-3" tabindex="-1"></a><span class="co">#&gt; Warning in mean.default(numbers): argument is not numeric or logical: returning</span></span>
<span id="cb906-4"><a href="UsefulTricks.html#cb906-4" tabindex="-1"></a><span class="co">#&gt; NA</span></span>
<span id="cb906-5"><a href="UsefulTricks.html#cb906-5" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>The <code>numbers</code> list is a simple, one-level list, so we can just convert
it to a vector and call the function:</p>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="UsefulTricks.html#cb907-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">unlist</span>(numbers))</span>
<span id="cb907-2"><a href="UsefulTricks.html#cb907-2" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<p>The big headaches come when you have multilevel list structures: lists
within lists. These can occur within complex data structures. Here is a
list of lists in which each sublist is a column of data:</p>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="UsefulTricks.html#cb908-1" tabindex="-1"></a>my_lists <span class="ot">&lt;-</span></span>
<span id="cb908-2"><a href="UsefulTricks.html#cb908-2" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">col1 =</span> <span class="fu">list</span>(<span class="dv">7</span>, <span class="dv">8</span>),</span>
<span id="cb908-3"><a href="UsefulTricks.html#cb908-3" tabindex="-1"></a>       <span class="at">col2 =</span> <span class="fu">list</span>(<span class="dv">70</span>, <span class="dv">80</span>),</span>
<span id="cb908-4"><a href="UsefulTricks.html#cb908-4" tabindex="-1"></a>       <span class="at">col3 =</span> <span class="fu">list</span>(<span class="dv">700</span>, <span class="dv">800</span>))</span>
<span id="cb908-5"><a href="UsefulTricks.html#cb908-5" tabindex="-1"></a>my_lists</span>
<span id="cb908-6"><a href="UsefulTricks.html#cb908-6" tabindex="-1"></a><span class="co">#&gt; $col1</span></span>
<span id="cb908-7"><a href="UsefulTricks.html#cb908-7" tabindex="-1"></a><span class="co">#&gt; $col1[[1]]</span></span>
<span id="cb908-8"><a href="UsefulTricks.html#cb908-8" tabindex="-1"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb908-9"><a href="UsefulTricks.html#cb908-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb908-10"><a href="UsefulTricks.html#cb908-10" tabindex="-1"></a><span class="co">#&gt; $col1[[2]]</span></span>
<span id="cb908-11"><a href="UsefulTricks.html#cb908-11" tabindex="-1"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb908-12"><a href="UsefulTricks.html#cb908-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb908-13"><a href="UsefulTricks.html#cb908-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb908-14"><a href="UsefulTricks.html#cb908-14" tabindex="-1"></a><span class="co">#&gt; $col2</span></span>
<span id="cb908-15"><a href="UsefulTricks.html#cb908-15" tabindex="-1"></a><span class="co">#&gt; $col2[[1]]</span></span>
<span id="cb908-16"><a href="UsefulTricks.html#cb908-16" tabindex="-1"></a><span class="co">#&gt; [1] 70</span></span>
<span id="cb908-17"><a href="UsefulTricks.html#cb908-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb908-18"><a href="UsefulTricks.html#cb908-18" tabindex="-1"></a><span class="co">#&gt; $col2[[2]]</span></span>
<span id="cb908-19"><a href="UsefulTricks.html#cb908-19" tabindex="-1"></a><span class="co">#&gt; [1] 80</span></span>
<span id="cb908-20"><a href="UsefulTricks.html#cb908-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb908-21"><a href="UsefulTricks.html#cb908-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb908-22"><a href="UsefulTricks.html#cb908-22" tabindex="-1"></a><span class="co">#&gt; $col3</span></span>
<span id="cb908-23"><a href="UsefulTricks.html#cb908-23" tabindex="-1"></a><span class="co">#&gt; $col3[[1]]</span></span>
<span id="cb908-24"><a href="UsefulTricks.html#cb908-24" tabindex="-1"></a><span class="co">#&gt; [1] 700</span></span>
<span id="cb908-25"><a href="UsefulTricks.html#cb908-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb908-26"><a href="UsefulTricks.html#cb908-26" tabindex="-1"></a><span class="co">#&gt; $col3[[2]]</span></span>
<span id="cb908-27"><a href="UsefulTricks.html#cb908-27" tabindex="-1"></a><span class="co">#&gt; [1] 800</span></span></code></pre></div>
<p>Suppose we want to form this data into a matrix. The <code>cbind</code> function is
supposed to create data columns, but it gets confused by the list
structure and returns something useless:</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="UsefulTricks.html#cb909-1" tabindex="-1"></a><span class="fu">cbind</span>(my_lists)</span>
<span id="cb909-2"><a href="UsefulTricks.html#cb909-2" tabindex="-1"></a><span class="co">#&gt;      my_lists</span></span>
<span id="cb909-3"><a href="UsefulTricks.html#cb909-3" tabindex="-1"></a><span class="co">#&gt; col1 list,2  </span></span>
<span id="cb909-4"><a href="UsefulTricks.html#cb909-4" tabindex="-1"></a><span class="co">#&gt; col2 list,2  </span></span>
<span id="cb909-5"><a href="UsefulTricks.html#cb909-5" tabindex="-1"></a><span class="co">#&gt; col3 list,2</span></span></code></pre></div>
<p>If we <code>unlist</code> the data then we just get one big, long column, which is not what we are after either:</p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="UsefulTricks.html#cb910-1" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">unlist</span>(my_lists))</span>
<span id="cb910-2"><a href="UsefulTricks.html#cb910-2" tabindex="-1"></a><span class="co">#&gt;       [,1]</span></span>
<span id="cb910-3"><a href="UsefulTricks.html#cb910-3" tabindex="-1"></a><span class="co">#&gt; col11    7</span></span>
<span id="cb910-4"><a href="UsefulTricks.html#cb910-4" tabindex="-1"></a><span class="co">#&gt; col12    8</span></span>
<span id="cb910-5"><a href="UsefulTricks.html#cb910-5" tabindex="-1"></a><span class="co">#&gt; col21   70</span></span>
<span id="cb910-6"><a href="UsefulTricks.html#cb910-6" tabindex="-1"></a><span class="co">#&gt; col22   80</span></span>
<span id="cb910-7"><a href="UsefulTricks.html#cb910-7" tabindex="-1"></a><span class="co">#&gt; col31  700</span></span>
<span id="cb910-8"><a href="UsefulTricks.html#cb910-8" tabindex="-1"></a><span class="co">#&gt; col32  800</span></span></code></pre></div>
<p>The solution is to use <code>do.call</code>, which splits the list into individual
items and then calls <code>cbind</code> on those items:</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="UsefulTricks.html#cb911-1" tabindex="-1"></a><span class="fu">do.call</span>(cbind, my_lists)</span>
<span id="cb911-2"><a href="UsefulTricks.html#cb911-2" tabindex="-1"></a><span class="co">#&gt;      col1 col2 col3</span></span>
<span id="cb911-3"><a href="UsefulTricks.html#cb911-3" tabindex="-1"></a><span class="co">#&gt; [1,] 7    70   700 </span></span>
<span id="cb911-4"><a href="UsefulTricks.html#cb911-4" tabindex="-1"></a><span class="co">#&gt; [2,] 8    80   800</span></span></code></pre></div>
<p>Using <code>do.call</code> in that way is functionally identical to calling <code>cbind</code>
like this:</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="UsefulTricks.html#cb912-1" tabindex="-1"></a><span class="fu">cbind</span>(my_lists[[<span class="dv">1</span>]], my_lists[[<span class="dv">2</span>]], my_lists[[<span class="dv">3</span>]])</span>
<span id="cb912-2"><a href="UsefulTricks.html#cb912-2" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb912-3"><a href="UsefulTricks.html#cb912-3" tabindex="-1"></a><span class="co">#&gt; [1,] 7    70   700 </span></span>
<span id="cb912-4"><a href="UsefulTricks.html#cb912-4" tabindex="-1"></a><span class="co">#&gt; [2,] 8    80   800</span></span></code></pre></div>
<p>Be careful if the list elements have names. In that case, <code>do.call</code>
interprets the element names as names of parameters to the function,
which might cause trouble.</p>
<p>This recipe presents the most basic use of <code>do.call</code>. The function is
quite powerful and has many other uses. See the help page for more
details.</p>
</div>
<div id="see_also-id118" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id118" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="DataStructures.html#recipe-id074">5.29</a>, <a href="DataStructures.html#recipe-id074">“Converting One Structured Data Type into Another”</a>, for converting between data types.</p>
</div>
</div>
<div id="recipe-id114" class="section level2 hasAnchor" number="12.17">
<h2><span class="header-section-number">12.17</span> Defining Your Own Binary Operators<a href="UsefulTricks.html#recipe-id114" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id114" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id114" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to define your own binary operators, making your R code more
streamlined and readable.</p>
</div>
<div id="solution-id114" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id114" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R recognizes any text between percent signs (<code>%</code>…<code>%</code>) as a binary
operator. Create and define a new binary operator by assigning a
two-argument function to it.</p>
</div>
<div id="discussion-id114" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id114" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R contains an interesting feature that lets you define your own binary
operators. Any text between two percent signs (<code>%</code>…<code>%</code>) is
automatically interpreted by R as a binary operator. R predefines
several such operators, such as <code>%/%</code> for integer division, <code>%*%</code> for
matrix multiplication, and the pipe <code>%&gt;%</code> in the <code>magrittr</code> package.</p>
<p>You can create a new binary operator by assigning a function to it. This
example creates an operator, <code>%+-%</code>:</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="UsefulTricks.html#cb913-1" tabindex="-1"></a><span class="st">&#39;%+-%&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, margin)</span>
<span id="cb913-2"><a href="UsefulTricks.html#cb913-2" tabindex="-1"></a>  x <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> margin</span></code></pre></div>
<p>The expression <code>x %+-% m</code> calculates <code>x</code> ± <code>m</code>. Here it calculates 100 ±
(1.96 × 15), the two-standard-deviation range of a standard IQ test:</p>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="UsefulTricks.html#cb914-1" tabindex="-1"></a><span class="dv">100</span> <span class="sc">%+-%</span> (<span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">15</span>)</span>
<span id="cb914-2"><a href="UsefulTricks.html#cb914-2" tabindex="-1"></a><span class="co">#&gt; [1]  70.6 129.4</span></span></code></pre></div>
<p>Notice that we quote the binary operator when defining it but not when
using it.</p>
<p>The pleasure of defining your own operators is that you can wrap
commonly used operations inside a succinct syntax. If your application
frequently concatenates two strings without an intervening blank, then you
might define a binary concatenation operator for that purpose:</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="UsefulTricks.html#cb915-1" tabindex="-1"></a><span class="st">&#39;%+%&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(s1, s2)</span>
<span id="cb915-2"><a href="UsefulTricks.html#cb915-2" tabindex="-1"></a>  <span class="fu">paste</span>(s1, s2, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb915-3"><a href="UsefulTricks.html#cb915-3" tabindex="-1"></a><span class="st">&quot;Hello&quot;</span> <span class="sc">%+%</span> <span class="st">&quot;World&quot;</span></span>
<span id="cb915-4"><a href="UsefulTricks.html#cb915-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;HelloWorld&quot;</span></span>
<span id="cb915-5"><a href="UsefulTricks.html#cb915-5" tabindex="-1"></a><span class="st">&quot;limit=&quot;</span> <span class="sc">%+%</span> <span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">2</span>)</span>
<span id="cb915-6"><a href="UsefulTricks.html#cb915-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;limit=1.96&quot;</span></span></code></pre></div>
<p>A danger of defining your own operators, however, is that the code becomes less
portable to other environments. Bring the definitions along with the
code in which they are used; otherwise, R will complain about undefined
operators.</p>
<p>All user-defined operators have the same precedence and are listed
collectively in Table <a href="SomeBasics.html#tab:precedence">2.1</a> as <code>%</code><em>any</em><code>%</code>. Their
precedence is fairly high: higher than multiplication and division but
lower than exponentiation and sequence creation. As a result, it’s easy
to misexpress yourself. If we omit parentheses from the <code>%+-%</code>
example, we get an unexpected result:</p>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="UsefulTricks.html#cb916-1" tabindex="-1"></a><span class="dv">100</span> <span class="sc">%+-%</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">15</span> </span>
<span id="cb916-2"><a href="UsefulTricks.html#cb916-2" tabindex="-1"></a><span class="co">#&gt; [1] 1471 1529</span></span></code></pre></div>
<p>R interpreted the expression as <code>(100 %+-% 1.96) * 15</code>.</p>
</div>
<div id="see_also-id114" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-id114" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="SomeBasics.html#recipe-id018">2.11</a>, <a href="SomeBasics.html#recipe-id018">“Getting Operator Precedence Right”</a>, for more about operator precedence and Recipe <a href="SimpleProgramming.html#recipe-id117">15.3</a>,
<a href="SimpleProgramming.html#recipe-id117">“Defining a Function”</a>, for how to define a function.</p>
</div>
</div>
<div id="recipe-id111" class="section level2 hasAnchor" number="12.18">
<h2><span class="header-section-number">12.18</span> Suppressing the Startup Message<a href="UsefulTricks.html#recipe-id111" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id111" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id111" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you run R from a command prompt or shell script, you are tired of seeing R’s verbose startup message.</p>
</div>
<div id="solution-id111" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id111" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>--quiet</code> command-line option when you start R from the command line or shell script.</p>
</div>
<div id="discussion-id111" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id111" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The startup message from R is handy for beginners because it contains
useful information about the R project and getting help. But the novelty
wears off pretty quickly—especially if you start R from a shell prompt to use it as a calculator throughout the day. This is not particularly helpful if you’re using R only from RStudio.</p>
<p>If you start R from the shell prompt, use the <code>--quiet</code> option to hide
the startup message:</p>
<div class="sourceCode" id="cb917"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb917-1"><a href="UsefulTricks.html#cb917-1" tabindex="-1"></a><span class="ex">R</span> <span class="at">--quiet</span></span></code></pre></div>
<p>On a Linux or Mac box, you could alias R like this from the shell so you never see the startup message:</p>
<div class="sourceCode" id="cb918"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb918-1"><a href="UsefulTricks.html#cb918-1" tabindex="-1"></a><span class="bu">alias</span> R=<span class="st">&quot;/usr/bin/R --quiet&quot;</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id106" class="section level2 hasAnchor" number="12.19">
<h2><span class="header-section-number">12.19</span> Getting and Setting Environment Variables<a href="UsefulTricks.html#recipe-id106" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id106" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-id106" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to see the value of an environment variable, or you want to
change its value.</p>
</div>
<div id="solution-id106" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-id106" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>Sys.getenv</code> function to see values. Use <code>Sys.putenv</code> to change
them:</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="UsefulTricks.html#cb919-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">DB_PASSWORD =</span> <span class="st">&quot;My_Password!&quot;</span>)</span>
<span id="cb919-2"><a href="UsefulTricks.html#cb919-2" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;DB_PASSWORD&quot;</span>)</span>
<span id="cb919-3"><a href="UsefulTricks.html#cb919-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;My_Password!&quot;</span></span></code></pre></div>
</div>
<div id="discussion-id106" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-id106" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Environment variables are often used to configure and
control software. Each process has its own set of environment
variables, which are inherited from its parent process. You sometimes
need to see the environment variable settings for your R process in
order to understand its behavior. Likewise, you sometimes need to change
those settings to modify that behavior.</p>
<p>A common use case is to store a username or password for use in accessing a remote database or cloud service. It’s a really bad idea to store passwords in plain text in a project script. One way to avoid storing passwords in your script is to set an environment variable containing your password when R starts.</p>
<p>To ensure our password and username are available at every R login, we can add calls to <code>Sys.setenv</code> in our <em>.Rprofile</em> file in our home directory. The <em>.Rprofile</em> is an R script that is run every time R starts.</p>
<p>We can add the following to our <code>.Rprofile</code>:</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="UsefulTricks.html#cb920-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">DB_USERID =</span> <span class="st">&quot;JDL&quot;</span>)</span>
<span id="cb920-2"><a href="UsefulTricks.html#cb920-2" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">DB_PASSWORD =</span> <span class="st">&quot;My_Password!&quot;</span>)</span></code></pre></div>
<p>Then we can then fetch and use the environment variables in a script to log into an Amazon Redshift database, for example:</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="UsefulTricks.html#cb921-1" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(</span>
<span id="cb921-2"><a href="UsefulTricks.html#cb921-2" tabindex="-1"></a>  RPostgreSQL<span class="sc">::</span><span class="fu">PostgreSQL</span>(),</span>
<span id="cb921-3"><a href="UsefulTricks.html#cb921-3" tabindex="-1"></a>  <span class="at">dbname   =</span> <span class="st">&quot;my_database&quot;</span>,</span>
<span id="cb921-4"><a href="UsefulTricks.html#cb921-4" tabindex="-1"></a>  <span class="at">port     =</span> <span class="dv">5439</span>,</span>
<span id="cb921-5"><a href="UsefulTricks.html#cb921-5" tabindex="-1"></a>  <span class="at">host     =</span> <span class="st">&quot;my_database.amazonaws.com&quot;</span>,</span>
<span id="cb921-6"><a href="UsefulTricks.html#cb921-6" tabindex="-1"></a>  <span class="at">user     =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;DB_USERID&quot;</span>),</span>
<span id="cb921-7"><a href="UsefulTricks.html#cb921-7" tabindex="-1"></a>  <span class="at">password =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;DB_PASSWORD&quot;</span>)</span>
<span id="cb921-8"><a href="UsefulTricks.html#cb921-8" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="see-also-4" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see-also-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="NavigatingTheSoftware.html#recipe-id099">3.16</a>, <a href="NavigatingTheSoftware.html#recipe-id099">“Customizing R Startup”</a>, for more about changing configuration at startup.</p>
</div>
</div>
<div id="recipe-codesections" class="section level2 hasAnchor" number="12.20">
<h2><span class="header-section-number">12.20</span> Use Code Sections<a href="UsefulTricks.html#recipe-codesections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-codesections" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-codesections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You’ve got a long script and you’re finding it difficult to navigate from one section of code to the next.</p>
</div>
<div id="solution-codesections" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-codesections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Code sections provide section dividers in an outline pane on the side of your editor. To use code sections, simply start a comment with <code>#</code> and then end the comment with <code>----</code> or <code>####</code> or <code>====</code>:</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="UsefulTricks.html#cb922-1" tabindex="-1"></a></span>
<span id="cb922-2"><a href="UsefulTricks.html#cb922-2" tabindex="-1"></a><span class="co"># My First Section      -----</span></span>
<span id="cb922-3"><a href="UsefulTricks.html#cb922-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb922-4"><a href="UsefulTricks.html#cb922-4" tabindex="-1"></a></span>
<span id="cb922-5"><a href="UsefulTricks.html#cb922-5" tabindex="-1"></a><span class="co"># My Second Section     ####</span></span>
<span id="cb922-6"><a href="UsefulTricks.html#cb922-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb922-7"><a href="UsefulTricks.html#cb922-7" tabindex="-1"></a></span>
<span id="cb922-8"><a href="UsefulTricks.html#cb922-8" tabindex="-1"></a><span class="co"># My Third Section      ====</span></span>
<span id="cb922-9"><a href="UsefulTricks.html#cb922-9" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">3</span></span></code></pre></div>
<p>In the RStudio editor window you can see the outline on the righthand side of Figure <a href="UsefulTricks.html#fig:codesection">12.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:codesection"></span>
<img src="images_v2/codesection.png" alt="Code sections" width="85%" />
<p class="caption">
Figure 12.2: Code sections
</p>
</div>
</div>
<div id="discussion-codesections" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-codesections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Code sections are just a specially formatted type of R comment since they start with the <code>#</code> symbol. If you open your code with any editor other than RStudio, they are treated simply as code comments. But RStudio sees these specially formatted code comments as section headers and creates a helpful outline in the side of the editor.</p>
<p>The first time you use code sections, you may need to click the outline icon to the right of the Source button in order to show the outline.</p>
<p>If you are writing R Markdown instead of a <code>*.R</code> script, your Markdown headings and subheadings will show up in the outline pane, making navigating your document much easier.</p>
</div>
<div id="see_also-codesections" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-codesections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="RMarkdown.html#recipe-headings">16.4</a>, <a href="RMarkdown.html#recipe-headings">“Inserting Document Headings”</a>, for using section headings in R Markdown documents.</p>
</div>
</div>
<div id="recipe-parallel_local" class="section level2 hasAnchor" number="12.21">
<h2><span class="header-section-number">12.21</span> Executing R in Parallel Locally<a href="UsefulTricks.html#recipe-parallel_local" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-parallel_local" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-parallel_local" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have code that takes a while to run and you would like to speed it up by using more of the cores on your local computer.</p>
</div>
<div id="solution-parallel_local" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-parallel_local" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The easiest solution to get up and running with is to use the <code>furrr</code> package, which in turn uses the <code>future</code> package to provide parallel processing via functions that feel like those from <code>purrr</code> except that they operate in parallel.</p>
<p>To use <code>furrr</code> we downloaded the latest development version from GitHub because the package is still under active development as of this writing:</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="UsefulTricks.html#cb923-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;DavisVaughan/furrr&quot;</span>)</span></code></pre></div>
<p>To use <code>furrr</code> to parallelize our code, we call the <code>furrr::future_map</code> in place of the <code>purrr::map</code> function we discussed in Recipe <a href="DataTransformations.html#recipe-id149">6.1</a>, <a href="DataTransformations.html#recipe-id149">“Applying a Function to Each List Element”</a>. But first we have to tell <code>furrr</code> how we want to parallelize. In this case we want a <code>multiprocess</code> parallel process that uses all our local processors. So we set that up by calling <code>plan(multiprocess)</code>. Then we can apply a function to every element in our list using <code>future_map</code>:</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="UsefulTricks.html#cb924-1" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb924-2"><a href="UsefulTricks.html#cb924-2" tabindex="-1"></a></span>
<span id="cb924-3"><a href="UsefulTricks.html#cb924-3" tabindex="-1"></a><span class="fu">plan</span>(multisession)</span>
<span id="cb924-4"><a href="UsefulTricks.html#cb924-4" tabindex="-1"></a></span>
<span id="cb924-5"><a href="UsefulTricks.html#cb924-5" tabindex="-1"></a><span class="fu">future_map</span>(my_list, some_function)</span></code></pre></div>
</div>
<div id="discussion-parallel_local" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-parallel_local" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s do an example simulation to illustrate parallelization. A classic stochastic simulation is to draw random points inside of a 2 x 2 box and see how many points fall within one unit from the center of the box. The ratio of points inside the box / total points then multiplied by 4 is a good estimate of pi. The following function takes one input, <code>n_iterations</code>, which is the number of random points to simulate. Then it returns the resulting average estimate of pi:</p>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="UsefulTricks.html#cb925-1" tabindex="-1"></a>simulate_pi <span class="ot">&lt;-</span> <span class="cf">function</span>(n_iterations) {</span>
<span id="cb925-2"><a href="UsefulTricks.html#cb925-2" tabindex="-1"></a>  rand_draws <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">2</span> <span class="sc">*</span> n_iterations, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb925-3"><a href="UsefulTricks.html#cb925-3" tabindex="-1"></a>  num_in <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sqrt</span>(rand_draws[, <span class="dv">1</span>]<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span> rand_draws[, <span class="dv">2</span>]<span class="sc">**</span><span class="dv">2</span>) <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb925-4"><a href="UsefulTricks.html#cb925-4" tabindex="-1"></a>  pi_hat <span class="ot">&lt;-</span> (num_in <span class="sc">/</span> n_iterations) <span class="sc">*</span> <span class="dv">4</span></span>
<span id="cb925-5"><a href="UsefulTricks.html#cb925-5" tabindex="-1"></a>  <span class="fu">return</span>(pi_hat)</span>
<span id="cb925-6"><a href="UsefulTricks.html#cb925-6" tabindex="-1"></a>}</span>
<span id="cb925-7"><a href="UsefulTricks.html#cb925-7" tabindex="-1"></a><span class="fu">simulate_pi</span>(<span class="dv">1000000</span>)</span>
<span id="cb925-8"><a href="UsefulTricks.html#cb925-8" tabindex="-1"></a><span class="co">#&gt; [1] 3.14</span></span></code></pre></div>
<p>As you can see, even with 1,000,000 simulations the result is only accurate out to a couple of decimal points. This is not a very efficient way to estimate pi, but it works for our illustration.</p>
<p>For the purpose of comparison later, let’s run 200 runs of this pi simulator where each run has 5,000,000 simulated points.
We’ll do this by creating a list with 200 elements, each of which is the value 5,000,000, which we will pass to <code>simulate_pi</code>.
We’ll time the code with the <code>tictoc</code> package:</p>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="UsefulTricks.html#cb926-1" tabindex="-1"></a><span class="fu">library</span>(purrr)  <span class="co"># for `map`</span></span>
<span id="cb926-2"><a href="UsefulTricks.html#cb926-2" tabindex="-1"></a><span class="fu">library</span>(tictoc) <span class="co"># for timing our code</span></span>
<span id="cb926-3"><a href="UsefulTricks.html#cb926-3" tabindex="-1"></a></span>
<span id="cb926-4"><a href="UsefulTricks.html#cb926-4" tabindex="-1"></a>draw_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">rep</span>(<span class="dv">5000000</span>, <span class="dv">200</span>))</span>
<span id="cb926-5"><a href="UsefulTricks.html#cb926-5" tabindex="-1"></a></span>
<span id="cb926-6"><a href="UsefulTricks.html#cb926-6" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&quot;simulate pi - single process&quot;</span>)</span>
<span id="cb926-7"><a href="UsefulTricks.html#cb926-7" tabindex="-1"></a>sims_list <span class="ot">&lt;-</span> <span class="fu">map</span>(draw_list, simulate_pi)</span>
<span id="cb926-8"><a href="UsefulTricks.html#cb926-8" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb926-9"><a href="UsefulTricks.html#cb926-9" tabindex="-1"></a><span class="co">#&gt; simulate pi - single process: 27.684 sec elapsed</span></span>
<span id="cb926-10"><a href="UsefulTricks.html#cb926-10" tabindex="-1"></a></span>
<span id="cb926-11"><a href="UsefulTricks.html#cb926-11" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">unlist</span>(sims_list))</span>
<span id="cb926-12"><a href="UsefulTricks.html#cb926-12" tabindex="-1"></a><span class="co">#&gt; [1] 3.14</span></span></code></pre></div>
<p>That runs in less than two minutes and gives an estimate of pi based on a billion simulation (5m x 200).</p>
<p>Now let’s take the exact same R function, <code>simulate_pi</code>, and run it through <code>future_map</code> to run it in parallel:</p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="UsefulTricks.html#cb927-1" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb927-2"><a href="UsefulTricks.html#cb927-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: future</span></span>
<span id="cb927-3"><a href="UsefulTricks.html#cb927-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb927-4"><a href="UsefulTricks.html#cb927-4" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;future&#39;</span></span>
<span id="cb927-5"><a href="UsefulTricks.html#cb927-5" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:tseries&#39;:</span></span>
<span id="cb927-6"><a href="UsefulTricks.html#cb927-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb927-7"><a href="UsefulTricks.html#cb927-7" tabindex="-1"></a><span class="co">#&gt;     value</span></span>
<span id="cb927-8"><a href="UsefulTricks.html#cb927-8" tabindex="-1"></a><span class="fu">plan</span>(multisession)</span>
<span id="cb927-9"><a href="UsefulTricks.html#cb927-9" tabindex="-1"></a></span>
<span id="cb927-10"><a href="UsefulTricks.html#cb927-10" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&quot;simulate pi - parallel&quot;</span>)</span>
<span id="cb927-11"><a href="UsefulTricks.html#cb927-11" tabindex="-1"></a>sims_list <span class="ot">&lt;-</span> <span class="fu">future_map</span>(draw_list, simulate_pi)</span>
<span id="cb927-12"><a href="UsefulTricks.html#cb927-12" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb927-13"><a href="UsefulTricks.html#cb927-13" tabindex="-1"></a><span class="co">#&gt; simulate pi - parallel: 5.964 sec elapsed</span></span>
<span id="cb927-14"><a href="UsefulTricks.html#cb927-14" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">unlist</span>(sims_list))</span>
<span id="cb927-15"><a href="UsefulTricks.html#cb927-15" tabindex="-1"></a><span class="co">#&gt; [1] 3.14</span></span></code></pre></div>
<p>The preceding example was run on a MacBook Pro with four physical cores and two virtual cores per physical core. When you’re running code in parallel the best-case scenario is that the runtime is reduced by 1/(number of physical cores). With four physical cores you can see the parallel runtime is much faster than the single-threaded version, but not quite one-fourth the runtime of the single-threaded version. There is always some overhead from moving the data around, so you will never experience the best-case scenario. And the more data each iteration produces, the less speed improvement you will experience from parallelization.</p>
</div>
<div id="see_also-parallel_local" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-parallel_local" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe @ref(recipe-parallel_remote), <a href="UsefulTricks.html#recipe-parallel_remote">“Executing R in Parallel Remotely”</a></p>
</div>
</div>
<div id="recipe-parallel_remote" class="section level2 hasAnchor" number="12.22">
<h2><span class="header-section-number">12.22</span> Executing R in Parallel Remotely<a href="UsefulTricks.html#recipe-parallel_remote" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-parallel_remote" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="UsefulTricks.html#problem-parallel_remote" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have access to a number of remote machines and you would like to run your code in parallel across them all.</p>
</div>
<div id="solution-parallel_remote" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="UsefulTricks.html#solution-parallel_remote" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Running code in parallel across multiple machines can be tricky to set up initially. However, if we start with a few key prerequisites in place, the process has a much higher probability of success.</p>
<p>Starting prerequisites:</p>
<ul>
<li>You can <code>ssh</code> from your main machine to each remote node without a password using previously generated SSH keys.</li>
<li>The remote nodes all have R installed (ideally the same version of R).</li>
<li>Paths are set such that you can run <code>Rscript</code> from SSH.</li>
<li>The remote nodes have the package <code>furrr</code> installed (which in turn installs <code>future</code>).</li>
<li>The remote nodes already have all the packages installed on which your distributed code depends.</li>
</ul>
<p>Once you have worker nodes that are set up and ready to go, you can create a cluster by calling <code>makeClusterPSOCK</code> from the <code>future</code> package. Then use the resulting cluster with the <code>furrr</code> function <code>future_map</code>:</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="UsefulTricks.html#cb928-1" tabindex="-1"></a><span class="fu">library</span>(furrr) <span class="co"># loads future as a dependency</span></span>
<span id="cb928-2"><a href="UsefulTricks.html#cb928-2" tabindex="-1"></a></span>
<span id="cb928-3"><a href="UsefulTricks.html#cb928-3" tabindex="-1"></a>workers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;node_1.domain.com&quot;</span>, <span class="st">&quot;node_2.domain.com&quot;</span>)</span>
<span id="cb928-4"><a href="UsefulTricks.html#cb928-4" tabindex="-1"></a></span>
<span id="cb928-5"><a href="UsefulTricks.html#cb928-5" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeClusterPSOCK</span>(</span>
<span id="cb928-6"><a href="UsefulTricks.html#cb928-6" tabindex="-1"></a>  <span class="at">worker =</span> workers</span>
<span id="cb928-7"><a href="UsefulTricks.html#cb928-7" tabindex="-1"></a>)</span>
<span id="cb928-8"><a href="UsefulTricks.html#cb928-8" tabindex="-1"></a></span>
<span id="cb928-9"><a href="UsefulTricks.html#cb928-9" tabindex="-1"></a><span class="fu">plan</span>(cluster, <span class="at">workers =</span> cl)</span>
<span id="cb928-10"><a href="UsefulTricks.html#cb928-10" tabindex="-1"></a></span>
<span id="cb928-11"><a href="UsefulTricks.html#cb928-11" tabindex="-1"></a><span class="fu">future_map</span>(my_list, some_function)</span></code></pre></div>
</div>
<div id="discussion-parallel_remote" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="UsefulTricks.html#discussion-parallel_remote" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have two big Linux machines named <code>von-neumann12</code> and <code>von-neumann15</code> that we can use to run numerical models. These machines meet the criteria just listed, so they are good candidates to be our backend for a <code>furrr</code>/<code>future</code> cluster. Let’s do the same pi simulation we did in the prior recipe using the <code>simulate_pi</code> function:</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="UsefulTricks.html#cb929-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb929-2"><a href="UsefulTricks.html#cb929-2" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb929-3"><a href="UsefulTricks.html#cb929-3" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb929-4"><a href="UsefulTricks.html#cb929-4" tabindex="-1"></a></span>
<span id="cb929-5"><a href="UsefulTricks.html#cb929-5" tabindex="-1"></a>my_workers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;von-neumann12&#39;</span>,<span class="st">&#39;von-neumann15&#39;</span>)</span>
<span id="cb929-6"><a href="UsefulTricks.html#cb929-6" tabindex="-1"></a></span>
<span id="cb929-7"><a href="UsefulTricks.html#cb929-7" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeClusterPSOCK</span>(</span>
<span id="cb929-8"><a href="UsefulTricks.html#cb929-8" tabindex="-1"></a>  <span class="at">workers =</span> my_workers,</span>
<span id="cb929-9"><a href="UsefulTricks.html#cb929-9" tabindex="-1"></a>  <span class="at">rscript =</span> <span class="st">&#39;/home/anaconda2/bin/Rscript&#39;</span>,  <span class="co">#yours may differ</span></span>
<span id="cb929-10"><a href="UsefulTricks.html#cb929-10" tabindex="-1"></a>  <span class="at">verbose=</span><span class="cn">TRUE</span></span>
<span id="cb929-11"><a href="UsefulTricks.html#cb929-11" tabindex="-1"></a>)</span>
<span id="cb929-12"><a href="UsefulTricks.html#cb929-12" tabindex="-1"></a></span>
<span id="cb929-13"><a href="UsefulTricks.html#cb929-13" tabindex="-1"></a>draw_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">rep</span>(<span class="dv">5000000</span>, <span class="dv">200</span>))</span>
<span id="cb929-14"><a href="UsefulTricks.html#cb929-14" tabindex="-1"></a></span>
<span id="cb929-15"><a href="UsefulTricks.html#cb929-15" tabindex="-1"></a><span class="fu">plan</span>(cluster, <span class="at">workers =</span> cl)</span>
<span id="cb929-16"><a href="UsefulTricks.html#cb929-16" tabindex="-1"></a></span>
<span id="cb929-17"><a href="UsefulTricks.html#cb929-17" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&#39;simulate pi - parallel map&#39;</span>)</span>
<span id="cb929-18"><a href="UsefulTricks.html#cb929-18" tabindex="-1"></a>sims_list_parallel <span class="ot">&lt;-</span> draw_list <span class="sc">%&gt;%</span></span>
<span id="cb929-19"><a href="UsefulTricks.html#cb929-19" tabindex="-1"></a>  <span class="fu">future_map</span>(simulate_pi)</span>
<span id="cb929-20"><a href="UsefulTricks.html#cb929-20" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb929-21"><a href="UsefulTricks.html#cb929-21" tabindex="-1"></a><span class="co">#&gt; simulate pi - parallel map: 116.986 sec elapsed</span></span>
<span id="cb929-22"><a href="UsefulTricks.html#cb929-22" tabindex="-1"></a></span>
<span id="cb929-23"><a href="UsefulTricks.html#cb929-23" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">unlist</span>(sims_list_parallel))</span>
<span id="cb929-24"><a href="UsefulTricks.html#cb929-24" tabindex="-1"></a><span class="co">#&gt; [1] 3.14167</span></span></code></pre></div>
<p>This is ~8.5 million sims per second.</p>
<p>The two nodes in our ad hoc cluster each have 32 processors and 128GB of RAM. But if you compare the runtime of the preceding code with the runtime of the prior recipe run on a humble MacBook Pro, you’ll notice that the MacBook executed the code in about the same time as the multi-CPU Linux cluster with 64 total processors! This unintuitive surprise happens because the preceding code runs only on one CPU per cluster node. So, as a result, it uses only two CPUs, while the MacBook example uses all four of its CPUs.</p>
<p>So how do we run parallel code on a cluster and have each node also run in parallel across multiple CPU cores? To do that we need to make three changes to our code:</p>
<ol style="list-style-type: decimal">
<li>Create a nested parallel plan that uses <em>both</em> <code>cluster</code> and <code>multiprocess</code>.</li>
<li>Create an input list that is a nested list. Each cluster machine will get from the main list an item that contains sublist items that it can process in parallel across all its CPUs.</li>
<li>Call <code>future_map</code> twice using a nested call. The outer <code>future_map</code> will parallelize items across the cluster nodes, and then the inner call will parallelize across the CPUs.</li>
</ol>
<p>To created the nested parallel plan, we will create a multipart plan by passing a list of two plans to the <code>plan</code> function like this:</p>
<pre><code>plan(list(tweak(cluster, workers = cl), multiprocess))</code></pre>
<p>The second change is to create the nested list to iterate on. We can do that by using the <code>split</code> command and passing it our prior list followed by a vector of <code>1:4</code> like so:</p>
<pre><code>split(draw_list, 1:4)</code></pre>
<p>This will break the initial list into four sublists. So our resulting list will have four elements. Each sublist will have 50 inputs for our final <code>simulate_pi</code> function.</p>
<p>The third change to our code is to create a nested <code>future_map</code> call that will pass each of our four list elements to the worker nodes, which subsequently will iterate over the elements of each sublist. We create that nested function like this:</p>
<pre><code>future_map(draw_list, ~future_map(.,simulate_pi))</code></pre>
<p>The <code>~</code> sets up R to expect an anonymous function inside the first <code>future_map</code> call, and the <code>.</code> tells R where to put the list element. The anonymous function in this example is a separate call to <code>future_map</code> that gets executed on each node.</p>
<p>Here’s all three changes integrated into code:</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="UsefulTricks.html#cb933-1" tabindex="-1"></a><span class="co"># nested parallel plan. The first part of the plan is the cluster call </span></span>
<span id="cb933-2"><a href="UsefulTricks.html#cb933-2" tabindex="-1"></a><span class="co"># followed by the multiprocess</span></span>
<span id="cb933-3"><a href="UsefulTricks.html#cb933-3" tabindex="-1"></a><span class="fu">plan</span>(<span class="fu">list</span>(<span class="fu">tweak</span>(cluster, <span class="at">workers =</span> cl), multiprocess))</span>
<span id="cb933-4"><a href="UsefulTricks.html#cb933-4" tabindex="-1"></a></span>
<span id="cb933-5"><a href="UsefulTricks.html#cb933-5" tabindex="-1"></a><span class="co"># break the draw_list into a nested list with fewer elements</span></span>
<span id="cb933-6"><a href="UsefulTricks.html#cb933-6" tabindex="-1"></a>draw_list_nested <span class="ot">&lt;-</span> <span class="fu">split</span>(draw_list, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb933-7"><a href="UsefulTricks.html#cb933-7" tabindex="-1"></a></span>
<span id="cb933-8"><a href="UsefulTricks.html#cb933-8" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&#39;simulate pi - parallel nested map&#39;</span>)</span>
<span id="cb933-9"><a href="UsefulTricks.html#cb933-9" tabindex="-1"></a>sims_list_nested_parallel <span class="ot">&lt;-</span> <span class="fu">future_map</span>(draw_list_nested, <span class="sc">~</span><span class="fu">future_map</span>(.,simulate_pi))</span>
<span id="cb933-10"><a href="UsefulTricks.html#cb933-10" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb933-11"><a href="UsefulTricks.html#cb933-11" tabindex="-1"></a><span class="co">#&gt; simulate pi - parallel nested map: 15.964 sec elapsed</span></span>
<span id="cb933-12"><a href="UsefulTricks.html#cb933-12" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">unlist</span>(sims_list_nested_parallel))</span>
<span id="cb933-13"><a href="UsefulTricks.html#cb933-13" tabindex="-1"></a><span class="co">#&gt; [1] 3.14158</span></span></code></pre></div>
<p>You can see the runtime decreased substantially from the prior example. Although with 32 processors on each node, we’re not seeing a 32x improvement in runtime. This is because we’re passing only 50 sets of simulations to each node. Each node runs 32 sets of simulations in the first pass but only 18 in the second pass, leaving half the CPUs idle.</p>
<p>Let’s keep the CPUs a little busier by increasing our total simulations from 1 billion to 25 billion. Then we’ll break them into 500 work blocks to be spread to the two worker nodes:</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="UsefulTricks.html#cb934-1" tabindex="-1"></a>draw_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">rep</span>(<span class="dv">5000000</span>, <span class="dv">5000</span>))</span>
<span id="cb934-2"><a href="UsefulTricks.html#cb934-2" tabindex="-1"></a>draw_list_nested <span class="ot">&lt;-</span> <span class="fu">split</span>(draw_list, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb934-3"><a href="UsefulTricks.html#cb934-3" tabindex="-1"></a></span>
<span id="cb934-4"><a href="UsefulTricks.html#cb934-4" tabindex="-1"></a><span class="fu">plan</span>(<span class="fu">list</span>(<span class="fu">tweak</span>(cluster, <span class="at">workers =</span> cl), multiprocess))</span>
<span id="cb934-5"><a href="UsefulTricks.html#cb934-5" tabindex="-1"></a></span>
<span id="cb934-6"><a href="UsefulTricks.html#cb934-6" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">&#39;simulate pi - parallel nested map&#39;</span>)</span>
<span id="cb934-7"><a href="UsefulTricks.html#cb934-7" tabindex="-1"></a>sims_list_nested_parallel <span class="ot">&lt;-</span> <span class="fu">future_map</span>(draw_list_nested, <span class="sc">~</span><span class="fu">future_map</span>(.,simulate_pi))</span>
<span id="cb934-8"><a href="UsefulTricks.html#cb934-8" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb934-9"><a href="UsefulTricks.html#cb934-9" tabindex="-1"></a><span class="co">#&gt; simulate pi - parallel nested map: 260.532 sec elapsed</span></span>
<span id="cb934-10"><a href="UsefulTricks.html#cb934-10" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">unlist</span>(sims_list_nested_parallel))</span>
<span id="cb934-11"><a href="UsefulTricks.html#cb934-11" tabindex="-1"></a><span class="co">#&gt; [1] 3.14157</span></span></code></pre></div>
<p>This gives us ~ 96 million sims per second.</p>
</div>
<div id="see_also-parallel_remote" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="UsefulTricks.html#see_also-parallel_remote" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>future</code> package has multiple excellent vignettes. To better understand the nested <code>plan</code> call, start with <code>vignette('future-3-topologies',package = 'future')</code>.</p>
<p>Further info about <code>furrr</code> can be found at its <a href="https://github.com/DavisVaughan/furrr">GitHub page</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="LinearRegressionAndANOVA.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="BeyondBasics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/CerebralMastication/R-Cookbook/edit/master/12_UsefulTricks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
