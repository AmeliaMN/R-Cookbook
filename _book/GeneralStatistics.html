<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 General Statistics | R Cookbook, 2nd Edition</title>
  <meta name="description" content="Second edition of R Cookbook" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="9 General Statistics | R Cookbook, 2nd Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Second edition of R Cookbook" />
  <meta name="github-repo" content="CerebralMastication/R-Cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 General Statistics | R Cookbook, 2nd Edition" />
  
  <meta name="twitter:description" content="Second edition of R Cookbook" />
  

<meta name="author" content="James (JD) Long" />
<meta name="author" content="Paul Teetor" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Probability.html"/>
<link rel="next" href="Graphics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129487349-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-129487349-3');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R Cookbook 2nd Edition</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to the R Cookbook 2nd Edition</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-recipes"><i class="fa fa-check"></i>The Recipes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-note-on-terminology"><i class="fa fa-check"></i>A Note on Terminology</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-and-platform-notes"><i class="fa fa-check"></i>Software and Platform Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions Used in This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-code-examples"><i class="fa fa-check"></i>Using Code Examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#safari-books-online"><i class="fa fa-check"></i>SafariÂ® Books Online</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i><b>1</b> Getting Started and Getting Help</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#intro-GettingStarted"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1.1" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id001"><i class="fa fa-check"></i><b>1.1</b> Downloading and Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id002b"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-startingrstudio"><i class="fa fa-check"></i><b>1.3</b> Starting RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id007"><i class="fa fa-check"></i><b>1.4</b> Entering Commands</a></li>
<li class="chapter" data-level="1.5" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id097"><i class="fa fa-check"></i><b>1.5</b> Exiting from RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id100"><i class="fa fa-check"></i><b>1.6</b> Interrupting R</a></li>
<li class="chapter" data-level="1.7" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id265"><i class="fa fa-check"></i><b>1.7</b> Viewing the Supplied Documentation</a></li>
<li class="chapter" data-level="1.8" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id003"><i class="fa fa-check"></i><b>1.8</b> Getting Help on a Function</a></li>
<li class="chapter" data-level="1.9" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id267"><i class="fa fa-check"></i><b>1.9</b> Searching the Supplied Documentation</a></li>
<li class="chapter" data-level="1.10" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id266"><i class="fa fa-check"></i><b>1.10</b> Getting Help on a Package</a></li>
<li class="chapter" data-level="1.11" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id005"><i class="fa fa-check"></i><b>1.11</b> Searching the Web for Help</a></li>
<li class="chapter" data-level="1.12" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id270"><i class="fa fa-check"></i><b>1.12</b> Finding Relevant Functions and Packages</a></li>
<li class="chapter" data-level="1.13" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id268"><i class="fa fa-check"></i><b>1.13</b> Searching the Mailing Lists</a></li>
<li class="chapter" data-level="1.14" data-path="GettingStarted.html"><a href="GettingStarted.html#recipe-id269"><i class="fa fa-check"></i><b>1.14</b> Submitting Questions to Stack Overflow or Elsewhere in the Community</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="SomeBasics.html"><a href="SomeBasics.html"><i class="fa fa-check"></i><b>2</b> Some Basics</a>
<ul>
<li class="chapter" data-level="" data-path="SomeBasics.html"><a href="SomeBasics.html#intro-SomeBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2.1" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id017"><i class="fa fa-check"></i><b>2.1</b> Printing Something to the Screen</a></li>
<li class="chapter" data-level="2.2" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id016"><i class="fa fa-check"></i><b>2.2</b> Setting Variables</a></li>
<li class="chapter" data-level="2.3" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id091"><i class="fa fa-check"></i><b>2.3</b> Listing Variables</a></li>
<li class="chapter" data-level="2.4" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id075"><i class="fa fa-check"></i><b>2.4</b> Deleting Variables</a></li>
<li class="chapter" data-level="2.5" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id038"><i class="fa fa-check"></i><b>2.5</b> Creating a Vector</a></li>
<li class="chapter" data-level="2.6" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id101"><i class="fa fa-check"></i><b>2.6</b> Computing Basic Statistics</a></li>
<li class="chapter" data-level="2.7" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id021"><i class="fa fa-check"></i><b>2.7</b> Creating Sequences</a></li>
<li class="chapter" data-level="2.8" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id020"><i class="fa fa-check"></i><b>2.8</b> Comparing Vectors</a></li>
<li class="chapter" data-level="2.9" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id039"><i class="fa fa-check"></i><b>2.9</b> Selecting Vector Elements</a></li>
<li class="chapter" data-level="2.10" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id019"><i class="fa fa-check"></i><b>2.10</b> Performing Vector Arithmetic</a></li>
<li class="chapter" data-level="2.11" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id018"><i class="fa fa-check"></i><b>2.11</b> Getting Operator Precedence Right</a></li>
<li class="chapter" data-level="2.12" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id022"><i class="fa fa-check"></i><b>2.12</b> Typing Less and Accomplishing More</a></li>
<li class="chapter" data-level="2.13" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-pipe-2"><i class="fa fa-check"></i><b>2.13</b> Creating a Pipeline of Function Calls</a></li>
<li class="chapter" data-level="2.14" data-path="SomeBasics.html"><a href="SomeBasics.html#recipe-id025"><i class="fa fa-check"></i><b>2.14</b> Avoiding Some Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html"><i class="fa fa-check"></i><b>3</b> Navigating the Software</a>
<ul>
<li class="chapter" data-level="" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#intro-NavigatingTheSoftware"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="3.1" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id008"><i class="fa fa-check"></i><b>3.1</b> Getting and Setting the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-CreateProject"><i class="fa fa-check"></i><b>3.2</b> Creating a New RStudio Project</a></li>
<li class="chapter" data-level="3.3" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id009"><i class="fa fa-check"></i><b>3.3</b> Saving Your Workspace</a></li>
<li class="chapter" data-level="3.4" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id023"><i class="fa fa-check"></i><b>3.4</b> Viewing Your Command History</a></li>
<li class="chapter" data-level="3.5" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id024"><i class="fa fa-check"></i><b>3.5</b> Saving the Result of the Previous Command</a></li>
<li class="chapter" data-level="3.6" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id010"><i class="fa fa-check"></i><b>3.6</b> Displaying Loaded Packages via the Search Path</a></li>
<li class="chapter" data-level="3.7" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id094"><i class="fa fa-check"></i><b>3.7</b> Viewing the List of Installed Packages</a></li>
<li class="chapter" data-level="3.8" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id013"><i class="fa fa-check"></i><b>3.8</b> Accessing the Functions in a Package</a></li>
<li class="chapter" data-level="3.9" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id257"><i class="fa fa-check"></i><b>3.9</b> Accessing Built-in Datasets</a></li>
<li class="chapter" data-level="3.10" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id012"><i class="fa fa-check"></i><b>3.10</b> Installing Packages from CRAN</a></li>
<li class="chapter" data-level="3.11" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-installGH"><i class="fa fa-check"></i><b>3.11</b> Installing a Package from GitHub</a></li>
<li class="chapter" data-level="3.12" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id272"><i class="fa fa-check"></i><b>3.12</b> Setting or Changing a Default CRAN Mirror</a></li>
<li class="chapter" data-level="3.13" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id014"><i class="fa fa-check"></i><b>3.13</b> Running a Script</a></li>
<li class="chapter" data-level="3.14" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id015"><i class="fa fa-check"></i><b>3.14</b> Running a Batch Script</a></li>
<li class="chapter" data-level="3.15" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id102"><i class="fa fa-check"></i><b>3.15</b> Locating the R Home Directory</a></li>
<li class="chapter" data-level="3.16" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-id099"><i class="fa fa-check"></i><b>3.16</b> Customizing R Startup</a></li>
<li class="chapter" data-level="3.17" data-path="NavigatingTheSoftware.html"><a href="NavigatingTheSoftware.html#recipe-Rcloud"><i class="fa fa-check"></i><b>3.17</b> Using R and RStudio in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="InputAndOutput.html"><a href="InputAndOutput.html"><i class="fa fa-check"></i><b>4</b> Input and Output</a>
<ul>
<li class="chapter" data-level="" data-path="InputAndOutput.html"><a href="InputAndOutput.html#intro-InputAndOutput"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="4.1" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id035"><i class="fa fa-check"></i><b>4.1</b> Entering Data from the Keyboard</a></li>
<li class="chapter" data-level="4.2" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id036"><i class="fa fa-check"></i><b>4.2</b> Printing Fewer Digits (or More Digits)</a></li>
<li class="chapter" data-level="4.3" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id034"><i class="fa fa-check"></i><b>4.3</b> Redirecting Output to a File</a></li>
<li class="chapter" data-level="4.4" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id030"><i class="fa fa-check"></i><b>4.4</b> Listing Files</a></li>
<li class="chapter" data-level="4.5" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id033"><i class="fa fa-check"></i><b>4.5</b> Dealing with âCannot Open Fileâ in Windows</a></li>
<li class="chapter" data-level="4.6" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id136"><i class="fa fa-check"></i><b>4.6</b> Reading Fixed-Width Records</a></li>
<li class="chapter" data-level="4.7" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id245"><i class="fa fa-check"></i><b>4.7</b> Reading Tabular Data Files</a></li>
<li class="chapter" data-level="4.8" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id027"><i class="fa fa-check"></i><b>4.8</b> Reading from CSV Files</a></li>
<li class="chapter" data-level="4.9" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id028"><i class="fa fa-check"></i><b>4.9</b> Writing to CSV Files</a></li>
<li class="chapter" data-level="4.10" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id031"><i class="fa fa-check"></i><b>4.10</b> Reading Tabular or CSV Data from the Web</a></li>
<li class="chapter" data-level="4.11" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readexcel"><i class="fa fa-check"></i><b>4.11</b> Reading Data from Excel</a></li>
<li class="chapter" data-level="4.12" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-writeexcel"><i class="fa fa-check"></i><b>4.12</b> Writing a Data Frame to Excel</a></li>
<li class="chapter" data-level="4.13" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-readsas"><i class="fa fa-check"></i><b>4.13</b> Reading Data from a SAS file</a></li>
<li class="chapter" data-level="4.14" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id246"><i class="fa fa-check"></i><b>4.14</b> Reading Data from HTML Tables</a></li>
<li class="chapter" data-level="4.15" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id098"><i class="fa fa-check"></i><b>4.15</b> Reading Files with a Complex Structure</a></li>
<li class="chapter" data-level="4.16" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id037"><i class="fa fa-check"></i><b>4.16</b> Reading from MySQL Databases</a></li>
<li class="chapter" data-level="4.17" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-dbplyr"><i class="fa fa-check"></i><b>4.17</b> Accessing a Database with dbplyr</a></li>
<li class="chapter" data-level="4.18" data-path="InputAndOutput.html"><a href="InputAndOutput.html#recipe-id029"><i class="fa fa-check"></i><b>4.18</b> Saving and Transporting Objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DataStructures.html"><a href="DataStructures.html"><i class="fa fa-check"></i><b>5</b> Data Structures</a>
<ul>
<li class="chapter" data-level="" data-path="DataStructures.html"><a href="DataStructures.html#intro-DataStructures"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="5.1" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id048"><i class="fa fa-check"></i><b>5.1</b> Appending Data to a Vector</a></li>
<li class="chapter" data-level="5.2" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id049"><i class="fa fa-check"></i><b>5.2</b> Inserting Data into a Vector</a></li>
<li class="chapter" data-level="5.3" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id050"><i class="fa fa-check"></i><b>5.3</b> Understanding the Recycling Rule</a></li>
<li class="chapter" data-level="5.4" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id051"><i class="fa fa-check"></i><b>5.4</b> Creating a Factor (Categorical Variable)</a></li>
<li class="chapter" data-level="5.5" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id227"><i class="fa fa-check"></i><b>5.5</b> Combining Multiple Vectors into One Vector and a Factor</a></li>
<li class="chapter" data-level="5.6" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id053"><i class="fa fa-check"></i><b>5.6</b> Creating a List</a></li>
<li class="chapter" data-level="5.7" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id054"><i class="fa fa-check"></i><b>5.7</b> Selecting List Elements by Position</a></li>
<li class="chapter" data-level="5.8" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id253"><i class="fa fa-check"></i><b>5.8</b> Selecting List Elements by Name</a></li>
<li class="chapter" data-level="5.9" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id158"><i class="fa fa-check"></i><b>5.9</b> Building a Name/Value Association List</a></li>
<li class="chapter" data-level="5.10" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id056"><i class="fa fa-check"></i><b>5.10</b> Removing an Element from a List</a></li>
<li class="chapter" data-level="5.11" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id152"><i class="fa fa-check"></i><b>5.11</b> Flatten a List into a Vector</a></li>
<li class="chapter" data-level="5.12" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id058"><i class="fa fa-check"></i><b>5.12</b> Removing NULL Elements from a List</a></li>
<li class="chapter" data-level="5.13" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id060"><i class="fa fa-check"></i><b>5.13</b> Removing List Elements Using a Condition</a></li>
<li class="chapter" data-level="5.14" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id062"><i class="fa fa-check"></i><b>5.14</b> Initializing a Matrix</a></li>
<li class="chapter" data-level="5.15" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id139"><i class="fa fa-check"></i><b>5.15</b> Performing Matrix Operations</a></li>
<li class="chapter" data-level="5.16" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id063"><i class="fa fa-check"></i><b>5.16</b> Giving Descriptive Names to the Rows and Columns of a Matrix</a></li>
<li class="chapter" data-level="5.17" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id250"><i class="fa fa-check"></i><b>5.17</b> Selecting One Row or Column from a Matrix</a></li>
<li class="chapter" data-level="5.18" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id251"><i class="fa fa-check"></i><b>5.18</b> Initializing a Data Frame from Column Data</a></li>
<li class="chapter" data-level="5.19" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id252"><i class="fa fa-check"></i><b>5.19</b> Initializing a Data Frame from Row Data</a></li>
<li class="chapter" data-level="5.20" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id071"><i class="fa fa-check"></i><b>5.20</b> Appending Rows to a Data Frame</a></li>
<li class="chapter" data-level="5.21" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id068"><i class="fa fa-check"></i><b>5.21</b> Selecting Data Frame Columns by Position</a></li>
<li class="chapter" data-level="5.22" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id254"><i class="fa fa-check"></i><b>5.22</b> Selecting Data Frame Columns by Name</a></li>
<li class="chapter" data-level="5.23" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id069"><i class="fa fa-check"></i><b>5.23</b> Changing the Names of Data Frame Columns</a></li>
<li class="chapter" data-level="5.24" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id249"><i class="fa fa-check"></i><b>5.24</b> Removing NAs from a Data Frame</a></li>
<li class="chapter" data-level="5.25" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id072"><i class="fa fa-check"></i><b>5.25</b> Excluding Columns by Name</a></li>
<li class="chapter" data-level="5.26" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id155"><i class="fa fa-check"></i><b>5.26</b> Combining Two Data Frames</a></li>
<li class="chapter" data-level="5.27" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id057"><i class="fa fa-check"></i><b>5.27</b> Merging Data Frames by Common Column</a></li>
<li class="chapter" data-level="5.28" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id248"><i class="fa fa-check"></i><b>5.28</b> Converting One Atomic Value into Another</a></li>
<li class="chapter" data-level="5.29" data-path="DataStructures.html"><a href="DataStructures.html#recipe-id074"><i class="fa fa-check"></i><b>5.29</b> Converting One Structured Data Type into Another</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="DataTransformations.html"><a href="DataTransformations.html"><i class="fa fa-check"></i><b>6</b> Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="DataTransformations.html"><a href="DataTransformations.html#intro-DataTransformations"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="6.1" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id149"><i class="fa fa-check"></i><b>6.1</b> Applying a Function to Each List Element</a></li>
<li class="chapter" data-level="6.2" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-row_df"><i class="fa fa-check"></i><b>6.2</b> Applying a Function to Every Row of a Data Frame</a></li>
<li class="chapter" data-level="6.3" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id146"><i class="fa fa-check"></i><b>6.3</b> Applying a Function to Every Row of a Matrix</a></li>
<li class="chapter" data-level="6.4" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id157"><i class="fa fa-check"></i><b>6.4</b> Applying a Function to Every Column</a></li>
<li class="chapter" data-level="6.5" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id275"><i class="fa fa-check"></i><b>6.5</b> Applying a Function to Parallel Vectors or Lists</a></li>
<li class="chapter" data-level="6.6" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-id148"><i class="fa fa-check"></i><b>6.6</b> Applying a Function to Groups of Data</a></li>
<li class="chapter" data-level="6.7" data-path="DataTransformations.html"><a href="DataTransformations.html#recipe-casewhen"><i class="fa fa-check"></i><b>6.7</b> Creating a New Column Based on Some Condition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="StringsAndDates.html"><a href="StringsAndDates.html"><i class="fa fa-check"></i><b>7</b> Strings and Dates</a>
<ul>
<li class="chapter" data-level="" data-path="StringsAndDates.html"><a href="StringsAndDates.html#I_sect17_d1e17434"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="7.1" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id093"><i class="fa fa-check"></i><b>7.1</b> Getting the Length of a String</a></li>
<li class="chapter" data-level="7.2" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id040"><i class="fa fa-check"></i><b>7.2</b> Concatenating Strings</a></li>
<li class="chapter" data-level="7.3" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id041"><i class="fa fa-check"></i><b>7.3</b> Extracting Substrings</a></li>
<li class="chapter" data-level="7.4" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id276"><i class="fa fa-check"></i><b>7.4</b> Splitting a String According to a Delimiter</a></li>
<li class="chapter" data-level="7.5" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id277"><i class="fa fa-check"></i><b>7.5</b> Replacing Substrings</a></li>
<li class="chapter" data-level="7.6" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id109"><i class="fa fa-check"></i><b>7.6</b> Generating All Pairwise Combinations of Strings</a></li>
<li class="chapter" data-level="7.7" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id045"><i class="fa fa-check"></i><b>7.7</b> Getting the Current Date</a></li>
<li class="chapter" data-level="7.8" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id043"><i class="fa fa-check"></i><b>7.8</b> Converting a String into a Date</a></li>
<li class="chapter" data-level="7.9" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id044"><i class="fa fa-check"></i><b>7.9</b> Converting a Date into a String</a></li>
<li class="chapter" data-level="7.10" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id241"><i class="fa fa-check"></i><b>7.10</b> Converting Year, Month, and Day into a Date</a></li>
<li class="chapter" data-level="7.11" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id042"><i class="fa fa-check"></i><b>7.11</b> Getting the Julian Date</a></li>
<li class="chapter" data-level="7.12" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id046"><i class="fa fa-check"></i><b>7.12</b> Extracting the Parts of a Date</a></li>
<li class="chapter" data-level="7.13" data-path="StringsAndDates.html"><a href="StringsAndDates.html#recipe-id047"><i class="fa fa-check"></i><b>7.13</b> Creating a Sequence of Dates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Probability.html"><a href="Probability.html"><i class="fa fa-check"></i><b>8</b> Probability</a>
<ul>
<li class="chapter" data-level="" data-path="Probability.html"><a href="Probability.html#intro-Probability"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="8.1" data-path="Probability.html"><a href="Probability.html#recipe-id163"><i class="fa fa-check"></i><b>8.1</b> Counting the Number of Combinations</a></li>
<li class="chapter" data-level="8.2" data-path="Probability.html"><a href="Probability.html#recipe-id198"><i class="fa fa-check"></i><b>8.2</b> Generating Combinations</a></li>
<li class="chapter" data-level="8.3" data-path="Probability.html"><a href="Probability.html#recipe-id165"><i class="fa fa-check"></i><b>8.3</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="8.4" data-path="Probability.html"><a href="Probability.html#recipe-id201"><i class="fa fa-check"></i><b>8.4</b> Generating Reproducible Random Numbers</a></li>
<li class="chapter" data-level="8.5" data-path="Probability.html"><a href="Probability.html#recipe-id199"><i class="fa fa-check"></i><b>8.5</b> Generating a Random Sample</a></li>
<li class="chapter" data-level="8.6" data-path="Probability.html"><a href="Probability.html#recipe-id200"><i class="fa fa-check"></i><b>8.6</b> Generating Random Sequences</a></li>
<li class="chapter" data-level="8.7" data-path="Probability.html"><a href="Probability.html#recipe-id151"><i class="fa fa-check"></i><b>8.7</b> Randomly Permuting a Vector</a></li>
<li class="chapter" data-level="8.8" data-path="Probability.html"><a href="Probability.html#recipe-id196"><i class="fa fa-check"></i><b>8.8</b> Calculating Probabilities for Discrete Distributions</a></li>
<li class="chapter" data-level="8.9" data-path="Probability.html"><a href="Probability.html#recipe-id197"><i class="fa fa-check"></i><b>8.9</b> Calculating Probabilities for Continuous Distributions</a></li>
<li class="chapter" data-level="8.10" data-path="Probability.html"><a href="Probability.html#recipe-id168"><i class="fa fa-check"></i><b>8.10</b> Converting Probabilities to Quantiles</a></li>
<li class="chapter" data-level="8.11" data-path="Probability.html"><a href="Probability.html#recipe-id166"><i class="fa fa-check"></i><b>8.11</b> Plotting a Density Function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html"><i class="fa fa-check"></i><b>9</b> General Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#intro-GeneralStatistics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="9.1" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id119"><i class="fa fa-check"></i><b>9.1</b> Summarizing Your Data</a></li>
<li class="chapter" data-level="9.2" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id229"><i class="fa fa-check"></i><b>9.2</b> Calculating Relative Frequencies</a></li>
<li class="chapter" data-level="9.3" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id124"><i class="fa fa-check"></i><b>9.3</b> Tabulating Factors and Creating Contingency Tables</a></li>
<li class="chapter" data-level="9.4" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id125"><i class="fa fa-check"></i><b>9.4</b> Testing Categorical Variables for Independence</a></li>
<li class="chapter" data-level="9.5" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id143"><i class="fa fa-check"></i><b>9.5</b> Calculating Quantiles (and Quartiles) of a Dataset</a></li>
<li class="chapter" data-level="9.6" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id142"><i class="fa fa-check"></i><b>9.6</b> Inverting a Quantile</a></li>
<li class="chapter" data-level="9.7" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id133"><i class="fa fa-check"></i><b>9.7</b> Converting Data to z-Scores</a></li>
<li class="chapter" data-level="9.8" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id121"><i class="fa fa-check"></i><b>9.8</b> Testing the Mean of a Sample (t Test)</a></li>
<li class="chapter" data-level="9.9" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id123"><i class="fa fa-check"></i><b>9.9</b> Forming a Confidence Interval for a Mean</a></li>
<li class="chapter" data-level="9.10" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id135"><i class="fa fa-check"></i><b>9.10</b> Forming a Confidence Interval for a Median</a></li>
<li class="chapter" data-level="9.11" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id225"><i class="fa fa-check"></i><b>9.11</b> Testing a Sample Proportion</a></li>
<li class="chapter" data-level="9.12" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id226"><i class="fa fa-check"></i><b>9.12</b> Forming a Confidence Interval for a Proportion</a></li>
<li class="chapter" data-level="9.13" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id126"><i class="fa fa-check"></i><b>9.13</b> Testing for Normality</a></li>
<li class="chapter" data-level="9.14" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id131"><i class="fa fa-check"></i><b>9.14</b> Testing for Runs</a></li>
<li class="chapter" data-level="9.15" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id122"><i class="fa fa-check"></i><b>9.15</b> Comparing the Means of Two Samples</a></li>
<li class="chapter" data-level="9.16" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id130"><i class="fa fa-check"></i><b>9.16</b> Comparing the Locations of Two Samples Nonparametrically</a></li>
<li class="chapter" data-level="9.17" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id132"><i class="fa fa-check"></i><b>9.17</b> Testing a Correlation for Significance</a></li>
<li class="chapter" data-level="9.18" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id134"><i class="fa fa-check"></i><b>9.18</b> Testing Groups for Equal Proportions</a></li>
<li class="chapter" data-level="9.19" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id127"><i class="fa fa-check"></i><b>9.19</b> Performing Pairwise Comparisons Between Group Means</a></li>
<li class="chapter" data-level="9.20" data-path="GeneralStatistics.html"><a href="GeneralStatistics.html#recipe-id129"><i class="fa fa-check"></i><b>9.20</b> Testing Two Samples for the Same Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Graphics.html"><a href="Graphics.html"><i class="fa fa-check"></i><b>10</b> Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="Graphics.html"><a href="Graphics.html#intro-Graphics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10.1" data-path="Graphics.html"><a href="Graphics.html#recipe-id171"><i class="fa fa-check"></i><b>10.1</b> Creating a Scatter Plot</a></li>
<li class="chapter" data-level="10.2" data-path="Graphics.html"><a href="Graphics.html#recipe-id259"><i class="fa fa-check"></i><b>10.2</b> Adding a Title and Labels</a></li>
<li class="chapter" data-level="10.3" data-path="Graphics.html"><a href="Graphics.html#recipe-id261"><i class="fa fa-check"></i><b>10.3</b> Adding (or Removing) a Grid</a></li>
<li class="chapter" data-level="10.4" data-path="Graphics.html"><a href="Graphics.html#recipe-theme"><i class="fa fa-check"></i><b>10.4</b> Applying a Theme to a ggplot Figure</a></li>
<li class="chapter" data-level="10.5" data-path="Graphics.html"><a href="Graphics.html#recipe-id262"><i class="fa fa-check"></i><b>10.5</b> Creating a Scatter Plot of Multiple Groups</a></li>
<li class="chapter" data-level="10.6" data-path="Graphics.html"><a href="Graphics.html#recipe-id260"><i class="fa fa-check"></i><b>10.6</b> Adding (or Removing) a Legend</a></li>
<li class="chapter" data-level="10.7" data-path="Graphics.html"><a href="Graphics.html#recipe-id217"><i class="fa fa-check"></i><b>10.7</b> Plotting the Regression Line of a Scatter Plot</a></li>
<li class="chapter" data-level="10.8" data-path="Graphics.html"><a href="Graphics.html#recipe-id184"><i class="fa fa-check"></i><b>10.8</b> Plotting All Variables Against All Other Variables</a></li>
<li class="chapter" data-level="10.9" data-path="Graphics.html"><a href="Graphics.html#recipe-id185"><i class="fa fa-check"></i><b>10.9</b> Creating One Scatter Plot for Each Group</a></li>
<li class="chapter" data-level="10.10" data-path="Graphics.html"><a href="Graphics.html#recipe-id175"><i class="fa fa-check"></i><b>10.10</b> Creating a Bar Chart</a></li>
<li class="chapter" data-level="10.11" data-path="Graphics.html"><a href="Graphics.html#recipe-id177"><i class="fa fa-check"></i><b>10.11</b> Adding Confidence Intervals to a Bar Chart</a></li>
<li class="chapter" data-level="10.12" data-path="Graphics.html"><a href="Graphics.html#recipe-id176"><i class="fa fa-check"></i><b>10.12</b> Coloring a Bar Chart</a></li>
<li class="chapter" data-level="10.13" data-path="Graphics.html"><a href="Graphics.html#recipe-id174"><i class="fa fa-check"></i><b>10.13</b> Plotting a Line from x and y Points</a></li>
<li class="chapter" data-level="10.14" data-path="Graphics.html"><a href="Graphics.html#recipe-id256"><i class="fa fa-check"></i><b>10.14</b> Changing the Type, Width, or Color of a Line</a></li>
<li class="chapter" data-level="10.15" data-path="Graphics.html"><a href="Graphics.html#recipe-id263"><i class="fa fa-check"></i><b>10.15</b> Plotting Multiple Datasets</a></li>
<li class="chapter" data-level="10.16" data-path="Graphics.html"><a href="Graphics.html#recipe-id186"><i class="fa fa-check"></i><b>10.16</b> Adding Vertical or Horizontal Lines</a></li>
<li class="chapter" data-level="10.17" data-path="Graphics.html"><a href="Graphics.html#recipe-id178"><i class="fa fa-check"></i><b>10.17</b> Creating a Boxplot</a></li>
<li class="chapter" data-level="10.18" data-path="Graphics.html"><a href="Graphics.html#recipe-id179"><i class="fa fa-check"></i><b>10.18</b> Creating One Boxplot for Each Factor Level</a></li>
<li class="chapter" data-level="10.19" data-path="Graphics.html"><a href="Graphics.html#recipe-id182"><i class="fa fa-check"></i><b>10.19</b> Creating a Histogram</a></li>
<li class="chapter" data-level="10.20" data-path="Graphics.html"><a href="Graphics.html#recipe-id183"><i class="fa fa-check"></i><b>10.20</b> Adding a Density Estimate to a Histogram</a></li>
<li class="chapter" data-level="10.21" data-path="Graphics.html"><a href="Graphics.html#recipe-id180"><i class="fa fa-check"></i><b>10.21</b> Creating a Normal QuantileâQuantile Plot</a></li>
<li class="chapter" data-level="10.22" data-path="Graphics.html"><a href="Graphics.html#recipe-id181"><i class="fa fa-check"></i><b>10.22</b> Creating Other QuantileâQuantile Plots</a></li>
<li class="chapter" data-level="10.23" data-path="Graphics.html"><a href="Graphics.html#recipe-id191"><i class="fa fa-check"></i><b>10.23</b> Plotting a Variable in Multiple Colors</a></li>
<li class="chapter" data-level="10.24" data-path="Graphics.html"><a href="Graphics.html#recipe-id192"><i class="fa fa-check"></i><b>10.24</b> Graphing a Function</a></li>
<li class="chapter" data-level="10.25" data-path="Graphics.html"><a href="Graphics.html#recipe-id190"><i class="fa fa-check"></i><b>10.25</b> Displaying Several Figures on One Page</a></li>
<li class="chapter" data-level="10.26" data-path="Graphics.html"><a href="Graphics.html#recipe-id188"><i class="fa fa-check"></i><b>10.26</b> Writing Your Plot to a File</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html"><i class="fa fa-check"></i><b>11</b> Linear Regression and ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#intro-LinearRegressionAndANOVA"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id203"><i class="fa fa-check"></i><b>11.1</b> Performing Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id204"><i class="fa fa-check"></i><b>11.2</b> Performing Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.3" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id231"><i class="fa fa-check"></i><b>11.3</b> Getting Regression Statistics</a></li>
<li class="chapter" data-level="11.4" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id240"><i class="fa fa-check"></i><b>11.4</b> Understanding the Regression Summary</a></li>
<li class="chapter" data-level="11.5" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id205"><i class="fa fa-check"></i><b>11.5</b> Performing Linear Regression Without an Intercept</a></li>
<li class="chapter" data-level="11.6" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#title-highcor"><i class="fa fa-check"></i><b>11.6</b> Regressing Only Variables That Highly Correlate with Your Dependent Variable</a></li>
<li class="chapter" data-level="11.7" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id206"><i class="fa fa-check"></i><b>11.7</b> Performing Linear Regression with Interaction Terms</a></li>
<li class="chapter" data-level="11.8" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id236"><i class="fa fa-check"></i><b>11.8</b> Selecting the Best Regression Variables</a></li>
<li class="chapter" data-level="11.9" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id209"><i class="fa fa-check"></i><b>11.9</b> Regressing on a Subset of Your Data</a></li>
<li class="chapter" data-level="11.10" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id244"><i class="fa fa-check"></i><b>11.10</b> Using an Expression Inside a Regression Formula</a></li>
<li class="chapter" data-level="11.11" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id243"><i class="fa fa-check"></i><b>11.11</b> Regressing on a Polynomial</a></li>
<li class="chapter" data-level="11.12" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id208"><i class="fa fa-check"></i><b>11.12</b> Regressing on Transformed Data</a></li>
<li class="chapter" data-level="11.13" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id210"><i class="fa fa-check"></i><b>11.13</b> Finding the Best Power Transformation (BoxâCox Procedure)</a></li>
<li class="chapter" data-level="11.14" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id211"><i class="fa fa-check"></i><b>11.14</b> Forming Confidence Intervals for Regression Coefficients</a></li>
<li class="chapter" data-level="11.15" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id216"><i class="fa fa-check"></i><b>11.15</b> Plotting Regression Residuals</a></li>
<li class="chapter" data-level="11.16" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id212"><i class="fa fa-check"></i><b>11.16</b> Diagnosing a Linear Regression</a></li>
<li class="chapter" data-level="11.17" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id233"><i class="fa fa-check"></i><b>11.17</b> Identifying Influential Observations</a></li>
<li class="chapter" data-level="11.18" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id213"><i class="fa fa-check"></i><b>11.18</b> Testing Residuals for Autocorrelation (DurbinâWatson Test)</a></li>
<li class="chapter" data-level="11.19" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id214"><i class="fa fa-check"></i><b>11.19</b> Predicting New Values</a></li>
<li class="chapter" data-level="11.20" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id215"><i class="fa fa-check"></i><b>11.20</b> Forming Prediction Intervals</a></li>
<li class="chapter" data-level="11.21" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id218"><i class="fa fa-check"></i><b>11.21</b> Performing One-Way ANOVA</a></li>
<li class="chapter" data-level="11.22" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id221"><i class="fa fa-check"></i><b>11.22</b> Creating an Interaction Plot</a></li>
<li class="chapter" data-level="11.23" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id220"><i class="fa fa-check"></i><b>11.23</b> Finding Differences Between Means of Groups</a></li>
<li class="chapter" data-level="11.24" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id228"><i class="fa fa-check"></i><b>11.24</b> Performing Robust ANOVA (KruskalâWallis Test)</a></li>
<li class="chapter" data-level="11.25" data-path="LinearRegressionAndANOVA.html"><a href="LinearRegressionAndANOVA.html#recipe-id232"><i class="fa fa-check"></i><b>11.25</b> Comparing Models by Using ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="UsefulTricks.html"><a href="UsefulTricks.html"><i class="fa fa-check"></i><b>12</b> Useful Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="UsefulTricks.html"><a href="UsefulTricks.html#intro-UsefulTricks"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12.1" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id278"><i class="fa fa-check"></i><b>12.1</b> Peeking at Your Data</a></li>
<li class="chapter" data-level="12.2" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id271"><i class="fa fa-check"></i><b>12.2</b> Printing the Result of an Assignment</a></li>
<li class="chapter" data-level="12.3" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id138"><i class="fa fa-check"></i><b>12.3</b> Summing Rows and Columns</a></li>
<li class="chapter" data-level="12.4" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id112"><i class="fa fa-check"></i><b>12.4</b> Printing Data in Columns</a></li>
<li class="chapter" data-level="12.5" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id137"><i class="fa fa-check"></i><b>12.5</b> Binning Your Data</a></li>
<li class="chapter" data-level="12.6" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id116"><i class="fa fa-check"></i><b>12.6</b> Finding the Position of a Particular Value</a></li>
<li class="chapter" data-level="12.7" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id103"><i class="fa fa-check"></i><b>12.7</b> Selecting Every nth Element of a Vector</a></li>
<li class="chapter" data-level="12.8" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id107"><i class="fa fa-check"></i><b>12.8</b> Finding Minimums or Maximums</a></li>
<li class="chapter" data-level="12.9" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id110"><i class="fa fa-check"></i><b>12.9</b> Generating All Combinations of Several Variables</a></li>
<li class="chapter" data-level="12.10" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id153"><i class="fa fa-check"></i><b>12.10</b> Flattening a Data Frame</a></li>
<li class="chapter" data-level="12.11" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id247"><i class="fa fa-check"></i><b>12.11</b> Sorting a Data Frame</a></li>
<li class="chapter" data-level="12.12" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id223"><i class="fa fa-check"></i><b>12.12</b> Stripping Attributes from a Variable</a></li>
<li class="chapter" data-level="12.13" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id202"><i class="fa fa-check"></i><b>12.13</b> Revealing the Structure of an Object</a></li>
<li class="chapter" data-level="12.14" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id224"><i class="fa fa-check"></i><b>12.14</b> Timing Your Code</a></li>
<li class="chapter" data-level="12.15" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id113"><i class="fa fa-check"></i><b>12.15</b> Suppressing Warnings and Error Messages</a></li>
<li class="chapter" data-level="12.16" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id118"><i class="fa fa-check"></i><b>12.16</b> Taking Function Arguments from a List</a></li>
<li class="chapter" data-level="12.17" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id114"><i class="fa fa-check"></i><b>12.17</b> Defining Your Own Binary Operators</a></li>
<li class="chapter" data-level="12.18" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id111"><i class="fa fa-check"></i><b>12.18</b> Suppressing the Startup Message</a></li>
<li class="chapter" data-level="12.19" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-id106"><i class="fa fa-check"></i><b>12.19</b> Getting and Setting Environment Variables</a></li>
<li class="chapter" data-level="12.20" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-codesections"><i class="fa fa-check"></i><b>12.20</b> Use Code Sections</a></li>
<li class="chapter" data-level="12.21" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_local"><i class="fa fa-check"></i><b>12.21</b> Executing R in Parallel Locally</a></li>
<li class="chapter" data-level="12.22" data-path="UsefulTricks.html"><a href="UsefulTricks.html#recipe-parallel_remote"><i class="fa fa-check"></i><b>12.22</b> Executing R in Parallel Remotely</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="BeyondBasics.html"><a href="BeyondBasics.html"><i class="fa fa-check"></i><b>13</b> Beyond Basic Numerics and Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="BeyondBasics.html"><a href="BeyondBasics.html#intro-BeyondBasics"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="13.1" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id234"><i class="fa fa-check"></i><b>13.1</b> Minimizing or Maximizing a Single-Parameter Function</a></li>
<li class="chapter" data-level="13.2" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id235"><i class="fa fa-check"></i><b>13.2</b> Minimizing or Maximizing a Multiparameter Function</a></li>
<li class="chapter" data-level="13.3" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id140"><i class="fa fa-check"></i><b>13.3</b> Calculating Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="13.4" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id162"><i class="fa fa-check"></i><b>13.4</b> Performing Principal Component Analysis</a></li>
<li class="chapter" data-level="13.5" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id264"><i class="fa fa-check"></i><b>13.5</b> Performing Simple Orthogonal Regression</a></li>
<li class="chapter" data-level="13.6" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id160"><i class="fa fa-check"></i><b>13.6</b> Finding Clusters in Your Data</a></li>
<li class="chapter" data-level="13.7" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id161"><i class="fa fa-check"></i><b>13.7</b> Predicting a Binary-Valued Variable (Logistic Regression)</a></li>
<li class="chapter" data-level="13.8" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id159"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping a Statistic</a></li>
<li class="chapter" data-level="13.9" data-path="BeyondBasics.html"><a href="BeyondBasics.html#recipe-id193"><i class="fa fa-check"></i><b>13.9</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html"><i class="fa fa-check"></i><b>14</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14.1" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id076"><i class="fa fa-check"></i><b>14.1</b> Representing Time Series Data</a></li>
<li class="chapter" data-level="14.2" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id089"><i class="fa fa-check"></i><b>14.2</b> Plotting Time Series Data</a></li>
<li class="chapter" data-level="14.3" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id077"><i class="fa fa-check"></i><b>14.3</b> Extracting the Oldest or Newest Observations</a></li>
<li class="chapter" data-level="14.4" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id281"><i class="fa fa-check"></i><b>14.4</b> Subsetting a Time Series</a></li>
<li class="chapter" data-level="14.5" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id079"><i class="fa fa-check"></i><b>14.5</b> Merging Several Time Series</a></li>
<li class="chapter" data-level="14.6" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id239"><i class="fa fa-check"></i><b>14.6</b> Filling or Padding a Time Series</a></li>
<li class="chapter" data-level="14.7" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id280"><i class="fa fa-check"></i><b>14.7</b> Lagging a Time Series</a></li>
<li class="chapter" data-level="14.8" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id141"><i class="fa fa-check"></i><b>14.8</b> Computing Successive Differences</a></li>
<li class="chapter" data-level="14.9" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id080"><i class="fa fa-check"></i><b>14.9</b> Performing Calculations on Time Series</a></li>
<li class="chapter" data-level="14.10" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id279"><i class="fa fa-check"></i><b>14.10</b> Computing a Moving Average</a></li>
<li class="chapter" data-level="14.11" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id282"><i class="fa fa-check"></i><b>14.11</b> Applying a Function by Calendar Period</a></li>
<li class="chapter" data-level="14.12" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id081"><i class="fa fa-check"></i><b>14.12</b> Applying a Rolling Function</a></li>
<li class="chapter" data-level="14.13" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id082"><i class="fa fa-check"></i><b>14.13</b> Plotting the Autocorrelation Function</a></li>
<li class="chapter" data-level="14.14" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id104"><i class="fa fa-check"></i><b>14.14</b> Testing a Time Series for Autocorrelation</a></li>
<li class="chapter" data-level="14.15" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id083"><i class="fa fa-check"></i><b>14.15</b> Plotting the Partial Autocorrelation Function</a></li>
<li class="chapter" data-level="14.16" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id084"><i class="fa fa-check"></i><b>14.16</b> Finding Lagged Correlations Between Two Time Series</a></li>
<li class="chapter" data-level="14.17" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id088"><i class="fa fa-check"></i><b>14.17</b> Detrending a Time Series</a></li>
<li class="chapter" data-level="14.18" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id085"><i class="fa fa-check"></i><b>14.18</b> Fitting an ARIMA Model</a></li>
<li class="chapter" data-level="14.19" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id237"><i class="fa fa-check"></i><b>14.19</b> Removing Insignificant ARIMA Coefficients</a></li>
<li class="chapter" data-level="14.20" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id238"><i class="fa fa-check"></i><b>14.20</b> Running Diagnostics on an ARIMA Model</a></li>
<li class="chapter" data-level="14.21" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id086"><i class="fa fa-check"></i><b>14.21</b> Making Forecasts from an ARIMA Model</a></li>
<li class="chapter" data-level="14.22" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-plotting_forecast"><i class="fa fa-check"></i><b>14.22</b> Plotting a Forecast</a></li>
<li class="chapter" data-level="14.23" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id087"><i class="fa fa-check"></i><b>14.23</b> Testing for Mean Reversion</a></li>
<li class="chapter" data-level="14.24" data-path="TimeSeriesAnalysis.html"><a href="TimeSeriesAnalysis.html#recipe-id195"><i class="fa fa-check"></i><b>14.24</b> Smoothing a Time Series</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html"><i class="fa fa-check"></i><b>15</b> Simple Programming</a>
<ul>
<li class="chapter" data-level="" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#intro-SimpleProgramming"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="15.1" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-creating_if_logic"><i class="fa fa-check"></i><b>15.1</b> Choosing Between Two Alternatives: if-else</a></li>
<li class="chapter" data-level="15.2" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-for_loop"><i class="fa fa-check"></i><b>15.2</b> Iterating with a Loop</a></li>
<li class="chapter" data-level="15.3" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-id117"><i class="fa fa-check"></i><b>15.3</b> Defining a Function</a></li>
<li class="chapter" data-level="15.4" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-variable"><i class="fa fa-check"></i><b>15.4</b> Creating a Local Variable</a></li>
<li class="chapter" data-level="15.5" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#choosing-between-multiple-alternatives-switch"><i class="fa fa-check"></i><b>15.5</b> Choosing Between Multiple Alternatives: switch</a></li>
<li class="chapter" data-level="15.6" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-title"><i class="fa fa-check"></i><b>15.6</b> Defining Defaults for Function Parameters</a></li>
<li class="chapter" data-level="15.7" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#signaling-errors"><i class="fa fa-check"></i><b>15.7</b> Signaling Errors</a></li>
<li class="chapter" data-level="15.8" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#protecting-against-errors"><i class="fa fa-check"></i><b>15.8</b> Protecting Against Errors</a></li>
<li class="chapter" data-level="15.9" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-anon-function"><i class="fa fa-check"></i><b>15.9</b> Creating an Anonymous Function</a></li>
<li class="chapter" data-level="15.10" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#creating-a-collection-of-reusable-functions"><i class="fa fa-check"></i><b>15.10</b> Creating a Collection of Reusable Functions</a></li>
<li class="chapter" data-level="15.11" data-path="SimpleProgramming.html"><a href="SimpleProgramming.html#recipe-indent"><i class="fa fa-check"></i><b>15.11</b> Automatically Reindent Code</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RMarkdown.html"><a href="RMarkdown.html"><i class="fa fa-check"></i><b>16</b> R Markdown and Publishing</a>
<ul>
<li class="chapter" data-level="" data-path="RMarkdown.html"><a href="RMarkdown.html#intro-Rmd_pub"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="16.1" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-new_doc"><i class="fa fa-check"></i><b>16.1</b> Creating a New Document</a></li>
<li class="chapter" data-level="16.2" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-metadata"><i class="fa fa-check"></i><b>16.2</b> Adding a Title, Author, or Date</a></li>
<li class="chapter" data-level="16.3" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc-text"><i class="fa fa-check"></i><b>16.3</b> Formatting Document Text</a></li>
<li class="chapter" data-level="16.4" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-headings"><i class="fa fa-check"></i><b>16.4</b> Inserting Document Headings</a></li>
<li class="chapter" data-level="16.5" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-list"><i class="fa fa-check"></i><b>16.5</b> Inserting a List</a></li>
<li class="chapter" data-level="16.6" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-exec_r"><i class="fa fa-check"></i><b>16.6</b> Showing Output from R Code</a></li>
<li class="chapter" data-level="16.7" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-code-results"><i class="fa fa-check"></i><b>16.7</b> Controlling Which Code and Results Are Shown</a></li>
<li class="chapter" data-level="16.8" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-doc_plot"><i class="fa fa-check"></i><b>16.8</b> Inserting a Plot</a></li>
<li class="chapter" data-level="16.9" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-static-table"><i class="fa fa-check"></i><b>16.9</b> Inserting a Table</a></li>
<li class="chapter" data-level="16.10" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-tables"><i class="fa fa-check"></i><b>16.10</b> Inserting a Table of Data</a></li>
<li class="chapter" data-level="16.11" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-equations"><i class="fa fa-check"></i><b>16.11</b> Inserting Math Equations</a></li>
<li class="chapter" data-level="16.12" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-html"><i class="fa fa-check"></i><b>16.12</b> Generating HTML Output</a></li>
<li class="chapter" data-level="16.13" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-pdf"><i class="fa fa-check"></i><b>16.13</b> Generating PDF Output</a></li>
<li class="chapter" data-level="16.14" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-word"><i class="fa fa-check"></i><b>16.14</b> Generating Microsoft Word Output</a></li>
<li class="chapter" data-level="16.15" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-prez"><i class="fa fa-check"></i><b>16.15</b> Generating Presentation Output</a></li>
<li class="chapter" data-level="16.16" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-param_report"><i class="fa fa-check"></i><b>16.16</b> Creating a Parameterized Report</a></li>
<li class="chapter" data-level="16.17" data-path="RMarkdown.html"><a href="RMarkdown.html#recipe-rmd_org"><i class="fa fa-check"></i><b>16.17</b> Organizing Your R Markdown Workflow</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cookbook, 2nd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="GeneralStatistics" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> General Statistics<a href="GeneralStatistics.html#GeneralStatistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro-GeneralStatistics" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="GeneralStatistics.html#intro-GeneralStatistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Any significant application of R includes statistics or models or
graphics. This chapter addresses the statistics. Some recipes simply
describe how to calculate a statistic, such as relative frequency. Most
recipes involve statistical tests or confidence intervals. The
statistical tests let you choose between two competing hypotheses; that
paradigm is described next. Confidence intervals reflect the likely
range of a population parameter and are calculated based on your data
sample.</p>
<div id="null-hypotheses-alternative-hypotheses-and-p-values" class="section level3 unnumbered hasAnchor">
<h3>Null Hypotheses, Alternative Hypotheses, and p-Values<a href="GeneralStatistics.html#null-hypotheses-alternative-hypotheses-and-p-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many of the statistical tests in this chapter use a time-tested paradigm
of statistical inference. In the paradigm, we have one or two data
samples. We also have two competing hypotheses, either of which could
reasonably be true.</p>
<p>One hypothesis, called the <em>null hypothesis</em>, is that <em>nothing happened</em>:
the mean was unchanged; the treatment had no effect; you got the
expected answer; the model did not improve; and so forth.</p>
<p>The other hypothesis, called the <em>alternative hypothesis</em>, is that
<em>something happened</em>: the mean rose; the treatment improved the
patientsâ health; you got an unexpected answer; the model fit better;
and so forth.</p>
<p>We want to determine which hypothesis is more likely in light of the
data:</p>
<ol style="list-style-type: decimal">
<li><p>To begin, we assume that the null hypothesis is true.</p></li>
<li><p>We calculate a test statistic. It could be something simple, such as
the mean of the sample, or it could be quite complex. The critical
requirement is that we must know the statisticâs distribution. We
might know the distribution of the sample mean, for example, by
invoking the Central Limit Theorem.</p></li>
<li><p>From the statistic and its distribution we can calculate a <em>p</em>-value,
the probability of a test statistic value as extreme or more extreme
than the one we observed, while assuming that the null hypothesis
is true.</p></li>
<li><p>If the <em>p</em>-value is too small, we have strong evidence against the
null hypothesis. This is called <em>rejecting</em> the null hypothesis.</p></li>
<li><p>If the <em>p</em>-value is not small, then we have no such evidence. This is
called <em>failing to reject</em> the null hypothesis.</p></li>
</ol>
<p>There is one necessary decision here: When is a <em>p</em>-value âtoo smallâ?</p>
<blockquote>
<p><strong>Note</strong></p>
<p>In this book, we follow the common convention that we reject the null
hypothesis when <em>p</em> &lt; 0.05 and fail to reject it when <em>p</em> &gt;
0.05. In statistical terminology, we chose a significance level of <em>Î±</em>
= 0.05 to define the border between strong evidence and insufficient
evidence against the null hypothesis.</p>
</blockquote>
<p>But the real answer is, âit depends.â Your chosen significance level
depends on your problem domain. The conventional limit of <em>p</em> &lt; 0.05
works for many problems. In our work, the data are especially noisy and so
we are often satisfied with <em>p</em> &lt; 0.10. For someone working in
high-risk areas, <em>p</em> &lt; 0.01 or <em>p</em> &lt; 0.001 might be necessary.</p>
<p>In the recipes, we mention which tests include a <em>p</em>-value so that you
can compare the <em>p</em>-value against your chosen significance level of <em>Î±</em>.
We worded the recipes to help you interpret the comparison. Here is the
wording from Recipe <a href="GeneralStatistics.html#recipe-id125">9.4</a>, <a href="GeneralStatistics.html#recipe-id125">Testing Categorical Variables for Independence</a>, a test
for the independence of two factors:</p>
<blockquote>
<p>Conventionally, a <em>p</em>-value of less than 0.05 indicates that the
variables are likely not independent whereas a <em>p</em>-value exceeding
0.05 fails to provide any such evidence.</p>
</blockquote>
<p>This is a compact way of saying:</p>
<ul>
<li><p>The null hypothesis is that the variables are independent.</p></li>
<li><p>The alternative hypothesis is that the variables are
not independent.</p></li>
<li><p>For <em>Î±</em> = 0.05, if <em>p</em> &lt; 0.05 then we reject the null hypothesis,
giving strong evidence that the variables are not independent; if
<em>p</em> &gt; 0.05, we fail to reject the null hypothesis.</p></li>
<li><p>You are free to choose your own <em>Î±</em>, of course, in which case your
decision to reject or fail to reject might be different.</p></li>
</ul>
<p>Remember, the recipe states the <em>informal interpretation</em> of the test
results, not the rigorous mathematical interpretation. We use colloquial
language in the hope that it will guide you toward a practical
understanding and application of the test. If the precise semantics of
hypothesis testing is critical for your work, we urge you to consult the
reference cited under <a href="GeneralStatistics.html#see_also_9">See Also</a> or one of the other fine
textbooks on mathematical statistics.</p>
</div>
<div id="confidence-intervals" class="section level3 unnumbered hasAnchor">
<h3>Confidence Intervals<a href="GeneralStatistics.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hypothesis testing is a well-understood mathematical procedure, but it
can be frustrating. First, the semantics is tricky. The test does not
reach a definite, useful conclusion. You might get strong evidence
against the null hypothesis, but thatâs all youâll get. Second, it does
not give you a number, only evidence.</p>
<p>If you want numbers then use confidence intervals, which bound the
estimate of a population parameter at a given level of confidence.
Recipes in this chapter can calculate confidence intervals for means,
medians, and proportions of a population.</p>
<p>For example, Recipe <a href="GeneralStatistics.html#recipe-id123">9.9</a>, <a href="GeneralStatistics.html#recipe-id123">âForming a Confidence Interval for a Meanâ</a>,
calculates a 95% confidence interval for the population mean based on
sample data. The interval is 97.16 &lt; <em>Î¼</em> &lt; 103.98, which means
there is a 95% probability that the populationâs mean, <em>Î¼</em>, is between
97.16 and 103.98.</p>
</div>
<div id="see_also_9" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also_9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Statistical terminology and conventions can vary. This book generally
follows the conventions of <em>Mathematical Statistics with Applications</em>,
6th ed., by Dennis Wackerly et al.Â (Duxbury Press). We recommend this book also
for learning more about the statistical tests described in this chapter.</p>
</div>
</div>
<div id="recipe-id119" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Summarizing Your Data<a href="GeneralStatistics.html#recipe-id119" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id119" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id119" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want a basic statistical summary of your data.</p>
</div>
<div id="solution-id119" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id119" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>summary</code> function gives some useful statistics for vectors,
matrices, factors, and data frames:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="GeneralStatistics.html#cb545-1" tabindex="-1"></a><span class="fu">summary</span>(vec)</span>
<span id="cb545-2"><a href="GeneralStatistics.html#cb545-2" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb545-3"><a href="GeneralStatistics.html#cb545-3" tabindex="-1"></a><span class="co">#&gt;     0.0     0.5     1.0     1.6     1.9    33.0</span></span></code></pre></div>
</div>
<div id="discussion-id119" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id119" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Solution exhibits the summary of a vector. The <code>1st Qu.</code> and <code>3rd Qu.</code> are the first and third quartile,
respectively. Having both the median and mean is useful because you can
quickly detect skew. The preceding Solution, for example, shows a mean that is
larger than the median; this indicates a possible skew to the right, as one would expect from a lognormal distribution.</p>
<p>The summary of a matrix works column by column. Here we see the summary
of a matrix, <code>mat</code>, with three columns named <code>Samp1</code>, <code>Samp2</code>, and <code>Samp3</code>:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="GeneralStatistics.html#cb546-1" tabindex="-1"></a><span class="fu">summary</span>(mat)</span>
<span id="cb546-2"><a href="GeneralStatistics.html#cb546-2" tabindex="-1"></a><span class="co">#&gt;      Samp1           Samp2            Samp3      </span></span>
<span id="cb546-3"><a href="GeneralStatistics.html#cb546-3" tabindex="-1"></a><span class="co">#&gt;  Min.   :  1.0   Min.   :-2.943   Min.   : 0.04  </span></span>
<span id="cb546-4"><a href="GeneralStatistics.html#cb546-4" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 25.8   1st Qu.:-0.774   1st Qu.: 0.39  </span></span>
<span id="cb546-5"><a href="GeneralStatistics.html#cb546-5" tabindex="-1"></a><span class="co">#&gt;  Median : 50.5   Median :-0.052   Median : 0.85  </span></span>
<span id="cb546-6"><a href="GeneralStatistics.html#cb546-6" tabindex="-1"></a><span class="co">#&gt;  Mean   : 50.5   Mean   :-0.067   Mean   : 1.60  </span></span>
<span id="cb546-7"><a href="GeneralStatistics.html#cb546-7" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 75.2   3rd Qu.: 0.684   3rd Qu.: 2.12  </span></span>
<span id="cb546-8"><a href="GeneralStatistics.html#cb546-8" tabindex="-1"></a><span class="co">#&gt;  Max.   :100.0   Max.   : 2.150   Max.   :13.18</span></span></code></pre></div>
<p>The summary of a factor gives counts:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="GeneralStatistics.html#cb547-1" tabindex="-1"></a><span class="fu">summary</span>(fac)</span>
<span id="cb547-2"><a href="GeneralStatistics.html#cb547-2" tabindex="-1"></a><span class="co">#&gt; Maybe    No   Yes </span></span>
<span id="cb547-3"><a href="GeneralStatistics.html#cb547-3" tabindex="-1"></a><span class="co">#&gt;    43    26    31</span></span></code></pre></div>
<p>The summary of a character vector is pretty useless, just the vector length:</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="GeneralStatistics.html#cb548-1" tabindex="-1"></a><span class="fu">summary</span>(char)</span>
<span id="cb548-2"><a href="GeneralStatistics.html#cb548-2" tabindex="-1"></a><span class="co">#&gt;    Length     Class      Mode </span></span>
<span id="cb548-3"><a href="GeneralStatistics.html#cb548-3" tabindex="-1"></a><span class="co">#&gt;       100 character character</span></span></code></pre></div>
<p>The summary of a data frame incorporates all these features. It works
column by column, giving an appropriate summary according to the column
type. Numeric values receive a statistical summary and factors are
counted (character strings are not summarized):</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="GeneralStatistics.html#cb549-1" tabindex="-1"></a>suburbs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./data/suburbs.txt&quot;</span>)</span>
<span id="cb549-2"><a href="GeneralStatistics.html#cb549-2" tabindex="-1"></a><span class="fu">summary</span>(suburbs)</span>
<span id="cb549-3"><a href="GeneralStatistics.html#cb549-3" tabindex="-1"></a><span class="co">#&gt;      city              county             state                pop         </span></span>
<span id="cb549-4"><a href="GeneralStatistics.html#cb549-4" tabindex="-1"></a><span class="co">#&gt;  Length:17          Length:17          Length:17          Min.   :   5428  </span></span>
<span id="cb549-5"><a href="GeneralStatistics.html#cb549-5" tabindex="-1"></a><span class="co">#&gt;  Class :character   Class :character   Class :character   1st Qu.:  72616  </span></span>
<span id="cb549-6"><a href="GeneralStatistics.html#cb549-6" tabindex="-1"></a><span class="co">#&gt;  Mode  :character   Mode  :character   Mode  :character   Median :  83048  </span></span>
<span id="cb549-7"><a href="GeneralStatistics.html#cb549-7" tabindex="-1"></a><span class="co">#&gt;                                                           Mean   : 249770  </span></span>
<span id="cb549-8"><a href="GeneralStatistics.html#cb549-8" tabindex="-1"></a><span class="co">#&gt;                                                           3rd Qu.: 102746  </span></span>
<span id="cb549-9"><a href="GeneralStatistics.html#cb549-9" tabindex="-1"></a><span class="co">#&gt;                                                           Max.   :2853114</span></span></code></pre></div>
<p>The âsummaryâ of a list is pretty funky: just the data type of each list member.
Here is a <code>summary</code> of a list of vectors:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="GeneralStatistics.html#cb550-1" tabindex="-1"></a><span class="fu">summary</span>(vec_list)</span>
<span id="cb550-2"><a href="GeneralStatistics.html#cb550-2" tabindex="-1"></a><span class="co">#&gt;   Length Class  Mode     </span></span>
<span id="cb550-3"><a href="GeneralStatistics.html#cb550-3" tabindex="-1"></a><span class="co">#&gt; x 100    -none- numeric  </span></span>
<span id="cb550-4"><a href="GeneralStatistics.html#cb550-4" tabindex="-1"></a><span class="co">#&gt; y 100    -none- numeric  </span></span>
<span id="cb550-5"><a href="GeneralStatistics.html#cb550-5" tabindex="-1"></a><span class="co">#&gt; z 100    -none- character</span></span></code></pre></div>
<p>To summarize the data inside a list of vectors, map <code>summary</code> to each list element:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="GeneralStatistics.html#cb551-1" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb551-2"><a href="GeneralStatistics.html#cb551-2" tabindex="-1"></a><span class="fu">map</span>(vec_list, summary)</span>
<span id="cb551-3"><a href="GeneralStatistics.html#cb551-3" tabindex="-1"></a><span class="co">#&gt; $x</span></span>
<span id="cb551-4"><a href="GeneralStatistics.html#cb551-4" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb551-5"><a href="GeneralStatistics.html#cb551-5" tabindex="-1"></a><span class="co">#&gt;  -2.572  -0.583   0.006   0.018   0.710   2.413 </span></span>
<span id="cb551-6"><a href="GeneralStatistics.html#cb551-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb551-7"><a href="GeneralStatistics.html#cb551-7" tabindex="-1"></a><span class="co">#&gt; $y</span></span>
<span id="cb551-8"><a href="GeneralStatistics.html#cb551-8" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb551-9"><a href="GeneralStatistics.html#cb551-9" tabindex="-1"></a><span class="co">#&gt;  -1.772  -0.740   0.024   0.027   0.597   2.293 </span></span>
<span id="cb551-10"><a href="GeneralStatistics.html#cb551-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb551-11"><a href="GeneralStatistics.html#cb551-11" tabindex="-1"></a><span class="co">#&gt; $z</span></span>
<span id="cb551-12"><a href="GeneralStatistics.html#cb551-12" tabindex="-1"></a><span class="co">#&gt;    Length     Class      Mode </span></span>
<span id="cb551-13"><a href="GeneralStatistics.html#cb551-13" tabindex="-1"></a><span class="co">#&gt;       100 character character</span></span></code></pre></div>
<p>Unfortunately, the <code>summary</code> function does not compute any measure of
variability, such as standard deviation or median absolute deviation.
This is a serious shortcoming, so we usually call <code>sd</code> or <code>mad</code> (mean absolute deviation) right after calling <code>summary</code>.</p>
</div>
<div id="see_also-id119" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id119" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipes <a href="SomeBasics.html#recipe-id101">2.6</a>, <a href="SomeBasics.html#recipe-id101">âComputing Basic Statisticsâ</a>, and <a href="DataTransformations.html#recipe-id149">6.1</a>, <a href="DataTransformations.html#recipe-id149">âApplying a Function to Each List Elementâ</a>.</p>
</div>
</div>
<div id="recipe-id229" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Calculating Relative Frequencies<a href="GeneralStatistics.html#recipe-id229" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id229" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id229" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to count the relative frequency of certain observations in your
sample.</p>
</div>
<div id="solution-id229" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id229" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Identify the interesting observations by using a logical expression;
then use the <code>mean</code> function to calculate the fraction of observations
it identifies. For example, given a vector <em>x</em>, you can find the
relative frequency of positive values in this way:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="GeneralStatistics.html#cb552-1" tabindex="-1"></a><span class="fu">mean</span>(x <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb552-2"><a href="GeneralStatistics.html#cb552-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.1</span></span></code></pre></div>
</div>
<div id="discussion-id229" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id229" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A logical expression, such as <em>x</em> &gt; 3, produces a vector of logical
values (<code>TRUE</code> and <code>FALSE</code>), one for each element of <em>x</em>. The <code>mean</code>
function converts those values to 1s and 0s, respectively, and computes
the average. This gives the fraction of values that are <code>TRUE</code>âin other
words, the relative frequency of the interesting values. In the
Solution, for example, thatâs the relative frequency of
values greater than 3.</p>
<p>The concept here is pretty simple. The tricky part is dreaming up a
suitable logical expression. Here are some examples:</p>
<dl>
<dt><code>mean(lab == "NJ")</code></dt>
<dd>
<p>Fraction of <code>lab</code> values that are New Jersey</p>
</dd>
<dt><code>mean(after &gt; before)</code></dt>
<dd>
<p>Fraction of observations for which the effect increases</p>
</dd>
<dt><code>mean(abs(x-mean(*x*)) &gt; 2*sd(*x*))</code></dt>
<dd>
<p>Fraction of observations that exceed two standard deviations from
the mean</p>
</dd>
<dt><code>mean(diff(ts) &gt;  0)</code></dt>
<dd>
<p>Fraction of observations in a time series that are larger than the
previous observation</p>
</dd>
</dl>
</div>
</div>
<div id="recipe-id124" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Tabulating Factors and Creating Contingency Tables<a href="GeneralStatistics.html#recipe-id124" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id124" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id124" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want to tabulate one factor or build a contingency table from
multiple factors.</p>
</div>
<div id="solution-id124" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id124" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>table</code> function produces counts of one factor:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="GeneralStatistics.html#cb553-1" tabindex="-1"></a><span class="fu">table</span>(f1)</span>
<span id="cb553-2"><a href="GeneralStatistics.html#cb553-2" tabindex="-1"></a><span class="co">#&gt; f1</span></span>
<span id="cb553-3"><a href="GeneralStatistics.html#cb553-3" tabindex="-1"></a><span class="co">#&gt;  a  b  c  d  e </span></span>
<span id="cb553-4"><a href="GeneralStatistics.html#cb553-4" tabindex="-1"></a><span class="co">#&gt; 17 17 22 20 24</span></span></code></pre></div>
<p>It can also produce contingency tables (cross-tabulations) from two or
more factors:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="GeneralStatistics.html#cb554-1" tabindex="-1"></a><span class="fu">table</span>(f1, f2)</span>
<span id="cb554-2"><a href="GeneralStatistics.html#cb554-2" tabindex="-1"></a><span class="co">#&gt;    f2</span></span>
<span id="cb554-3"><a href="GeneralStatistics.html#cb554-3" tabindex="-1"></a><span class="co">#&gt; f1   f  g  h</span></span>
<span id="cb554-4"><a href="GeneralStatistics.html#cb554-4" tabindex="-1"></a><span class="co">#&gt;   a  7  4  6</span></span>
<span id="cb554-5"><a href="GeneralStatistics.html#cb554-5" tabindex="-1"></a><span class="co">#&gt;   b  6  6  5</span></span>
<span id="cb554-6"><a href="GeneralStatistics.html#cb554-6" tabindex="-1"></a><span class="co">#&gt;   c 12  5  5</span></span>
<span id="cb554-7"><a href="GeneralStatistics.html#cb554-7" tabindex="-1"></a><span class="co">#&gt;   d  7  5  8</span></span>
<span id="cb554-8"><a href="GeneralStatistics.html#cb554-8" tabindex="-1"></a><span class="co">#&gt;   e  6  9  9</span></span></code></pre></div>
<p><code>table</code> works for characters, too, not only factors:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="GeneralStatistics.html#cb555-1" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(letters[<span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>], <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb555-2"><a href="GeneralStatistics.html#cb555-2" tabindex="-1"></a><span class="fu">table</span>(t1)</span>
<span id="cb555-3"><a href="GeneralStatistics.html#cb555-3" tabindex="-1"></a><span class="co">#&gt; t1</span></span>
<span id="cb555-4"><a href="GeneralStatistics.html#cb555-4" tabindex="-1"></a><span class="co">#&gt;  i  j  k </span></span>
<span id="cb555-5"><a href="GeneralStatistics.html#cb555-5" tabindex="-1"></a><span class="co">#&gt; 37 32 31</span></span></code></pre></div>
</div>
<div id="discussion-id124" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id124" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>table</code> function counts the levels of one factor or characters, such as these
counts of <code>initial</code> and <code>outcome</code> (which are factors):</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="GeneralStatistics.html#cb556-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb556-2"><a href="GeneralStatistics.html#cb556-2" tabindex="-1"></a>initial <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Maybe&quot;</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb556-3"><a href="GeneralStatistics.html#cb556-3" tabindex="-1"></a>outcome <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Pass&quot;</span>, <span class="st">&quot;Fail&quot;</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb556-4"><a href="GeneralStatistics.html#cb556-4" tabindex="-1"></a></span>
<span id="cb556-5"><a href="GeneralStatistics.html#cb556-5" tabindex="-1"></a><span class="fu">table</span>(initial)</span>
<span id="cb556-6"><a href="GeneralStatistics.html#cb556-6" tabindex="-1"></a><span class="co">#&gt; initial</span></span>
<span id="cb556-7"><a href="GeneralStatistics.html#cb556-7" tabindex="-1"></a><span class="co">#&gt; Maybe    No   Yes </span></span>
<span id="cb556-8"><a href="GeneralStatistics.html#cb556-8" tabindex="-1"></a><span class="co">#&gt;    21    39    40</span></span>
<span id="cb556-9"><a href="GeneralStatistics.html#cb556-9" tabindex="-1"></a></span>
<span id="cb556-10"><a href="GeneralStatistics.html#cb556-10" tabindex="-1"></a><span class="fu">table</span>(outcome)</span>
<span id="cb556-11"><a href="GeneralStatistics.html#cb556-11" tabindex="-1"></a><span class="co">#&gt; outcome</span></span>
<span id="cb556-12"><a href="GeneralStatistics.html#cb556-12" tabindex="-1"></a><span class="co">#&gt; Fail Pass </span></span>
<span id="cb556-13"><a href="GeneralStatistics.html#cb556-13" tabindex="-1"></a><span class="co">#&gt;   56   44</span></span></code></pre></div>
<p>The greater power of <code>table</code> is in producing contingency tables, also
known as cross-tabulations. Each cell in a contingency table counts how
many times that row/column combination occurred:</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="GeneralStatistics.html#cb557-1" tabindex="-1"></a><span class="fu">table</span>(initial, outcome)</span>
<span id="cb557-2"><a href="GeneralStatistics.html#cb557-2" tabindex="-1"></a><span class="co">#&gt;        outcome</span></span>
<span id="cb557-3"><a href="GeneralStatistics.html#cb557-3" tabindex="-1"></a><span class="co">#&gt; initial Fail Pass</span></span>
<span id="cb557-4"><a href="GeneralStatistics.html#cb557-4" tabindex="-1"></a><span class="co">#&gt;   Maybe   12    9</span></span>
<span id="cb557-5"><a href="GeneralStatistics.html#cb557-5" tabindex="-1"></a><span class="co">#&gt;   No      22   17</span></span>
<span id="cb557-6"><a href="GeneralStatistics.html#cb557-6" tabindex="-1"></a><span class="co">#&gt;   Yes     22   18</span></span></code></pre></div>
<p>This table shows that the combination of <code>initial = Yes</code> and
<code>outcome = Fail</code> occurred 13 times, the combination of <code>initial = Yes</code>
and <code>outcome = Pass</code> occurred 17 times, and so forth.</p>
</div>
<div id="see_also-id124" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id124" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>xtabs</code> function can also produce a contingency table. It has a
formula interface, which some people prefer.</p>
</div>
</div>
<div id="recipe-id125" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Testing Categorical Variables for Independence<a href="GeneralStatistics.html#recipe-id125" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id125" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id125" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have two categorical variables that are represented by factors. You
want to test them for independence using the chi-squared test.</p>
</div>
<div id="solution-id125" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id125" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>table</code> function to produce a contingency table from the two
factors. Then use the <code>summary</code> function to perform a chi-squared test
of the contingency table. In this example we have two vectors of factor values, which we created in the prior recipe:</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="GeneralStatistics.html#cb558-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">table</span>(initial, outcome))</span>
<span id="cb558-2"><a href="GeneralStatistics.html#cb558-2" tabindex="-1"></a><span class="co">#&gt; Number of cases in table: 100 </span></span>
<span id="cb558-3"><a href="GeneralStatistics.html#cb558-3" tabindex="-1"></a><span class="co">#&gt; Number of factors: 2 </span></span>
<span id="cb558-4"><a href="GeneralStatistics.html#cb558-4" tabindex="-1"></a><span class="co">#&gt; Test for independence of all factors:</span></span>
<span id="cb558-5"><a href="GeneralStatistics.html#cb558-5" tabindex="-1"></a><span class="co">#&gt;  Chisq = 0.03, df = 2, p-value = 1</span></span></code></pre></div>
<p>The output includes a <em>p</em>-value. Conventionally, a <em>p</em>-value of less
than 0.05 indicates that the variables are likely not independent,
whereas a <em>p</em>-value exceeding 0.05 fails to provide any such evidence.</p>
</div>
<div id="discussion-id125" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id125" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example performs a chi-squared test on the contingency table from Recipe <a href="GeneralStatistics.html#recipe-id124">9.3</a>,
<a href="GeneralStatistics.html#recipe-id124">âTabulating Factors and Creating Contingency Tablesâ</a>, and
yields a <em>p</em>-value of 0.2:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="GeneralStatistics.html#cb559-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">table</span>(initial, outcome))</span>
<span id="cb559-2"><a href="GeneralStatistics.html#cb559-2" tabindex="-1"></a><span class="co">#&gt; Number of cases in table: 100 </span></span>
<span id="cb559-3"><a href="GeneralStatistics.html#cb559-3" tabindex="-1"></a><span class="co">#&gt; Number of factors: 2 </span></span>
<span id="cb559-4"><a href="GeneralStatistics.html#cb559-4" tabindex="-1"></a><span class="co">#&gt; Test for independence of all factors:</span></span>
<span id="cb559-5"><a href="GeneralStatistics.html#cb559-5" tabindex="-1"></a><span class="co">#&gt;  Chisq = 0.03, df = 2, p-value = 1</span></span></code></pre></div>
<p>The large <em>p</em>-value indicates that the two factors, <code>initial</code> and
<code>outcome</code>, are probably independent. Practically speaking, we
conclude there is no connection between the variables. This makes sense, as this example data was created by simply drawing random data using the <code>sample</code> function in the prior recipe.</p>
</div>
<div id="see_also-id125" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id125" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>chisq.test</code> function can also perform this test.</p>
</div>
</div>
<div id="recipe-id143" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Calculating Quantiles (and Quartiles) of a Dataset<a href="GeneralStatistics.html#recipe-id143" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id143" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id143" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given a fraction <em>f</em>, you want to know the corresponding quantile of
your data. That is, you seek the observation <em>x</em> such that the fraction
of observations below <em>x</em> is <em>f</em>.</p>
</div>
<div id="solution-id143" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id143" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>quantile</code> function. The second argument is the fraction, <em>f</em>:</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="GeneralStatistics.html#cb560-1" tabindex="-1"></a><span class="fu">quantile</span>(vec, <span class="fl">0.95</span>)</span>
<span id="cb560-2"><a href="GeneralStatistics.html#cb560-2" tabindex="-1"></a><span class="co">#&gt; 95% </span></span>
<span id="cb560-3"><a href="GeneralStatistics.html#cb560-3" tabindex="-1"></a><span class="co">#&gt; 1.8</span></span></code></pre></div>
<p>For quartiles, simply omit the second argument altogether:</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="GeneralStatistics.html#cb561-1" tabindex="-1"></a><span class="fu">quantile</span>(vec)</span>
<span id="cb561-2"><a href="GeneralStatistics.html#cb561-2" tabindex="-1"></a><span class="co">#&gt;     0%    25%    50%    75%   100% </span></span>
<span id="cb561-3"><a href="GeneralStatistics.html#cb561-3" tabindex="-1"></a><span class="co">#&gt; -2.823 -0.900 -0.169  0.699  2.357</span></span></code></pre></div>
</div>
<div id="discussion-id143" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id143" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose <code>vec</code> contains 1,000 observations between 0 and 1. The
<code>quantile</code> function can tell you which observation delimits the lower 5%
of the data:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="GeneralStatistics.html#cb562-1" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb562-2"><a href="GeneralStatistics.html#cb562-2" tabindex="-1"></a><span class="fu">quantile</span>(vec, .<span class="dv">05</span>)</span>
<span id="cb562-3"><a href="GeneralStatistics.html#cb562-3" tabindex="-1"></a><span class="co">#&gt;     5% </span></span>
<span id="cb562-4"><a href="GeneralStatistics.html#cb562-4" tabindex="-1"></a><span class="co">#&gt; 0.0454</span></span></code></pre></div>
<p>The <code>quantile</code> documentation refers to the second argument as a
âprobability,â which is natural when we think of probability as meaning
relative frequency.</p>
<p>In true R style, the second argument can be a vector of probabilities;
in this case, <code>quantile</code> returns a vector of corresponding quantiles,
one for each probability:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="GeneralStatistics.html#cb563-1" tabindex="-1"></a><span class="fu">quantile</span>(vec, <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>))</span>
<span id="cb563-2"><a href="GeneralStatistics.html#cb563-2" tabindex="-1"></a><span class="co">#&gt;     5%    95% </span></span>
<span id="cb563-3"><a href="GeneralStatistics.html#cb563-3" tabindex="-1"></a><span class="co">#&gt; 0.0454 0.9363</span></span></code></pre></div>
<p>That is a handy way to identify the middle 90% (in this case) of the
observations.</p>
<p>If you omit the probabilities altogether, then R assumes you want the
probabilities 0, 0.25, 0.50, 0.75, and 1.0âin other words, the
quartiles:</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="GeneralStatistics.html#cb564-1" tabindex="-1"></a><span class="fu">quantile</span>(vec)</span>
<span id="cb564-2"><a href="GeneralStatistics.html#cb564-2" tabindex="-1"></a><span class="co">#&gt;       0%      25%      50%      75%     100% </span></span>
<span id="cb564-3"><a href="GeneralStatistics.html#cb564-3" tabindex="-1"></a><span class="co">#&gt; 0.000405 0.238567 0.477110 0.741725 0.999379</span></span></code></pre></div>
<p>Amazingly, the <code>quantile</code> function implements nine (yes, nine) different
algorithms for computing quantiles. Study the help page before assuming
that the default algorithm is the best one for you.</p>
</div>
</div>
<div id="recipe-id142" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Inverting a Quantile<a href="GeneralStatistics.html#recipe-id142" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id142" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id142" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given an observation <em>x</em> from your data, you want to know its
corresponding quantile. That is, you want to know what fraction of the
data is less than <em>x</em>.</p>
</div>
<div id="solution-id142" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id142" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Assuming your data is in a vector <code>vec</code>, compare the data against the
observation and then use <code>mean</code> to compute the relative frequency of
values less than <em>x</em>âsay, 1.6 as per this example.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="GeneralStatistics.html#cb565-1" tabindex="-1"></a><span class="fu">mean</span>(vec <span class="sc">&lt;</span> <span class="fl">1.6</span>)</span>
<span id="cb565-2"><a href="GeneralStatistics.html#cb565-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.932</span></span></code></pre></div>
</div>
<div id="discussion-id142" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id142" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The expression <code>vec &lt; *x*</code> compares every element of <code>vec</code> against <code>*x*</code> and
returns a vector of logical values, where the <em>n</em>th logical value is
<code>TRUE</code> if <code>vec[*n*] &lt; *x*</code>. The <code>mean</code> function converts those logical
values to <code>0</code> and <code>1</code>: <code>0</code> for <code>FALSE</code> and <code>1</code> for <code>TRUE</code>. The average of all
those <code>1</code>s and <code>0</code>s is the fraction of <code>vec</code> that is less than <code>*x*</code>, or the
inverse quantile of <code>*x*</code>.</p>
</div>
<div id="see_also-id142" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id142" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is an application of the general approach described in Recipe <a href="GeneralStatistics.html#recipe-id229">9.2</a>,
<a href="GeneralStatistics.html#recipe-id229">âCalculating Relative Frequenciesâ</a>.</p>
</div>
</div>
<div id="recipe-id133" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Converting Data to z-Scores<a href="GeneralStatistics.html#recipe-id133" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id133" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id133" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a dataset, and you want to calculate the corresponding
<em>z</em>-scores for all data elements. (This is sometimes called <em>normalizing</em>
the data.)</p>
</div>
<div id="solution-id133" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id133" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>scale</code> function:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="GeneralStatistics.html#cb566-1" tabindex="-1"></a><span class="fu">scale</span>(x)</span>
<span id="cb566-2"><a href="GeneralStatistics.html#cb566-2" tabindex="-1"></a><span class="co">#&gt;          [,1]</span></span>
<span id="cb566-3"><a href="GeneralStatistics.html#cb566-3" tabindex="-1"></a><span class="co">#&gt;  [1,]  2.2638</span></span>
<span id="cb566-4"><a href="GeneralStatistics.html#cb566-4" tabindex="-1"></a><span class="co">#&gt;  [2,] -0.0463</span></span>
<span id="cb566-5"><a href="GeneralStatistics.html#cb566-5" tabindex="-1"></a><span class="co">#&gt;  [3,] -0.9400</span></span>
<span id="cb566-6"><a href="GeneralStatistics.html#cb566-6" tabindex="-1"></a><span class="co">#&gt;  [4,] -0.7755</span></span>
<span id="cb566-7"><a href="GeneralStatistics.html#cb566-7" tabindex="-1"></a><span class="co">#&gt;  [5,]  1.0020</span></span>
<span id="cb566-8"><a href="GeneralStatistics.html#cb566-8" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.0650</span></span>
<span id="cb566-9"><a href="GeneralStatistics.html#cb566-9" tabindex="-1"></a><span class="co">#&gt;  [7,] -1.0227</span></span>
<span id="cb566-10"><a href="GeneralStatistics.html#cb566-10" tabindex="-1"></a><span class="co">#&gt;  [8,] -0.5412</span></span>
<span id="cb566-11"><a href="GeneralStatistics.html#cb566-11" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.1408</span></span>
<span id="cb566-12"><a href="GeneralStatistics.html#cb566-12" tabindex="-1"></a><span class="co">#&gt; [10,] -0.1458</span></span>
<span id="cb566-13"><a href="GeneralStatistics.html#cb566-13" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;scaled:center&quot;)</span></span>
<span id="cb566-14"><a href="GeneralStatistics.html#cb566-14" tabindex="-1"></a><span class="co">#&gt; [1] 2.53</span></span>
<span id="cb566-15"><a href="GeneralStatistics.html#cb566-15" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;scaled:scale&quot;)</span></span>
<span id="cb566-16"><a href="GeneralStatistics.html#cb566-16" tabindex="-1"></a><span class="co">#&gt; [1] 2.15</span></span></code></pre></div>
<p>This works for vectors, matrices, and data frames. In the case of a
vector, <code>scale</code> returns the vector of normalized values. In the case of
matrices and data frames, <code>scale</code> normalizes each column independently
and returns columns of normalized values in a matrix.</p>
</div>
<div id="discussion-id133" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id133" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You might also want to normalize a single value <em>y</em> relative to a
dataset <em>x</em>. You can do so by using vectorized operations as follows:</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="GeneralStatistics.html#cb567-1" tabindex="-1"></a>(y <span class="sc">-</span> <span class="fu">mean</span>(x)) <span class="sc">/</span> <span class="fu">sd</span>(x)</span>
<span id="cb567-2"><a href="GeneralStatistics.html#cb567-2" tabindex="-1"></a><span class="co">#&gt; [1] -0.619</span></span></code></pre></div>
</div>
</div>
<div id="recipe-id121" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Testing the Mean of a Sample (t Test)<a href="GeneralStatistics.html#recipe-id121" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id121" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id121" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a sample from a population. Given this sample, you want to know
if the mean of the population could reasonably be a particular value <em>m</em>.</p>
</div>
<div id="solution-id121" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id121" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Apply the <code>t.test</code> function to the sample <em>x</em> with the argument <code>mu = m</code>:</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="GeneralStatistics.html#cb568-1" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">mu =</span> m)</span></code></pre></div>
<p>The output includes a <em>p</em>-value. Conventionally, if <em>p</em> &lt; 0.05 then
the population mean is unlikely to be <em>m</em>, whereas <em>p</em> &gt; 0.05 provides
no such evidence.</p>
<p>If your sample size <em>n</em> is small, then the underlying population must be
normally distributed in order to derive meaningful results from the <em>t</em>
test. A good rule of thumb is that âsmallâ means <em>n</em> &lt; 30.</p>
</div>
<div id="discussion-id121" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id121" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>t</em> test is a workhorse of statistics, and this is one of its basic
uses: making inferences about a population mean from a sample. The
following example simulates sampling from a normal population with mean
<em>Î¼</em> = 100. It uses the <em>t</em> test to ask if the population mean could be
95, and <code>t.test</code> reports a <em>p</em>-value of 0.005:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="GeneralStatistics.html#cb569-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">75</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb569-2"><a href="GeneralStatistics.html#cb569-2" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">mu =</span> <span class="dv">95</span>)</span>
<span id="cb569-3"><a href="GeneralStatistics.html#cb569-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb569-4"><a href="GeneralStatistics.html#cb569-4" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb569-5"><a href="GeneralStatistics.html#cb569-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb569-6"><a href="GeneralStatistics.html#cb569-6" tabindex="-1"></a><span class="co">#&gt; data:  x</span></span>
<span id="cb569-7"><a href="GeneralStatistics.html#cb569-7" tabindex="-1"></a><span class="co">#&gt; t = 3, df = 74, p-value = 0.005</span></span>
<span id="cb569-8"><a href="GeneralStatistics.html#cb569-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 95</span></span>
<span id="cb569-9"><a href="GeneralStatistics.html#cb569-9" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb569-10"><a href="GeneralStatistics.html#cb569-10" tabindex="-1"></a><span class="co">#&gt;   96.5 103.0</span></span>
<span id="cb569-11"><a href="GeneralStatistics.html#cb569-11" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb569-12"><a href="GeneralStatistics.html#cb569-12" tabindex="-1"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb569-13"><a href="GeneralStatistics.html#cb569-13" tabindex="-1"></a><span class="co">#&gt;      99.7</span></span></code></pre></div>
<p>The <em>p</em>-value is small and so itâs unlikely (based on the sample data)
that 95 could be the mean of the population.</p>
<p>Informally, we could interpret the low <em>p</em>-value as follows. If the
population mean were really 95, then the probability of observing our
test statistic (<em>t</em> = 2.8898 or something more extreme) would be only
0.005. That is very improbable, yet that is the value we observed.
Hence we conclude that the null hypothesis is wrong; therefore, the
sample data does not support the claim that the population mean is 95.</p>
<p>In sharp contrast, testing for a mean of 100 gives a <em>p</em>-value of
0.9:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="GeneralStatistics.html#cb570-1" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">mu =</span> <span class="dv">100</span>)</span>
<span id="cb570-2"><a href="GeneralStatistics.html#cb570-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb570-3"><a href="GeneralStatistics.html#cb570-3" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb570-4"><a href="GeneralStatistics.html#cb570-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb570-5"><a href="GeneralStatistics.html#cb570-5" tabindex="-1"></a><span class="co">#&gt; data:  x</span></span>
<span id="cb570-6"><a href="GeneralStatistics.html#cb570-6" tabindex="-1"></a><span class="co">#&gt; t = -0.2, df = 74, p-value = 0.9</span></span>
<span id="cb570-7"><a href="GeneralStatistics.html#cb570-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 100</span></span>
<span id="cb570-8"><a href="GeneralStatistics.html#cb570-8" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb570-9"><a href="GeneralStatistics.html#cb570-9" tabindex="-1"></a><span class="co">#&gt;   96.5 103.0</span></span>
<span id="cb570-10"><a href="GeneralStatistics.html#cb570-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb570-11"><a href="GeneralStatistics.html#cb570-11" tabindex="-1"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb570-12"><a href="GeneralStatistics.html#cb570-12" tabindex="-1"></a><span class="co">#&gt;      99.7</span></span></code></pre></div>
<p>The large <em>p</em>-value indicates that the sample is consistent with
assuming a population mean <em>Î¼</em> of 100. In statistical terms, the data
does not provide evidence against the true mean being 100.</p>
<p>A common case is testing for a mean of zero. If you omit the <code>mu</code>
argument, it defaults to zero.</p>
</div>
<div id="see_also-id121" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id121" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>t.test</code> function is a many-splendored thing. See Recipes <a href="GeneralStatistics.html#recipe-id123">9.9</a>, <a href="GeneralStatistics.html#recipe-id123">âForming a Confidence Interval for a Meanâ</a>, and <a href="GeneralStatistics.html#recipe-id122">9.15</a>,
<a href="GeneralStatistics.html#recipe-id122">âComparing the Means of Two Samplesâ</a>, for other uses.</p>
</div>
</div>
<div id="recipe-id123" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Forming a Confidence Interval for a Mean<a href="GeneralStatistics.html#recipe-id123" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id123" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id123" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a sample from a population. Given that sample, you want to
determine a confidence interval for the populationâs mean.</p>
</div>
<div id="solution-id123" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id123" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Apply the <code>t.test</code> function to your sample <em>x</em>:</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="GeneralStatistics.html#cb571-1" tabindex="-1"></a><span class="fu">t.test</span>(x)</span></code></pre></div>
<p>The output includes a confidence interval at the 95% confidence level.
To see intervals at other levels, use the <code>conf.level</code> argument.</p>
<p>As in Recipe <a href="GeneralStatistics.html#recipe-id121">9.8</a>, <a href="GeneralStatistics.html#recipe-id121">âTesting the Mean of a Sampleâ</a>, if your sample size <em>n</em> is small, then the
underlying population must be normally distributed for there to be a
meaningful confidence interval. Again, a good rule of thumb is that
âsmallâ means <em>n</em> &lt; 30.</p>
</div>
<div id="discussion-id123" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id123" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Applying the <code>t.test</code> function to a vector yields a lot of output.
Buried in the output is a confidence interval:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="GeneralStatistics.html#cb572-1" tabindex="-1"></a><span class="fu">t.test</span>(x)</span>
<span id="cb572-2"><a href="GeneralStatistics.html#cb572-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb572-3"><a href="GeneralStatistics.html#cb572-3" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb572-4"><a href="GeneralStatistics.html#cb572-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb572-5"><a href="GeneralStatistics.html#cb572-5" tabindex="-1"></a><span class="co">#&gt; data:  x</span></span>
<span id="cb572-6"><a href="GeneralStatistics.html#cb572-6" tabindex="-1"></a><span class="co">#&gt; t = 53, df = 49, p-value &lt;2e-16</span></span>
<span id="cb572-7"><a href="GeneralStatistics.html#cb572-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span id="cb572-8"><a href="GeneralStatistics.html#cb572-8" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb572-9"><a href="GeneralStatistics.html#cb572-9" tabindex="-1"></a><span class="co">#&gt;   94.2 101.5</span></span>
<span id="cb572-10"><a href="GeneralStatistics.html#cb572-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb572-11"><a href="GeneralStatistics.html#cb572-11" tabindex="-1"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb572-12"><a href="GeneralStatistics.html#cb572-12" tabindex="-1"></a><span class="co">#&gt;      97.9</span></span></code></pre></div>
<p>In this example, the confidence interval is approximately 94.2 &lt; <em>Î¼</em>
&lt; 101.5, which is sometimes written simply as (94.2, 101.5).</p>
<p>We can raise the confidence level to 99% by setting <code>conf.level=0.99</code>:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="GeneralStatistics.html#cb573-1" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">conf.level =</span> <span class="fl">0.99</span>)</span>
<span id="cb573-2"><a href="GeneralStatistics.html#cb573-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb573-3"><a href="GeneralStatistics.html#cb573-3" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb573-4"><a href="GeneralStatistics.html#cb573-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb573-5"><a href="GeneralStatistics.html#cb573-5" tabindex="-1"></a><span class="co">#&gt; data:  x</span></span>
<span id="cb573-6"><a href="GeneralStatistics.html#cb573-6" tabindex="-1"></a><span class="co">#&gt; t = 53, df = 49, p-value &lt;2e-16</span></span>
<span id="cb573-7"><a href="GeneralStatistics.html#cb573-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span id="cb573-8"><a href="GeneralStatistics.html#cb573-8" tabindex="-1"></a><span class="co">#&gt; 99 percent confidence interval:</span></span>
<span id="cb573-9"><a href="GeneralStatistics.html#cb573-9" tabindex="-1"></a><span class="co">#&gt;   92.9 102.8</span></span>
<span id="cb573-10"><a href="GeneralStatistics.html#cb573-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb573-11"><a href="GeneralStatistics.html#cb573-11" tabindex="-1"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb573-12"><a href="GeneralStatistics.html#cb573-12" tabindex="-1"></a><span class="co">#&gt;      97.9</span></span></code></pre></div>
<p>That change widens the confidence interval to 92.9 &lt; <em>Î¼</em> &lt;
102.8.</p>
</div>
</div>
<div id="recipe-id135" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> Forming a Confidence Interval for a Median<a href="GeneralStatistics.html#recipe-id135" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id135" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id135" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a data sample, and you want to know the confidence interval for
the median.</p>
</div>
<div id="solution-id135" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id135" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>wilcox.test</code> function, setting <code>conf.int=TRUE</code>:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="GeneralStatistics.html#cb574-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The output will contain a confidence interval for the median.</p>
</div>
<div id="discussion-id135" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id135" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The procedure for calculating the confidence interval of a mean is
well defined and widely known. The same is not true for the median,
unfortunately. There are several procedures for calculating the medianâs
confidence interval. None of them is âtheâ procedure, but the Wilcoxon signed rank test is pretty standard.</p>
<p>The <code>wilcox.test</code> function implements that procedure. Buried in the
output is the 95% confidence interval, which is approximately (â0.102,
0.646) in this case:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="GeneralStatistics.html#cb575-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb575-2"><a href="GeneralStatistics.html#cb575-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb575-3"><a href="GeneralStatistics.html#cb575-3" tabindex="-1"></a><span class="co">#&gt;  Wilcoxon signed rank exact test</span></span>
<span id="cb575-4"><a href="GeneralStatistics.html#cb575-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb575-5"><a href="GeneralStatistics.html#cb575-5" tabindex="-1"></a><span class="co">#&gt; data:  x</span></span>
<span id="cb575-6"><a href="GeneralStatistics.html#cb575-6" tabindex="-1"></a><span class="co">#&gt; V = 220, p-value = 0.1</span></span>
<span id="cb575-7"><a href="GeneralStatistics.html#cb575-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true location is not equal to 0</span></span>
<span id="cb575-8"><a href="GeneralStatistics.html#cb575-8" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb575-9"><a href="GeneralStatistics.html#cb575-9" tabindex="-1"></a><span class="co">#&gt;  -0.102  0.646</span></span>
<span id="cb575-10"><a href="GeneralStatistics.html#cb575-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb575-11"><a href="GeneralStatistics.html#cb575-11" tabindex="-1"></a><span class="co">#&gt; (pseudo)median </span></span>
<span id="cb575-12"><a href="GeneralStatistics.html#cb575-12" tabindex="-1"></a><span class="co">#&gt;          0.311</span></span></code></pre></div>
<p>You can change the confidence level by setting <code>conf.level</code>, such as
<code>conf.level=0.99</code> or other such values.</p>
<p>The output also includes something called the <em>pseudomedian</em>, which is
defined on the help page. Donât assume it equals the median; they are
different:</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="GeneralStatistics.html#cb576-1" tabindex="-1"></a><span class="fu">median</span>(x)</span>
<span id="cb576-2"><a href="GeneralStatistics.html#cb576-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.314</span></span></code></pre></div>
</div>
<div id="see_also-id135" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id135" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The bootstrap procedure is also useful for estimating the medianâs
confidence interval; see Recipes <a href="Probability.html#recipe-id199">8.5</a>, <a href="#recipe-id199,">âGenerating a Random Sampleâ</a> and <a href="BeyondBasics.html#recipe-id159">13.8</a>,
<a href="BeyondBasics.html#recipe-id159">âBootstrapping a Statisticâ</a>.</p>
</div>
</div>
<div id="recipe-id225" class="section level2 hasAnchor" number="9.11">
<h2><span class="header-section-number">9.11</span> Testing a Sample Proportion<a href="GeneralStatistics.html#recipe-id225" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id225" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id225" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a sample of values from a population consisting of successes
and failures. You believe the true proportion of successes is <em>p</em>, and
you want to test that hypothesis using the sample data.</p>
</div>
<div id="solution-id225" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id225" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>prop.test</code> function. Suppose the sample size is <em>n</em> and the
sample contains <em>x</em> successes:</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="GeneralStatistics.html#cb577-1" tabindex="-1"></a><span class="fu">prop.test</span>(x, n, p)</span></code></pre></div>
<p>The output includes a <em>p</em>-value. Conventionally, a <em>p</em>-value of less
than 0.05 indicates that the true proportion is unlikely to be <em>p</em>,
whereas a <em>p</em>-value exceeding 0.05 fails to provide such evidence.</p>
</div>
<div id="discussion-id225" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id225" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose you encounter some loudmouthed fan of the Chicago Cubs early in
the baseball season. The Cubs have played 20 games and won 11 of them,
or 55% of their games. Based on that evidence, the fan is âvery
confidentâ that the Cubs will win more than half of their games this
year. Should he be that confident?</p>
<p>The <code>prop.test</code> function can evaluate the fanâs logic. Here, the number
of observations is <em>n</em> = 20, the number of successes is <em>x</em> = 11, and
<em>p</em> is the true probability of winning a game. We want to know whether
it is reasonable to conclude, based on the data, that <em>p</em> &gt; 0.5.
Normally, <code>prop.test</code> would check for <em>p</em> â  0.05, but we can check for
<em>p</em> &gt; 0.5 instead by setting <code>alternative="greater"</code>:</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="GeneralStatistics.html#cb578-1" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="dv">11</span>, <span class="dv">20</span>, <span class="fl">0.5</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb578-2"><a href="GeneralStatistics.html#cb578-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb578-3"><a href="GeneralStatistics.html#cb578-3" tabindex="-1"></a><span class="co">#&gt;  1-sample proportions test with continuity correction</span></span>
<span id="cb578-4"><a href="GeneralStatistics.html#cb578-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb578-5"><a href="GeneralStatistics.html#cb578-5" tabindex="-1"></a><span class="co">#&gt; data:  11 out of 20, null probability 0.5</span></span>
<span id="cb578-6"><a href="GeneralStatistics.html#cb578-6" tabindex="-1"></a><span class="co">#&gt; X-squared = 0.05, df = 1, p-value = 0.4</span></span>
<span id="cb578-7"><a href="GeneralStatistics.html#cb578-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true p is greater than 0.5</span></span>
<span id="cb578-8"><a href="GeneralStatistics.html#cb578-8" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb578-9"><a href="GeneralStatistics.html#cb578-9" tabindex="-1"></a><span class="co">#&gt;  0.35 1.00</span></span>
<span id="cb578-10"><a href="GeneralStatistics.html#cb578-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb578-11"><a href="GeneralStatistics.html#cb578-11" tabindex="-1"></a><span class="co">#&gt;    p </span></span>
<span id="cb578-12"><a href="GeneralStatistics.html#cb578-12" tabindex="-1"></a><span class="co">#&gt; 0.55</span></span></code></pre></div>
<p>The <code>prop.test</code> output shows a large <em>p</em>-value, 0.55, so we cannot
reject the null hypothesis; that is, we cannot reasonably conclude that
<em>p</em> is greater than 1/2. The Cubs fan is being overly confident based on
too little data. No surprise there.</p>
</div>
</div>
<div id="recipe-id226" class="section level2 hasAnchor" number="9.12">
<h2><span class="header-section-number">9.12</span> Forming a Confidence Interval for a Proportion<a href="GeneralStatistics.html#recipe-id226" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id226" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id226" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have a sample of values from a population consisting of successes
and failures. Based on the sample data, you want to form a confidence
interval for the populationâs proportion of successes.</p>
</div>
<div id="solution-id226" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id226" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>prop.test</code> function. Suppose the sample size is <em>n</em> and the
sample contains <em>x</em> successes:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="GeneralStatistics.html#cb579-1" tabindex="-1"></a><span class="fu">prop.test</span>(x, n)</span></code></pre></div>
<p>The function output includes the confidence interval for <em>p</em>.</p>
</div>
<div id="discussion-id226" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id226" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We subscribe to a stock market newsletter that is well written,
but includes a section purporting to identify stocks that are
likely to rise. It does this by looking for a certain pattern in the
stock price. It recently reported, for example, that a certain stock was
following the pattern. It also reported that the stock rose six times
after the last nine times that pattern occurred. The writers concluded
that the probability of the stock rising again was therefore 6/9, or
66.7%.</p>
<p>Using <code>prop.test</code>, we can obtain the confidence interval for the true
proportion of times the stock rises after the pattern. Here, the number
of observations is <em>n</em> = 9 and the number of successes is <em>x</em> = 6. The
output shows a confidence interval of (0.309, 0.910) at the 95%
confidence level:</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="GeneralStatistics.html#cb580-1" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="dv">6</span>, <span class="dv">9</span>)</span>
<span id="cb580-2"><a href="GeneralStatistics.html#cb580-2" tabindex="-1"></a><span class="co">#&gt; Warning in prop.test(6, 9): Chi-squared approximation may be incorrect</span></span>
<span id="cb580-3"><a href="GeneralStatistics.html#cb580-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb580-4"><a href="GeneralStatistics.html#cb580-4" tabindex="-1"></a><span class="co">#&gt;  1-sample proportions test with continuity correction</span></span>
<span id="cb580-5"><a href="GeneralStatistics.html#cb580-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb580-6"><a href="GeneralStatistics.html#cb580-6" tabindex="-1"></a><span class="co">#&gt; data:  6 out of 9, null probability 0.5</span></span>
<span id="cb580-7"><a href="GeneralStatistics.html#cb580-7" tabindex="-1"></a><span class="co">#&gt; X-squared = 0.4, df = 1, p-value = 0.5</span></span>
<span id="cb580-8"><a href="GeneralStatistics.html#cb580-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true p is not equal to 0.5</span></span>
<span id="cb580-9"><a href="GeneralStatistics.html#cb580-9" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb580-10"><a href="GeneralStatistics.html#cb580-10" tabindex="-1"></a><span class="co">#&gt;  0.309 0.910</span></span>
<span id="cb580-11"><a href="GeneralStatistics.html#cb580-11" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb580-12"><a href="GeneralStatistics.html#cb580-12" tabindex="-1"></a><span class="co">#&gt;     p </span></span>
<span id="cb580-13"><a href="GeneralStatistics.html#cb580-13" tabindex="-1"></a><span class="co">#&gt; 0.667</span></span></code></pre></div>
<p>The writers are pretty foolish to say the probability of rising is
66.7%. They could be leading their readers into a very bad bet.</p>
<p>By default, <code>prop.test</code> calculates a confidence interval at the 95%
confidence level. Use the <code>conf.level</code> argument for other confidence
levels:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="GeneralStatistics.html#cb581-1" tabindex="-1"></a><span class="fu">prop.test</span>(x, n, p, <span class="at">conf.level =</span> <span class="fl">0.99</span>)   <span class="co"># 99% confidence level</span></span></code></pre></div>
</div>
<div id="see_also-id226" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id226" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="GeneralStatistics.html#recipe-id225">9.11</a>, <a href="GeneralStatistics.html#recipe-id225">âTesting a Sample Proportionâ</a>.</p>
</div>
</div>
<div id="recipe-id126" class="section level2 hasAnchor" number="9.13">
<h2><span class="header-section-number">9.13</span> Testing for Normality<a href="GeneralStatistics.html#recipe-id126" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id126" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id126" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You want a statistical test to determine whether your data sample is
from a normally distributed population.</p>
</div>
<div id="solution-id126" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id126" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>shapiro.test</code> function:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="GeneralStatistics.html#cb582-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(x)</span></code></pre></div>
<p>The output includes a <em>p</em>-value. Conventionally, <em>p</em> &lt; 0.05 indicates
that the population is likely not normally distributed, whereas <em>p</em> &gt;
0.05 provides no such evidence.</p>
</div>
<div id="discussion-id126" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id126" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example reports a <em>p</em>-value of .7765 for <em>x</em>:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="GeneralStatistics.html#cb583-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(x)</span>
<span id="cb583-2"><a href="GeneralStatistics.html#cb583-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb583-3"><a href="GeneralStatistics.html#cb583-3" tabindex="-1"></a><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span id="cb583-4"><a href="GeneralStatistics.html#cb583-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb583-5"><a href="GeneralStatistics.html#cb583-5" tabindex="-1"></a><span class="co">#&gt; data:  x</span></span>
<span id="cb583-6"><a href="GeneralStatistics.html#cb583-6" tabindex="-1"></a><span class="co">#&gt; W = 1, p-value = 0.4</span></span></code></pre></div>
<p>The large <em>p</em>-value suggests the underlying population could be normally
distributed. The next example reports a very small <em>p</em>-value for <em>y</em>, so it
is unlikely that this sample came from a normal population:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="GeneralStatistics.html#cb584-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(y)</span>
<span id="cb584-2"><a href="GeneralStatistics.html#cb584-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb584-3"><a href="GeneralStatistics.html#cb584-3" tabindex="-1"></a><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span id="cb584-4"><a href="GeneralStatistics.html#cb584-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb584-5"><a href="GeneralStatistics.html#cb584-5" tabindex="-1"></a><span class="co">#&gt; data:  y</span></span>
<span id="cb584-6"><a href="GeneralStatistics.html#cb584-6" tabindex="-1"></a><span class="co">#&gt; W = 0.7, p-value = 7e-13</span></span></code></pre></div>
<p>We have highlighted the ShapiroâWilk test because it is a standard R
function. You can also install the package <code>nortest</code>, which is dedicated
entirely to tests for normality. This package includes:</p>
<ul>
<li><p>AndersonâDarling test (<code>ad.test</code>)</p></li>
<li><p>Cramerâvon Mises test (<code>cvm.test</code>)</p></li>
<li><p>Lilliefors test (<code>lillie.test</code>)</p></li>
<li><p>Pearson chi-squared test for the composite hypothesis of normality
(<code>pearson.test</code>)</p></li>
<li><p>ShapiroâFrancia test (<code>sf.test</code>)</p></li>
</ul>
<p>The problem with all these tests is their null hypothesis: they all
assume that the population is normally distributed until proven
otherwise. As a result, the population must be decidedly non-normal
before the test reports a small <em>p</em>-value and you can reject that null
hypothesis. That makes the tests quite conservative, tending to err on
the side of normality.</p>
<p>Instead of depending solely upon a statistical test, we suggest also
using histograms (Recipe <a href="Graphics.html#recipe-id182">10.19</a>, <a href="Graphics.html#recipe-id182">âCreating a Histogramâ</a>) and quantile-quantile plots
(Recipe <a href="Graphics.html#recipe-id180">10.21</a>, <a href="Graphics.html#recipe-id180">âCreating a Normal QuantileâQuantile Plotâ</a>) to evaluate the normality of any data. Are the
tails too fat? Is the peak too peaked? Your judgment is likely better
than a single statistical test.</p>
</div>
<div id="see_also-id126" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id126" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="NavigatingTheSoftware.html#recipe-id012">3.10</a>, <a href="NavigatingTheSoftware.html#recipe-id012">âInstalling Packages from CRANâ</a>, for how to install the <code>nortest</code> package.</p>
</div>
</div>
<div id="recipe-id131" class="section level2 hasAnchor" number="9.14">
<h2><span class="header-section-number">9.14</span> Testing for Runs<a href="GeneralStatistics.html#recipe-id131" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id131" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id131" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your data is a sequence of binary values: yes/no, 0/1, true/false, or
other two-valued data. You want to know: Is the sequence random?</p>
</div>
<div id="solution-id131" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id131" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>tseries</code> package contains the <code>runs.test</code> function, which checks a
sequence for randomness. The sequence should be a factor with two
levels:</p>
<pre><code>#&gt; Registered S3 method overwritten by &#39;quantmod&#39;:
#&gt;   method            from
#&gt;   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="GeneralStatistics.html#cb586-1" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb586-2"><a href="GeneralStatistics.html#cb586-2" tabindex="-1"></a><span class="fu">runs.test</span>(<span class="fu">as.factor</span>(s))</span></code></pre></div>
<p>The <code>runs.test</code> function reports a <em>p</em>-value. Conventionally, a
<em>p</em>-value of less than 0.05 indicates that the sequence is likely not
random, whereas a <em>p</em>-value exceeding 0.05 provides no such evidence.</p>
</div>
<div id="discussion-id131" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id131" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A run is a subsequence composed of identical values, such as all <code>1</code>s or
all <code>0</code>s. A random sequence should be properly jumbled up, without too
many runs. Similarly, it shouldnât contain too <em>few</em> runs, either. A
sequence of perfectly alternating values (<code>0</code>, <code>1</code>, <code>0</code>, <code>1</code>, <code>0</code>, <code>1</code>, â¦)
contains no runs, but would you say that itâs random?</p>
<p>The <code>runs.test</code> function checks the number of runs in your sequence. If
there are too many or too few, it reports a small <em>p</em>-value.</p>
<p>This first example generates a random sequence of <code>0</code>s and <code>1</code>s and then
tests the sequence for runs. Not surprisingly, <code>runs.test</code> reports a
large <em>p</em>-value, indicating the sequence is likely random:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="GeneralStatistics.html#cb587-1" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">100</span>, <span class="at">replace =</span> T)</span>
<span id="cb587-2"><a href="GeneralStatistics.html#cb587-2" tabindex="-1"></a><span class="fu">runs.test</span>(<span class="fu">as.factor</span>(s))</span>
<span id="cb587-3"><a href="GeneralStatistics.html#cb587-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb587-4"><a href="GeneralStatistics.html#cb587-4" tabindex="-1"></a><span class="co">#&gt;  Runs Test</span></span>
<span id="cb587-5"><a href="GeneralStatistics.html#cb587-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb587-6"><a href="GeneralStatistics.html#cb587-6" tabindex="-1"></a><span class="co">#&gt; data:  as.factor(s)</span></span>
<span id="cb587-7"><a href="GeneralStatistics.html#cb587-7" tabindex="-1"></a><span class="co">#&gt; Standard Normal = -0.2, p-value = 0.9</span></span>
<span id="cb587-8"><a href="GeneralStatistics.html#cb587-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two.sided</span></span></code></pre></div>
<p>This next sequence, however, consists of three runs and so the reported
<em>p</em>-value is quite low:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="GeneralStatistics.html#cb588-1" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb588-2"><a href="GeneralStatistics.html#cb588-2" tabindex="-1"></a><span class="fu">runs.test</span>(<span class="fu">as.factor</span>(s))</span>
<span id="cb588-3"><a href="GeneralStatistics.html#cb588-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb588-4"><a href="GeneralStatistics.html#cb588-4" tabindex="-1"></a><span class="co">#&gt;  Runs Test</span></span>
<span id="cb588-5"><a href="GeneralStatistics.html#cb588-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb588-6"><a href="GeneralStatistics.html#cb588-6" tabindex="-1"></a><span class="co">#&gt; data:  as.factor(s)</span></span>
<span id="cb588-7"><a href="GeneralStatistics.html#cb588-7" tabindex="-1"></a><span class="co">#&gt; Standard Normal = -2, p-value = 0.02</span></span>
<span id="cb588-8"><a href="GeneralStatistics.html#cb588-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two.sided</span></span></code></pre></div>
</div>
<div id="see_also-id131" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id131" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipes <a href="DataStructures.html#recipe-id051">5.4</a>, <a href="DataStructures.html#recipe-id051">âCreating a Factorâ</a>, and <a href="Probability.html#recipe-id200">8.6</a>, <a href="Probability.html#recipe-id200">âGenerating Random Sequencesâ</a>.</p>
</div>
</div>
<div id="recipe-id122" class="section level2 hasAnchor" number="9.15">
<h2><span class="header-section-number">9.15</span> Comparing the Means of Two Samples<a href="GeneralStatistics.html#recipe-id122" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id122" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id122" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have one sample each from two populations. You want to know if the
two populations could have the same mean.</p>
</div>
<div id="solution-id122" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id122" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Perform a <em>t</em> test by calling the <code>t.test</code> function:</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="GeneralStatistics.html#cb589-1" tabindex="-1"></a><span class="fu">t.test</span>(x, y)</span></code></pre></div>
<p>By default, <code>t.test</code> assumes that your data are not paired. If the
observations are paired (i.e., if each <em>x<sub>i</sub></em> is paired with one
<em>y<sub>i</sub></em>), then specify <code>paired=TRUE</code>:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="GeneralStatistics.html#cb590-1" tabindex="-1"></a><span class="fu">t.test</span>(x, y, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>In either case, <code>t.test</code> will compute a <em>p</em>-value. Conventionally, if
<em>p</em> &lt; 0.05 then the means are likely different, whereas <em>p</em> &gt; 0.05
provides no such evidence:</p>
<ul>
<li><p>If either sample size is small, then the populations must be
normally distributed. Here, âsmallâ means fewer than 20 data points.</p></li>
<li><p>If the two populations have the same variance, specify
<code>var.equal=TRUE</code> to obtain a less conservative test.</p></li>
</ul>
</div>
<div id="discussion-id122" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id122" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We often use the <em>t</em> test to get a quick sense of the difference between
two population means. It requires that the samples be large enough (i.e., both
samples have 20 or more observations) or that the underlying populations
be normally distributed. We donât take the ânormally distributedâ part
too literally. Being bell-shaped and reasonably symmetrical should be good enough.</p>
<p>A key distinction here is whether or not your data contains paired
observations, since the results may differ in the two cases. Suppose we
want to know if coffee in the morning improves scores on SATs. We
could run the experiment two ways:</p>
<ul>
<li><p>Randomly select one group of people. Give them the SAT twice,
once with morning coffee and once without morning coffee. For each
person, we will have two SAT scores. These are paired observations.</p></li>
<li><p>Randomly select two groups of people. One group has a cup of morning
coffee and takes the SAT. The other group just takes the test.
We have a score for each person, but the scores are not paired in
any way.</p></li>
</ul>
<p>Statistically, these experiments are quite different. In experiment 1,
there are two observations for each person (caffeinated and decaf) and
they are not statistically independent. In experiment 2, the data are
independent.</p>
<p>If you have paired observations (experiment 1) and erroneously analyze
them as unpaired observations (experiment 2), then you could get this
result with a <em>p</em>-value of 0.3:</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="GeneralStatistics.html#cb591-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/sat.rdata&quot;</span>)</span>
<span id="cb591-2"><a href="GeneralStatistics.html#cb591-2" tabindex="-1"></a><span class="fu">t.test</span>(x, y)</span>
<span id="cb591-3"><a href="GeneralStatistics.html#cb591-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb591-4"><a href="GeneralStatistics.html#cb591-4" tabindex="-1"></a><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span id="cb591-5"><a href="GeneralStatistics.html#cb591-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb591-6"><a href="GeneralStatistics.html#cb591-6" tabindex="-1"></a><span class="co">#&gt; data:  x and y</span></span>
<span id="cb591-7"><a href="GeneralStatistics.html#cb591-7" tabindex="-1"></a><span class="co">#&gt; t = -1, df = 198, p-value = 0.3</span></span>
<span id="cb591-8"><a href="GeneralStatistics.html#cb591-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb591-9"><a href="GeneralStatistics.html#cb591-9" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb591-10"><a href="GeneralStatistics.html#cb591-10" tabindex="-1"></a><span class="co">#&gt;  -46.4  16.2</span></span>
<span id="cb591-11"><a href="GeneralStatistics.html#cb591-11" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb591-12"><a href="GeneralStatistics.html#cb591-12" tabindex="-1"></a><span class="co">#&gt; mean of x mean of y </span></span>
<span id="cb591-13"><a href="GeneralStatistics.html#cb591-13" tabindex="-1"></a><span class="co">#&gt;      1054      1069</span></span></code></pre></div>
<p>The large <em>p</em>-value forces you to conclude there is no difference
between the groups. Contrast that result with the one that follows from
analyzing the same data but correctly identifying it as paired:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="GeneralStatistics.html#cb592-1" tabindex="-1"></a><span class="fu">t.test</span>(x, y, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb592-2"><a href="GeneralStatistics.html#cb592-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb592-3"><a href="GeneralStatistics.html#cb592-3" tabindex="-1"></a><span class="co">#&gt;  Paired t-test</span></span>
<span id="cb592-4"><a href="GeneralStatistics.html#cb592-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb592-5"><a href="GeneralStatistics.html#cb592-5" tabindex="-1"></a><span class="co">#&gt; data:  x and y</span></span>
<span id="cb592-6"><a href="GeneralStatistics.html#cb592-6" tabindex="-1"></a><span class="co">#&gt; t = -18, df = 99, p-value &lt;2e-16</span></span>
<span id="cb592-7"><a href="GeneralStatistics.html#cb592-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean difference is not equal to 0</span></span>
<span id="cb592-8"><a href="GeneralStatistics.html#cb592-8" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb592-9"><a href="GeneralStatistics.html#cb592-9" tabindex="-1"></a><span class="co">#&gt;  -16.8 -13.5</span></span>
<span id="cb592-10"><a href="GeneralStatistics.html#cb592-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb592-11"><a href="GeneralStatistics.html#cb592-11" tabindex="-1"></a><span class="co">#&gt; mean difference </span></span>
<span id="cb592-12"><a href="GeneralStatistics.html#cb592-12" tabindex="-1"></a><span class="co">#&gt;           -15.1</span></span></code></pre></div>
<p>The <em>p</em>-value plummets to 2e-16, and we reach the exactly opposite
conclusion.</p>
</div>
<div id="see_also-id122" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id122" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If the populations are not normally distributed (bell-shaped) and either
sample is small, consider using the WilcoxonâMannâWhitney test described
in Recipe <a href="GeneralStatistics.html#recipe-id130">9.16</a>,
<a href="GeneralStatistics.html#recipe-id130">âComparing the Locations of Two Samples Nonparametricallyâ</a>.</p>
</div>
</div>
<div id="recipe-id130" class="section level2 hasAnchor" number="9.16">
<h2><span class="header-section-number">9.16</span> Comparing the Locations of Two Samples Nonparametrically<a href="GeneralStatistics.html#recipe-id130" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id130" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id130" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have samples from two populations. You donât know the distribution
of the populations, but you know they have similar shapes. You want to
know: Is one population shifted to the left or right compared with the
other?</p>
</div>
<div id="solution-id130" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id130" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can use a nonparametric test, the WilcoxonâMannâWhitney test, which
is implemented by the <code>wilcox.test</code> function. For paired observations
(every <em>x</em><sub><em>i</em></sub> is paired with <em>y</em><sub><em>i</em></sub>), set <code>paired=TRUE</code>:</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="GeneralStatistics.html#cb593-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>For unpaired observations, let <code>paired</code> default to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="GeneralStatistics.html#cb594-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y)</span></code></pre></div>
<p>The test output includes a <em>p</em>-value. Conventionally, a <em>p</em>-value of
less than 0.05 indicates that the second population is likely shifted
left or right with respect to the first population, whereas a <em>p</em>-value
exceeding 0.05 provides no such evidence.</p>
</div>
<div id="discussion-id130" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id130" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we stop making assumptions regarding the distributions of
populations, we enter the world of nonparametric statistics. The
WilcoxonâMannâWhitney test is nonparametric and so can be applied to
more datasets than the <em>t</em> test, which requires that the data be
normally distributed (for small samples). This testâs only assumption is
that the two populations have the same shape.</p>
<p>In this recipe, we are asking: Is the second population shifted left or
right with respect to the first? This is similar to asking whether the
average of the second population is smaller or larger than the first.
However, the WilcoxonâMannâWhitney test answers a different question: it
tells us whether the central locations of the two populations are
significantly different or, equivalently, whether their relative
frequencies are different.</p>
<p>Suppose we randomly select a group of employees and ask each one to
complete the same task under two different circumstances: under
favorable conditions and under unfavorable conditions, such as a noisy
environment. We measure their completion times under both conditions, so
we have two measurements for each employee. We want to know if the two
times are significantly different, but we canât assume they are normally
distributed.</p>
<p>The data are paired, so we must set <code>paired=TRUE</code>:</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="GeneralStatistics.html#cb595-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./data/workers.rdata&quot;</span>)</span>
<span id="cb595-2"><a href="GeneralStatistics.html#cb595-2" tabindex="-1"></a><span class="fu">wilcox.test</span>(fav, unfav, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb595-3"><a href="GeneralStatistics.html#cb595-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb595-4"><a href="GeneralStatistics.html#cb595-4" tabindex="-1"></a><span class="co">#&gt;  Wilcoxon signed rank exact test</span></span>
<span id="cb595-5"><a href="GeneralStatistics.html#cb595-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb595-6"><a href="GeneralStatistics.html#cb595-6" tabindex="-1"></a><span class="co">#&gt; data:  fav and unfav</span></span>
<span id="cb595-7"><a href="GeneralStatistics.html#cb595-7" tabindex="-1"></a><span class="co">#&gt; V = 12, p-value = 1e-04</span></span>
<span id="cb595-8"><a href="GeneralStatistics.html#cb595-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<p>The <em>p</em>-value is essentially zero. Statistically speaking, we reject the
assumption that the completion times were equal. Practically speaking,
itâs reasonable to conclude that the times were different.</p>
<p>In this example, setting <code>paired=TRUE</code> is critical. Treating the data as
unpaired would be wrong because the observations are not independent;
and this, in turn, would produce bogus results. Running the example with
<code>paired=FALSE</code> produces a <em>p</em>-value of 0.1022, which leads to the wrong
conclusion.</p>
</div>
<div id="see_also-id130" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id130" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="GeneralStatistics.html#recipe-id122">9.15</a>, <a href="GeneralStatistics.html#recipe-id122">âComparing the Means of Two Samplesâ</a>, for the
parametric test.</p>
</div>
</div>
<div id="recipe-id132" class="section level2 hasAnchor" number="9.17">
<h2><span class="header-section-number">9.17</span> Testing a Correlation for Significance<a href="GeneralStatistics.html#recipe-id132" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id132" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id132" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You calculated the correlation between two variables, but you donât know
if the correlation is statistically significant.</p>
</div>
<div id="solution-id132" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id132" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>cor.test</code> function can calculate both the <em>p</em>-value and the
confidence interval of the correlation. If the variables came from
normally distributed populations then use the default measure of
correlation, which is the Pearson method:</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="GeneralStatistics.html#cb596-1" tabindex="-1"></a><span class="fu">cor.test</span>(x, y)</span></code></pre></div>
<p>For non-normal populations, use the Spearman method instead:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="GeneralStatistics.html#cb597-1" tabindex="-1"></a><span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<p>The function returns several values, including the <em>p</em>-value from the
test of significance. Conventionally, <em>p</em> &lt; 0.05 indicates that the
correlation is likely significant, whereas <em>p</em> &gt; 0.05 indicates it is
not.</p>
</div>
<div id="discussion-id132" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id132" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In our experience, people often fail to check a correlation for
significance. In fact, many people are unaware that a correlation can be
insignificant. They jam their data into a computer, calculate the
correlation, and blindly believe the result. However, they should ask
themselves: Was there enough data? Is the magnitude of the correlation
large enough? Fortunately, the <code>cor.test</code> function answers those
questions.</p>
<p>Suppose we have two vectors, <em>x</em> and <em>y</em>, with values from normal
populations. We might be very pleased that their correlation is greater
than 0.75:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="GeneralStatistics.html#cb598-1" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span>
<span id="cb598-2"><a href="GeneralStatistics.html#cb598-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.751</span></span></code></pre></div>
<p>But that is naÃ¯ve. If we run <code>cor.test</code>, it reports a relatively large
<em>p</em>-value of 0.09:</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="GeneralStatistics.html#cb599-1" tabindex="-1"></a><span class="fu">cor.test</span>(x, y)</span>
<span id="cb599-2"><a href="GeneralStatistics.html#cb599-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb599-3"><a href="GeneralStatistics.html#cb599-3" tabindex="-1"></a><span class="co">#&gt;  Pearson&#39;s product-moment correlation</span></span>
<span id="cb599-4"><a href="GeneralStatistics.html#cb599-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb599-5"><a href="GeneralStatistics.html#cb599-5" tabindex="-1"></a><span class="co">#&gt; data:  x and y</span></span>
<span id="cb599-6"><a href="GeneralStatistics.html#cb599-6" tabindex="-1"></a><span class="co">#&gt; t = 2, df = 4, p-value = 0.09</span></span>
<span id="cb599-7"><a href="GeneralStatistics.html#cb599-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb599-8"><a href="GeneralStatistics.html#cb599-8" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb599-9"><a href="GeneralStatistics.html#cb599-9" tabindex="-1"></a><span class="co">#&gt;  -0.155  0.971</span></span>
<span id="cb599-10"><a href="GeneralStatistics.html#cb599-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb599-11"><a href="GeneralStatistics.html#cb599-11" tabindex="-1"></a><span class="co">#&gt;   cor </span></span>
<span id="cb599-12"><a href="GeneralStatistics.html#cb599-12" tabindex="-1"></a><span class="co">#&gt; 0.751</span></span></code></pre></div>
<p>The <em>p</em>-value is above the conventional threshold of 0.05, so we
conclude that the correlation is unlikely to be significant.</p>
<p>You can also check the correlation by using the confidence interval. In
this example, the confidence interval is (â0.155, 0.971). The interval
contains zero and so it is possible that the correlation is zero, in
which case there would be no correlation. Again, you could not be
confident that the reported correlation is significant.</p>
<p>The <code>cor.test</code> output also includes the point estimate reported by <code>cor</code>
(at the bottom, labeled âsample estimatesâ), saving you the additional
step of running <code>cor</code>.</p>
<p>By default, <code>cor.test</code> calculates the Pearson correlation, which assumes
that the underlying populations are normally distributed. The Spearman
method makes no such assumption because it is nonparametric. Use
<code>method="Spearman"</code> when working with nonnormal data.</p>
</div>
<div id="see_also-id132" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id132" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="SomeBasics.html#recipe-id101">2.6</a>, <a href="SomeBasics.html#recipe-id101">âComputing Basic Statisticsâ</a>, for calculating simple correlations.</p>
</div>
</div>
<div id="recipe-id134" class="section level2 hasAnchor" number="9.18">
<h2><span class="header-section-number">9.18</span> Testing Groups for Equal Proportions<a href="GeneralStatistics.html#recipe-id134" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id134" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id134" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have samples from two or more groups. The groupâs elements are
binary-valued: either success or failure. You want to know if the groups
have equal proportions of successes.</p>
</div>
<div id="solution-id134" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id134" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>prop.test</code> function with two vector arguments:</p>
<pre><code>#&gt; 
#&gt;  2-sample test for equality of proportions with continuity correction
#&gt; 
#&gt; data:  ns out of nt
#&gt; X-squared = 5, df = 1, p-value = 0.03
#&gt; alternative hypothesis: two.sided
#&gt; 95 percent confidence interval:
#&gt;  -0.3058 -0.0142
#&gt; sample estimates:
#&gt; prop 1 prop 2 
#&gt;   0.48   0.64</code></pre>
<p>These are parallel vectors. The first vector, <code>ns</code>, gives the number of
successes in each group. The second vector, <code>nt</code>, gives the size of the
corresponding group (often called the <em>number of trials</em>).</p>
<p>The output includes a <em>p</em>-value. Conventionally, a <em>p</em>-value of less
than 0.05 indicates that it is likely the groupsâ proportions are
different, whereas a <em>p</em>-value exceeding 0.05 provides no such evidence.</p>
</div>
<div id="discussion-id134" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id134" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Recipe <a href="GeneralStatistics.html#recipe-id225">9.11</a>, <a href="GeneralStatistics.html#recipe-id225">âTesting a Sample Proportionâ</a>, we tested a proportion
based on one sample. Here, we have samples from several groups and want
to compare the proportions in the underlying groups.</p>
<p>One of the authors recently taught statistics to 38 students and awarded a grade of A to 14 of them.
A colleague taught the same class to 40 students and awarded
an A to only 10. We wanted to know: Is the author fostering grade inflation by
awarding significantly more A grades than the other teacher did?</p>
<p>We used <code>prop.test</code>. âSuccessâ means awarding an A, so the vector of
successes contains two elements: the number awarded by the author and the number
awarded by the colleague:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="GeneralStatistics.html#cb601-1" tabindex="-1"></a>successes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">10</span>)</span></code></pre></div>
<p>The number of trials is the number of students in the corresponding class:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="GeneralStatistics.html#cb602-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">40</span>)</span></code></pre></div>
<p>The <code>prop.test</code> output yields a <em>p</em>-value of 0.4:</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="GeneralStatistics.html#cb603-1" tabindex="-1"></a><span class="fu">prop.test</span>(successes, trials)</span>
<span id="cb603-2"><a href="GeneralStatistics.html#cb603-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb603-3"><a href="GeneralStatistics.html#cb603-3" tabindex="-1"></a><span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span></span>
<span id="cb603-4"><a href="GeneralStatistics.html#cb603-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb603-5"><a href="GeneralStatistics.html#cb603-5" tabindex="-1"></a><span class="co">#&gt; data:  successes out of trials</span></span>
<span id="cb603-6"><a href="GeneralStatistics.html#cb603-6" tabindex="-1"></a><span class="co">#&gt; X-squared = 0.8, df = 1, p-value = 0.4</span></span>
<span id="cb603-7"><a href="GeneralStatistics.html#cb603-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two.sided</span></span>
<span id="cb603-8"><a href="GeneralStatistics.html#cb603-8" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb603-9"><a href="GeneralStatistics.html#cb603-9" tabindex="-1"></a><span class="co">#&gt;  -0.111  0.348</span></span>
<span id="cb603-10"><a href="GeneralStatistics.html#cb603-10" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb603-11"><a href="GeneralStatistics.html#cb603-11" tabindex="-1"></a><span class="co">#&gt; prop 1 prop 2 </span></span>
<span id="cb603-12"><a href="GeneralStatistics.html#cb603-12" tabindex="-1"></a><span class="co">#&gt;  0.368  0.250</span></span></code></pre></div>
<p>The relatively large <em>p</em>-value means that we cannot reject the null
hypothesis: the evidence does not suggest any difference between the teachersâ grading.</p>
</div>
<div id="see_also-id134" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id134" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipe <a href="GeneralStatistics.html#recipe-id225">9.11</a>, <a href="GeneralStatistics.html#recipe-id225">âTesting a Sample Proportionâ</a>.</p>
</div>
</div>
<div id="recipe-id127" class="section level2 hasAnchor" number="9.19">
<h2><span class="header-section-number">9.19</span> Performing Pairwise Comparisons Between Group Means<a href="GeneralStatistics.html#recipe-id127" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id127" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id127" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have several samples, and you want to perform a pairwise comparison
between the sample means. That is, you want to compare the mean of every
sample against the mean of every other sample.</p>
</div>
<div id="solution-id127" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id127" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Place all data into one vector and create a parallel factor to identify
the groups. Use <code>pairwise.t.test</code> to perform the pairwise comparison of
means:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="GeneralStatistics.html#cb604-1" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(x, f)   <span class="co"># x is the data, f is the grouping factor</span></span></code></pre></div>
<p>The output contains a table of <em>p</em>-values, one for each pair of groups.
Conventionally, if <em>p</em> &lt; 0.05 then the two groups likely have
different means, whereas <em>p</em> &gt; 0.05 provides no such evidence.</p>
</div>
<div id="discussion-id127" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id127" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is more complicated than Recipe <a href="GeneralStatistics.html#recipe-id122">9.15</a>,
<a href="GeneralStatistics.html#recipe-id122">âComparing the Means of Two Samplesâ</a>, where we compared
the means of two samples. Here we have several samples and want to
compare the mean of every sample against the mean of every other sample.</p>
<p>Statistically speaking, pairwise comparisons are tricky. It is not the
same as simply performing a <em>t</em> test on every possible pair. The
<em>p</em>-values must be adjusted, as otherwise you will get an overly
optimistic result. The help pages for <code>pairwise.t.test</code> and <code>p.adjust</code>
describe the adjustment algorithms available in R. Anyone doing serious
pairwise comparisons is urged to review the help pages and consult a
good textbook on the subject.</p>
<p>Suppose we are using a larger sample of the data from Recipe <a href="DataStructures.html#recipe-id227">5.5</a>, <a href="DataStructures.html#recipe-id227">âCombining Multiple Vectors into One Vector and a Factorâ</a>, where we combined
data for freshmen, sophomores, and juniors into a data frame called
<code>comb</code>. The data frame has two columns: the data in a column called
<code>values</code>, and the grouping factor in a column called <code>ind</code>. We can use
<code>pairwise.t.test</code> to perform pairwise comparisons between the groups:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="GeneralStatistics.html#cb605-1" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(comb<span class="sc">$</span>values, comb<span class="sc">$</span>ind)</span>
<span id="cb605-2"><a href="GeneralStatistics.html#cb605-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb605-3"><a href="GeneralStatistics.html#cb605-3" tabindex="-1"></a><span class="co">#&gt;  Pairwise comparisons using t tests with pooled SD </span></span>
<span id="cb605-4"><a href="GeneralStatistics.html#cb605-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb605-5"><a href="GeneralStatistics.html#cb605-5" tabindex="-1"></a><span class="co">#&gt; data:  comb$values and comb$ind </span></span>
<span id="cb605-6"><a href="GeneralStatistics.html#cb605-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb605-7"><a href="GeneralStatistics.html#cb605-7" tabindex="-1"></a><span class="co">#&gt;      fresh soph </span></span>
<span id="cb605-8"><a href="GeneralStatistics.html#cb605-8" tabindex="-1"></a><span class="co">#&gt; soph 0.001 -    </span></span>
<span id="cb605-9"><a href="GeneralStatistics.html#cb605-9" tabindex="-1"></a><span class="co">#&gt; jrs  3e-04 0.592</span></span>
<span id="cb605-10"><a href="GeneralStatistics.html#cb605-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb605-11"><a href="GeneralStatistics.html#cb605-11" tabindex="-1"></a><span class="co">#&gt; P value adjustment method: holm</span></span></code></pre></div>
<p>Notice the table of <em>p</em>-values. The comparisons of juniors versus
freshmen and of sophomores versus freshmen produced small <em>p</em>-values:
0.0011 and 0.0003, respectively. We can conclude there are significant
differences between those groups. However, the comparison of sophomores
versus juniors produced a (relatively) large <em>p</em>-value of 0.592, so
they are not significantly different.</p>
</div>
<div id="see_also-id127" class="section level3 unnumbered hasAnchor">
<h3>See Also<a href="GeneralStatistics.html#see_also-id127" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>See Recipes <a href="DataStructures.html#recipe-id227">5.5</a>, <a href="DataStructures.html#recipe-id227">âCombining Multiple Vectors into One Vector and a Factorâ</a> and <a href="GeneralStatistics.html#recipe-id122">9.15</a>, <a href="GeneralStatistics.html#recipe-id122">âComparing the Means of Two Samplesâ</a>.</p>
</div>
</div>
<div id="recipe-id129" class="section level2 hasAnchor" number="9.20">
<h2><span class="header-section-number">9.20</span> Testing Two Samples for the Same Distribution<a href="GeneralStatistics.html#recipe-id129" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problem-id129" class="section level3 unnumbered hasAnchor">
<h3>Problem<a href="GeneralStatistics.html#problem-id129" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have two samples, and you are wondering: Did they come from the same distribution?</p>
</div>
<div id="solution-id129" class="section level3 unnumbered hasAnchor">
<h3>Solution<a href="GeneralStatistics.html#solution-id129" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The KolmogorovâSmirnov test compares two samples and tests them for
being drawn from the same distribution. The <code>ks.test</code> function
implements that test:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="GeneralStatistics.html#cb606-1" tabindex="-1"></a><span class="fu">ks.test</span>(x, y)</span></code></pre></div>
<p>The output includes a <em>p</em>-value. Conventionally, a <em>p</em>-value of less
than 0.05 indicates that the two samples (<em>x</em> and <em>y</em>) were drawn from
different distributions, whereas a <em>p</em>-value exceeding 0.05 provides no
such evidence.</p>
</div>
<div id="discussion-id129" class="section level3 unnumbered hasAnchor">
<h3>Discussion<a href="GeneralStatistics.html#discussion-id129" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The KolmogorovâSmirnov test is wonderful for two reasons. First, it is a
nonparametric test and so you neednât make any assumptions regarding the
underlying distributions: it works for all distributions. Second, it
checks the location, dispersion, and shape of the populations, based on
the samples. If these characteristics disagree then the test will detect
that, allowing us to conclude that the underlying distributions are
different.</p>
<p>Suppose we suspect that the vectors <em>x</em> and <em>y</em> come from differing
distributions. Here, <code>ks.test</code> reports a <em>p</em>-value of 0.04:</p>
<pre><code>#&gt; 
#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test
#&gt; 
#&gt; data:  x and y
#&gt; D = 0.2, p-value = 0.04
#&gt; alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="GeneralStatistics.html#cb608-1" tabindex="-1"></a><span class="fu">ks.test</span>(x, y)</span>
<span id="cb608-2"><a href="GeneralStatistics.html#cb608-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb608-3"><a href="GeneralStatistics.html#cb608-3" tabindex="-1"></a><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span id="cb608-4"><a href="GeneralStatistics.html#cb608-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb608-5"><a href="GeneralStatistics.html#cb608-5" tabindex="-1"></a><span class="co">#&gt; data:  x and y</span></span>
<span id="cb608-6"><a href="GeneralStatistics.html#cb608-6" tabindex="-1"></a><span class="co">#&gt; D = 0.2, p-value = 0.04</span></span>
<span id="cb608-7"><a href="GeneralStatistics.html#cb608-7" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two-sided</span></span></code></pre></div>
<p>From the small <em>p</em>-value we can conclude that the samples are from
different distributions. However, when we test <em>x</em> against another
sample, <em>z</em>, the <em>p</em>-value is much larger (0.6); this suggests that
<em>x</em> and <em>z</em> could have the same underlying distribution:</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="GeneralStatistics.html#cb609-1" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span>
<span id="cb609-2"><a href="GeneralStatistics.html#cb609-2" tabindex="-1"></a><span class="fu">ks.test</span>(x, z)</span>
<span id="cb609-3"><a href="GeneralStatistics.html#cb609-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb609-4"><a href="GeneralStatistics.html#cb609-4" tabindex="-1"></a><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span id="cb609-5"><a href="GeneralStatistics.html#cb609-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb609-6"><a href="GeneralStatistics.html#cb609-6" tabindex="-1"></a><span class="co">#&gt; data:  x and z</span></span>
<span id="cb609-7"><a href="GeneralStatistics.html#cb609-7" tabindex="-1"></a><span class="co">#&gt; D = 0.1, p-value = 0.6</span></span>
<span id="cb609-8"><a href="GeneralStatistics.html#cb609-8" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two-sided</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Probability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/CerebralMastication/R-Cookbook/edit/master/09_GeneralStatistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
